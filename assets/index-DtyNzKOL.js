function Zb(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();console.log("=== Environment Debug ===");console.log("Mode:","production");console.log("Prod:",!0);console.log("Dev:",!1);console.log("Base URL:","/Project-managment-app/");console.log("Supabase URL exists:",!0);console.log("Supabase Key exists:",!0);console.log("Current Origin:",typeof window<"u"?window.location.origin:"server-side");console.log("========================");var Gn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ng(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function zT(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var Qb={exports:{}},ch={},Gb={exports:{}},Fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Iu=Symbol.for("react.element"),BT=Symbol.for("react.portal"),FT=Symbol.for("react.fragment"),$T=Symbol.for("react.strict_mode"),UT=Symbol.for("react.profiler"),VT=Symbol.for("react.provider"),HT=Symbol.for("react.context"),qT=Symbol.for("react.forward_ref"),WT=Symbol.for("react.suspense"),KT=Symbol.for("react.memo"),ZT=Symbol.for("react.lazy"),m_=Symbol.iterator;function QT(t){return t===null||typeof t!="object"?null:(t=m_&&t[m_]||t["@@iterator"],typeof t=="function"?t:null)}var Jb={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Yb=Object.assign,Xb={};function Wa(t,e,n){this.props=t,this.context=e,this.refs=Xb,this.updater=n||Jb}Wa.prototype.isReactComponent={};Wa.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Wa.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function ex(){}ex.prototype=Wa.prototype;function Lg(t,e,n){this.props=t,this.context=e,this.refs=Xb,this.updater=n||Jb}var Rg=Lg.prototype=new ex;Rg.constructor=Lg;Yb(Rg,Wa.prototype);Rg.isPureReactComponent=!0;var g_=Array.isArray,tx=Object.prototype.hasOwnProperty,Dg={current:null},nx={key:!0,ref:!0,__self:!0,__source:!0};function rx(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)tx.call(e,r)&&!nx.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var u=Array(l),d=0;d<l;d++)u[d]=arguments[d+2];i.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:Iu,type:t,key:s,ref:o,props:i,_owner:Dg.current}}function GT(t,e){return{$$typeof:Iu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Ag(t){return typeof t=="object"&&t!==null&&t.$$typeof===Iu}function JT(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var y_=/\/+/g;function Ef(t,e){return typeof t=="object"&&t!==null&&t.key!=null?JT(""+t.key):e.toString(36)}function Zc(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Iu:case BT:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Ef(o,0):r,g_(i)?(n="",t!=null&&(n=t.replace(y_,"$&/")+"/"),Zc(i,e,n,"",function(d){return d})):i!=null&&(Ag(i)&&(i=GT(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(y_,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",g_(t))for(var l=0;l<t.length;l++){s=t[l];var u=r+Ef(s,l);o+=Zc(s,e,n,u,i)}else if(u=QT(t),typeof u=="function")for(t=u.call(t),l=0;!(s=t.next()).done;)s=s.value,u=r+Ef(s,l++),o+=Zc(s,e,n,u,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function pc(t,e,n){if(t==null)return t;var r=[],i=0;return Zc(t,r,"","",function(s){return e.call(n,s,i++)}),r}function YT(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var kn={current:null},Qc={transition:null},XT={ReactCurrentDispatcher:kn,ReactCurrentBatchConfig:Qc,ReactCurrentOwner:Dg};function ix(){throw Error("act(...) is not supported in production builds of React.")}Fe.Children={map:pc,forEach:function(t,e,n){pc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return pc(t,function(){e++}),e},toArray:function(t){return pc(t,function(e){return e})||[]},only:function(t){if(!Ag(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Fe.Component=Wa;Fe.Fragment=FT;Fe.Profiler=UT;Fe.PureComponent=Lg;Fe.StrictMode=$T;Fe.Suspense=WT;Fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XT;Fe.act=ix;Fe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Yb({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Dg.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)tx.call(e,u)&&!nx.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var d=0;d<u;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:Iu,type:t.type,key:i,ref:s,props:r,_owner:o}};Fe.createContext=function(t){return t={$$typeof:HT,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:VT,_context:t},t.Consumer=t};Fe.createElement=rx;Fe.createFactory=function(t){var e=rx.bind(null,t);return e.type=t,e};Fe.createRef=function(){return{current:null}};Fe.forwardRef=function(t){return{$$typeof:qT,render:t}};Fe.isValidElement=Ag;Fe.lazy=function(t){return{$$typeof:ZT,_payload:{_status:-1,_result:t},_init:YT}};Fe.memo=function(t,e){return{$$typeof:KT,type:t,compare:e===void 0?null:e}};Fe.startTransition=function(t){var e=Qc.transition;Qc.transition={};try{t()}finally{Qc.transition=e}};Fe.unstable_act=ix;Fe.useCallback=function(t,e){return kn.current.useCallback(t,e)};Fe.useContext=function(t){return kn.current.useContext(t)};Fe.useDebugValue=function(){};Fe.useDeferredValue=function(t){return kn.current.useDeferredValue(t)};Fe.useEffect=function(t,e){return kn.current.useEffect(t,e)};Fe.useId=function(){return kn.current.useId()};Fe.useImperativeHandle=function(t,e,n){return kn.current.useImperativeHandle(t,e,n)};Fe.useInsertionEffect=function(t,e){return kn.current.useInsertionEffect(t,e)};Fe.useLayoutEffect=function(t,e){return kn.current.useLayoutEffect(t,e)};Fe.useMemo=function(t,e){return kn.current.useMemo(t,e)};Fe.useReducer=function(t,e,n){return kn.current.useReducer(t,e,n)};Fe.useRef=function(t){return kn.current.useRef(t)};Fe.useState=function(t){return kn.current.useState(t)};Fe.useSyncExternalStore=function(t,e,n){return kn.current.useSyncExternalStore(t,e,n)};Fe.useTransition=function(){return kn.current.useTransition()};Fe.version="18.3.1";Gb.exports=Fe;var M=Gb.exports;const q=Ng(M),eP=Zb({__proto__:null,default:q},[M]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tP=M,nP=Symbol.for("react.element"),rP=Symbol.for("react.fragment"),iP=Object.prototype.hasOwnProperty,sP=tP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,oP={key:!0,ref:!0,__self:!0,__source:!0};function sx(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)iP.call(e,r)&&!oP.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:nP,type:t,key:s,ref:o,props:i,_owner:sP.current}}ch.Fragment=rP;ch.jsx=sx;ch.jsxs=sx;Qb.exports=ch;var w=Qb.exports,Ip={},ox={exports:{}},Yn={},ax={exports:{}},lx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(H,ne){var G=H.length;H.push(ne);e:for(;0<G;){var $=G-1>>>1,K=H[$];if(0<i(K,ne))H[$]=ne,H[G]=K,G=$;else break e}}function n(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var ne=H[0],G=H.pop();if(G!==ne){H[0]=G;e:for(var $=0,K=H.length,ie=K>>>1;$<ie;){var re=2*($+1)-1,te=H[re],ee=re+1,Se=H[ee];if(0>i(te,G))ee<K&&0>i(Se,te)?(H[$]=Se,H[ee]=G,$=ee):(H[$]=te,H[re]=G,$=re);else if(ee<K&&0>i(Se,G))H[$]=Se,H[ee]=G,$=ee;else break e}}return ne}function i(H,ne){var G=H.sortIndex-ne.sortIndex;return G!==0?G:H.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],d=[],h=1,f=null,m=3,g=!1,_=!1,v=!1,x=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(H){for(var ne=n(d);ne!==null;){if(ne.callback===null)r(d);else if(ne.startTime<=H)r(d),ne.sortIndex=ne.expirationTime,e(u,ne);else break;ne=n(d)}}function R(H){if(v=!1,C(H),!_)if(n(u)!==null)_=!0,ue(N);else{var ne=n(d);ne!==null&&Te(R,ne.startTime-H)}}function N(H,ne){_=!1,v&&(v=!1,S(D),D=-1),g=!0;var G=m;try{for(C(ne),f=n(u);f!==null&&(!(f.expirationTime>ne)||H&&!F());){var $=f.callback;if(typeof $=="function"){f.callback=null,m=f.priorityLevel;var K=$(f.expirationTime<=ne);ne=t.unstable_now(),typeof K=="function"?f.callback=K:f===n(u)&&r(u),C(ne)}else r(u);f=n(u)}if(f!==null)var ie=!0;else{var re=n(d);re!==null&&Te(R,re.startTime-ne),ie=!1}return ie}finally{f=null,m=G,g=!1}}var P=!1,T=null,D=-1,j=5,O=-1;function F(){return!(t.unstable_now()-O<j)}function Z(){if(T!==null){var H=t.unstable_now();O=H;var ne=!0;try{ne=T(!0,H)}finally{ne?se():(P=!1,T=null)}}else P=!1}var se;if(typeof k=="function")se=function(){k(Z)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,ye=oe.port2;oe.port1.onmessage=Z,se=function(){ye.postMessage(null)}}else se=function(){x(Z,0)};function ue(H){T=H,P||(P=!0,se())}function Te(H,ne){D=x(function(){H(t.unstable_now())},ne)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_continueExecution=function(){_||g||(_=!0,ue(N))},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(H){switch(m){case 1:case 2:case 3:var ne=3;break;default:ne=m}var G=m;m=ne;try{return H()}finally{m=G}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(H,ne){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var G=m;m=H;try{return ne()}finally{m=G}},t.unstable_scheduleCallback=function(H,ne,G){var $=t.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?$+G:$):G=$,H){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=G+K,H={id:h++,callback:ne,priorityLevel:H,startTime:G,expirationTime:K,sortIndex:-1},G>$?(H.sortIndex=G,e(d,H),n(u)===null&&H===n(d)&&(v?(S(D),D=-1):v=!0,Te(R,G-$))):(H.sortIndex=K,e(u,H),_||g||(_=!0,ue(N))),H},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(H){var ne=m;return function(){var G=m;m=ne;try{return H.apply(this,arguments)}finally{m=G}}}})(lx);ax.exports=lx;var aP=ax.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lP=M,Jn=aP;function X(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ux=new Set,tu={};function Ro(t,e){Na(t,e),Na(t+"Capture",e)}function Na(t,e){for(tu[t]=e,t=0;t<e.length;t++)ux.add(e[t])}var ki=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),jp=Object.prototype.hasOwnProperty,uP=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,v_={},__={};function cP(t){return jp.call(__,t)?!0:jp.call(v_,t)?!1:uP.test(t)?__[t]=!0:(v_[t]=!0,!1)}function dP(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function hP(t,e,n,r){if(e===null||typeof e>"u"||dP(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Cn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var tn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){tn[t]=new Cn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];tn[e]=new Cn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){tn[t]=new Cn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){tn[t]=new Cn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){tn[t]=new Cn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){tn[t]=new Cn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){tn[t]=new Cn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){tn[t]=new Cn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){tn[t]=new Cn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Ig=/[\-:]([a-z])/g;function jg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Ig,jg);tn[e]=new Cn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Ig,jg);tn[e]=new Cn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Ig,jg);tn[e]=new Cn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){tn[t]=new Cn(t,1,!1,t.toLowerCase(),null,!1,!1)});tn.xlinkHref=new Cn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){tn[t]=new Cn(t,1,!1,t.toLowerCase(),null,!0,!0)});function zg(t,e,n,r){var i=tn.hasOwnProperty(e)?tn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(hP(e,n,i,r)&&(n=null),r||i===null?cP(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Mi=lP.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,mc=Symbol.for("react.element"),aa=Symbol.for("react.portal"),la=Symbol.for("react.fragment"),Bg=Symbol.for("react.strict_mode"),zp=Symbol.for("react.profiler"),cx=Symbol.for("react.provider"),dx=Symbol.for("react.context"),Fg=Symbol.for("react.forward_ref"),Bp=Symbol.for("react.suspense"),Fp=Symbol.for("react.suspense_list"),$g=Symbol.for("react.memo"),Ki=Symbol.for("react.lazy"),hx=Symbol.for("react.offscreen"),w_=Symbol.iterator;function pl(t){return t===null||typeof t!="object"?null:(t=w_&&t[w_]||t["@@iterator"],typeof t=="function"?t:null)}var ct=Object.assign,Tf;function Tl(t){if(Tf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Tf=e&&e[1]||""}return`
`+Tf+t}var Pf=!1;function Mf(t,e){if(!t||Pf)return"";Pf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var u=`
`+i[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=l);break}}}finally{Pf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Tl(t):""}function fP(t){switch(t.tag){case 5:return Tl(t.type);case 16:return Tl("Lazy");case 13:return Tl("Suspense");case 19:return Tl("SuspenseList");case 0:case 2:case 15:return t=Mf(t.type,!1),t;case 11:return t=Mf(t.type.render,!1),t;case 1:return t=Mf(t.type,!0),t;default:return""}}function $p(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case la:return"Fragment";case aa:return"Portal";case zp:return"Profiler";case Bg:return"StrictMode";case Bp:return"Suspense";case Fp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case dx:return(t.displayName||"Context")+".Consumer";case cx:return(t._context.displayName||"Context")+".Provider";case Fg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case $g:return e=t.displayName||null,e!==null?e:$p(t.type)||"Memo";case Ki:e=t._payload,t=t._init;try{return $p(t(e))}catch{}}return null}function pP(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $p(e);case 8:return e===Bg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ss(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function fx(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function mP(t){var e=fx(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function gc(t){t._valueTracker||(t._valueTracker=mP(t))}function px(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=fx(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function fd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Up(t,e){var n=e.checked;return ct({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function b_(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ss(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function mx(t,e){e=e.checked,e!=null&&zg(t,"checked",e,!1)}function Vp(t,e){mx(t,e);var n=Ss(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Hp(t,e.type,n):e.hasOwnProperty("defaultValue")&&Hp(t,e.type,Ss(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function x_(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Hp(t,e,n){(e!=="number"||fd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Pl=Array.isArray;function ba(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ss(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function qp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(X(91));return ct({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function S_(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(X(92));if(Pl(n)){if(1<n.length)throw Error(X(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ss(n)}}function gx(t,e){var n=Ss(e.value),r=Ss(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function k_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function yx(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Wp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?yx(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var yc,vx=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(yc=yc||document.createElement("div"),yc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=yc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function nu(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Il={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gP=["Webkit","ms","Moz","O"];Object.keys(Il).forEach(function(t){gP.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Il[e]=Il[t]})});function _x(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Il.hasOwnProperty(t)&&Il[t]?(""+e).trim():e+"px"}function wx(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=_x(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var yP=ct({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Kp(t,e){if(e){if(yP[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(X(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(X(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(X(61))}if(e.style!=null&&typeof e.style!="object")throw Error(X(62))}}function Zp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qp=null;function Ug(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Gp=null,xa=null,Sa=null;function C_(t){if(t=Bu(t)){if(typeof Gp!="function")throw Error(X(280));var e=t.stateNode;e&&(e=mh(e),Gp(t.stateNode,t.type,e))}}function bx(t){xa?Sa?Sa.push(t):Sa=[t]:xa=t}function xx(){if(xa){var t=xa,e=Sa;if(Sa=xa=null,C_(t),e)for(t=0;t<e.length;t++)C_(e[t])}}function Sx(t,e){return t(e)}function kx(){}var Of=!1;function Cx(t,e,n){if(Of)return t(e,n);Of=!0;try{return Sx(t,e,n)}finally{Of=!1,(xa!==null||Sa!==null)&&(kx(),xx())}}function ru(t,e){var n=t.stateNode;if(n===null)return null;var r=mh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(X(231,e,typeof n));return n}var Jp=!1;if(ki)try{var ml={};Object.defineProperty(ml,"passive",{get:function(){Jp=!0}}),window.addEventListener("test",ml,ml),window.removeEventListener("test",ml,ml)}catch{Jp=!1}function vP(t,e,n,r,i,s,o,l,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var jl=!1,pd=null,md=!1,Yp=null,_P={onError:function(t){jl=!0,pd=t}};function wP(t,e,n,r,i,s,o,l,u){jl=!1,pd=null,vP.apply(_P,arguments)}function bP(t,e,n,r,i,s,o,l,u){if(wP.apply(this,arguments),jl){if(jl){var d=pd;jl=!1,pd=null}else throw Error(X(198));md||(md=!0,Yp=d)}}function Do(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Ex(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function E_(t){if(Do(t)!==t)throw Error(X(188))}function xP(t){var e=t.alternate;if(!e){if(e=Do(t),e===null)throw Error(X(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return E_(i),t;if(s===r)return E_(i),e;s=s.sibling}throw Error(X(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o)throw Error(X(189))}}if(n.alternate!==r)throw Error(X(190))}if(n.tag!==3)throw Error(X(188));return n.stateNode.current===n?t:e}function Tx(t){return t=xP(t),t!==null?Px(t):null}function Px(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Px(t);if(e!==null)return e;t=t.sibling}return null}var Mx=Jn.unstable_scheduleCallback,T_=Jn.unstable_cancelCallback,SP=Jn.unstable_shouldYield,kP=Jn.unstable_requestPaint,mt=Jn.unstable_now,CP=Jn.unstable_getCurrentPriorityLevel,Vg=Jn.unstable_ImmediatePriority,Ox=Jn.unstable_UserBlockingPriority,gd=Jn.unstable_NormalPriority,EP=Jn.unstable_LowPriority,Nx=Jn.unstable_IdlePriority,dh=null,Zr=null;function TP(t){if(Zr&&typeof Zr.onCommitFiberRoot=="function")try{Zr.onCommitFiberRoot(dh,t,void 0,(t.current.flags&128)===128)}catch{}}var Lr=Math.clz32?Math.clz32:OP,PP=Math.log,MP=Math.LN2;function OP(t){return t>>>=0,t===0?32:31-(PP(t)/MP|0)|0}var vc=64,_c=4194304;function Ml(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function yd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~i;l!==0?r=Ml(l):(s&=o,s!==0&&(r=Ml(s)))}else o=n&~i,o!==0?r=Ml(o):s!==0&&(r=Ml(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Lr(e),i=1<<n,r|=t[n],e&=~i;return r}function NP(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function LP(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Lr(s),l=1<<o,u=i[o];u===-1?(!(l&n)||l&r)&&(i[o]=NP(l,e)):u<=e&&(t.expiredLanes|=l),s&=~l}}function Xp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Lx(){var t=vc;return vc<<=1,!(vc&4194240)&&(vc=64),t}function Nf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ju(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Lr(e),t[e]=n}function RP(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Lr(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Hg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Lr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Ze=0;function Rx(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Dx,qg,Ax,Ix,jx,em=!1,wc=[],us=null,cs=null,ds=null,iu=new Map,su=new Map,Yi=[],DP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function P_(t,e){switch(t){case"focusin":case"focusout":us=null;break;case"dragenter":case"dragleave":cs=null;break;case"mouseover":case"mouseout":ds=null;break;case"pointerover":case"pointerout":iu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":su.delete(e.pointerId)}}function gl(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Bu(e),e!==null&&qg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function AP(t,e,n,r,i){switch(e){case"focusin":return us=gl(us,t,e,n,r,i),!0;case"dragenter":return cs=gl(cs,t,e,n,r,i),!0;case"mouseover":return ds=gl(ds,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return iu.set(s,gl(iu.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,su.set(s,gl(su.get(s)||null,t,e,n,r,i)),!0}return!1}function zx(t){var e=so(t.target);if(e!==null){var n=Do(e);if(n!==null){if(e=n.tag,e===13){if(e=Ex(n),e!==null){t.blockedOn=e,jx(t.priority,function(){Ax(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Gc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=tm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Qp=r,n.target.dispatchEvent(r),Qp=null}else return e=Bu(n),e!==null&&qg(e),t.blockedOn=n,!1;e.shift()}return!0}function M_(t,e,n){Gc(t)&&n.delete(e)}function IP(){em=!1,us!==null&&Gc(us)&&(us=null),cs!==null&&Gc(cs)&&(cs=null),ds!==null&&Gc(ds)&&(ds=null),iu.forEach(M_),su.forEach(M_)}function yl(t,e){t.blockedOn===e&&(t.blockedOn=null,em||(em=!0,Jn.unstable_scheduleCallback(Jn.unstable_NormalPriority,IP)))}function ou(t){function e(i){return yl(i,t)}if(0<wc.length){yl(wc[0],t);for(var n=1;n<wc.length;n++){var r=wc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(us!==null&&yl(us,t),cs!==null&&yl(cs,t),ds!==null&&yl(ds,t),iu.forEach(e),su.forEach(e),n=0;n<Yi.length;n++)r=Yi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Yi.length&&(n=Yi[0],n.blockedOn===null);)zx(n),n.blockedOn===null&&Yi.shift()}var ka=Mi.ReactCurrentBatchConfig,vd=!0;function jP(t,e,n,r){var i=Ze,s=ka.transition;ka.transition=null;try{Ze=1,Wg(t,e,n,r)}finally{Ze=i,ka.transition=s}}function zP(t,e,n,r){var i=Ze,s=ka.transition;ka.transition=null;try{Ze=4,Wg(t,e,n,r)}finally{Ze=i,ka.transition=s}}function Wg(t,e,n,r){if(vd){var i=tm(t,e,n,r);if(i===null)$f(t,e,r,_d,n),P_(t,r);else if(AP(i,t,e,n,r))r.stopPropagation();else if(P_(t,r),e&4&&-1<DP.indexOf(t)){for(;i!==null;){var s=Bu(i);if(s!==null&&Dx(s),s=tm(t,e,n,r),s===null&&$f(t,e,r,_d,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else $f(t,e,r,null,n)}}var _d=null;function tm(t,e,n,r){if(_d=null,t=Ug(r),t=so(t),t!==null)if(e=Do(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Ex(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return _d=t,null}function Bx(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(CP()){case Vg:return 1;case Ox:return 4;case gd:case EP:return 16;case Nx:return 536870912;default:return 16}default:return 16}}var ns=null,Kg=null,Jc=null;function Fx(){if(Jc)return Jc;var t,e=Kg,n=e.length,r,i="value"in ns?ns.value:ns.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Jc=i.slice(t,1<r?1-r:void 0)}function Yc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function bc(){return!0}function O_(){return!1}function Xn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?bc:O_,this.isPropagationStopped=O_,this}return ct(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=bc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=bc)},persist:function(){},isPersistent:bc}),e}var Ka={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zg=Xn(Ka),zu=ct({},Ka,{view:0,detail:0}),BP=Xn(zu),Lf,Rf,vl,hh=ct({},zu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==vl&&(vl&&t.type==="mousemove"?(Lf=t.screenX-vl.screenX,Rf=t.screenY-vl.screenY):Rf=Lf=0,vl=t),Lf)},movementY:function(t){return"movementY"in t?t.movementY:Rf}}),N_=Xn(hh),FP=ct({},hh,{dataTransfer:0}),$P=Xn(FP),UP=ct({},zu,{relatedTarget:0}),Df=Xn(UP),VP=ct({},Ka,{animationName:0,elapsedTime:0,pseudoElement:0}),HP=Xn(VP),qP=ct({},Ka,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),WP=Xn(qP),KP=ct({},Ka,{data:0}),L_=Xn(KP),ZP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},QP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},GP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function JP(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=GP[t])?!!e[t]:!1}function Qg(){return JP}var YP=ct({},zu,{key:function(t){if(t.key){var e=ZP[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Yc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?QP[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qg,charCode:function(t){return t.type==="keypress"?Yc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Yc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),XP=Xn(YP),eM=ct({},hh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),R_=Xn(eM),tM=ct({},zu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qg}),nM=Xn(tM),rM=ct({},Ka,{propertyName:0,elapsedTime:0,pseudoElement:0}),iM=Xn(rM),sM=ct({},hh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),oM=Xn(sM),aM=[9,13,27,32],Gg=ki&&"CompositionEvent"in window,zl=null;ki&&"documentMode"in document&&(zl=document.documentMode);var lM=ki&&"TextEvent"in window&&!zl,$x=ki&&(!Gg||zl&&8<zl&&11>=zl),D_=" ",A_=!1;function Ux(t,e){switch(t){case"keyup":return aM.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ua=!1;function uM(t,e){switch(t){case"compositionend":return Vx(e);case"keypress":return e.which!==32?null:(A_=!0,D_);case"textInput":return t=e.data,t===D_&&A_?null:t;default:return null}}function cM(t,e){if(ua)return t==="compositionend"||!Gg&&Ux(t,e)?(t=Fx(),Jc=Kg=ns=null,ua=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return $x&&e.locale!=="ko"?null:e.data;default:return null}}var dM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function I_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!dM[t.type]:e==="textarea"}function Hx(t,e,n,r){bx(r),e=wd(e,"onChange"),0<e.length&&(n=new Zg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Bl=null,au=null;function hM(t){tS(t,0)}function fh(t){var e=ha(t);if(px(e))return t}function fM(t,e){if(t==="change")return e}var qx=!1;if(ki){var Af;if(ki){var If="oninput"in document;if(!If){var j_=document.createElement("div");j_.setAttribute("oninput","return;"),If=typeof j_.oninput=="function"}Af=If}else Af=!1;qx=Af&&(!document.documentMode||9<document.documentMode)}function z_(){Bl&&(Bl.detachEvent("onpropertychange",Wx),au=Bl=null)}function Wx(t){if(t.propertyName==="value"&&fh(au)){var e=[];Hx(e,au,t,Ug(t)),Cx(hM,e)}}function pM(t,e,n){t==="focusin"?(z_(),Bl=e,au=n,Bl.attachEvent("onpropertychange",Wx)):t==="focusout"&&z_()}function mM(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return fh(au)}function gM(t,e){if(t==="click")return fh(e)}function yM(t,e){if(t==="input"||t==="change")return fh(e)}function vM(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Dr=typeof Object.is=="function"?Object.is:vM;function lu(t,e){if(Dr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!jp.call(e,i)||!Dr(t[i],e[i]))return!1}return!0}function B_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function F_(t,e){var n=B_(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=B_(n)}}function Kx(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Kx(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Zx(){for(var t=window,e=fd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=fd(t.document)}return e}function Jg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function _M(t){var e=Zx(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Kx(n.ownerDocument.documentElement,n)){if(r!==null&&Jg(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=F_(n,s);var o=F_(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var wM=ki&&"documentMode"in document&&11>=document.documentMode,ca=null,nm=null,Fl=null,rm=!1;function $_(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;rm||ca==null||ca!==fd(r)||(r=ca,"selectionStart"in r&&Jg(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Fl&&lu(Fl,r)||(Fl=r,r=wd(nm,"onSelect"),0<r.length&&(e=new Zg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ca)))}function xc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var da={animationend:xc("Animation","AnimationEnd"),animationiteration:xc("Animation","AnimationIteration"),animationstart:xc("Animation","AnimationStart"),transitionend:xc("Transition","TransitionEnd")},jf={},Qx={};ki&&(Qx=document.createElement("div").style,"AnimationEvent"in window||(delete da.animationend.animation,delete da.animationiteration.animation,delete da.animationstart.animation),"TransitionEvent"in window||delete da.transitionend.transition);function ph(t){if(jf[t])return jf[t];if(!da[t])return t;var e=da[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Qx)return jf[t]=e[n];return t}var Gx=ph("animationend"),Jx=ph("animationiteration"),Yx=ph("animationstart"),Xx=ph("transitionend"),eS=new Map,U_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ts(t,e){eS.set(t,e),Ro(e,[t])}for(var zf=0;zf<U_.length;zf++){var Bf=U_[zf],bM=Bf.toLowerCase(),xM=Bf[0].toUpperCase()+Bf.slice(1);Ts(bM,"on"+xM)}Ts(Gx,"onAnimationEnd");Ts(Jx,"onAnimationIteration");Ts(Yx,"onAnimationStart");Ts("dblclick","onDoubleClick");Ts("focusin","onFocus");Ts("focusout","onBlur");Ts(Xx,"onTransitionEnd");Na("onMouseEnter",["mouseout","mouseover"]);Na("onMouseLeave",["mouseout","mouseover"]);Na("onPointerEnter",["pointerout","pointerover"]);Na("onPointerLeave",["pointerout","pointerover"]);Ro("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ro("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ro("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ro("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ro("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ro("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ol="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),SM=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ol));function V_(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,bP(r,e,void 0,t),t.currentTarget=null}function tS(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],u=l.instance,d=l.currentTarget;if(l=l.listener,u!==s&&i.isPropagationStopped())break e;V_(i,l,d),s=u}else for(o=0;o<r.length;o++){if(l=r[o],u=l.instance,d=l.currentTarget,l=l.listener,u!==s&&i.isPropagationStopped())break e;V_(i,l,d),s=u}}}if(md)throw t=Yp,md=!1,Yp=null,t}function nt(t,e){var n=e[lm];n===void 0&&(n=e[lm]=new Set);var r=t+"__bubble";n.has(r)||(nS(e,t,2,!1),n.add(r))}function Ff(t,e,n){var r=0;e&&(r|=4),nS(n,t,r,e)}var Sc="_reactListening"+Math.random().toString(36).slice(2);function uu(t){if(!t[Sc]){t[Sc]=!0,ux.forEach(function(n){n!=="selectionchange"&&(SM.has(n)||Ff(n,!1,t),Ff(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Sc]||(e[Sc]=!0,Ff("selectionchange",!1,e))}}function nS(t,e,n,r){switch(Bx(e)){case 1:var i=jP;break;case 4:i=zP;break;default:i=Wg}n=i.bind(null,e,n,t),i=void 0,!Jp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function $f(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;o=o.return}for(;l!==null;){if(o=so(l),o===null)return;if(u=o.tag,u===5||u===6){r=s=o;continue e}l=l.parentNode}}r=r.return}Cx(function(){var d=s,h=Ug(n),f=[];e:{var m=eS.get(t);if(m!==void 0){var g=Zg,_=t;switch(t){case"keypress":if(Yc(n)===0)break e;case"keydown":case"keyup":g=XP;break;case"focusin":_="focus",g=Df;break;case"focusout":_="blur",g=Df;break;case"beforeblur":case"afterblur":g=Df;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=N_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=$P;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=nM;break;case Gx:case Jx:case Yx:g=HP;break;case Xx:g=iM;break;case"scroll":g=BP;break;case"wheel":g=oM;break;case"copy":case"cut":case"paste":g=WP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=R_}var v=(e&4)!==0,x=!v&&t==="scroll",S=v?m!==null?m+"Capture":null:m;v=[];for(var k=d,C;k!==null;){C=k;var R=C.stateNode;if(C.tag===5&&R!==null&&(C=R,S!==null&&(R=ru(k,S),R!=null&&v.push(cu(k,R,C)))),x)break;k=k.return}0<v.length&&(m=new g(m,_,null,n,h),f.push({event:m,listeners:v}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",m&&n!==Qp&&(_=n.relatedTarget||n.fromElement)&&(so(_)||_[Ci]))break e;if((g||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,g?(_=n.relatedTarget||n.toElement,g=d,_=_?so(_):null,_!==null&&(x=Do(_),_!==x||_.tag!==5&&_.tag!==6)&&(_=null)):(g=null,_=d),g!==_)){if(v=N_,R="onMouseLeave",S="onMouseEnter",k="mouse",(t==="pointerout"||t==="pointerover")&&(v=R_,R="onPointerLeave",S="onPointerEnter",k="pointer"),x=g==null?m:ha(g),C=_==null?m:ha(_),m=new v(R,k+"leave",g,n,h),m.target=x,m.relatedTarget=C,R=null,so(h)===d&&(v=new v(S,k+"enter",_,n,h),v.target=C,v.relatedTarget=x,R=v),x=R,g&&_)t:{for(v=g,S=_,k=0,C=v;C;C=Zo(C))k++;for(C=0,R=S;R;R=Zo(R))C++;for(;0<k-C;)v=Zo(v),k--;for(;0<C-k;)S=Zo(S),C--;for(;k--;){if(v===S||S!==null&&v===S.alternate)break t;v=Zo(v),S=Zo(S)}v=null}else v=null;g!==null&&H_(f,m,g,v,!1),_!==null&&x!==null&&H_(f,x,_,v,!0)}}e:{if(m=d?ha(d):window,g=m.nodeName&&m.nodeName.toLowerCase(),g==="select"||g==="input"&&m.type==="file")var N=fM;else if(I_(m))if(qx)N=yM;else{N=mM;var P=pM}else(g=m.nodeName)&&g.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(N=gM);if(N&&(N=N(t,d))){Hx(f,N,n,h);break e}P&&P(t,m,d),t==="focusout"&&(P=m._wrapperState)&&P.controlled&&m.type==="number"&&Hp(m,"number",m.value)}switch(P=d?ha(d):window,t){case"focusin":(I_(P)||P.contentEditable==="true")&&(ca=P,nm=d,Fl=null);break;case"focusout":Fl=nm=ca=null;break;case"mousedown":rm=!0;break;case"contextmenu":case"mouseup":case"dragend":rm=!1,$_(f,n,h);break;case"selectionchange":if(wM)break;case"keydown":case"keyup":$_(f,n,h)}var T;if(Gg)e:{switch(t){case"compositionstart":var D="onCompositionStart";break e;case"compositionend":D="onCompositionEnd";break e;case"compositionupdate":D="onCompositionUpdate";break e}D=void 0}else ua?Ux(t,n)&&(D="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(D="onCompositionStart");D&&($x&&n.locale!=="ko"&&(ua||D!=="onCompositionStart"?D==="onCompositionEnd"&&ua&&(T=Fx()):(ns=h,Kg="value"in ns?ns.value:ns.textContent,ua=!0)),P=wd(d,D),0<P.length&&(D=new L_(D,t,null,n,h),f.push({event:D,listeners:P}),T?D.data=T:(T=Vx(n),T!==null&&(D.data=T)))),(T=lM?uM(t,n):cM(t,n))&&(d=wd(d,"onBeforeInput"),0<d.length&&(h=new L_("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:d}),h.data=T))}tS(f,e)})}function cu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function wd(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=ru(t,n),s!=null&&r.unshift(cu(t,s,i)),s=ru(t,e),s!=null&&r.push(cu(t,s,i))),t=t.return}return r}function Zo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function H_(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var l=n,u=l.alternate,d=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&d!==null&&(l=d,i?(u=ru(n,s),u!=null&&o.unshift(cu(n,u,l))):i||(u=ru(n,s),u!=null&&o.push(cu(n,u,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var kM=/\r\n?/g,CM=/\u0000|\uFFFD/g;function q_(t){return(typeof t=="string"?t:""+t).replace(kM,`
`).replace(CM,"")}function kc(t,e,n){if(e=q_(e),q_(t)!==e&&n)throw Error(X(425))}function bd(){}var im=null,sm=null;function om(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var am=typeof setTimeout=="function"?setTimeout:void 0,EM=typeof clearTimeout=="function"?clearTimeout:void 0,W_=typeof Promise=="function"?Promise:void 0,TM=typeof queueMicrotask=="function"?queueMicrotask:typeof W_<"u"?function(t){return W_.resolve(null).then(t).catch(PM)}:am;function PM(t){setTimeout(function(){throw t})}function Uf(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),ou(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);ou(e)}function hs(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function K_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Za=Math.random().toString(36).slice(2),qr="__reactFiber$"+Za,du="__reactProps$"+Za,Ci="__reactContainer$"+Za,lm="__reactEvents$"+Za,MM="__reactListeners$"+Za,OM="__reactHandles$"+Za;function so(t){var e=t[qr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ci]||n[qr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=K_(t);t!==null;){if(n=t[qr])return n;t=K_(t)}return e}t=n,n=t.parentNode}return null}function Bu(t){return t=t[qr]||t[Ci],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ha(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(X(33))}function mh(t){return t[du]||null}var um=[],fa=-1;function Ps(t){return{current:t}}function rt(t){0>fa||(t.current=um[fa],um[fa]=null,fa--)}function Xe(t,e){fa++,um[fa]=t.current,t.current=e}var ks={},dn=Ps(ks),An=Ps(!1),bo=ks;function La(t,e){var n=t.type.contextTypes;if(!n)return ks;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function In(t){return t=t.childContextTypes,t!=null}function xd(){rt(An),rt(dn)}function Z_(t,e,n){if(dn.current!==ks)throw Error(X(168));Xe(dn,e),Xe(An,n)}function rS(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(X(108,pP(t)||"Unknown",i));return ct({},n,r)}function Sd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ks,bo=dn.current,Xe(dn,t),Xe(An,An.current),!0}function Q_(t,e,n){var r=t.stateNode;if(!r)throw Error(X(169));n?(t=rS(t,e,bo),r.__reactInternalMemoizedMergedChildContext=t,rt(An),rt(dn),Xe(dn,t)):rt(An),Xe(An,n)}var gi=null,gh=!1,Vf=!1;function iS(t){gi===null?gi=[t]:gi.push(t)}function NM(t){gh=!0,iS(t)}function Ms(){if(!Vf&&gi!==null){Vf=!0;var t=0,e=Ze;try{var n=gi;for(Ze=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}gi=null,gh=!1}catch(i){throw gi!==null&&(gi=gi.slice(t+1)),Mx(Vg,Ms),i}finally{Ze=e,Vf=!1}}return null}var pa=[],ma=0,kd=null,Cd=0,cr=[],dr=0,xo=null,yi=1,vi="";function Gs(t,e){pa[ma++]=Cd,pa[ma++]=kd,kd=t,Cd=e}function sS(t,e,n){cr[dr++]=yi,cr[dr++]=vi,cr[dr++]=xo,xo=t;var r=yi;t=vi;var i=32-Lr(r)-1;r&=~(1<<i),n+=1;var s=32-Lr(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,yi=1<<32-Lr(e)+i|n<<i|r,vi=s+t}else yi=1<<s|n<<i|r,vi=t}function Yg(t){t.return!==null&&(Gs(t,1),sS(t,1,0))}function Xg(t){for(;t===kd;)kd=pa[--ma],pa[ma]=null,Cd=pa[--ma],pa[ma]=null;for(;t===xo;)xo=cr[--dr],cr[dr]=null,vi=cr[--dr],cr[dr]=null,yi=cr[--dr],cr[dr]=null}var Zn=null,Kn=null,ot=!1,Or=null;function oS(t,e){var n=fr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function G_(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Zn=t,Kn=hs(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Zn=t,Kn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=xo!==null?{id:yi,overflow:vi}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=fr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Zn=t,Kn=null,!0):!1;default:return!1}}function cm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function dm(t){if(ot){var e=Kn;if(e){var n=e;if(!G_(t,e)){if(cm(t))throw Error(X(418));e=hs(n.nextSibling);var r=Zn;e&&G_(t,e)?oS(r,n):(t.flags=t.flags&-4097|2,ot=!1,Zn=t)}}else{if(cm(t))throw Error(X(418));t.flags=t.flags&-4097|2,ot=!1,Zn=t}}}function J_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Zn=t}function Cc(t){if(t!==Zn)return!1;if(!ot)return J_(t),ot=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!om(t.type,t.memoizedProps)),e&&(e=Kn)){if(cm(t))throw aS(),Error(X(418));for(;e;)oS(t,e),e=hs(e.nextSibling)}if(J_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(X(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Kn=hs(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Kn=null}}else Kn=Zn?hs(t.stateNode.nextSibling):null;return!0}function aS(){for(var t=Kn;t;)t=hs(t.nextSibling)}function Ra(){Kn=Zn=null,ot=!1}function ey(t){Or===null?Or=[t]:Or.push(t)}var LM=Mi.ReactCurrentBatchConfig;function _l(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(X(309));var r=n.stateNode}if(!r)throw Error(X(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(X(284));if(!n._owner)throw Error(X(290,t))}return t}function Ec(t,e){throw t=Object.prototype.toString.call(e),Error(X(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Y_(t){var e=t._init;return e(t._payload)}function lS(t){function e(S,k){if(t){var C=S.deletions;C===null?(S.deletions=[k],S.flags|=16):C.push(k)}}function n(S,k){if(!t)return null;for(;k!==null;)e(S,k),k=k.sibling;return null}function r(S,k){for(S=new Map;k!==null;)k.key!==null?S.set(k.key,k):S.set(k.index,k),k=k.sibling;return S}function i(S,k){return S=gs(S,k),S.index=0,S.sibling=null,S}function s(S,k,C){return S.index=C,t?(C=S.alternate,C!==null?(C=C.index,C<k?(S.flags|=2,k):C):(S.flags|=2,k)):(S.flags|=1048576,k)}function o(S){return t&&S.alternate===null&&(S.flags|=2),S}function l(S,k,C,R){return k===null||k.tag!==6?(k=Gf(C,S.mode,R),k.return=S,k):(k=i(k,C),k.return=S,k)}function u(S,k,C,R){var N=C.type;return N===la?h(S,k,C.props.children,R,C.key):k!==null&&(k.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Ki&&Y_(N)===k.type)?(R=i(k,C.props),R.ref=_l(S,k,C),R.return=S,R):(R=sd(C.type,C.key,C.props,null,S.mode,R),R.ref=_l(S,k,C),R.return=S,R)}function d(S,k,C,R){return k===null||k.tag!==4||k.stateNode.containerInfo!==C.containerInfo||k.stateNode.implementation!==C.implementation?(k=Jf(C,S.mode,R),k.return=S,k):(k=i(k,C.children||[]),k.return=S,k)}function h(S,k,C,R,N){return k===null||k.tag!==7?(k=mo(C,S.mode,R,N),k.return=S,k):(k=i(k,C),k.return=S,k)}function f(S,k,C){if(typeof k=="string"&&k!==""||typeof k=="number")return k=Gf(""+k,S.mode,C),k.return=S,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case mc:return C=sd(k.type,k.key,k.props,null,S.mode,C),C.ref=_l(S,null,k),C.return=S,C;case aa:return k=Jf(k,S.mode,C),k.return=S,k;case Ki:var R=k._init;return f(S,R(k._payload),C)}if(Pl(k)||pl(k))return k=mo(k,S.mode,C,null),k.return=S,k;Ec(S,k)}return null}function m(S,k,C,R){var N=k!==null?k.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return N!==null?null:l(S,k,""+C,R);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case mc:return C.key===N?u(S,k,C,R):null;case aa:return C.key===N?d(S,k,C,R):null;case Ki:return N=C._init,m(S,k,N(C._payload),R)}if(Pl(C)||pl(C))return N!==null?null:h(S,k,C,R,null);Ec(S,C)}return null}function g(S,k,C,R,N){if(typeof R=="string"&&R!==""||typeof R=="number")return S=S.get(C)||null,l(k,S,""+R,N);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case mc:return S=S.get(R.key===null?C:R.key)||null,u(k,S,R,N);case aa:return S=S.get(R.key===null?C:R.key)||null,d(k,S,R,N);case Ki:var P=R._init;return g(S,k,C,P(R._payload),N)}if(Pl(R)||pl(R))return S=S.get(C)||null,h(k,S,R,N,null);Ec(k,R)}return null}function _(S,k,C,R){for(var N=null,P=null,T=k,D=k=0,j=null;T!==null&&D<C.length;D++){T.index>D?(j=T,T=null):j=T.sibling;var O=m(S,T,C[D],R);if(O===null){T===null&&(T=j);break}t&&T&&O.alternate===null&&e(S,T),k=s(O,k,D),P===null?N=O:P.sibling=O,P=O,T=j}if(D===C.length)return n(S,T),ot&&Gs(S,D),N;if(T===null){for(;D<C.length;D++)T=f(S,C[D],R),T!==null&&(k=s(T,k,D),P===null?N=T:P.sibling=T,P=T);return ot&&Gs(S,D),N}for(T=r(S,T);D<C.length;D++)j=g(T,S,D,C[D],R),j!==null&&(t&&j.alternate!==null&&T.delete(j.key===null?D:j.key),k=s(j,k,D),P===null?N=j:P.sibling=j,P=j);return t&&T.forEach(function(F){return e(S,F)}),ot&&Gs(S,D),N}function v(S,k,C,R){var N=pl(C);if(typeof N!="function")throw Error(X(150));if(C=N.call(C),C==null)throw Error(X(151));for(var P=N=null,T=k,D=k=0,j=null,O=C.next();T!==null&&!O.done;D++,O=C.next()){T.index>D?(j=T,T=null):j=T.sibling;var F=m(S,T,O.value,R);if(F===null){T===null&&(T=j);break}t&&T&&F.alternate===null&&e(S,T),k=s(F,k,D),P===null?N=F:P.sibling=F,P=F,T=j}if(O.done)return n(S,T),ot&&Gs(S,D),N;if(T===null){for(;!O.done;D++,O=C.next())O=f(S,O.value,R),O!==null&&(k=s(O,k,D),P===null?N=O:P.sibling=O,P=O);return ot&&Gs(S,D),N}for(T=r(S,T);!O.done;D++,O=C.next())O=g(T,S,D,O.value,R),O!==null&&(t&&O.alternate!==null&&T.delete(O.key===null?D:O.key),k=s(O,k,D),P===null?N=O:P.sibling=O,P=O);return t&&T.forEach(function(Z){return e(S,Z)}),ot&&Gs(S,D),N}function x(S,k,C,R){if(typeof C=="object"&&C!==null&&C.type===la&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case mc:e:{for(var N=C.key,P=k;P!==null;){if(P.key===N){if(N=C.type,N===la){if(P.tag===7){n(S,P.sibling),k=i(P,C.props.children),k.return=S,S=k;break e}}else if(P.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Ki&&Y_(N)===P.type){n(S,P.sibling),k=i(P,C.props),k.ref=_l(S,P,C),k.return=S,S=k;break e}n(S,P);break}else e(S,P);P=P.sibling}C.type===la?(k=mo(C.props.children,S.mode,R,C.key),k.return=S,S=k):(R=sd(C.type,C.key,C.props,null,S.mode,R),R.ref=_l(S,k,C),R.return=S,S=R)}return o(S);case aa:e:{for(P=C.key;k!==null;){if(k.key===P)if(k.tag===4&&k.stateNode.containerInfo===C.containerInfo&&k.stateNode.implementation===C.implementation){n(S,k.sibling),k=i(k,C.children||[]),k.return=S,S=k;break e}else{n(S,k);break}else e(S,k);k=k.sibling}k=Jf(C,S.mode,R),k.return=S,S=k}return o(S);case Ki:return P=C._init,x(S,k,P(C._payload),R)}if(Pl(C))return _(S,k,C,R);if(pl(C))return v(S,k,C,R);Ec(S,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,k!==null&&k.tag===6?(n(S,k.sibling),k=i(k,C),k.return=S,S=k):(n(S,k),k=Gf(C,S.mode,R),k.return=S,S=k),o(S)):n(S,k)}return x}var Da=lS(!0),uS=lS(!1),Ed=Ps(null),Td=null,ga=null,ty=null;function ny(){ty=ga=Td=null}function ry(t){var e=Ed.current;rt(Ed),t._currentValue=e}function hm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ca(t,e){Td=t,ty=ga=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Dn=!0),t.firstContext=null)}function vr(t){var e=t._currentValue;if(ty!==t)if(t={context:t,memoizedValue:e,next:null},ga===null){if(Td===null)throw Error(X(308));ga=t,Td.dependencies={lanes:0,firstContext:t}}else ga=ga.next=t;return e}var oo=null;function iy(t){oo===null?oo=[t]:oo.push(t)}function cS(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,iy(e)):(n.next=i.next,i.next=n),e.interleaved=n,Ei(t,r)}function Ei(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Zi=!1;function sy(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dS(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function wi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function fs(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,qe&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Ei(t,n)}return i=r.interleaved,i===null?(e.next=e,iy(r)):(e.next=i.next,i.next=e),r.interleaved=e,Ei(t,n)}function Xc(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Hg(t,n)}}function X_(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Pd(t,e,n,r){var i=t.updateQueue;Zi=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var u=l,d=u.next;u.next=null,o===null?s=d:o.next=d,o=u;var h=t.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=d:l.next=d,h.lastBaseUpdate=u))}if(s!==null){var f=i.baseState;o=0,h=d=u=null,l=s;do{var m=l.lane,g=l.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:g,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var _=t,v=l;switch(m=e,g=n,v.tag){case 1:if(_=v.payload,typeof _=="function"){f=_.call(g,f,m);break e}f=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=v.payload,m=typeof _=="function"?_.call(g,f,m):_,m==null)break e;f=ct({},f,m);break e;case 2:Zi=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,m=i.effects,m===null?i.effects=[l]:m.push(l))}else g={eventTime:g,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(d=h=g,u=f):h=h.next=g,o|=m;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;m=l,l=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(h===null&&(u=f),i.baseState=u,i.firstBaseUpdate=d,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);ko|=o,t.lanes=o,t.memoizedState=f}}function ew(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(X(191,i));i.call(r)}}}var Fu={},Qr=Ps(Fu),hu=Ps(Fu),fu=Ps(Fu);function ao(t){if(t===Fu)throw Error(X(174));return t}function oy(t,e){switch(Xe(fu,e),Xe(hu,t),Xe(Qr,Fu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Wp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Wp(e,t)}rt(Qr),Xe(Qr,e)}function Aa(){rt(Qr),rt(hu),rt(fu)}function hS(t){ao(fu.current);var e=ao(Qr.current),n=Wp(e,t.type);e!==n&&(Xe(hu,t),Xe(Qr,n))}function ay(t){hu.current===t&&(rt(Qr),rt(hu))}var lt=Ps(0);function Md(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Hf=[];function ly(){for(var t=0;t<Hf.length;t++)Hf[t]._workInProgressVersionPrimary=null;Hf.length=0}var ed=Mi.ReactCurrentDispatcher,qf=Mi.ReactCurrentBatchConfig,So=0,ut=null,Mt=null,zt=null,Od=!1,$l=!1,pu=0,RM=0;function on(){throw Error(X(321))}function uy(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Dr(t[n],e[n]))return!1;return!0}function cy(t,e,n,r,i,s){if(So=s,ut=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ed.current=t===null||t.memoizedState===null?jM:zM,t=n(r,i),$l){s=0;do{if($l=!1,pu=0,25<=s)throw Error(X(301));s+=1,zt=Mt=null,e.updateQueue=null,ed.current=BM,t=n(r,i)}while($l)}if(ed.current=Nd,e=Mt!==null&&Mt.next!==null,So=0,zt=Mt=ut=null,Od=!1,e)throw Error(X(300));return t}function dy(){var t=pu!==0;return pu=0,t}function Ur(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zt===null?ut.memoizedState=zt=t:zt=zt.next=t,zt}function _r(){if(Mt===null){var t=ut.alternate;t=t!==null?t.memoizedState:null}else t=Mt.next;var e=zt===null?ut.memoizedState:zt.next;if(e!==null)zt=e,Mt=t;else{if(t===null)throw Error(X(310));Mt=t,t={memoizedState:Mt.memoizedState,baseState:Mt.baseState,baseQueue:Mt.baseQueue,queue:Mt.queue,next:null},zt===null?ut.memoizedState=zt=t:zt=zt.next=t}return zt}function mu(t,e){return typeof e=="function"?e(t):e}function Wf(t){var e=_r(),n=e.queue;if(n===null)throw Error(X(311));n.lastRenderedReducer=t;var r=Mt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=o=null,u=null,d=s;do{var h=d.lane;if((So&h)===h)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(l=u=f,o=r):u=u.next=f,ut.lanes|=h,ko|=h}d=d.next}while(d!==null&&d!==s);u===null?o=r:u.next=l,Dr(r,e.memoizedState)||(Dn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,ut.lanes|=s,ko|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Kf(t){var e=_r(),n=e.queue;if(n===null)throw Error(X(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Dr(s,e.memoizedState)||(Dn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function fS(){}function pS(t,e){var n=ut,r=_r(),i=e(),s=!Dr(r.memoizedState,i);if(s&&(r.memoizedState=i,Dn=!0),r=r.queue,hy(yS.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||zt!==null&&zt.memoizedState.tag&1){if(n.flags|=2048,gu(9,gS.bind(null,n,r,i,e),void 0,null),$t===null)throw Error(X(349));So&30||mS(n,e,i)}return i}function mS(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ut.updateQueue,e===null?(e={lastEffect:null,stores:null},ut.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function gS(t,e,n,r){e.value=n,e.getSnapshot=r,vS(e)&&_S(t)}function yS(t,e,n){return n(function(){vS(e)&&_S(t)})}function vS(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Dr(t,n)}catch{return!0}}function _S(t){var e=Ei(t,1);e!==null&&Rr(e,t,1,-1)}function tw(t){var e=Ur();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:mu,lastRenderedState:t},e.queue=t,t=t.dispatch=IM.bind(null,ut,t),[e.memoizedState,t]}function gu(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ut.updateQueue,e===null?(e={lastEffect:null,stores:null},ut.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function wS(){return _r().memoizedState}function td(t,e,n,r){var i=Ur();ut.flags|=t,i.memoizedState=gu(1|e,n,void 0,r===void 0?null:r)}function yh(t,e,n,r){var i=_r();r=r===void 0?null:r;var s=void 0;if(Mt!==null){var o=Mt.memoizedState;if(s=o.destroy,r!==null&&uy(r,o.deps)){i.memoizedState=gu(e,n,s,r);return}}ut.flags|=t,i.memoizedState=gu(1|e,n,s,r)}function nw(t,e){return td(8390656,8,t,e)}function hy(t,e){return yh(2048,8,t,e)}function bS(t,e){return yh(4,2,t,e)}function xS(t,e){return yh(4,4,t,e)}function SS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function kS(t,e,n){return n=n!=null?n.concat([t]):null,yh(4,4,SS.bind(null,e,t),n)}function fy(){}function CS(t,e){var n=_r();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&uy(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function ES(t,e){var n=_r();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&uy(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function TS(t,e,n){return So&21?(Dr(n,e)||(n=Lx(),ut.lanes|=n,ko|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Dn=!0),t.memoizedState=n)}function DM(t,e){var n=Ze;Ze=n!==0&&4>n?n:4,t(!0);var r=qf.transition;qf.transition={};try{t(!1),e()}finally{Ze=n,qf.transition=r}}function PS(){return _r().memoizedState}function AM(t,e,n){var r=ms(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},MS(t))OS(e,n);else if(n=cS(t,e,n,r),n!==null){var i=vn();Rr(n,t,r,i),NS(n,e,r)}}function IM(t,e,n){var r=ms(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(MS(t))OS(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,n);if(i.hasEagerState=!0,i.eagerState=l,Dr(l,o)){var u=e.interleaved;u===null?(i.next=i,iy(e)):(i.next=u.next,u.next=i),e.interleaved=i;return}}catch{}finally{}n=cS(t,e,i,r),n!==null&&(i=vn(),Rr(n,t,r,i),NS(n,e,r))}}function MS(t){var e=t.alternate;return t===ut||e!==null&&e===ut}function OS(t,e){$l=Od=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function NS(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Hg(t,n)}}var Nd={readContext:vr,useCallback:on,useContext:on,useEffect:on,useImperativeHandle:on,useInsertionEffect:on,useLayoutEffect:on,useMemo:on,useReducer:on,useRef:on,useState:on,useDebugValue:on,useDeferredValue:on,useTransition:on,useMutableSource:on,useSyncExternalStore:on,useId:on,unstable_isNewReconciler:!1},jM={readContext:vr,useCallback:function(t,e){return Ur().memoizedState=[t,e===void 0?null:e],t},useContext:vr,useEffect:nw,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,td(4194308,4,SS.bind(null,e,t),n)},useLayoutEffect:function(t,e){return td(4194308,4,t,e)},useInsertionEffect:function(t,e){return td(4,2,t,e)},useMemo:function(t,e){var n=Ur();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ur();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=AM.bind(null,ut,t),[r.memoizedState,t]},useRef:function(t){var e=Ur();return t={current:t},e.memoizedState=t},useState:tw,useDebugValue:fy,useDeferredValue:function(t){return Ur().memoizedState=t},useTransition:function(){var t=tw(!1),e=t[0];return t=DM.bind(null,t[1]),Ur().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ut,i=Ur();if(ot){if(n===void 0)throw Error(X(407));n=n()}else{if(n=e(),$t===null)throw Error(X(349));So&30||mS(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,nw(yS.bind(null,r,s,t),[t]),r.flags|=2048,gu(9,gS.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Ur(),e=$t.identifierPrefix;if(ot){var n=vi,r=yi;n=(r&~(1<<32-Lr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=pu++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=RM++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},zM={readContext:vr,useCallback:CS,useContext:vr,useEffect:hy,useImperativeHandle:kS,useInsertionEffect:bS,useLayoutEffect:xS,useMemo:ES,useReducer:Wf,useRef:wS,useState:function(){return Wf(mu)},useDebugValue:fy,useDeferredValue:function(t){var e=_r();return TS(e,Mt.memoizedState,t)},useTransition:function(){var t=Wf(mu)[0],e=_r().memoizedState;return[t,e]},useMutableSource:fS,useSyncExternalStore:pS,useId:PS,unstable_isNewReconciler:!1},BM={readContext:vr,useCallback:CS,useContext:vr,useEffect:hy,useImperativeHandle:kS,useInsertionEffect:bS,useLayoutEffect:xS,useMemo:ES,useReducer:Kf,useRef:wS,useState:function(){return Kf(mu)},useDebugValue:fy,useDeferredValue:function(t){var e=_r();return Mt===null?e.memoizedState=t:TS(e,Mt.memoizedState,t)},useTransition:function(){var t=Kf(mu)[0],e=_r().memoizedState;return[t,e]},useMutableSource:fS,useSyncExternalStore:pS,useId:PS,unstable_isNewReconciler:!1};function Er(t,e){if(t&&t.defaultProps){e=ct({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function fm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:ct({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var vh={isMounted:function(t){return(t=t._reactInternals)?Do(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=vn(),i=ms(t),s=wi(r,i);s.payload=e,n!=null&&(s.callback=n),e=fs(t,s,i),e!==null&&(Rr(e,t,i,r),Xc(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=vn(),i=ms(t),s=wi(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=fs(t,s,i),e!==null&&(Rr(e,t,i,r),Xc(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=vn(),r=ms(t),i=wi(n,r);i.tag=2,e!=null&&(i.callback=e),e=fs(t,i,r),e!==null&&(Rr(e,t,r,n),Xc(e,t,r))}};function rw(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!lu(n,r)||!lu(i,s):!0}function LS(t,e,n){var r=!1,i=ks,s=e.contextType;return typeof s=="object"&&s!==null?s=vr(s):(i=In(e)?bo:dn.current,r=e.contextTypes,s=(r=r!=null)?La(t,i):ks),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=vh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function iw(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&vh.enqueueReplaceState(e,e.state,null)}function pm(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},sy(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=vr(s):(s=In(e)?bo:dn.current,i.context=La(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(fm(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&vh.enqueueReplaceState(i,i.state,null),Pd(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Ia(t,e){try{var n="",r=e;do n+=fP(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Zf(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function mm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var FM=typeof WeakMap=="function"?WeakMap:Map;function RS(t,e,n){n=wi(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Rd||(Rd=!0,Cm=r),mm(t,e)},n}function DS(t,e,n){n=wi(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){mm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){mm(t,e),typeof r!="function"&&(ps===null?ps=new Set([this]):ps.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function sw(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new FM;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=eO.bind(null,t,e,n),e.then(t,t))}function ow(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function aw(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=wi(-1,1),e.tag=2,fs(n,e,1))),n.lanes|=1),t)}var $M=Mi.ReactCurrentOwner,Dn=!1;function mn(t,e,n,r){e.child=t===null?uS(e,null,n,r):Da(e,t.child,n,r)}function lw(t,e,n,r,i){n=n.render;var s=e.ref;return Ca(e,i),r=cy(t,e,n,r,s,i),n=dy(),t!==null&&!Dn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ti(t,e,i)):(ot&&n&&Yg(e),e.flags|=1,mn(t,e,r,i),e.child)}function uw(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!by(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,AS(t,e,s,r,i)):(t=sd(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:lu,n(o,r)&&t.ref===e.ref)return Ti(t,e,i)}return e.flags|=1,t=gs(s,r),t.ref=e.ref,t.return=e,e.child=t}function AS(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(lu(s,r)&&t.ref===e.ref)if(Dn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Dn=!0);else return e.lanes=t.lanes,Ti(t,e,i)}return gm(t,e,n,r,i)}function IS(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xe(va,Hn),Hn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Xe(va,Hn),Hn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Xe(va,Hn),Hn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Xe(va,Hn),Hn|=r;return mn(t,e,i,n),e.child}function jS(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function gm(t,e,n,r,i){var s=In(n)?bo:dn.current;return s=La(e,s),Ca(e,i),n=cy(t,e,n,r,s,i),r=dy(),t!==null&&!Dn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ti(t,e,i)):(ot&&r&&Yg(e),e.flags|=1,mn(t,e,n,i),e.child)}function cw(t,e,n,r,i){if(In(n)){var s=!0;Sd(e)}else s=!1;if(Ca(e,i),e.stateNode===null)nd(t,e),LS(e,n,r),pm(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var u=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=vr(d):(d=In(n)?bo:dn.current,d=La(e,d));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||u!==d)&&iw(e,o,r,d),Zi=!1;var m=e.memoizedState;o.state=m,Pd(e,r,o,i),u=e.memoizedState,l!==r||m!==u||An.current||Zi?(typeof h=="function"&&(fm(e,n,h,r),u=e.memoizedState),(l=Zi||rw(e,n,l,r,m,u,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,dS(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:Er(e.type,l),o.props=d,f=e.pendingProps,m=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=vr(u):(u=In(n)?bo:dn.current,u=La(e,u));var g=n.getDerivedStateFromProps;(h=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||m!==u)&&iw(e,o,r,u),Zi=!1,m=e.memoizedState,o.state=m,Pd(e,r,o,i);var _=e.memoizedState;l!==f||m!==_||An.current||Zi?(typeof g=="function"&&(fm(e,n,g,r),_=e.memoizedState),(d=Zi||rw(e,n,d,r,m,_,u)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,_,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,_,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=_),o.props=r,o.state=_,o.context=u,r=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return ym(t,e,n,r,s,i)}function ym(t,e,n,r,i,s){jS(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&Q_(e,n,!1),Ti(t,e,s);r=e.stateNode,$M.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Da(e,t.child,null,s),e.child=Da(e,null,l,s)):mn(t,e,l,s),e.memoizedState=r.state,i&&Q_(e,n,!0),e.child}function zS(t){var e=t.stateNode;e.pendingContext?Z_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Z_(t,e.context,!1),oy(t,e.containerInfo)}function dw(t,e,n,r,i){return Ra(),ey(i),e.flags|=256,mn(t,e,n,r),e.child}var vm={dehydrated:null,treeContext:null,retryLane:0};function _m(t){return{baseLanes:t,cachePool:null,transitions:null}}function BS(t,e,n){var r=e.pendingProps,i=lt.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Xe(lt,i&1),t===null)return dm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=bh(o,r,0,null),t=mo(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=_m(n),e.memoizedState=vm,t):py(e,o));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return UM(t,e,o,r,l,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,l=i.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=gs(i,u),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=gs(l,s):(s=mo(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?_m(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=vm,r}return s=t.child,t=s.sibling,r=gs(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function py(t,e){return e=bh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Tc(t,e,n,r){return r!==null&&ey(r),Da(e,t.child,null,n),t=py(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function UM(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Zf(Error(X(422))),Tc(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=bh({mode:"visible",children:r.children},i,0,null),s=mo(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Da(e,t.child,null,o),e.child.memoizedState=_m(o),e.memoizedState=vm,s);if(!(e.mode&1))return Tc(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(X(419)),r=Zf(s,r,void 0),Tc(t,e,o,r)}if(l=(o&t.childLanes)!==0,Dn||l){if(r=$t,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ei(t,i),Rr(r,t,i,-1))}return wy(),r=Zf(Error(X(421))),Tc(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=tO.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Kn=hs(i.nextSibling),Zn=e,ot=!0,Or=null,t!==null&&(cr[dr++]=yi,cr[dr++]=vi,cr[dr++]=xo,yi=t.id,vi=t.overflow,xo=e),e=py(e,r.children),e.flags|=4096,e)}function hw(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),hm(t.return,e,n)}function Qf(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function FS(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(mn(t,e,r.children,n),r=lt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&hw(t,n,e);else if(t.tag===19)hw(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Xe(lt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Md(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Qf(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Md(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Qf(e,!0,n,null,s);break;case"together":Qf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function nd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ti(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ko|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(X(153));if(e.child!==null){for(t=e.child,n=gs(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=gs(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function VM(t,e,n){switch(e.tag){case 3:zS(e),Ra();break;case 5:hS(e);break;case 1:In(e.type)&&Sd(e);break;case 4:oy(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Xe(Ed,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Xe(lt,lt.current&1),e.flags|=128,null):n&e.child.childLanes?BS(t,e,n):(Xe(lt,lt.current&1),t=Ti(t,e,n),t!==null?t.sibling:null);Xe(lt,lt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return FS(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Xe(lt,lt.current),r)break;return null;case 22:case 23:return e.lanes=0,IS(t,e,n)}return Ti(t,e,n)}var $S,wm,US,VS;$S=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};wm=function(){};US=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,ao(Qr.current);var s=null;switch(n){case"input":i=Up(t,i),r=Up(t,r),s=[];break;case"select":i=ct({},i,{value:void 0}),r=ct({},r,{value:void 0}),s=[];break;case"textarea":i=qp(t,i),r=qp(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=bd)}Kp(n,r);var o;n=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var l=i[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(tu.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in r){var u=r[d];if(l=i?.[d],r.hasOwnProperty(d)&&u!==l&&(u!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(s||(s=[]),s.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(s=s||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(s=s||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(tu.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&nt("scroll",t),s||l===u||(s=[])):(s=s||[]).push(d,u))}n&&(s=s||[]).push("style",n);var d=s;(e.updateQueue=d)&&(e.flags|=4)}};VS=function(t,e,n,r){n!==r&&(e.flags|=4)};function wl(t,e){if(!ot)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function an(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function HM(t,e,n){var r=e.pendingProps;switch(Xg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return an(e),null;case 1:return In(e.type)&&xd(),an(e),null;case 3:return r=e.stateNode,Aa(),rt(An),rt(dn),ly(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Cc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Or!==null&&(Pm(Or),Or=null))),wm(t,e),an(e),null;case 5:ay(e);var i=ao(fu.current);if(n=e.type,t!==null&&e.stateNode!=null)US(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(X(166));return an(e),null}if(t=ao(Qr.current),Cc(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[qr]=e,r[du]=s,t=(e.mode&1)!==0,n){case"dialog":nt("cancel",r),nt("close",r);break;case"iframe":case"object":case"embed":nt("load",r);break;case"video":case"audio":for(i=0;i<Ol.length;i++)nt(Ol[i],r);break;case"source":nt("error",r);break;case"img":case"image":case"link":nt("error",r),nt("load",r);break;case"details":nt("toggle",r);break;case"input":b_(r,s),nt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},nt("invalid",r);break;case"textarea":S_(r,s),nt("invalid",r)}Kp(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&kc(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&kc(r.textContent,l,t),i=["children",""+l]):tu.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&nt("scroll",r)}switch(n){case"input":gc(r),x_(r,s,!0);break;case"textarea":gc(r),k_(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=bd)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=yx(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[qr]=e,t[du]=r,$S(t,e,!1,!1),e.stateNode=t;e:{switch(o=Zp(n,r),n){case"dialog":nt("cancel",t),nt("close",t),i=r;break;case"iframe":case"object":case"embed":nt("load",t),i=r;break;case"video":case"audio":for(i=0;i<Ol.length;i++)nt(Ol[i],t);i=r;break;case"source":nt("error",t),i=r;break;case"img":case"image":case"link":nt("error",t),nt("load",t),i=r;break;case"details":nt("toggle",t),i=r;break;case"input":b_(t,r),i=Up(t,r),nt("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=ct({},r,{value:void 0}),nt("invalid",t);break;case"textarea":S_(t,r),i=qp(t,r),nt("invalid",t);break;default:i=r}Kp(n,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var u=l[s];s==="style"?wx(t,u):s==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&vx(t,u)):s==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&nu(t,u):typeof u=="number"&&nu(t,""+u):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(tu.hasOwnProperty(s)?u!=null&&s==="onScroll"&&nt("scroll",t):u!=null&&zg(t,s,u,o))}switch(n){case"input":gc(t),x_(t,r,!1);break;case"textarea":gc(t),k_(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ss(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?ba(t,!!r.multiple,s,!1):r.defaultValue!=null&&ba(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=bd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return an(e),null;case 6:if(t&&e.stateNode!=null)VS(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(X(166));if(n=ao(fu.current),ao(Qr.current),Cc(e)){if(r=e.stateNode,n=e.memoizedProps,r[qr]=e,(s=r.nodeValue!==n)&&(t=Zn,t!==null))switch(t.tag){case 3:kc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&kc(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[qr]=e,e.stateNode=r}return an(e),null;case 13:if(rt(lt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ot&&Kn!==null&&e.mode&1&&!(e.flags&128))aS(),Ra(),e.flags|=98560,s=!1;else if(s=Cc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(X(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(X(317));s[qr]=e}else Ra(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;an(e),s=!1}else Or!==null&&(Pm(Or),Or=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||lt.current&1?Dt===0&&(Dt=3):wy())),e.updateQueue!==null&&(e.flags|=4),an(e),null);case 4:return Aa(),wm(t,e),t===null&&uu(e.stateNode.containerInfo),an(e),null;case 10:return ry(e.type._context),an(e),null;case 17:return In(e.type)&&xd(),an(e),null;case 19:if(rt(lt),s=e.memoizedState,s===null)return an(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)wl(s,!1);else{if(Dt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Md(t),o!==null){for(e.flags|=128,wl(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Xe(lt,lt.current&1|2),e.child}t=t.sibling}s.tail!==null&&mt()>ja&&(e.flags|=128,r=!0,wl(s,!1),e.lanes=4194304)}else{if(!r)if(t=Md(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),wl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ot)return an(e),null}else 2*mt()-s.renderingStartTime>ja&&n!==1073741824&&(e.flags|=128,r=!0,wl(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=mt(),e.sibling=null,n=lt.current,Xe(lt,r?n&1|2:n&1),e):(an(e),null);case 22:case 23:return _y(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Hn&1073741824&&(an(e),e.subtreeFlags&6&&(e.flags|=8192)):an(e),null;case 24:return null;case 25:return null}throw Error(X(156,e.tag))}function qM(t,e){switch(Xg(e),e.tag){case 1:return In(e.type)&&xd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Aa(),rt(An),rt(dn),ly(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return ay(e),null;case 13:if(rt(lt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(X(340));Ra()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return rt(lt),null;case 4:return Aa(),null;case 10:return ry(e.type._context),null;case 22:case 23:return _y(),null;case 24:return null;default:return null}}var Pc=!1,un=!1,WM=typeof WeakSet=="function"?WeakSet:Set,fe=null;function ya(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){dt(t,e,r)}else n.current=null}function bm(t,e,n){try{n()}catch(r){dt(t,e,r)}}var fw=!1;function KM(t,e){if(im=vd,t=Zx(),Jg(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,l=-1,u=-1,d=0,h=0,f=t,m=null;t:for(;;){for(var g;f!==n||i!==0&&f.nodeType!==3||(l=o+i),f!==s||r!==0&&f.nodeType!==3||(u=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(g=f.firstChild)!==null;)m=f,f=g;for(;;){if(f===t)break t;if(m===n&&++d===i&&(l=o),m===s&&++h===r&&(u=o),(g=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=g}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(sm={focusedElem:t,selectionRange:n},vd=!1,fe=e;fe!==null;)if(e=fe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,fe=t;else for(;fe!==null;){e=fe;try{var _=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var v=_.memoizedProps,x=_.memoizedState,S=e.stateNode,k=S.getSnapshotBeforeUpdate(e.elementType===e.type?v:Er(e.type,v),x);S.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var C=e.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(X(163))}}catch(R){dt(e,e.return,R)}if(t=e.sibling,t!==null){t.return=e.return,fe=t;break}fe=e.return}return _=fw,fw=!1,_}function Ul(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&bm(e,n,s)}i=i.next}while(i!==r)}}function _h(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function xm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function HS(t){var e=t.alternate;e!==null&&(t.alternate=null,HS(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[qr],delete e[du],delete e[lm],delete e[MM],delete e[OM])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function qS(t){return t.tag===5||t.tag===3||t.tag===4}function pw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||qS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Sm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=bd));else if(r!==4&&(t=t.child,t!==null))for(Sm(t,e,n),t=t.sibling;t!==null;)Sm(t,e,n),t=t.sibling}function km(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(km(t,e,n),t=t.sibling;t!==null;)km(t,e,n),t=t.sibling}var Gt=null,Tr=!1;function Ui(t,e,n){for(n=n.child;n!==null;)WS(t,e,n),n=n.sibling}function WS(t,e,n){if(Zr&&typeof Zr.onCommitFiberUnmount=="function")try{Zr.onCommitFiberUnmount(dh,n)}catch{}switch(n.tag){case 5:un||ya(n,e);case 6:var r=Gt,i=Tr;Gt=null,Ui(t,e,n),Gt=r,Tr=i,Gt!==null&&(Tr?(t=Gt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Gt.removeChild(n.stateNode));break;case 18:Gt!==null&&(Tr?(t=Gt,n=n.stateNode,t.nodeType===8?Uf(t.parentNode,n):t.nodeType===1&&Uf(t,n),ou(t)):Uf(Gt,n.stateNode));break;case 4:r=Gt,i=Tr,Gt=n.stateNode.containerInfo,Tr=!0,Ui(t,e,n),Gt=r,Tr=i;break;case 0:case 11:case 14:case 15:if(!un&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&bm(n,e,o),i=i.next}while(i!==r)}Ui(t,e,n);break;case 1:if(!un&&(ya(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){dt(n,e,l)}Ui(t,e,n);break;case 21:Ui(t,e,n);break;case 22:n.mode&1?(un=(r=un)||n.memoizedState!==null,Ui(t,e,n),un=r):Ui(t,e,n);break;default:Ui(t,e,n)}}function mw(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new WM),e.forEach(function(r){var i=nO.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function kr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Gt=l.stateNode,Tr=!1;break e;case 3:Gt=l.stateNode.containerInfo,Tr=!0;break e;case 4:Gt=l.stateNode.containerInfo,Tr=!0;break e}l=l.return}if(Gt===null)throw Error(X(160));WS(s,o,i),Gt=null,Tr=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(d){dt(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)KS(e,t),e=e.sibling}function KS(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(kr(e,t),$r(t),r&4){try{Ul(3,t,t.return),_h(3,t)}catch(v){dt(t,t.return,v)}try{Ul(5,t,t.return)}catch(v){dt(t,t.return,v)}}break;case 1:kr(e,t),$r(t),r&512&&n!==null&&ya(n,n.return);break;case 5:if(kr(e,t),$r(t),r&512&&n!==null&&ya(n,n.return),t.flags&32){var i=t.stateNode;try{nu(i,"")}catch(v){dt(t,t.return,v)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&mx(i,s),Zp(l,o);var d=Zp(l,s);for(o=0;o<u.length;o+=2){var h=u[o],f=u[o+1];h==="style"?wx(i,f):h==="dangerouslySetInnerHTML"?vx(i,f):h==="children"?nu(i,f):zg(i,h,f,d)}switch(l){case"input":Vp(i,s);break;case"textarea":gx(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?ba(i,!!s.multiple,g,!1):m!==!!s.multiple&&(s.defaultValue!=null?ba(i,!!s.multiple,s.defaultValue,!0):ba(i,!!s.multiple,s.multiple?[]:"",!1))}i[du]=s}catch(v){dt(t,t.return,v)}}break;case 6:if(kr(e,t),$r(t),r&4){if(t.stateNode===null)throw Error(X(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(v){dt(t,t.return,v)}}break;case 3:if(kr(e,t),$r(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ou(e.containerInfo)}catch(v){dt(t,t.return,v)}break;case 4:kr(e,t),$r(t);break;case 13:kr(e,t),$r(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(yy=mt())),r&4&&mw(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(un=(d=un)||h,kr(e,t),un=d):kr(e,t),$r(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(fe=t,h=t.child;h!==null;){for(f=fe=h;fe!==null;){switch(m=fe,g=m.child,m.tag){case 0:case 11:case 14:case 15:Ul(4,m,m.return);break;case 1:ya(m,m.return);var _=m.stateNode;if(typeof _.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,_.props=e.memoizedProps,_.state=e.memoizedState,_.componentWillUnmount()}catch(v){dt(r,n,v)}}break;case 5:ya(m,m.return);break;case 22:if(m.memoizedState!==null){yw(f);continue}}g!==null?(g.return=m,fe=g):yw(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{i=f.stateNode,d?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,u=f.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=_x("display",o))}catch(v){dt(t,t.return,v)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(v){dt(t,t.return,v)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:kr(e,t),$r(t),r&4&&mw(t);break;case 21:break;default:kr(e,t),$r(t)}}function $r(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(qS(n)){var r=n;break e}n=n.return}throw Error(X(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(nu(i,""),r.flags&=-33);var s=pw(t);km(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=pw(t);Sm(t,l,o);break;default:throw Error(X(161))}}catch(u){dt(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function ZM(t,e,n){fe=t,ZS(t)}function ZS(t,e,n){for(var r=(t.mode&1)!==0;fe!==null;){var i=fe,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Pc;if(!o){var l=i.alternate,u=l!==null&&l.memoizedState!==null||un;l=Pc;var d=un;if(Pc=o,(un=u)&&!d)for(fe=i;fe!==null;)o=fe,u=o.child,o.tag===22&&o.memoizedState!==null?vw(i):u!==null?(u.return=o,fe=u):vw(i);for(;s!==null;)fe=s,ZS(s),s=s.sibling;fe=i,Pc=l,un=d}gw(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,fe=s):gw(t)}}function gw(t){for(;fe!==null;){var e=fe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:un||_h(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!un)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Er(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&ew(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}ew(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&ou(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(X(163))}un||e.flags&512&&xm(e)}catch(m){dt(e,e.return,m)}}if(e===t){fe=null;break}if(n=e.sibling,n!==null){n.return=e.return,fe=n;break}fe=e.return}}function yw(t){for(;fe!==null;){var e=fe;if(e===t){fe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,fe=n;break}fe=e.return}}function vw(t){for(;fe!==null;){var e=fe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{_h(4,e)}catch(u){dt(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(u){dt(e,i,u)}}var s=e.return;try{xm(e)}catch(u){dt(e,s,u)}break;case 5:var o=e.return;try{xm(e)}catch(u){dt(e,o,u)}}}catch(u){dt(e,e.return,u)}if(e===t){fe=null;break}var l=e.sibling;if(l!==null){l.return=e.return,fe=l;break}fe=e.return}}var QM=Math.ceil,Ld=Mi.ReactCurrentDispatcher,my=Mi.ReactCurrentOwner,mr=Mi.ReactCurrentBatchConfig,qe=0,$t=null,bt=null,en=0,Hn=0,va=Ps(0),Dt=0,yu=null,ko=0,wh=0,gy=0,Vl=null,Ln=null,yy=0,ja=1/0,fi=null,Rd=!1,Cm=null,ps=null,Mc=!1,rs=null,Dd=0,Hl=0,Em=null,rd=-1,id=0;function vn(){return qe&6?mt():rd!==-1?rd:rd=mt()}function ms(t){return t.mode&1?qe&2&&en!==0?en&-en:LM.transition!==null?(id===0&&(id=Lx()),id):(t=Ze,t!==0||(t=window.event,t=t===void 0?16:Bx(t.type)),t):1}function Rr(t,e,n,r){if(50<Hl)throw Hl=0,Em=null,Error(X(185));ju(t,n,r),(!(qe&2)||t!==$t)&&(t===$t&&(!(qe&2)&&(wh|=n),Dt===4&&Xi(t,en)),jn(t,r),n===1&&qe===0&&!(e.mode&1)&&(ja=mt()+500,gh&&Ms()))}function jn(t,e){var n=t.callbackNode;LP(t,e);var r=yd(t,t===$t?en:0);if(r===0)n!==null&&T_(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&T_(n),e===1)t.tag===0?NM(_w.bind(null,t)):iS(_w.bind(null,t)),TM(function(){!(qe&6)&&Ms()}),n=null;else{switch(Rx(r)){case 1:n=Vg;break;case 4:n=Ox;break;case 16:n=gd;break;case 536870912:n=Nx;break;default:n=gd}n=nk(n,QS.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function QS(t,e){if(rd=-1,id=0,qe&6)throw Error(X(327));var n=t.callbackNode;if(Ea()&&t.callbackNode!==n)return null;var r=yd(t,t===$t?en:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Ad(t,r);else{e=r;var i=qe;qe|=2;var s=JS();($t!==t||en!==e)&&(fi=null,ja=mt()+500,po(t,e));do try{YM();break}catch(l){GS(t,l)}while(!0);ny(),Ld.current=s,qe=i,bt!==null?e=0:($t=null,en=0,e=Dt)}if(e!==0){if(e===2&&(i=Xp(t),i!==0&&(r=i,e=Tm(t,i))),e===1)throw n=yu,po(t,0),Xi(t,r),jn(t,mt()),n;if(e===6)Xi(t,r);else{if(i=t.current.alternate,!(r&30)&&!GM(i)&&(e=Ad(t,r),e===2&&(s=Xp(t),s!==0&&(r=s,e=Tm(t,s))),e===1))throw n=yu,po(t,0),Xi(t,r),jn(t,mt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(X(345));case 2:Js(t,Ln,fi);break;case 3:if(Xi(t,r),(r&130023424)===r&&(e=yy+500-mt(),10<e)){if(yd(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){vn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=am(Js.bind(null,t,Ln,fi),e);break}Js(t,Ln,fi);break;case 4:if(Xi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Lr(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=mt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*QM(r/1960))-r,10<r){t.timeoutHandle=am(Js.bind(null,t,Ln,fi),r);break}Js(t,Ln,fi);break;case 5:Js(t,Ln,fi);break;default:throw Error(X(329))}}}return jn(t,mt()),t.callbackNode===n?QS.bind(null,t):null}function Tm(t,e){var n=Vl;return t.current.memoizedState.isDehydrated&&(po(t,e).flags|=256),t=Ad(t,e),t!==2&&(e=Ln,Ln=n,e!==null&&Pm(e)),t}function Pm(t){Ln===null?Ln=t:Ln.push.apply(Ln,t)}function GM(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Dr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Xi(t,e){for(e&=~gy,e&=~wh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Lr(e),r=1<<n;t[n]=-1,e&=~r}}function _w(t){if(qe&6)throw Error(X(327));Ea();var e=yd(t,0);if(!(e&1))return jn(t,mt()),null;var n=Ad(t,e);if(t.tag!==0&&n===2){var r=Xp(t);r!==0&&(e=r,n=Tm(t,r))}if(n===1)throw n=yu,po(t,0),Xi(t,e),jn(t,mt()),n;if(n===6)throw Error(X(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Js(t,Ln,fi),jn(t,mt()),null}function vy(t,e){var n=qe;qe|=1;try{return t(e)}finally{qe=n,qe===0&&(ja=mt()+500,gh&&Ms())}}function Co(t){rs!==null&&rs.tag===0&&!(qe&6)&&Ea();var e=qe;qe|=1;var n=mr.transition,r=Ze;try{if(mr.transition=null,Ze=1,t)return t()}finally{Ze=r,mr.transition=n,qe=e,!(qe&6)&&Ms()}}function _y(){Hn=va.current,rt(va)}function po(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,EM(n)),bt!==null)for(n=bt.return;n!==null;){var r=n;switch(Xg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&xd();break;case 3:Aa(),rt(An),rt(dn),ly();break;case 5:ay(r);break;case 4:Aa();break;case 13:rt(lt);break;case 19:rt(lt);break;case 10:ry(r.type._context);break;case 22:case 23:_y()}n=n.return}if($t=t,bt=t=gs(t.current,null),en=Hn=e,Dt=0,yu=null,gy=wh=ko=0,Ln=Vl=null,oo!==null){for(e=0;e<oo.length;e++)if(n=oo[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}oo=null}return t}function GS(t,e){do{var n=bt;try{if(ny(),ed.current=Nd,Od){for(var r=ut.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Od=!1}if(So=0,zt=Mt=ut=null,$l=!1,pu=0,my.current=null,n===null||n.return===null){Dt=1,yu=e,bt=null;break}e:{var s=t,o=n.return,l=n,u=e;if(e=en,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,h=l,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var g=ow(o);if(g!==null){g.flags&=-257,aw(g,o,l,s,e),g.mode&1&&sw(s,d,e),e=g,u=d;var _=e.updateQueue;if(_===null){var v=new Set;v.add(u),e.updateQueue=v}else _.add(u);break e}else{if(!(e&1)){sw(s,d,e),wy();break e}u=Error(X(426))}}else if(ot&&l.mode&1){var x=ow(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),aw(x,o,l,s,e),ey(Ia(u,l));break e}}s=u=Ia(u,l),Dt!==4&&(Dt=2),Vl===null?Vl=[s]:Vl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var S=RS(s,u,e);X_(s,S);break e;case 1:l=u;var k=s.type,C=s.stateNode;if(!(s.flags&128)&&(typeof k.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(ps===null||!ps.has(C)))){s.flags|=65536,e&=-e,s.lanes|=e;var R=DS(s,l,e);X_(s,R);break e}}s=s.return}while(s!==null)}XS(n)}catch(N){e=N,bt===n&&n!==null&&(bt=n=n.return);continue}break}while(!0)}function JS(){var t=Ld.current;return Ld.current=Nd,t===null?Nd:t}function wy(){(Dt===0||Dt===3||Dt===2)&&(Dt=4),$t===null||!(ko&268435455)&&!(wh&268435455)||Xi($t,en)}function Ad(t,e){var n=qe;qe|=2;var r=JS();($t!==t||en!==e)&&(fi=null,po(t,e));do try{JM();break}catch(i){GS(t,i)}while(!0);if(ny(),qe=n,Ld.current=r,bt!==null)throw Error(X(261));return $t=null,en=0,Dt}function JM(){for(;bt!==null;)YS(bt)}function YM(){for(;bt!==null&&!SP();)YS(bt)}function YS(t){var e=tk(t.alternate,t,Hn);t.memoizedProps=t.pendingProps,e===null?XS(t):bt=e,my.current=null}function XS(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=qM(n,e),n!==null){n.flags&=32767,bt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Dt=6,bt=null;return}}else if(n=HM(n,e,Hn),n!==null){bt=n;return}if(e=e.sibling,e!==null){bt=e;return}bt=e=t}while(e!==null);Dt===0&&(Dt=5)}function Js(t,e,n){var r=Ze,i=mr.transition;try{mr.transition=null,Ze=1,XM(t,e,n,r)}finally{mr.transition=i,Ze=r}return null}function XM(t,e,n,r){do Ea();while(rs!==null);if(qe&6)throw Error(X(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(X(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(RP(t,s),t===$t&&(bt=$t=null,en=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Mc||(Mc=!0,nk(gd,function(){return Ea(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=mr.transition,mr.transition=null;var o=Ze;Ze=1;var l=qe;qe|=4,my.current=null,KM(t,n),KS(n,t),_M(sm),vd=!!im,sm=im=null,t.current=n,ZM(n),kP(),qe=l,Ze=o,mr.transition=s}else t.current=n;if(Mc&&(Mc=!1,rs=t,Dd=i),s=t.pendingLanes,s===0&&(ps=null),TP(n.stateNode),jn(t,mt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Rd)throw Rd=!1,t=Cm,Cm=null,t;return Dd&1&&t.tag!==0&&Ea(),s=t.pendingLanes,s&1?t===Em?Hl++:(Hl=0,Em=t):Hl=0,Ms(),null}function Ea(){if(rs!==null){var t=Rx(Dd),e=mr.transition,n=Ze;try{if(mr.transition=null,Ze=16>t?16:t,rs===null)var r=!1;else{if(t=rs,rs=null,Dd=0,qe&6)throw Error(X(331));var i=qe;for(qe|=4,fe=t.current;fe!==null;){var s=fe,o=s.child;if(fe.flags&16){var l=s.deletions;if(l!==null){for(var u=0;u<l.length;u++){var d=l[u];for(fe=d;fe!==null;){var h=fe;switch(h.tag){case 0:case 11:case 15:Ul(8,h,s)}var f=h.child;if(f!==null)f.return=h,fe=f;else for(;fe!==null;){h=fe;var m=h.sibling,g=h.return;if(HS(h),h===d){fe=null;break}if(m!==null){m.return=g,fe=m;break}fe=g}}}var _=s.alternate;if(_!==null){var v=_.child;if(v!==null){_.child=null;do{var x=v.sibling;v.sibling=null,v=x}while(v!==null)}}fe=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,fe=o;else e:for(;fe!==null;){if(s=fe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Ul(9,s,s.return)}var S=s.sibling;if(S!==null){S.return=s.return,fe=S;break e}fe=s.return}}var k=t.current;for(fe=k;fe!==null;){o=fe;var C=o.child;if(o.subtreeFlags&2064&&C!==null)C.return=o,fe=C;else e:for(o=k;fe!==null;){if(l=fe,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:_h(9,l)}}catch(N){dt(l,l.return,N)}if(l===o){fe=null;break e}var R=l.sibling;if(R!==null){R.return=l.return,fe=R;break e}fe=l.return}}if(qe=i,Ms(),Zr&&typeof Zr.onPostCommitFiberRoot=="function")try{Zr.onPostCommitFiberRoot(dh,t)}catch{}r=!0}return r}finally{Ze=n,mr.transition=e}}return!1}function ww(t,e,n){e=Ia(n,e),e=RS(t,e,1),t=fs(t,e,1),e=vn(),t!==null&&(ju(t,1,e),jn(t,e))}function dt(t,e,n){if(t.tag===3)ww(t,t,n);else for(;e!==null;){if(e.tag===3){ww(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ps===null||!ps.has(r))){t=Ia(n,t),t=DS(e,t,1),e=fs(e,t,1),t=vn(),e!==null&&(ju(e,1,t),jn(e,t));break}}e=e.return}}function eO(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=vn(),t.pingedLanes|=t.suspendedLanes&n,$t===t&&(en&n)===n&&(Dt===4||Dt===3&&(en&130023424)===en&&500>mt()-yy?po(t,0):gy|=n),jn(t,e)}function ek(t,e){e===0&&(t.mode&1?(e=_c,_c<<=1,!(_c&130023424)&&(_c=4194304)):e=1);var n=vn();t=Ei(t,e),t!==null&&(ju(t,e,n),jn(t,n))}function tO(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),ek(t,n)}function nO(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(X(314))}r!==null&&r.delete(e),ek(t,n)}var tk;tk=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||An.current)Dn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Dn=!1,VM(t,e,n);Dn=!!(t.flags&131072)}else Dn=!1,ot&&e.flags&1048576&&sS(e,Cd,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;nd(t,e),t=e.pendingProps;var i=La(e,dn.current);Ca(e,n),i=cy(null,e,r,t,i,n);var s=dy();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,In(r)?(s=!0,Sd(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,sy(e),i.updater=vh,e.stateNode=i,i._reactInternals=e,pm(e,r,t,n),e=ym(null,e,r,!0,s,n)):(e.tag=0,ot&&s&&Yg(e),mn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(nd(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=iO(r),t=Er(r,t),i){case 0:e=gm(null,e,r,t,n);break e;case 1:e=cw(null,e,r,t,n);break e;case 11:e=lw(null,e,r,t,n);break e;case 14:e=uw(null,e,r,Er(r.type,t),n);break e}throw Error(X(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Er(r,i),gm(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Er(r,i),cw(t,e,r,i,n);case 3:e:{if(zS(e),t===null)throw Error(X(387));r=e.pendingProps,s=e.memoizedState,i=s.element,dS(t,e),Pd(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Ia(Error(X(423)),e),e=dw(t,e,r,n,i);break e}else if(r!==i){i=Ia(Error(X(424)),e),e=dw(t,e,r,n,i);break e}else for(Kn=hs(e.stateNode.containerInfo.firstChild),Zn=e,ot=!0,Or=null,n=uS(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ra(),r===i){e=Ti(t,e,n);break e}mn(t,e,r,n)}e=e.child}return e;case 5:return hS(e),t===null&&dm(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,om(r,i)?o=null:s!==null&&om(r,s)&&(e.flags|=32),jS(t,e),mn(t,e,o,n),e.child;case 6:return t===null&&dm(e),null;case 13:return BS(t,e,n);case 4:return oy(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Da(e,null,r,n):mn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Er(r,i),lw(t,e,r,i,n);case 7:return mn(t,e,e.pendingProps,n),e.child;case 8:return mn(t,e,e.pendingProps.children,n),e.child;case 12:return mn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Xe(Ed,r._currentValue),r._currentValue=o,s!==null)if(Dr(s.value,o)){if(s.children===i.children&&!An.current){e=Ti(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(s.tag===1){u=wi(-1,n&-n),u.tag=2;var d=s.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?u.next=u:(u.next=h.next,h.next=u),d.pending=u}}s.lanes|=n,u=s.alternate,u!==null&&(u.lanes|=n),hm(s.return,n,e),l.lanes|=n;break}u=u.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(X(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),hm(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}mn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Ca(e,n),i=vr(i),r=r(i),e.flags|=1,mn(t,e,r,n),e.child;case 14:return r=e.type,i=Er(r,e.pendingProps),i=Er(r.type,i),uw(t,e,r,i,n);case 15:return AS(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Er(r,i),nd(t,e),e.tag=1,In(r)?(t=!0,Sd(e)):t=!1,Ca(e,n),LS(e,r,i),pm(e,r,i,n),ym(null,e,r,!0,t,n);case 19:return FS(t,e,n);case 22:return IS(t,e,n)}throw Error(X(156,e.tag))};function nk(t,e){return Mx(t,e)}function rO(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fr(t,e,n,r){return new rO(t,e,n,r)}function by(t){return t=t.prototype,!(!t||!t.isReactComponent)}function iO(t){if(typeof t=="function")return by(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Fg)return 11;if(t===$g)return 14}return 2}function gs(t,e){var n=t.alternate;return n===null?(n=fr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function sd(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")by(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case la:return mo(n.children,i,s,e);case Bg:o=8,i|=8;break;case zp:return t=fr(12,n,e,i|2),t.elementType=zp,t.lanes=s,t;case Bp:return t=fr(13,n,e,i),t.elementType=Bp,t.lanes=s,t;case Fp:return t=fr(19,n,e,i),t.elementType=Fp,t.lanes=s,t;case hx:return bh(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case cx:o=10;break e;case dx:o=9;break e;case Fg:o=11;break e;case $g:o=14;break e;case Ki:o=16,r=null;break e}throw Error(X(130,t==null?t:typeof t,""))}return e=fr(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function mo(t,e,n,r){return t=fr(7,t,r,e),t.lanes=n,t}function bh(t,e,n,r){return t=fr(22,t,r,e),t.elementType=hx,t.lanes=n,t.stateNode={isHidden:!1},t}function Gf(t,e,n){return t=fr(6,t,null,e),t.lanes=n,t}function Jf(t,e,n){return e=fr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function sO(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Nf(0),this.expirationTimes=Nf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Nf(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function xy(t,e,n,r,i,s,o,l,u){return t=new sO(t,e,n,l,u),e===1?(e=1,s===!0&&(e|=8)):e=0,s=fr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},sy(s),t}function oO(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:aa,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function rk(t){if(!t)return ks;t=t._reactInternals;e:{if(Do(t)!==t||t.tag!==1)throw Error(X(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(In(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(X(171))}if(t.tag===1){var n=t.type;if(In(n))return rS(t,n,e)}return e}function ik(t,e,n,r,i,s,o,l,u){return t=xy(n,r,!0,t,i,s,o,l,u),t.context=rk(null),n=t.current,r=vn(),i=ms(n),s=wi(r,i),s.callback=e??null,fs(n,s,i),t.current.lanes=i,ju(t,i,r),jn(t,r),t}function xh(t,e,n,r){var i=e.current,s=vn(),o=ms(i);return n=rk(n),e.context===null?e.context=n:e.pendingContext=n,e=wi(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=fs(i,e,o),t!==null&&(Rr(t,i,o,s),Xc(t,i,o)),o}function Id(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function bw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Sy(t,e){bw(t,e),(t=t.alternate)&&bw(t,e)}function aO(){return null}var sk=typeof reportError=="function"?reportError:function(t){console.error(t)};function ky(t){this._internalRoot=t}Sh.prototype.render=ky.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(X(409));xh(t,e,null,null)};Sh.prototype.unmount=ky.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Co(function(){xh(null,t,null,null)}),e[Ci]=null}};function Sh(t){this._internalRoot=t}Sh.prototype.unstable_scheduleHydration=function(t){if(t){var e=Ix();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Yi.length&&e!==0&&e<Yi[n].priority;n++);Yi.splice(n,0,t),n===0&&zx(t)}};function Cy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function kh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function xw(){}function lO(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var d=Id(o);s.call(d)}}var o=ik(e,r,t,0,null,!1,!1,"",xw);return t._reactRootContainer=o,t[Ci]=o.current,uu(t.nodeType===8?t.parentNode:t),Co(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var d=Id(u);l.call(d)}}var u=xy(t,0,!1,null,null,!1,!1,"",xw);return t._reactRootContainer=u,t[Ci]=u.current,uu(t.nodeType===8?t.parentNode:t),Co(function(){xh(e,u,n,r)}),u}function Ch(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var u=Id(o);l.call(u)}}xh(e,o,t,i)}else o=lO(n,e,t,i,r);return Id(o)}Dx=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ml(e.pendingLanes);n!==0&&(Hg(e,n|1),jn(e,mt()),!(qe&6)&&(ja=mt()+500,Ms()))}break;case 13:Co(function(){var r=Ei(t,1);if(r!==null){var i=vn();Rr(r,t,1,i)}}),Sy(t,1)}};qg=function(t){if(t.tag===13){var e=Ei(t,134217728);if(e!==null){var n=vn();Rr(e,t,134217728,n)}Sy(t,134217728)}};Ax=function(t){if(t.tag===13){var e=ms(t),n=Ei(t,e);if(n!==null){var r=vn();Rr(n,t,e,r)}Sy(t,e)}};Ix=function(){return Ze};jx=function(t,e){var n=Ze;try{return Ze=t,e()}finally{Ze=n}};Gp=function(t,e,n){switch(e){case"input":if(Vp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=mh(r);if(!i)throw Error(X(90));px(r),Vp(r,i)}}}break;case"textarea":gx(t,n);break;case"select":e=n.value,e!=null&&ba(t,!!n.multiple,e,!1)}};Sx=vy;kx=Co;var uO={usingClientEntryPoint:!1,Events:[Bu,ha,mh,bx,xx,vy]},bl={findFiberByHostInstance:so,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},cO={bundleType:bl.bundleType,version:bl.version,rendererPackageName:bl.rendererPackageName,rendererConfig:bl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Mi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Tx(t),t===null?null:t.stateNode},findFiberByHostInstance:bl.findFiberByHostInstance||aO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Oc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Oc.isDisabled&&Oc.supportsFiber)try{dh=Oc.inject(cO),Zr=Oc}catch{}}Yn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uO;Yn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Cy(e))throw Error(X(200));return oO(t,e,null,n)};Yn.createRoot=function(t,e){if(!Cy(t))throw Error(X(299));var n=!1,r="",i=sk;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=xy(t,1,!1,null,null,n,!1,r,i),t[Ci]=e.current,uu(t.nodeType===8?t.parentNode:t),new ky(e)};Yn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(X(188)):(t=Object.keys(t).join(","),Error(X(268,t)));return t=Tx(e),t=t===null?null:t.stateNode,t};Yn.flushSync=function(t){return Co(t)};Yn.hydrate=function(t,e,n){if(!kh(e))throw Error(X(200));return Ch(null,t,e,!0,n)};Yn.hydrateRoot=function(t,e,n){if(!Cy(t))throw Error(X(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=sk;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=ik(e,null,t,1,n??null,i,!1,s,o),t[Ci]=e.current,uu(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Sh(e)};Yn.render=function(t,e,n){if(!kh(e))throw Error(X(200));return Ch(null,t,e,!1,n)};Yn.unmountComponentAtNode=function(t){if(!kh(t))throw Error(X(40));return t._reactRootContainer?(Co(function(){Ch(null,null,t,!1,function(){t._reactRootContainer=null,t[Ci]=null})}),!0):!1};Yn.unstable_batchedUpdates=vy;Yn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!kh(n))throw Error(X(200));if(t==null||t._reactInternals===void 0)throw Error(X(38));return Ch(t,e,n,!1,r)};Yn.version="18.3.1-next-f1338f8080-20240426";function ok(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ok)}catch(t){console.error(t)}}ok(),ox.exports=Yn;var Wr=ox.exports;const ak=Ng(Wr),dO=Zb({__proto__:null,default:ak},[Wr]);var Sw=Wr;Ip.createRoot=Sw.createRoot,Ip.hydrateRoot=Sw.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function st(){return st=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},st.apply(this,arguments)}var wt;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(wt||(wt={}));const kw="popstate";function hO(t){t===void 0&&(t={});function e(r,i){let{pathname:s,search:o,hash:l}=r.location;return vu("",{pathname:s,search:o,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:Eo(i)}return pO(e,n,null,t)}function $e(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function za(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function fO(){return Math.random().toString(36).substr(2,8)}function Cw(t,e){return{usr:t.state,key:t.key,idx:e}}function vu(t,e,n,r){return n===void 0&&(n=null),st({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Os(e):e,{state:n,key:e&&e.key||r||fO()})}function Eo(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Os(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function pO(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,l=wt.Pop,u=null,d=h();d==null&&(d=0,o.replaceState(st({},o.state,{idx:d}),""));function h(){return(o.state||{idx:null}).idx}function f(){l=wt.Pop;let x=h(),S=x==null?null:x-d;d=x,u&&u({action:l,location:v.location,delta:S})}function m(x,S){l=wt.Push;let k=vu(v.location,x,S);d=h()+1;let C=Cw(k,d),R=v.createHref(k);try{o.pushState(C,"",R)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;i.location.assign(R)}s&&u&&u({action:l,location:v.location,delta:1})}function g(x,S){l=wt.Replace;let k=vu(v.location,x,S);d=h();let C=Cw(k,d),R=v.createHref(k);o.replaceState(C,"",R),s&&u&&u({action:l,location:v.location,delta:0})}function _(x){let S=i.location.origin!=="null"?i.location.origin:i.location.href,k=typeof x=="string"?x:Eo(x);return k=k.replace(/ $/,"%20"),$e(S,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,S)}let v={get action(){return l},get location(){return t(i,o)},listen(x){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(kw,f),u=x,()=>{i.removeEventListener(kw,f),u=null}},createHref(x){return e(i,x)},createURL:_,encodeLocation(x){let S=_(x);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:m,replace:g,go(x){return o.go(x)}};return v}var Ke;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Ke||(Ke={}));const mO=new Set(["lazy","caseSensitive","path","id","index","children"]);function gO(t){return t.index===!0}function jd(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((i,s)=>{let o=[...n,String(s)],l=typeof i.id=="string"?i.id:o.join("-");if($e(i.index!==!0||!i.children,"Cannot specify children on an index route"),$e(!r[l],'Found a route id collision on id "'+l+`".  Route id's must be globally unique within Data Router usages`),gO(i)){let u=st({},i,e(i),{id:l});return r[l]=u,u}else{let u=st({},i,e(i),{id:l,children:void 0});return r[l]=u,i.children&&(u.children=jd(i.children,e,o,r)),u}})}function eo(t,e,n){return n===void 0&&(n="/"),od(t,e,n,!1)}function od(t,e,n,r){let i=typeof e=="string"?Os(e):e,s=Qa(i.pathname||"/",n);if(s==null)return null;let o=lk(t);vO(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let d=MO(s);l=TO(o[u],d,r)}return l}function yO(t,e){let{route:n,pathname:r,params:i}=t;return{id:n.id,pathname:r,params:i,data:e[n.id],handle:n.handle}}function lk(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,o,l)=>{let u={relativePath:l===void 0?s.path||"":l,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};u.relativePath.startsWith("/")&&($e(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let d=bi([r,u.relativePath]),h=n.concat(u);s.children&&s.children.length>0&&($e(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),lk(s.children,e,h,d)),!(s.path==null&&!s.index)&&e.push({path:d,score:CO(d,s.index),routesMeta:h})};return t.forEach((s,o)=>{var l;if(s.path===""||!((l=s.path)!=null&&l.includes("?")))i(s,o);else for(let u of uk(s.path))i(s,o,u)}),e}function uk(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=uk(r.join("/")),l=[];return l.push(...o.map(u=>u===""?s:[s,u].join("/"))),i&&l.push(...o),l.map(u=>t.startsWith("/")&&u===""?"/":u)}function vO(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:EO(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const _O=/^:[\w-]+$/,wO=3,bO=2,xO=1,SO=10,kO=-2,Ew=t=>t==="*";function CO(t,e){let n=t.split("/"),r=n.length;return n.some(Ew)&&(r+=kO),e&&(r+=bO),n.filter(i=>!Ew(i)).reduce((i,s)=>i+(_O.test(s)?wO:s===""?xO:SO),r)}function EO(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function TO(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,i={},s="/",o=[];for(let l=0;l<r.length;++l){let u=r[l],d=l===r.length-1,h=s==="/"?e:e.slice(s.length)||"/",f=Tw({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},h),m=u.route;if(!f&&d&&n&&!r[r.length-1].route.index&&(f=Tw({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!f)return null;Object.assign(i,f.params),o.push({params:i,pathname:bi([s,f.pathname]),pathnameBase:LO(bi([s,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(s=bi([s,f.pathnameBase]))}return o}function Tw(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=PO(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:r.reduce((d,h,f)=>{let{paramName:m,isOptional:g}=h;if(m==="*"){let v=l[f]||"";o=s.slice(0,s.length-v.length).replace(/(.)\/+$/,"$1")}const _=l[f];return g&&!_?d[m]=void 0:d[m]=(_||"").replace(/%2F/g,"/"),d},{}),pathname:s,pathnameBase:o,pattern:t}}function PO(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),za(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(r.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function MO(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return za(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Qa(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function OO(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?Os(t):t;return{pathname:n?n.startsWith("/")?n:NO(n,e):e,search:RO(r),hash:DO(i)}}function NO(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Yf(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function ck(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Ey(t,e){let n=ck(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function Ty(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=Os(t):(i=st({},t),$e(!i.pathname||!i.pathname.includes("?"),Yf("?","pathname","search",i)),$e(!i.pathname||!i.pathname.includes("#"),Yf("#","pathname","hash",i)),$e(!i.search||!i.search.includes("#"),Yf("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,l;if(o==null)l=n;else{let f=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),f-=1;i.pathname=m.join("/")}l=f>=0?e[f]:"/"}let u=OO(i,l),d=o&&o!=="/"&&o.endsWith("/"),h=(s||o===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(d||h)&&(u.pathname+="/"),u}const bi=t=>t.join("/").replace(/\/\/+/g,"/"),LO=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),RO=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,DO=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class zd{constructor(e,n,r,i){i===void 0&&(i=!1),this.status=e,this.statusText=n||"",this.internal=i,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function _u(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const dk=["post","put","patch","delete"],AO=new Set(dk),IO=["get",...dk],jO=new Set(IO),zO=new Set([301,302,303,307,308]),BO=new Set([307,308]),Xf={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},FO={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},xl={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Py=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,$O=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),hk="remix-router-transitions";function UO(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;$e(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let i;if(t.mapRouteProperties)i=t.mapRouteProperties;else if(t.detectErrorBoundary){let I=t.detectErrorBoundary;i=z=>({hasErrorBoundary:I(z)})}else i=$O;let s={},o=jd(t.routes,i,void 0,s),l,u=t.basename||"/",d=t.dataStrategy||WO,h=t.patchRoutesOnNavigation,f=st({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),m=null,g=new Set,_=null,v=null,x=null,S=t.hydrationData!=null,k=eo(o,t.history.location,u),C=!1,R=null;if(k==null&&!h){let I=Nn(404,{pathname:t.history.location.pathname}),{matches:z,route:U}=zw(o);k=z,R={[U.id]:I}}k&&!t.hydrationData&&yt(k,o,t.history.location.pathname).active&&(k=null);let N;if(k)if(k.some(I=>I.route.lazy))N=!1;else if(!k.some(I=>I.route.loader))N=!0;else if(f.v7_partialHydration){let I=t.hydrationData?t.hydrationData.loaderData:null,z=t.hydrationData?t.hydrationData.errors:null;if(z){let U=k.findIndex(Q=>z[Q.route.id]!==void 0);N=k.slice(0,U+1).every(Q=>!Om(Q.route,I,z))}else N=k.every(U=>!Om(U.route,I,z))}else N=t.hydrationData!=null;else if(N=!1,k=[],f.v7_partialHydration){let I=yt(null,o,t.history.location.pathname);I.active&&I.matches&&(C=!0,k=I.matches)}let P,T={historyAction:t.history.action,location:t.history.location,matches:k,initialized:N,navigation:Xf,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||R,fetchers:new Map,blockers:new Map},D=wt.Pop,j=!1,O,F=!1,Z=new Map,se=null,oe=!1,ye=!1,ue=[],Te=new Set,H=new Map,ne=0,G=-1,$=new Map,K=new Set,ie=new Map,re=new Map,te=new Set,ee=new Map,Se=new Map,Re;function Ce(){if(m=t.history.listen(I=>{let{action:z,location:U,delta:Q}=I;if(Re){Re(),Re=void 0;return}za(Se.size===0||Q!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let W=Bs({currentLocation:T.location,nextLocation:U,historyAction:z});if(W&&Q!=null){let he=new Promise(ve=>{Re=ve});t.history.go(Q*-1),Ii(W,{state:"blocked",location:U,proceed(){Ii(W,{state:"proceeding",proceed:void 0,reset:void 0,location:U}),he.then(()=>t.history.go(Q))},reset(){let ve=new Map(T.blockers);ve.set(W,xl),De({blockers:ve})}});return}return kt(z,U)}),n){oN(e,Z);let I=()=>aN(e,Z);e.addEventListener("pagehide",I),se=()=>e.removeEventListener("pagehide",I)}return T.initialized||kt(wt.Pop,T.location,{initialHydration:!0}),P}function Oe(){m&&m(),se&&se(),g.clear(),O&&O.abort(),T.fetchers.forEach((I,z)=>sn(z)),T.blockers.forEach((I,z)=>zs(z))}function et(I){return g.add(I),()=>g.delete(I)}function De(I,z){z===void 0&&(z={}),T=st({},T,I);let U=[],Q=[];f.v7_fetcherPersist&&T.fetchers.forEach((W,he)=>{W.state==="idle"&&(te.has(he)?Q.push(he):U.push(he))}),te.forEach(W=>{!T.fetchers.has(W)&&!H.has(W)&&Q.push(W)}),[...g].forEach(W=>W(T,{deletedFetchers:Q,viewTransitionOpts:z.viewTransitionOpts,flushSync:z.flushSync===!0})),f.v7_fetcherPersist?(U.forEach(W=>T.fetchers.delete(W)),Q.forEach(W=>sn(W))):Q.forEach(W=>te.delete(W))}function gt(I,z,U){var Q,W;let{flushSync:he}=U===void 0?{}:U,ve=T.actionData!=null&&T.navigation.formMethod!=null&&Pr(T.navigation.formMethod)&&T.navigation.state==="loading"&&((Q=I.state)==null?void 0:Q._isRedirect)!==!0,ce;z.actionData?Object.keys(z.actionData).length>0?ce=z.actionData:ce=null:ve?ce=T.actionData:ce=null;let pe=z.loaderData?Iw(T.loaderData,z.loaderData,z.matches||[],z.errors):T.loaderData,de=T.blockers;de.size>0&&(de=new Map(de),de.forEach((ze,Et)=>de.set(Et,xl)));let ge=j===!0||T.navigation.formMethod!=null&&Pr(T.navigation.formMethod)&&((W=I.state)==null?void 0:W._isRedirect)!==!0;l&&(o=l,l=void 0),oe||D===wt.Pop||(D===wt.Push?t.history.push(I,I.state):D===wt.Replace&&t.history.replace(I,I.state));let ke;if(D===wt.Pop){let ze=Z.get(T.location.pathname);ze&&ze.has(I.pathname)?ke={currentLocation:T.location,nextLocation:I}:Z.has(I.pathname)&&(ke={currentLocation:I,nextLocation:T.location})}else if(F){let ze=Z.get(T.location.pathname);ze?ze.add(I.pathname):(ze=new Set([I.pathname]),Z.set(T.location.pathname,ze)),ke={currentLocation:T.location,nextLocation:I}}De(st({},z,{actionData:ce,loaderData:pe,historyAction:D,location:I,initialized:!0,navigation:Xf,revalidation:"idle",restoreScrollPosition:Kt(I,z.matches||T.matches),preventScrollReset:ge,blockers:de}),{viewTransitionOpts:ke,flushSync:he===!0}),D=wt.Pop,j=!1,F=!1,oe=!1,ye=!1,ue=[]}async function rn(I,z){if(typeof I=="number"){t.history.go(I);return}let U=Mm(T.location,T.matches,u,f.v7_prependBasename,I,f.v7_relativeSplatPath,z?.fromRouteId,z?.relative),{path:Q,submission:W,error:he}=Pw(f.v7_normalizeFormMethod,!1,U,z),ve=T.location,ce=vu(T.location,Q,z&&z.state);ce=st({},ce,t.history.encodeLocation(ce));let pe=z&&z.replace!=null?z.replace:void 0,de=wt.Push;pe===!0?de=wt.Replace:pe===!1||W!=null&&Pr(W.formMethod)&&W.formAction===T.location.pathname+T.location.search&&(de=wt.Replace);let ge=z&&"preventScrollReset"in z?z.preventScrollReset===!0:void 0,ke=(z&&z.flushSync)===!0,ze=Bs({currentLocation:ve,nextLocation:ce,historyAction:de});if(ze){Ii(ze,{state:"blocked",location:ce,proceed(){Ii(ze,{state:"proceeding",proceed:void 0,reset:void 0,location:ce}),rn(I,z)},reset(){let Et=new Map(T.blockers);Et.set(ze,xl),De({blockers:Et})}});return}return await kt(de,ce,{submission:W,pendingError:he,preventScrollReset:ge,replace:z&&z.replace,enableViewTransition:z&&z.viewTransition,flushSync:ke})}function Tn(){if(Un(),De({revalidation:"loading"}),T.navigation.state!=="submitting"){if(T.navigation.state==="idle"){kt(T.historyAction,T.location,{startUninterruptedRevalidation:!0});return}kt(D||T.historyAction,T.navigation.location,{overrideNavigation:T.navigation,enableViewTransition:F===!0})}}async function kt(I,z,U){O&&O.abort(),O=null,D=I,oe=(U&&U.startUninterruptedRevalidation)===!0,tr(T.location,T.matches),j=(U&&U.preventScrollReset)===!0,F=(U&&U.enableViewTransition)===!0;let Q=l||o,W=U&&U.overrideNavigation,he=U!=null&&U.initialHydration&&T.matches&&T.matches.length>0&&!C?T.matches:eo(Q,z,u),ve=(U&&U.flushSync)===!0;if(he&&T.initialized&&!ye&&YO(T.location,z)&&!(U&&U.submission&&Pr(U.submission.formMethod))){gt(z,{matches:he},{flushSync:ve});return}let ce=yt(he,Q,z.pathname);if(ce.active&&ce.matches&&(he=ce.matches),!he){let{error:Qe,notFoundMatches:He,route:it}=ji(z.pathname);gt(z,{matches:He,loaderData:{},errors:{[it.id]:Qe}},{flushSync:ve});return}O=new AbortController;let pe=Qo(t.history,z,O.signal,U&&U.submission),de;if(U&&U.pendingError)de=[to(he).route.id,{type:Ke.error,error:U.pendingError}];else if(U&&U.submission&&Pr(U.submission.formMethod)){let Qe=await Ct(pe,z,U.submission,he,ce.active,{replace:U.replace,flushSync:ve});if(Qe.shortCircuited)return;if(Qe.pendingActionResult){let[He,it]=Qe.pendingActionResult;if(qn(it)&&_u(it.error)&&it.error.status===404){O=null,gt(z,{matches:Qe.matches,loaderData:{},errors:{[He]:it.error}});return}}he=Qe.matches||he,de=Qe.pendingActionResult,W=ep(z,U.submission),ve=!1,ce.active=!1,pe=Qo(t.history,pe.url,pe.signal)}let{shortCircuited:ge,matches:ke,loaderData:ze,errors:Et}=await Pn(pe,z,he,ce.active,W,U&&U.submission,U&&U.fetcherSubmission,U&&U.replace,U&&U.initialHydration===!0,ve,de);ge||(O=null,gt(z,st({matches:ke||he},jw(de),{loaderData:ze,errors:Et})))}async function Ct(I,z,U,Q,W,he){he===void 0&&(he={}),Un();let ve=iN(z,U);if(De({navigation:ve},{flushSync:he.flushSync===!0}),W){let de=await Zt(Q,z.pathname,I.signal);if(de.type==="aborted")return{shortCircuited:!0};if(de.type==="error"){let ge=to(de.partialMatches).route.id;return{matches:de.partialMatches,pendingActionResult:[ge,{type:Ke.error,error:de.error}]}}else if(de.matches)Q=de.matches;else{let{notFoundMatches:ge,error:ke,route:ze}=ji(z.pathname);return{matches:ge,pendingActionResult:[ze.id,{type:Ke.error,error:ke}]}}}let ce,pe=Nl(Q,z);if(!pe.route.action&&!pe.route.lazy)ce={type:Ke.error,error:Nn(405,{method:I.method,pathname:z.pathname,routeId:pe.route.id})};else if(ce=(await ti("action",T,I,[pe],Q,null))[pe.route.id],I.signal.aborted)return{shortCircuited:!0};if(lo(ce)){let de;return he&&he.replace!=null?de=he.replace:de=Rw(ce.response.headers.get("Location"),new URL(I.url),u)===T.location.pathname+T.location.search,await er(I,ce,!0,{submission:U,replace:de}),{shortCircuited:!0}}if(is(ce))throw Nn(400,{type:"defer-action"});if(qn(ce)){let de=to(Q,pe.route.id);return(he&&he.replace)!==!0&&(D=wt.Push),{matches:Q,pendingActionResult:[de.route.id,ce]}}return{matches:Q,pendingActionResult:[pe.route.id,ce]}}async function Pn(I,z,U,Q,W,he,ve,ce,pe,de,ge){let ke=W||ep(z,he),ze=he||ve||Fw(ke),Et=!oe&&(!f.v7_partialHydration||!pe);if(Q){if(Et){let tt=Li(ge);De(st({navigation:ke},tt!==void 0?{actionData:tt}:{}),{flushSync:de})}let Ie=await Zt(U,z.pathname,I.signal);if(Ie.type==="aborted")return{shortCircuited:!0};if(Ie.type==="error"){let tt=to(Ie.partialMatches).route.id;return{matches:Ie.partialMatches,loaderData:{},errors:{[tt]:Ie.error}}}else if(Ie.matches)U=Ie.matches;else{let{error:tt,notFoundMatches:oi,route:br}=ji(z.pathname);return{matches:oi,loaderData:{},errors:{[br.id]:tt}}}}let Qe=l||o,[He,it]=Ow(t.history,T,U,ze,z,f.v7_partialHydration&&pe===!0,f.v7_skipActionErrorRevalidation,ye,ue,Te,te,ie,K,Qe,u,ge);if(at(Ie=>!(U&&U.some(tt=>tt.route.id===Ie))||He&&He.some(tt=>tt.route.id===Ie)),G=++ne,He.length===0&&it.length===0){let Ie=ni();return gt(z,st({matches:U,loaderData:{},errors:ge&&qn(ge[1])?{[ge[0]]:ge[1].error}:null},jw(ge),Ie?{fetchers:new Map(T.fetchers)}:{}),{flushSync:de}),{shortCircuited:!0}}if(Et){let Ie={};if(!Q){Ie.navigation=ke;let tt=Li(ge);tt!==void 0&&(Ie.actionData=tt)}it.length>0&&(Ie.fetchers=$n(it)),De(Ie,{flushSync:de})}it.forEach(Ie=>{Vn(Ie.key),Ie.controller&&H.set(Ie.key,Ie.controller)});let ii=()=>it.forEach(Ie=>Vn(Ie.key));O&&O.signal.addEventListener("abort",ii);let{loaderResults:Fs,fetcherResults:Mn}=await Ri(T,U,He,it,I);if(I.signal.aborted)return{shortCircuited:!0};O&&O.signal.removeEventListener("abort",ii),it.forEach(Ie=>H.delete(Ie.key));let rr=Nc(Fs);if(rr)return await er(I,rr.result,!0,{replace:ce}),{shortCircuited:!0};if(rr=Nc(Mn),rr)return K.add(rr.key),await er(I,rr.result,!0,{replace:ce}),{shortCircuited:!0};let{loaderData:rl,errors:$s}=Aw(T,U,Fs,ge,it,Mn,ee);ee.forEach((Ie,tt)=>{Ie.subscribe(oi=>{(oi||Ie.done)&&ee.delete(tt)})}),f.v7_partialHydration&&pe&&T.errors&&($s=st({},T.errors,$s));let si=ni(),Fo=js(G),zi=si||Fo||it.length>0;return st({matches:U,loaderData:rl,errors:$s},zi?{fetchers:new Map(T.fetchers)}:{})}function Li(I){if(I&&!qn(I[1]))return{[I[0]]:I[1].data};if(T.actionData)return Object.keys(T.actionData).length===0?null:T.actionData}function $n(I){return I.forEach(z=>{let U=T.fetchers.get(z.key),Q=Sl(void 0,U?U.data:void 0);T.fetchers.set(z.key,Q)}),new Map(T.fetchers)}function jr(I,z,U,Q){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");Vn(I);let W=(Q&&Q.flushSync)===!0,he=l||o,ve=Mm(T.location,T.matches,u,f.v7_prependBasename,U,f.v7_relativeSplatPath,z,Q?.relative),ce=eo(he,ve,u),pe=yt(ce,he,ve);if(pe.active&&pe.matches&&(ce=pe.matches),!ce){qt(I,z,Nn(404,{pathname:ve}),{flushSync:W});return}let{path:de,submission:ge,error:ke}=Pw(f.v7_normalizeFormMethod,!0,ve,Q);if(ke){qt(I,z,ke,{flushSync:W});return}let ze=Nl(ce,de),Et=(Q&&Q.preventScrollReset)===!0;if(ge&&Pr(ge.formMethod)){ei(I,z,de,ze,ce,pe.active,W,Et,ge);return}ie.set(I,{routeId:z,path:de}),Is(I,z,de,ze,ce,pe.active,W,Et,ge)}async function ei(I,z,U,Q,W,he,ve,ce,pe){Un(),ie.delete(I);function de(we){if(!we.route.action&&!we.route.lazy){let We=Nn(405,{method:pe.formMethod,pathname:U,routeId:z});return qt(I,z,We,{flushSync:ve}),!0}return!1}if(!he&&de(Q))return;let ge=T.fetchers.get(I);At(I,sN(pe,ge),{flushSync:ve});let ke=new AbortController,ze=Qo(t.history,U,ke.signal,pe);if(he){let we=await Zt(W,new URL(ze.url).pathname,ze.signal,I);if(we.type==="aborted")return;if(we.type==="error"){qt(I,z,we.error,{flushSync:ve});return}else if(we.matches){if(W=we.matches,Q=Nl(W,U),de(Q))return}else{qt(I,z,Nn(404,{pathname:U}),{flushSync:ve});return}}H.set(I,ke);let Et=ne,He=(await ti("action",T,ze,[Q],W,I))[Q.route.id];if(ze.signal.aborted){H.get(I)===ke&&H.delete(I);return}if(f.v7_fetcherPersist&&te.has(I)){if(lo(He)||qn(He)){At(I,Hi(void 0));return}}else{if(lo(He))if(H.delete(I),G>Et){At(I,Hi(void 0));return}else return K.add(I),At(I,Sl(pe)),er(ze,He,!1,{fetcherSubmission:pe,preventScrollReset:ce});if(qn(He)){qt(I,z,He.error);return}}if(is(He))throw Nn(400,{type:"defer-action"});let it=T.navigation.location||T.location,ii=Qo(t.history,it,ke.signal),Fs=l||o,Mn=T.navigation.state!=="idle"?eo(Fs,T.navigation.location,u):T.matches;$e(Mn,"Didn't find any matches after fetcher action");let rr=++ne;$.set(I,rr);let rl=Sl(pe,He.data);T.fetchers.set(I,rl);let[$s,si]=Ow(t.history,T,Mn,pe,it,!1,f.v7_skipActionErrorRevalidation,ye,ue,Te,te,ie,K,Fs,u,[Q.route.id,He]);si.filter(we=>we.key!==I).forEach(we=>{let We=we.key,Us=T.fetchers.get(We),Bi=Sl(void 0,Us?Us.data:void 0);T.fetchers.set(We,Bi),Vn(We),we.controller&&H.set(We,we.controller)}),De({fetchers:new Map(T.fetchers)});let Fo=()=>si.forEach(we=>Vn(we.key));ke.signal.addEventListener("abort",Fo);let{loaderResults:zi,fetcherResults:Ie}=await Ri(T,Mn,$s,si,ii);if(ke.signal.aborted)return;ke.signal.removeEventListener("abort",Fo),$.delete(I),H.delete(I),si.forEach(we=>H.delete(we.key));let tt=Nc(zi);if(tt)return er(ii,tt.result,!1,{preventScrollReset:ce});if(tt=Nc(Ie),tt)return K.add(tt.key),er(ii,tt.result,!1,{preventScrollReset:ce});let{loaderData:oi,errors:br}=Aw(T,Mn,zi,void 0,si,Ie,ee);if(T.fetchers.has(I)){let we=Hi(He.data);T.fetchers.set(I,we)}js(rr),T.navigation.state==="loading"&&rr>G?($e(D,"Expected pending action"),O&&O.abort(),gt(T.navigation.location,{matches:Mn,loaderData:oi,errors:br,fetchers:new Map(T.fetchers)})):(De({errors:br,loaderData:Iw(T.loaderData,oi,Mn,br),fetchers:new Map(T.fetchers)}),ye=!1)}async function Is(I,z,U,Q,W,he,ve,ce,pe){let de=T.fetchers.get(I);At(I,Sl(pe,de?de.data:void 0),{flushSync:ve});let ge=new AbortController,ke=Qo(t.history,U,ge.signal);if(he){let He=await Zt(W,new URL(ke.url).pathname,ke.signal,I);if(He.type==="aborted")return;if(He.type==="error"){qt(I,z,He.error,{flushSync:ve});return}else if(He.matches)W=He.matches,Q=Nl(W,U);else{qt(I,z,Nn(404,{pathname:U}),{flushSync:ve});return}}H.set(I,ge);let ze=ne,Qe=(await ti("loader",T,ke,[Q],W,I))[Q.route.id];if(is(Qe)&&(Qe=await My(Qe,ke.signal,!0)||Qe),H.get(I)===ge&&H.delete(I),!ke.signal.aborted){if(te.has(I)){At(I,Hi(void 0));return}if(lo(Qe))if(G>ze){At(I,Hi(void 0));return}else{K.add(I),await er(ke,Qe,!1,{preventScrollReset:ce});return}if(qn(Qe)){qt(I,z,Qe.error);return}$e(!is(Qe),"Unhandled fetcher deferred data"),At(I,Hi(Qe.data))}}async function er(I,z,U,Q){let{submission:W,fetcherSubmission:he,preventScrollReset:ve,replace:ce}=Q===void 0?{}:Q;z.response.headers.has("X-Remix-Revalidate")&&(ye=!0);let pe=z.response.headers.get("Location");$e(pe,"Expected a Location header on the redirect Response"),pe=Rw(pe,new URL(I.url),u);let de=vu(T.location,pe,{_isRedirect:!0});if(n){let He=!1;if(z.response.headers.has("X-Remix-Reload-Document"))He=!0;else if(Py.test(pe)){const it=t.history.createURL(pe);He=it.origin!==e.location.origin||Qa(it.pathname,u)==null}if(He){ce?e.location.replace(pe):e.location.assign(pe);return}}O=null;let ge=ce===!0||z.response.headers.has("X-Remix-Replace")?wt.Replace:wt.Push,{formMethod:ke,formAction:ze,formEncType:Et}=T.navigation;!W&&!he&&ke&&ze&&Et&&(W=Fw(T.navigation));let Qe=W||he;if(BO.has(z.response.status)&&Qe&&Pr(Qe.formMethod))await kt(ge,de,{submission:st({},Qe,{formAction:pe}),preventScrollReset:ve||j,enableViewTransition:U?F:void 0});else{let He=ep(de,W);await kt(ge,de,{overrideNavigation:He,fetcherSubmission:he,preventScrollReset:ve||j,enableViewTransition:U?F:void 0})}}async function ti(I,z,U,Q,W,he){let ve,ce={};try{ve=await KO(d,I,z,U,Q,W,he,s,i)}catch(pe){return Q.forEach(de=>{ce[de.route.id]={type:Ke.error,error:pe}}),ce}for(let[pe,de]of Object.entries(ve))if(XO(de)){let ge=de.result;ce[pe]={type:Ke.redirect,response:GO(ge,U,pe,W,u,f.v7_relativeSplatPath)}}else ce[pe]=await QO(de);return ce}async function Ri(I,z,U,Q,W){let he=I.matches,ve=ti("loader",I,W,U,z,null),ce=Promise.all(Q.map(async ge=>{if(ge.matches&&ge.match&&ge.controller){let ze=(await ti("loader",I,Qo(t.history,ge.path,ge.controller.signal),[ge.match],ge.matches,ge.key))[ge.match.route.id];return{[ge.key]:ze}}else return Promise.resolve({[ge.key]:{type:Ke.error,error:Nn(404,{pathname:ge.path})}})})),pe=await ve,de=(await ce).reduce((ge,ke)=>Object.assign(ge,ke),{});return await Promise.all([nN(z,pe,W.signal,he,I.loaderData),rN(z,de,Q)]),{loaderResults:pe,fetcherResults:de}}function Un(){ye=!0,ue.push(...at()),ie.forEach((I,z)=>{H.has(z)&&Te.add(z),Vn(z)})}function At(I,z,U){U===void 0&&(U={}),T.fetchers.set(I,z),De({fetchers:new Map(T.fetchers)},{flushSync:(U&&U.flushSync)===!0})}function qt(I,z,U,Q){Q===void 0&&(Q={});let W=to(T.matches,z);sn(I),De({errors:{[W.route.id]:U},fetchers:new Map(T.fetchers)},{flushSync:(Q&&Q.flushSync)===!0})}function Di(I){return re.set(I,(re.get(I)||0)+1),te.has(I)&&te.delete(I),T.fetchers.get(I)||FO}function sn(I){let z=T.fetchers.get(I);H.has(I)&&!(z&&z.state==="loading"&&$.has(I))&&Vn(I),ie.delete(I),$.delete(I),K.delete(I),f.v7_fetcherPersist&&te.delete(I),Te.delete(I),T.fetchers.delete(I)}function Bo(I){let z=(re.get(I)||0)-1;z<=0?(re.delete(I),te.add(I),f.v7_fetcherPersist||sn(I)):re.set(I,z),De({fetchers:new Map(T.fetchers)})}function Vn(I){let z=H.get(I);z&&(z.abort(),H.delete(I))}function Ai(I){for(let z of I){let U=Di(z),Q=Hi(U.data);T.fetchers.set(z,Q)}}function ni(){let I=[],z=!1;for(let U of K){let Q=T.fetchers.get(U);$e(Q,"Expected fetcher: "+U),Q.state==="loading"&&(K.delete(U),I.push(U),z=!0)}return Ai(I),z}function js(I){let z=[];for(let[U,Q]of $)if(Q<I){let W=T.fetchers.get(U);$e(W,"Expected fetcher: "+U),W.state==="loading"&&(Vn(U),$.delete(U),z.push(U))}return Ai(z),z.length>0}function ri(I,z){let U=T.blockers.get(I)||xl;return Se.get(I)!==z&&Se.set(I,z),U}function zs(I){T.blockers.delete(I),Se.delete(I)}function Ii(I,z){let U=T.blockers.get(I)||xl;$e(U.state==="unblocked"&&z.state==="blocked"||U.state==="blocked"&&z.state==="blocked"||U.state==="blocked"&&z.state==="proceeding"||U.state==="blocked"&&z.state==="unblocked"||U.state==="proceeding"&&z.state==="unblocked","Invalid blocker state transition: "+U.state+" -> "+z.state);let Q=new Map(T.blockers);Q.set(I,z),De({blockers:Q})}function Bs(I){let{currentLocation:z,nextLocation:U,historyAction:Q}=I;if(Se.size===0)return;Se.size>1&&za(!1,"A router only supports one blocker at a time");let W=Array.from(Se.entries()),[he,ve]=W[W.length-1],ce=T.blockers.get(he);if(!(ce&&ce.state==="proceeding")&&ve({currentLocation:z,nextLocation:U,historyAction:Q}))return he}function ji(I){let z=Nn(404,{pathname:I}),U=l||o,{matches:Q,route:W}=zw(U);return at(),{notFoundMatches:Q,route:W,error:z}}function at(I){let z=[];return ee.forEach((U,Q)=>{(!I||I(Q))&&(U.cancel(),z.push(Q),ee.delete(Q))}),z}function Wt(I,z,U){if(_=I,x=z,v=U||null,!S&&T.navigation===Xf){S=!0;let Q=Kt(T.location,T.matches);Q!=null&&De({restoreScrollPosition:Q})}return()=>{_=null,x=null,v=null}}function It(I,z){return v&&v(I,z.map(Q=>yO(Q,T.loaderData)))||I.key}function tr(I,z){if(_&&x){let U=It(I,z);_[U]=x()}}function Kt(I,z){if(_){let U=It(I,z),Q=_[U];if(typeof Q=="number")return Q}return null}function yt(I,z,U){if(h)if(I){if(Object.keys(I[0].params).length>0)return{active:!0,matches:od(z,U,u,!0)}}else return{active:!0,matches:od(z,U,u,!0)||[]};return{active:!1,matches:null}}async function Zt(I,z,U,Q){if(!h)return{type:"success",matches:I};let W=I;for(;;){let he=l==null,ve=l||o,ce=s;try{await h({signal:U,path:z,matches:W,fetcherKey:Q,patch:(ge,ke)=>{U.aborted||Lw(ge,ke,ve,ce,i)}})}catch(ge){return{type:"error",error:ge,partialMatches:W}}finally{he&&!U.aborted&&(o=[...o])}if(U.aborted)return{type:"aborted"};let pe=eo(ve,z,u);if(pe)return{type:"success",matches:pe};let de=od(ve,z,u,!0);if(!de||W.length===de.length&&W.every((ge,ke)=>ge.route.id===de[ke].route.id))return{type:"success",matches:null};W=de}}function nr(I){s={},l=jd(I,i,void 0,s)}function ft(I,z){let U=l==null;Lw(I,z,l||o,s,i),U&&(o=[...o],De({}))}return P={get basename(){return u},get future(){return f},get state(){return T},get routes(){return o},get window(){return e},initialize:Ce,subscribe:et,enableScrollRestoration:Wt,navigate:rn,fetch:jr,revalidate:Tn,createHref:I=>t.history.createHref(I),encodeLocation:I=>t.history.encodeLocation(I),getFetcher:Di,deleteFetcher:Bo,dispose:Oe,getBlocker:ri,deleteBlocker:zs,patchRoutes:ft,_internalFetchControllers:H,_internalActiveDeferreds:ee,_internalSetRoutes:nr},P}function VO(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function Mm(t,e,n,r,i,s,o,l){let u,d;if(o){u=[];for(let f of e)if(u.push(f),f.route.id===o){d=f;break}}else u=e,d=e[e.length-1];let h=Ty(i||".",Ey(u,s),Qa(t.pathname,n)||t.pathname,l==="path");if(i==null&&(h.search=t.search,h.hash=t.hash),(i==null||i===""||i===".")&&d){let f=Oy(h.search);if(d.route.index&&!f)h.search=h.search?h.search.replace(/^\?/,"?index&"):"?index";else if(!d.route.index&&f){let m=new URLSearchParams(h.search),g=m.getAll("index");m.delete("index"),g.filter(v=>v).forEach(v=>m.append("index",v));let _=m.toString();h.search=_?"?"+_:""}}return r&&n!=="/"&&(h.pathname=h.pathname==="/"?n:bi([n,h.pathname])),Eo(h)}function Pw(t,e,n,r){if(!r||!VO(r))return{path:n};if(r.formMethod&&!tN(r.formMethod))return{path:n,error:Nn(405,{method:r.formMethod})};let i=()=>({path:n,error:Nn(400,{type:"invalid-body"})}),s=r.formMethod||"get",o=t?s.toUpperCase():s.toLowerCase(),l=mk(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!Pr(o))return i();let m=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((g,_)=>{let[v,x]=_;return""+g+v+"="+x+`
`},""):String(r.body);return{path:n,submission:{formMethod:o,formAction:l,formEncType:r.formEncType,formData:void 0,json:void 0,text:m}}}else if(r.formEncType==="application/json"){if(!Pr(o))return i();try{let m=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:o,formAction:l,formEncType:r.formEncType,formData:void 0,json:m,text:void 0}}}catch{return i()}}}$e(typeof FormData=="function","FormData is not available in this environment");let u,d;if(r.formData)u=Nm(r.formData),d=r.formData;else if(r.body instanceof FormData)u=Nm(r.body),d=r.body;else if(r.body instanceof URLSearchParams)u=r.body,d=Dw(u);else if(r.body==null)u=new URLSearchParams,d=new FormData;else try{u=new URLSearchParams(r.body),d=Dw(u)}catch{return i()}let h={formMethod:o,formAction:l,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:d,json:void 0,text:void 0};if(Pr(h.formMethod))return{path:n,submission:h};let f=Os(n);return e&&f.search&&Oy(f.search)&&u.append("index",""),f.search="?"+u,{path:Eo(f),submission:h}}function Mw(t,e,n){n===void 0&&(n=!1);let r=t.findIndex(i=>i.route.id===e);return r>=0?t.slice(0,n?r+1:r):t}function Ow(t,e,n,r,i,s,o,l,u,d,h,f,m,g,_,v){let x=v?qn(v[1])?v[1].error:v[1].data:void 0,S=t.createURL(e.location),k=t.createURL(i),C=n;s&&e.errors?C=Mw(n,Object.keys(e.errors)[0],!0):v&&qn(v[1])&&(C=Mw(n,v[0]));let R=v?v[1].statusCode:void 0,N=o&&R&&R>=400,P=C.filter((D,j)=>{let{route:O}=D;if(O.lazy)return!0;if(O.loader==null)return!1;if(s)return Om(O,e.loaderData,e.errors);if(HO(e.loaderData,e.matches[j],D)||u.some(se=>se===D.route.id))return!0;let F=e.matches[j],Z=D;return Nw(D,st({currentUrl:S,currentParams:F.params,nextUrl:k,nextParams:Z.params},r,{actionResult:x,actionStatus:R,defaultShouldRevalidate:N?!1:l||S.pathname+S.search===k.pathname+k.search||S.search!==k.search||fk(F,Z)}))}),T=[];return f.forEach((D,j)=>{if(s||!n.some(oe=>oe.route.id===D.routeId)||h.has(j))return;let O=eo(g,D.path,_);if(!O){T.push({key:j,routeId:D.routeId,path:D.path,matches:null,match:null,controller:null});return}let F=e.fetchers.get(j),Z=Nl(O,D.path),se=!1;m.has(j)?se=!1:d.has(j)?(d.delete(j),se=!0):F&&F.state!=="idle"&&F.data===void 0?se=l:se=Nw(Z,st({currentUrl:S,currentParams:e.matches[e.matches.length-1].params,nextUrl:k,nextParams:n[n.length-1].params},r,{actionResult:x,actionStatus:R,defaultShouldRevalidate:N?!1:l})),se&&T.push({key:j,routeId:D.routeId,path:D.path,matches:O,match:Z,controller:new AbortController})}),[P,T]}function Om(t,e,n){if(t.lazy)return!0;if(!t.loader)return!1;let r=e!=null&&e[t.id]!==void 0,i=n!=null&&n[t.id]!==void 0;return!r&&i?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!r&&!i}function HO(t,e,n){let r=!e||n.route.id!==e.route.id,i=t[n.route.id]===void 0;return r||i}function fk(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function Nw(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}function Lw(t,e,n,r,i){var s;let o;if(t){let d=r[t];$e(d,"No route found to patch children into: routeId = "+t),d.children||(d.children=[]),o=d.children}else o=n;let l=e.filter(d=>!o.some(h=>pk(d,h))),u=jd(l,i,[t||"_","patch",String(((s=o)==null?void 0:s.length)||"0")],r);o.push(...u)}function pk(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((n,r)=>{var i;return(i=e.children)==null?void 0:i.some(s=>pk(n,s))}):!1}async function qO(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let i=n[t.id];$e(i,"No route found in manifest");let s={};for(let o in r){let u=i[o]!==void 0&&o!=="hasErrorBoundary";za(!u,'Route "'+i.id+'" has a static property "'+o+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+o+'" will be ignored.')),!u&&!mO.has(o)&&(s[o]=r[o])}Object.assign(i,s),Object.assign(i,st({},e(i),{lazy:void 0}))}async function WO(t){let{matches:e}=t,n=e.filter(i=>i.shouldLoad);return(await Promise.all(n.map(i=>i.resolve()))).reduce((i,s,o)=>Object.assign(i,{[n[o].route.id]:s}),{})}async function KO(t,e,n,r,i,s,o,l,u,d){let h=s.map(g=>g.route.lazy?qO(g.route,u,l):void 0),f=s.map((g,_)=>{let v=h[_],x=i.some(k=>k.route.id===g.route.id);return st({},g,{shouldLoad:x,resolve:async k=>(k&&r.method==="GET"&&(g.route.lazy||g.route.loader)&&(x=!0),x?ZO(e,r,g,v,k,d):Promise.resolve({type:Ke.data,result:void 0}))})}),m=await t({matches:f,request:r,params:s[0].params,fetcherKey:o,context:d});try{await Promise.all(h)}catch{}return m}async function ZO(t,e,n,r,i,s){let o,l,u=d=>{let h,f=new Promise((_,v)=>h=v);l=()=>h(),e.signal.addEventListener("abort",l);let m=_=>typeof d!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+n.route.id+"]"))):d({request:e,params:n.params,context:s},..._!==void 0?[_]:[]),g=(async()=>{try{return{type:"data",result:await(i?i(v=>m(v)):m())}}catch(_){return{type:"error",result:_}}})();return Promise.race([g,f])};try{let d=n.route[t];if(r)if(d){let h,[f]=await Promise.all([u(d).catch(m=>{h=m}),r]);if(h!==void 0)throw h;o=f}else if(await r,d=n.route[t],d)o=await u(d);else if(t==="action"){let h=new URL(e.url),f=h.pathname+h.search;throw Nn(405,{method:e.method,pathname:f,routeId:n.route.id})}else return{type:Ke.data,result:void 0};else if(d)o=await u(d);else{let h=new URL(e.url),f=h.pathname+h.search;throw Nn(404,{pathname:f})}$e(o.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(d){return{type:Ke.error,result:d}}finally{l&&e.signal.removeEventListener("abort",l)}return o}async function QO(t){let{result:e,type:n}=t;if(gk(e)){let f;try{let m=e.headers.get("Content-Type");m&&/\bapplication\/json\b/.test(m)?e.body==null?f=null:f=await e.json():f=await e.text()}catch(m){return{type:Ke.error,error:m}}return n===Ke.error?{type:Ke.error,error:new zd(e.status,e.statusText,f),statusCode:e.status,headers:e.headers}:{type:Ke.data,data:f,statusCode:e.status,headers:e.headers}}if(n===Ke.error){if(Bw(e)){var r,i;if(e.data instanceof Error){var s,o;return{type:Ke.error,error:e.data,statusCode:(s=e.init)==null?void 0:s.status,headers:(o=e.init)!=null&&o.headers?new Headers(e.init.headers):void 0}}return{type:Ke.error,error:new zd(((r=e.init)==null?void 0:r.status)||500,void 0,e.data),statusCode:_u(e)?e.status:void 0,headers:(i=e.init)!=null&&i.headers?new Headers(e.init.headers):void 0}}return{type:Ke.error,error:e,statusCode:_u(e)?e.status:void 0}}if(eN(e)){var l,u;return{type:Ke.deferred,deferredData:e,statusCode:(l=e.init)==null?void 0:l.status,headers:((u=e.init)==null?void 0:u.headers)&&new Headers(e.init.headers)}}if(Bw(e)){var d,h;return{type:Ke.data,data:e.data,statusCode:(d=e.init)==null?void 0:d.status,headers:(h=e.init)!=null&&h.headers?new Headers(e.init.headers):void 0}}return{type:Ke.data,data:e}}function GO(t,e,n,r,i,s){let o=t.headers.get("Location");if($e(o,"Redirects returned/thrown from loaders/actions must have a Location header"),!Py.test(o)){let l=r.slice(0,r.findIndex(u=>u.route.id===n)+1);o=Mm(new URL(e.url),l,i,!0,o,s),t.headers.set("Location",o)}return t}function Rw(t,e,n){if(Py.test(t)){let r=t,i=r.startsWith("//")?new URL(e.protocol+r):new URL(r),s=Qa(i.pathname,n)!=null;if(i.origin===e.origin&&s)return i.pathname+i.search+i.hash}return t}function Qo(t,e,n,r){let i=t.createURL(mk(e)).toString(),s={signal:n};if(r&&Pr(r.formMethod)){let{formMethod:o,formEncType:l}=r;s.method=o.toUpperCase(),l==="application/json"?(s.headers=new Headers({"Content-Type":l}),s.body=JSON.stringify(r.json)):l==="text/plain"?s.body=r.text:l==="application/x-www-form-urlencoded"&&r.formData?s.body=Nm(r.formData):s.body=r.formData}return new Request(i,s)}function Nm(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function Dw(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function JO(t,e,n,r,i){let s={},o=null,l,u=!1,d={},h=n&&qn(n[1])?n[1].error:void 0;return t.forEach(f=>{if(!(f.route.id in e))return;let m=f.route.id,g=e[m];if($e(!lo(g),"Cannot handle redirect results in processLoaderData"),qn(g)){let _=g.error;h!==void 0&&(_=h,h=void 0),o=o||{};{let v=to(t,m);o[v.route.id]==null&&(o[v.route.id]=_)}s[m]=void 0,u||(u=!0,l=_u(g.error)?g.error.status:500),g.headers&&(d[m]=g.headers)}else is(g)?(r.set(m,g.deferredData),s[m]=g.deferredData.data,g.statusCode!=null&&g.statusCode!==200&&!u&&(l=g.statusCode),g.headers&&(d[m]=g.headers)):(s[m]=g.data,g.statusCode&&g.statusCode!==200&&!u&&(l=g.statusCode),g.headers&&(d[m]=g.headers))}),h!==void 0&&n&&(o={[n[0]]:h},s[n[0]]=void 0),{loaderData:s,errors:o,statusCode:l||200,loaderHeaders:d}}function Aw(t,e,n,r,i,s,o){let{loaderData:l,errors:u}=JO(e,n,r,o);return i.forEach(d=>{let{key:h,match:f,controller:m}=d,g=s[h];if($e(g,"Did not find corresponding fetcher result"),!(m&&m.signal.aborted))if(qn(g)){let _=to(t.matches,f?.route.id);u&&u[_.route.id]||(u=st({},u,{[_.route.id]:g.error})),t.fetchers.delete(h)}else if(lo(g))$e(!1,"Unhandled fetcher revalidation redirect");else if(is(g))$e(!1,"Unhandled fetcher deferred data");else{let _=Hi(g.data);t.fetchers.set(h,_)}}),{loaderData:l,errors:u}}function Iw(t,e,n,r){let i=st({},e);for(let s of n){let o=s.route.id;if(e.hasOwnProperty(o)?e[o]!==void 0&&(i[o]=e[o]):t[o]!==void 0&&s.route.loader&&(i[o]=t[o]),r&&r.hasOwnProperty(o))break}return i}function jw(t){return t?qn(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function to(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function zw(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function Nn(t,e){let{pathname:n,routeId:r,method:i,type:s,message:o}=e===void 0?{}:e,l="Unknown Server Error",u="Unknown @remix-run/router error";return t===400?(l="Bad Request",i&&n&&r?u="You made a "+i+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":s==="defer-action"?u="defer() is not supported in actions":s==="invalid-body"&&(u="Unable to encode submission body")):t===403?(l="Forbidden",u='Route "'+r+'" does not match URL "'+n+'"'):t===404?(l="Not Found",u='No route matches URL "'+n+'"'):t===405&&(l="Method Not Allowed",i&&n&&r?u="You made a "+i.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":i&&(u='Invalid request method "'+i.toUpperCase()+'"')),new zd(t||500,l,new Error(u),!0)}function Nc(t){let e=Object.entries(t);for(let n=e.length-1;n>=0;n--){let[r,i]=e[n];if(lo(i))return{key:r,result:i}}}function mk(t){let e=typeof t=="string"?Os(t):t;return Eo(st({},e,{hash:""}))}function YO(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function XO(t){return gk(t.result)&&zO.has(t.result.status)}function is(t){return t.type===Ke.deferred}function qn(t){return t.type===Ke.error}function lo(t){return(t&&t.type)===Ke.redirect}function Bw(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function eN(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function gk(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function tN(t){return jO.has(t.toLowerCase())}function Pr(t){return AO.has(t.toLowerCase())}async function nN(t,e,n,r,i){let s=Object.entries(e);for(let o=0;o<s.length;o++){let[l,u]=s[o],d=t.find(m=>m?.route.id===l);if(!d)continue;let h=r.find(m=>m.route.id===d.route.id),f=h!=null&&!fk(h,d)&&(i&&i[d.route.id])!==void 0;is(u)&&f&&await My(u,n,!1).then(m=>{m&&(e[l]=m)})}}async function rN(t,e,n){for(let r=0;r<n.length;r++){let{key:i,routeId:s,controller:o}=n[r],l=e[i];t.find(d=>d?.route.id===s)&&is(l)&&($e(o,"Expected an AbortController for revalidating fetcher deferred result"),await My(l,o.signal,!0).then(d=>{d&&(e[i]=d)}))}}async function My(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:Ke.data,data:t.deferredData.unwrappedData}}catch(i){return{type:Ke.error,error:i}}return{type:Ke.data,data:t.deferredData.data}}}function Oy(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function Nl(t,e){let n=typeof e=="string"?Os(e).search:e.search;if(t[t.length-1].route.index&&Oy(n||""))return t[t.length-1];let r=ck(t);return r[r.length-1]}function Fw(t){let{formMethod:e,formAction:n,formEncType:r,text:i,formData:s,json:o}=t;if(!(!e||!n||!r)){if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:i};if(s!=null)return{formMethod:e,formAction:n,formEncType:r,formData:s,json:void 0,text:void 0};if(o!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:o,text:void 0}}}function ep(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function iN(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function Sl(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function sN(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function Hi(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function oN(t,e){try{let n=t.sessionStorage.getItem(hk);if(n){let r=JSON.parse(n);for(let[i,s]of Object.entries(r||{}))s&&Array.isArray(s)&&e.set(i,new Set(s||[]))}}catch{}}function aN(t,e){if(e.size>0){let n={};for(let[r,i]of e)n[r]=[...i];try{t.sessionStorage.setItem(hk,JSON.stringify(n))}catch(r){za(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Bd(){return Bd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Bd.apply(this,arguments)}const Eh=M.createContext(null),yk=M.createContext(null),Ao=M.createContext(null),Ny=M.createContext(null),Oi=M.createContext({outlet:null,matches:[],isDataRoute:!1}),vk=M.createContext(null);function lN(t,e){let{relative:n}=e===void 0?{}:e;$u()||$e(!1);let{basename:r,navigator:i}=M.useContext(Ao),{hash:s,pathname:o,search:l}=wk(t,{relative:n}),u=o;return r!=="/"&&(u=o==="/"?r:bi([r,o])),i.createHref({pathname:u,search:l,hash:s})}function $u(){return M.useContext(Ny)!=null}function Ns(){return $u()||$e(!1),M.useContext(Ny).location}function _k(t){M.useContext(Ao).static||M.useLayoutEffect(t)}function Th(){let{isDataRoute:t}=M.useContext(Oi);return t?xN():uN()}function uN(){$u()||$e(!1);let t=M.useContext(Eh),{basename:e,future:n,navigator:r}=M.useContext(Ao),{matches:i}=M.useContext(Oi),{pathname:s}=Ns(),o=JSON.stringify(Ey(i,n.v7_relativeSplatPath)),l=M.useRef(!1);return _k(()=>{l.current=!0}),M.useCallback(function(d,h){if(h===void 0&&(h={}),!l.current)return;if(typeof d=="number"){r.go(d);return}let f=Ty(d,JSON.parse(o),s,h.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:bi([e,f.pathname])),(h.replace?r.replace:r.push)(f,h.state,h)},[e,r,o,s,t])}const cN=M.createContext(null);function dN(t){let e=M.useContext(Oi).outlet;return e&&M.createElement(cN.Provider,{value:t},e)}function Io(){let{matches:t}=M.useContext(Oi),e=t[t.length-1];return e?e.params:{}}function wk(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=M.useContext(Ao),{matches:i}=M.useContext(Oi),{pathname:s}=Ns(),o=JSON.stringify(Ey(i,r.v7_relativeSplatPath));return M.useMemo(()=>Ty(t,JSON.parse(o),s,n==="path"),[t,o,s,n])}function hN(t,e,n,r){$u()||$e(!1);let{navigator:i}=M.useContext(Ao),{matches:s}=M.useContext(Oi),o=s[s.length-1],l=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let d=Ns(),h;h=d;let f=h.pathname||"/",m=f;if(u!=="/"){let v=u.replace(/^\//,"").split("/");m="/"+f.replace(/^\//,"").split("/").slice(v.length).join("/")}let g=eo(t,{pathname:m});return yN(g&&g.map(v=>Object.assign({},v,{params:Object.assign({},l,v.params),pathname:bi([u,i.encodeLocation?i.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?u:bi([u,i.encodeLocation?i.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),s,n,r)}function fN(){let t=bN(),e=_u(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return M.createElement(M.Fragment,null,M.createElement("h2",null,"Unexpected Application Error!"),M.createElement("h3",{style:{fontStyle:"italic"}},e),n?M.createElement("pre",{style:i},n):null,null)}const pN=M.createElement(fN,null);class mN extends M.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?M.createElement(Oi.Provider,{value:this.props.routeContext},M.createElement(vk.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function gN(t){let{routeContext:e,match:n,children:r}=t,i=M.useContext(Eh);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),M.createElement(Oi.Provider,{value:e},r)}function yN(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if(!n)return null;if(n.errors)t=n.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,l=(i=n)==null?void 0:i.errors;if(l!=null){let h=o.findIndex(f=>f.route.id&&l?.[f.route.id]!==void 0);h>=0||$e(!1),o=o.slice(0,Math.min(o.length,h+1))}let u=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let h=0;h<o.length;h++){let f=o[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(d=h),f.route.id){let{loaderData:m,errors:g}=n,_=f.route.loader&&m[f.route.id]===void 0&&(!g||g[f.route.id]===void 0);if(f.route.lazy||_){u=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((h,f,m)=>{let g,_=!1,v=null,x=null;n&&(g=l&&f.route.id?l[f.route.id]:void 0,v=f.route.errorElement||pN,u&&(d<0&&m===0?(SN("route-fallback"),_=!0,x=null):d===m&&(_=!0,x=f.route.hydrateFallbackElement||null)));let S=e.concat(o.slice(0,m+1)),k=()=>{let C;return g?C=v:_?C=x:f.route.Component?C=M.createElement(f.route.Component,null):f.route.element?C=f.route.element:C=h,M.createElement(gN,{match:f,routeContext:{outlet:h,matches:S,isDataRoute:n!=null},children:C})};return n&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?M.createElement(mN,{location:n.location,revalidation:n.revalidation,component:v,error:g,children:k(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):k()},null)}var bk=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(bk||{}),xk=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(xk||{});function vN(t){let e=M.useContext(Eh);return e||$e(!1),e}function _N(t){let e=M.useContext(yk);return e||$e(!1),e}function wN(t){let e=M.useContext(Oi);return e||$e(!1),e}function Sk(t){let e=wN(),n=e.matches[e.matches.length-1];return n.route.id||$e(!1),n.route.id}function bN(){var t;let e=M.useContext(vk),n=_N(),r=Sk();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function xN(){let{router:t}=vN(bk.UseNavigateStable),e=Sk(xk.UseNavigateStable),n=M.useRef(!1);return _k(()=>{n.current=!0}),M.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Bd({fromRouteId:e},s)))},[t,e])}const $w={};function SN(t,e,n){$w[t]||($w[t]=!0)}function kN(t,e){t?.v7_startTransition,t?.v7_relativeSplatPath===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function CN(t){return dN(t.context)}function EN(t){let{basename:e="/",children:n=null,location:r,navigationType:i=wt.Pop,navigator:s,static:o=!1,future:l}=t;$u()&&$e(!1);let u=e.replace(/^\/*/,"/"),d=M.useMemo(()=>({basename:u,navigator:s,static:o,future:Bd({v7_relativeSplatPath:!1},l)}),[u,l,s,o]);typeof r=="string"&&(r=Os(r));let{pathname:h="/",search:f="",hash:m="",state:g=null,key:_="default"}=r,v=M.useMemo(()=>{let x=Qa(h,u);return x==null?null:{location:{pathname:x,search:f,hash:m,state:g,key:_},navigationType:i}},[u,h,f,m,g,_,i]);return v==null?null:M.createElement(Ao.Provider,{value:d},M.createElement(Ny.Provider,{children:n,value:v}))}new Promise(()=>{});function TN(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:M.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:M.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:M.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function wu(){return wu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},wu.apply(this,arguments)}function PN(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function MN(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function ON(t,e){return t.button===0&&(!e||e==="_self")&&!MN(t)}const NN=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],LN="6";try{window.__reactRouterVersion=LN}catch{}function RN(t,e){return UO({basename:e?.basename,future:wu({},e?.future,{v7_prependBasename:!0}),history:hO({window:e?.window}),hydrationData:e?.hydrationData||DN(),routes:t,mapRouteProperties:TN,dataStrategy:e?.dataStrategy,patchRoutesOnNavigation:e?.patchRoutesOnNavigation,window:e?.window}).initialize()}function DN(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=wu({},e,{errors:AN(e.errors)})),e}function AN(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,i]of e)if(i&&i.__type==="RouteErrorResponse")n[r]=new zd(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let s=window[i.__subType];if(typeof s=="function")try{let o=new s(i.message);o.stack="",n[r]=o}catch{}}if(n[r]==null){let s=new Error(i.message);s.stack="",n[r]=s}}else n[r]=i;return n}const IN=M.createContext({isTransitioning:!1}),jN=M.createContext(new Map),zN="startTransition",Uw=eP[zN],BN="flushSync",Vw=dO[BN];function FN(t){Uw?Uw(t):t()}function kl(t){Vw?Vw(t):t()}let $N=class{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}};function UN(t){let{fallbackElement:e,router:n,future:r}=t,[i,s]=M.useState(n.state),[o,l]=M.useState(),[u,d]=M.useState({isTransitioning:!1}),[h,f]=M.useState(),[m,g]=M.useState(),[_,v]=M.useState(),x=M.useRef(new Map),{v7_startTransition:S}=r||{},k=M.useCallback(D=>{S?FN(D):D()},[S]),C=M.useCallback((D,j)=>{let{deletedFetchers:O,flushSync:F,viewTransitionOpts:Z}=j;D.fetchers.forEach((oe,ye)=>{oe.data!==void 0&&x.current.set(ye,oe.data)}),O.forEach(oe=>x.current.delete(oe));let se=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!Z||se){F?kl(()=>s(D)):k(()=>s(D));return}if(F){kl(()=>{m&&(h&&h.resolve(),m.skipTransition()),d({isTransitioning:!0,flushSync:!0,currentLocation:Z.currentLocation,nextLocation:Z.nextLocation})});let oe=n.window.document.startViewTransition(()=>{kl(()=>s(D))});oe.finished.finally(()=>{kl(()=>{f(void 0),g(void 0),l(void 0),d({isTransitioning:!1})})}),kl(()=>g(oe));return}m?(h&&h.resolve(),m.skipTransition(),v({state:D,currentLocation:Z.currentLocation,nextLocation:Z.nextLocation})):(l(D),d({isTransitioning:!0,flushSync:!1,currentLocation:Z.currentLocation,nextLocation:Z.nextLocation}))},[n.window,m,h,x,k]);M.useLayoutEffect(()=>n.subscribe(C),[n,C]),M.useEffect(()=>{u.isTransitioning&&!u.flushSync&&f(new $N)},[u]),M.useEffect(()=>{if(h&&o&&n.window){let D=o,j=h.promise,O=n.window.document.startViewTransition(async()=>{k(()=>s(D)),await j});O.finished.finally(()=>{f(void 0),g(void 0),l(void 0),d({isTransitioning:!1})}),g(O)}},[k,o,h,n.window]),M.useEffect(()=>{h&&o&&i.location.key===o.location.key&&h.resolve()},[h,m,i.location,o]),M.useEffect(()=>{!u.isTransitioning&&_&&(l(_.state),d({isTransitioning:!0,flushSync:!1,currentLocation:_.currentLocation,nextLocation:_.nextLocation}),v(void 0))},[u.isTransitioning,_]),M.useEffect(()=>{},[]);let R=M.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:D=>n.navigate(D),push:(D,j,O)=>n.navigate(D,{state:j,preventScrollReset:O?.preventScrollReset}),replace:(D,j,O)=>n.navigate(D,{replace:!0,state:j,preventScrollReset:O?.preventScrollReset})}),[n]),N=n.basename||"/",P=M.useMemo(()=>({router:n,navigator:R,static:!1,basename:N}),[n,R,N]),T=M.useMemo(()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath}),[n.future.v7_relativeSplatPath]);return M.useEffect(()=>kN(r,n.future),[r,n.future]),M.createElement(M.Fragment,null,M.createElement(Eh.Provider,{value:P},M.createElement(yk.Provider,{value:i},M.createElement(jN.Provider,{value:x.current},M.createElement(IN.Provider,{value:u},M.createElement(EN,{basename:N,location:i.location,navigationType:i.historyAction,navigator:R,future:T},i.initialized||n.future.v7_partialHydration?M.createElement(VN,{routes:n.routes,future:n.future,state:i}):e))))),null)}const VN=M.memo(HN);function HN(t){let{routes:e,future:n,state:r}=t;return hN(e,void 0,r,n)}const qN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",WN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ph=M.forwardRef(function(e,n){let{onClick:r,relative:i,reloadDocument:s,replace:o,state:l,target:u,to:d,preventScrollReset:h,viewTransition:f}=e,m=PN(e,NN),{basename:g}=M.useContext(Ao),_,v=!1;if(typeof d=="string"&&WN.test(d)&&(_=d,qN))try{let C=new URL(window.location.href),R=d.startsWith("//")?new URL(C.protocol+d):new URL(d),N=Qa(R.pathname,g);R.origin===C.origin&&N!=null?d=N+R.search+R.hash:v=!0}catch{}let x=lN(d,{relative:i}),S=KN(d,{replace:o,state:l,target:u,preventScrollReset:h,relative:i,viewTransition:f});function k(C){r&&r(C),C.defaultPrevented||S(C)}return M.createElement("a",wu({},m,{href:_||x,onClick:v||s?r:k,ref:n,target:u}))});var Hw;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Hw||(Hw={}));var qw;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(qw||(qw={}));function KN(t,e){let{target:n,replace:r,state:i,preventScrollReset:s,relative:o,viewTransition:l}=e===void 0?{}:e,u=Th(),d=Ns(),h=wk(t,{relative:o});return M.useCallback(f=>{if(ON(f,n)){f.preventDefault();let m=r!==void 0?r:Eo(d)===Eo(h);u(t,{replace:m,state:i,preventScrollReset:s,relative:o,viewTransition:l})}},[d,u,h,r,i,n,t,s,o,l])}var Ga=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},ZN={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},QN=class{#e=ZN;#t=!1;setTimeoutProvider(t){this.#e=t}setTimeout(t,e){return this.#e.setTimeout(t,e)}clearTimeout(t){this.#e.clearTimeout(t)}setInterval(t,e){return this.#e.setInterval(t,e)}clearInterval(t){this.#e.clearInterval(t)}},uo=new QN;function GN(t){setTimeout(t,0)}var To=typeof window>"u"||"Deno"in globalThis;function gn(){}function JN(t,e){return typeof t=="function"?t(e):t}function Lm(t){return typeof t=="number"&&t>=0&&t!==1/0}function kk(t,e){return Math.max(t+(e||0)-Date.now(),0)}function ys(t,e){return typeof t=="function"?t(e):t}function ar(t,e){return typeof t=="function"?t(e):t}function Ww(t,e){const{type:n="all",exact:r,fetchStatus:i,predicate:s,queryKey:o,stale:l}=t;if(o){if(r){if(e.queryHash!==Ly(o,e.options))return!1}else if(!bu(e.queryKey,o))return!1}if(n!=="all"){const u=e.isActive();if(n==="active"&&!u||n==="inactive"&&u)return!1}return!(typeof l=="boolean"&&e.isStale()!==l||i&&i!==e.state.fetchStatus||s&&!s(e))}function Kw(t,e){const{exact:n,status:r,predicate:i,mutationKey:s}=t;if(s){if(!e.options.mutationKey)return!1;if(n){if(Po(e.options.mutationKey)!==Po(s))return!1}else if(!bu(e.options.mutationKey,s))return!1}return!(r&&e.state.status!==r||i&&!i(e))}function Ly(t,e){return(e?.queryKeyHashFn||Po)(t)}function Po(t){return JSON.stringify(t,(e,n)=>Rm(n)?Object.keys(n).sort().reduce((r,i)=>(r[i]=n[i],r),{}):n)}function bu(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>bu(t[n],e[n])):!1}var YN=Object.prototype.hasOwnProperty;function Ck(t,e){if(t===e)return t;const n=Zw(t)&&Zw(e);if(!n&&!(Rm(t)&&Rm(e)))return e;const i=(n?t:Object.keys(t)).length,s=n?e:Object.keys(e),o=s.length,l=n?new Array(o):{};let u=0;for(let d=0;d<o;d++){const h=n?d:s[d],f=t[h],m=e[h];if(f===m){l[h]=f,(n?d<i:YN.call(t,h))&&u++;continue}if(f===null||m===null||typeof f!="object"||typeof m!="object"){l[h]=m;continue}const g=Ck(f,m);l[h]=g,g===f&&u++}return i===o&&u===i?t:l}function Fd(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function Zw(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Rm(t){if(!Qw(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!Qw(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function Qw(t){return Object.prototype.toString.call(t)==="[object Object]"}function XN(t){return new Promise(e=>{uo.setTimeout(e,t)})}function Dm(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?Ck(t,e):e}function eL(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function tL(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var Ry=Symbol();function Ek(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===Ry?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function Tk(t,e){return typeof t=="function"?t(...e):!!t}var nL=class extends Ga{#e;#t;#n;constructor(){super(),this.#n=t=>{if(!To&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},Dy=new nL;function Am(){let t,e;const n=new Promise((i,s)=>{t=i,e=s});n.status="pending",n.catch(()=>{});function r(i){Object.assign(n,i),delete n.resolve,delete n.reject}return n.resolve=i=>{r({status:"fulfilled",value:i}),t(i)},n.reject=i=>{r({status:"rejected",reason:i}),e(i)},n}var rL=GN;function iL(){let t=[],e=0,n=l=>{l()},r=l=>{l()},i=rL;const s=l=>{e?t.push(l):i(()=>{n(l)})},o=()=>{const l=t;t=[],l.length&&i(()=>{r(()=>{l.forEach(u=>{n(u)})})})};return{batch:l=>{let u;e++;try{u=l()}finally{e--,e||o()}return u},batchCalls:l=>(...u)=>{s(()=>{l(...u)})},schedule:s,setNotifyFunction:l=>{n=l},setBatchNotifyFunction:l=>{r=l},setScheduler:l=>{i=l}}}var Rt=iL(),sL=class extends Ga{#e=!0;#t;#n;constructor(){super(),this.#n=t=>{if(!To&&window.addEventListener){const e=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(n=>{n(t)}))}isOnline(){return this.#e}},$d=new sL;function oL(t){return Math.min(1e3*2**t,3e4)}function Pk(t){return(t??"online")==="online"?$d.isOnline():!0}var Im=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function Mk(t){let e=!1,n=0,r;const i=Am(),s=()=>i.status!=="pending",o=v=>{if(!s()){const x=new Im(v);m(x),t.onCancel?.(x)}},l=()=>{e=!0},u=()=>{e=!1},d=()=>Dy.isFocused()&&(t.networkMode==="always"||$d.isOnline())&&t.canRun(),h=()=>Pk(t.networkMode)&&t.canRun(),f=v=>{s()||(r?.(),i.resolve(v))},m=v=>{s()||(r?.(),i.reject(v))},g=()=>new Promise(v=>{r=x=>{(s()||d())&&v(x)},t.onPause?.()}).then(()=>{r=void 0,s()||t.onContinue?.()}),_=()=>{if(s())return;let v;const x=n===0?t.initialPromise:void 0;try{v=x??t.fn()}catch(S){v=Promise.reject(S)}Promise.resolve(v).then(f).catch(S=>{if(s())return;const k=t.retry??(To?0:3),C=t.retryDelay??oL,R=typeof C=="function"?C(n,S):C,N=k===!0||typeof k=="number"&&n<k||typeof k=="function"&&k(n,S);if(e||!N){m(S);return}n++,t.onFail?.(n,S),XN(R).then(()=>d()?void 0:g()).then(()=>{e?m(S):_()})})};return{promise:i,status:()=>i.status,cancel:o,continue:()=>(r?.(),i),cancelRetry:l,continueRetry:u,canStart:h,start:()=>(h()?_():g().then(_),i)}}var Ok=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Lm(this.gcTime)&&(this.#e=uo.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(To?1/0:5*60*1e3))}clearGcTimeout(){this.#e&&(uo.clearTimeout(this.#e),this.#e=void 0)}},aL=class extends Ok{#e;#t;#n;#i;#r;#o;#a;constructor(t){super(),this.#a=!1,this.#o=t.defaultOptions,this.setOptions(t.options),this.observers=[],this.#i=t.client,this.#n=this.#i.getQueryCache(),this.queryKey=t.queryKey,this.queryHash=t.queryHash,this.#e=Gw(this.options),this.state=t.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(t){if(this.options={...this.#o,...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const e=Gw(this.options);e.data!==void 0&&(this.setData(e.data,{updatedAt:e.dataUpdatedAt,manual:!0}),this.#e=e)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(t,e){const n=Dm(this.state.data,t,this.options);return this.#s({data:n,type:"success",dataUpdatedAt:e?.updatedAt,manual:e?.manual}),n}setState(t,e){this.#s({type:"setState",state:t,setStateOptions:e})}cancel(t){const e=this.#r?.promise;return this.#r?.cancel(t),e?e.then(gn).catch(gn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(t=>ar(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Ry||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>ys(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!kk(this.state.dataUpdatedAt,t)}onFocus(){this.observers.find(e=>e.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(e=>e.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(e=>e!==t),this.observers.length||(this.#r&&(this.#a?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#s({type:"invalidate"})}async fetch(t,e){if(this.state.fetchStatus!=="idle"&&this.#r?.status()!=="rejected"){if(this.state.data!==void 0&&e?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(t&&this.setOptions(t),!this.options.queryFn){const l=this.observers.find(u=>u.options.queryFn);l&&this.setOptions(l.options)}const n=new AbortController,r=l=>{Object.defineProperty(l,"signal",{enumerable:!0,get:()=>(this.#a=!0,n.signal)})},i=()=>{const l=Ek(this.options,e),d=(()=>{const h={client:this.#i,queryKey:this.queryKey,meta:this.meta};return r(h),h})();return this.#a=!1,this.options.persister?this.options.persister(l,d,this):l(d)},o=(()=>{const l={fetchOptions:e,options:this.options,queryKey:this.queryKey,client:this.#i,state:this.state,fetchFn:i};return r(l),l})();this.options.behavior?.onFetch(o,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==o.fetchOptions?.meta)&&this.#s({type:"fetch",meta:o.fetchOptions?.meta}),this.#r=Mk({initialPromise:e?.initialPromise,fn:o.fetchFn,onCancel:l=>{l instanceof Im&&l.revert&&this.setState({...this.#t,fetchStatus:"idle"}),n.abort()},onFail:(l,u)=>{this.#s({type:"failed",failureCount:l,error:u})},onPause:()=>{this.#s({type:"pause"})},onContinue:()=>{this.#s({type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0});try{const l=await this.#r.start();if(l===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(l),this.#n.config.onSuccess?.(l,this),this.#n.config.onSettled?.(l,this.state.error,this),l}catch(l){if(l instanceof Im){if(l.silent)return this.#r.promise;if(l.revert){if(this.state.data===void 0)throw l;return this.state.data}}throw this.#s({type:"error",error:l}),this.#n.config.onError?.(l,this),this.#n.config.onSettled?.(this.state.data,l,this),l}finally{this.scheduleGc()}}#s(t){const e=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...Nk(n.data,this.options),fetchMeta:t.meta??null};case"success":const r={...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=t.manual?r:void 0,r;case"error":const i=t.error;return{...n,error:i,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=e(this.state),Rt.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:t})})}};function Nk(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Pk(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function Gw(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var lL=class extends Ga{constructor(t,e){super(),this.options=e,this.#e=t,this.#s=null,this.#a=Am(),this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#n=void 0;#i=void 0;#r;#o;#a;#s;#m;#h;#f;#u;#c;#l;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),Jw(this.#t,this.options)?this.#d():this.updateResult(),this.#_())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return jm(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return jm(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#w(),this.#b(),this.#t.removeObserver(this)}setOptions(t){const e=this.options,n=this.#t;if(this.options=this.#e.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof ar(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#x(),this.#t.setOptions(this.options),e._defaulted&&!Fd(this.options,e)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const r=this.hasListeners();r&&Yw(this.#t,n,this.options,e)&&this.#d(),this.updateResult(),r&&(this.#t!==n||ar(this.options.enabled,this.#t)!==ar(e.enabled,this.#t)||ys(this.options.staleTime,this.#t)!==ys(e.staleTime,this.#t))&&this.#g();const i=this.#y();r&&(this.#t!==n||ar(this.options.enabled,this.#t)!==ar(e.enabled,this.#t)||i!==this.#l)&&this.#v(i)}getOptimisticResult(t){const e=this.#e.getQueryCache().build(this.#e,t),n=this.createResult(e,t);return cL(this,n)&&(this.#i=n,this.#o=this.options,this.#r=this.#t.state),n}getCurrentResult(){return this.#i}trackResult(t,e){return new Proxy(t,{get:(n,r)=>(this.trackProp(r),e?.(r),r==="promise"&&!this.options.experimental_prefetchInRender&&this.#a.status==="pending"&&this.#a.reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(n,r))})}trackProp(t){this.#p.add(t)}getCurrentQuery(){return this.#t}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=this.#e.defaultQueryOptions(t),n=this.#e.getQueryCache().build(this.#e,e);return n.fetch().then(()=>this.createResult(n,e))}fetch(t){return this.#d({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#i))}#d(t){this.#x();let e=this.#t.fetch(this.options,t);return t?.throwOnError||(e=e.catch(gn)),e}#g(){this.#w();const t=ys(this.options.staleTime,this.#t);if(To||this.#i.isStale||!Lm(t))return;const n=kk(this.#i.dataUpdatedAt,t)+1;this.#u=uo.setTimeout(()=>{this.#i.isStale||this.updateResult()},n)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#v(t){this.#b(),this.#l=t,!(To||ar(this.options.enabled,this.#t)===!1||!Lm(this.#l)||this.#l===0)&&(this.#c=uo.setInterval(()=>{(this.options.refetchIntervalInBackground||Dy.isFocused())&&this.#d()},this.#l))}#_(){this.#g(),this.#v(this.#y())}#w(){this.#u&&(uo.clearTimeout(this.#u),this.#u=void 0)}#b(){this.#c&&(uo.clearInterval(this.#c),this.#c=void 0)}createResult(t,e){const n=this.#t,r=this.options,i=this.#i,s=this.#r,o=this.#o,u=t!==n?t.state:this.#n,{state:d}=t;let h={...d},f=!1,m;if(e._optimisticResults){const D=this.hasListeners(),j=!D&&Jw(t,e),O=D&&Yw(t,n,e,r);(j||O)&&(h={...h,...Nk(d.data,t.options)}),e._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:g,errorUpdatedAt:_,status:v}=h;m=h.data;let x=!1;if(e.placeholderData!==void 0&&m===void 0&&v==="pending"){let D;i?.isPlaceholderData&&e.placeholderData===o?.placeholderData?(D=i.data,x=!0):D=typeof e.placeholderData=="function"?e.placeholderData(this.#f?.state.data,this.#f):e.placeholderData,D!==void 0&&(v="success",m=Dm(i?.data,D,e),f=!0)}if(e.select&&m!==void 0&&!x)if(i&&m===s?.data&&e.select===this.#m)m=this.#h;else try{this.#m=e.select,m=e.select(m),m=Dm(i?.data,m,e),this.#h=m,this.#s=null}catch(D){this.#s=D}this.#s&&(g=this.#s,m=this.#h,_=Date.now(),v="error");const S=h.fetchStatus==="fetching",k=v==="pending",C=v==="error",R=k&&S,N=m!==void 0,T={status:v,fetchStatus:h.fetchStatus,isPending:k,isSuccess:v==="success",isError:C,isInitialLoading:R,isLoading:R,data:m,dataUpdatedAt:h.dataUpdatedAt,error:g,errorUpdatedAt:_,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>u.dataUpdateCount||h.errorUpdateCount>u.errorUpdateCount,isFetching:S,isRefetching:S&&!k,isLoadingError:C&&!N,isPaused:h.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:C&&N,isStale:Ay(t,e),refetch:this.refetch,promise:this.#a,isEnabled:ar(e.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const D=F=>{T.status==="error"?F.reject(T.error):T.data!==void 0&&F.resolve(T.data)},j=()=>{const F=this.#a=T.promise=Am();D(F)},O=this.#a;switch(O.status){case"pending":t.queryHash===n.queryHash&&D(O);break;case"fulfilled":(T.status==="error"||T.data!==O.value)&&j();break;case"rejected":(T.status!=="error"||T.error!==O.reason)&&j();break}}return T}updateResult(){const t=this.#i,e=this.createResult(this.#t,this.options);if(this.#r=this.#t.state,this.#o=this.options,this.#r.data!==void 0&&(this.#f=this.#t),Fd(e,t))return;this.#i=e;const n=()=>{if(!t)return!0;const{notifyOnChangeProps:r}=this.options,i=typeof r=="function"?r():r;if(i==="all"||!i&&!this.#p.size)return!0;const s=new Set(i??this.#p);return this.options.throwOnError&&s.add("error"),Object.keys(this.#i).some(o=>{const l=o;return this.#i[l]!==t[l]&&s.has(l)})};this.#S({listeners:n()})}#x(){const t=this.#e.getQueryCache().build(this.#e,this.options);if(t===this.#t)return;const e=this.#t;this.#t=t,this.#n=t.state,this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#_()}#S(t){Rt.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(this.#i)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function uL(t,e){return ar(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function Jw(t,e){return uL(t,e)||t.state.data!==void 0&&jm(t,e,e.refetchOnMount)}function jm(t,e,n){if(ar(e.enabled,t)!==!1&&ys(e.staleTime,t)!=="static"){const r=typeof n=="function"?n(t):n;return r==="always"||r!==!1&&Ay(t,e)}return!1}function Yw(t,e,n,r){return(t!==e||ar(r.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&Ay(t,n)}function Ay(t,e){return ar(e.enabled,t)!==!1&&t.isStaleByTime(ys(e.staleTime,t))}function cL(t,e){return!Fd(t.getCurrentResult(),e)}function Xw(t){return{onFetch:(e,n)=>{const r=e.options,i=e.fetchOptions?.meta?.fetchMore?.direction,s=e.state.data?.pages||[],o=e.state.data?.pageParams||[];let l={pages:[],pageParams:[]},u=0;const d=async()=>{let h=!1;const f=_=>{Object.defineProperty(_,"signal",{enumerable:!0,get:()=>(e.signal.aborted?h=!0:e.signal.addEventListener("abort",()=>{h=!0}),e.signal)})},m=Ek(e.options,e.fetchOptions),g=async(_,v,x)=>{if(h)return Promise.reject();if(v==null&&_.pages.length)return Promise.resolve(_);const k=(()=>{const P={client:e.client,queryKey:e.queryKey,pageParam:v,direction:x?"backward":"forward",meta:e.options.meta};return f(P),P})(),C=await m(k),{maxPages:R}=e.options,N=x?tL:eL;return{pages:N(_.pages,C,R),pageParams:N(_.pageParams,v,R)}};if(i&&s.length){const _=i==="backward",v=_?dL:e0,x={pages:s,pageParams:o},S=v(r,x);l=await g(x,S,_)}else{const _=t??s.length;do{const v=u===0?o[0]??r.initialPageParam:e0(r,l);if(u>0&&v==null)break;l=await g(l,v),u++}while(u<_)}return l};e.options.persister?e.fetchFn=()=>e.options.persister?.(d,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n):e.fetchFn=d}}}function e0(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function dL(t,{pages:e,pageParams:n}){return e.length>0?t.getPreviousPageParam?.(e[0],e,n[0],n):void 0}var hL=class extends Ok{#e;#t;#n;#i;constructor(t){super(),this.#e=t.client,this.mutationId=t.mutationId,this.#n=t.mutationCache,this.#t=[],this.state=t.state||Lk(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){this.#t.includes(t)||(this.#t.push(t),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){this.#t=this.#t.filter(e=>e!==t),this.scheduleGc(),this.#n.notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#n.remove(this))}continue(){return this.#i?.continue()??this.execute(this.state.variables)}async execute(t){const e=()=>{this.#r({type:"continue"})},n={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#i=Mk({fn:()=>this.options.mutationFn?this.options.mutationFn(t,n):Promise.reject(new Error("No mutationFn found")),onFail:(s,o)=>{this.#r({type:"failed",failureCount:s,error:o})},onPause:()=>{this.#r({type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#n.canRun(this)});const r=this.state.status==="pending",i=!this.#i.canStart();try{if(r)e();else{this.#r({type:"pending",variables:t,isPaused:i}),await this.#n.config.onMutate?.(t,this,n);const o=await this.options.onMutate?.(t,n);o!==this.state.context&&this.#r({type:"pending",context:o,variables:t,isPaused:i})}const s=await this.#i.start();return await this.#n.config.onSuccess?.(s,t,this.state.context,this,n),await this.options.onSuccess?.(s,t,this.state.context,n),await this.#n.config.onSettled?.(s,null,this.state.variables,this.state.context,this,n),await this.options.onSettled?.(s,null,t,this.state.context,n),this.#r({type:"success",data:s}),s}catch(s){try{throw await this.#n.config.onError?.(s,t,this.state.context,this,n),await this.options.onError?.(s,t,this.state.context,n),await this.#n.config.onSettled?.(void 0,s,this.state.variables,this.state.context,this,n),await this.options.onSettled?.(void 0,s,t,this.state.context,n),s}finally{this.#r({type:"error",error:s})}}finally{this.#n.runNext(this)}}#r(t){const e=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=e(this.state),Rt.batch(()=>{this.#t.forEach(n=>{n.onMutationUpdate(t)}),this.#n.notify({mutation:this,type:"updated",action:t})})}};function Lk(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var fL=class extends Ga{constructor(t={}){super(),this.config=t,this.#e=new Set,this.#t=new Map,this.#n=0}#e;#t;#n;build(t,e,n){const r=new hL({client:t,mutationCache:this,mutationId:++this.#n,options:t.defaultMutationOptions(e),state:n});return this.add(r),r}add(t){this.#e.add(t);const e=Lc(t);if(typeof e=="string"){const n=this.#t.get(e);n?n.push(t):this.#t.set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(this.#e.delete(t)){const e=Lc(t);if(typeof e=="string"){const n=this.#t.get(e);if(n)if(n.length>1){const r=n.indexOf(t);r!==-1&&n.splice(r,1)}else n[0]===t&&this.#t.delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=Lc(t);if(typeof e=="string"){const r=this.#t.get(e)?.find(i=>i.state.status==="pending");return!r||r===t}else return!0}runNext(t){const e=Lc(t);return typeof e=="string"?this.#t.get(e)?.find(r=>r!==t&&r.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){Rt.batch(()=>{this.#e.forEach(t=>{this.notify({type:"removed",mutation:t})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(t){const e={exact:!0,...t};return this.getAll().find(n=>Kw(e,n))}findAll(t={}){return this.getAll().filter(e=>Kw(t,e))}notify(t){Rt.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return Rt.batch(()=>Promise.all(t.map(e=>e.continue().catch(gn))))}};function Lc(t){return t.options.scope?.id}var pL=class extends Ga{#e;#t=void 0;#n;#i;constructor(e,n){super(),this.#e=e,this.setOptions(n),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const n=this.options;this.options=this.#e.defaultMutationOptions(e),Fd(this.options,n)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),n?.mutationKey&&this.options.mutationKey&&Po(n.mutationKey)!==Po(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#r(),this.#o(e)}getCurrentResult(){return this.#t}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#r(),this.#o()}mutate(e,n){return this.#i=n,this.#n?.removeObserver(this),this.#n=this.#e.getMutationCache().build(this.#e,this.options),this.#n.addObserver(this),this.#n.execute(e)}#r(){const e=this.#n?.state??Lk();this.#t={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#o(e){Rt.batch(()=>{if(this.#i&&this.hasListeners()){const n=this.#t.variables,r=this.#t.context,i={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#i.onSuccess?.(e.data,n,r,i),this.#i.onSettled?.(e.data,null,n,r,i)):e?.type==="error"&&(this.#i.onError?.(e.error,n,r,i),this.#i.onSettled?.(void 0,e.error,n,r,i))}this.listeners.forEach(n=>{n(this.#t)})})}},mL=class extends Ga{constructor(t={}){super(),this.config=t,this.#e=new Map}#e;build(t,e,n){const r=e.queryKey,i=e.queryHash??Ly(r,e);let s=this.get(i);return s||(s=new aL({client:t,queryKey:r,queryHash:i,options:t.defaultQueryOptions(e),state:n,defaultOptions:t.getQueryDefaults(r)}),this.add(s)),s}add(t){this.#e.has(t.queryHash)||(this.#e.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=this.#e.get(t.queryHash);e&&(t.destroy(),e===t&&this.#e.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Rt.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#e.get(t)}getAll(){return[...this.#e.values()]}find(t){const e={exact:!0,...t};return this.getAll().find(n=>Ww(e,n))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(n=>Ww(t,n)):e}notify(t){Rt.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){Rt.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Rt.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},gL=class{#e;#t;#n;#i;#r;#o;#a;#s;constructor(t={}){this.#e=t.queryCache||new mL,this.#t=t.mutationCache||new fL,this.#n=t.defaultOptions||{},this.#i=new Map,this.#r=new Map,this.#o=0}mount(){this.#o++,this.#o===1&&(this.#a=Dy.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#s=$d.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#o--,this.#o===0&&(this.#a?.(),this.#a=void 0,this.#s?.(),this.#s=void 0)}isFetching(t){return this.#e.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#t.findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=this.#e.build(this,e),r=n.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(ys(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return this.#e.findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),s=this.#e.get(r.queryHash)?.state.data,o=JN(e,s);if(o!==void 0)return this.#e.build(this,r).setData(o,{...n,manual:!0})}setQueriesData(t,e,n){return Rt.batch(()=>this.#e.findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state}removeQueries(t){const e=this.#e;Rt.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=this.#e;return Rt.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},r=Rt.batch(()=>this.#e.findAll(t).map(i=>i.cancel(n)));return Promise.all(r).then(gn).catch(gn)}invalidateQueries(t,e={}){return Rt.batch(()=>(this.#e.findAll(t).forEach(n=>{n.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},r=Rt.batch(()=>this.#e.findAll(t).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let s=i.fetch(void 0,n);return n.throwOnError||(s=s.catch(gn)),i.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(r).then(gn)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=this.#e.build(this,e);return n.isStaleByTime(ys(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(gn).catch(gn)}fetchInfiniteQuery(t){return t.behavior=Xw(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(gn).catch(gn)}ensureInfiniteQueryData(t){return t.behavior=Xw(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return $d.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(t){this.#n=t}setQueryDefaults(t,e){this.#i.set(Po(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...this.#i.values()],n={};return e.forEach(r=>{bu(t,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(t,e){this.#r.set(Po(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...this.#r.values()],n={};return e.forEach(r=>{bu(t,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...this.#n.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Ly(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Ry&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...this.#n.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},Rk=M.createContext(void 0),nn=t=>{const e=M.useContext(Rk);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},yL=({client:t,children:e})=>(M.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),w.jsx(Rk.Provider,{value:t,children:e})),Dk=M.createContext(!1),vL=()=>M.useContext(Dk);Dk.Provider;function _L(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var wL=M.createContext(_L()),bL=()=>M.useContext(wL),xL=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},SL=t=>{M.useEffect(()=>{t.clearReset()},[t])},kL=({result:t,errorResetBoundary:e,throwOnError:n,query:r,suspense:i})=>t.isError&&!e.isReset()&&!t.isFetching&&r&&(i&&t.data===void 0||Tk(n,[t.error,r])),CL=t=>{if(t.suspense){const n=i=>i==="static"?i:Math.max(i??1e3,1e3),r=t.staleTime;t.staleTime=typeof r=="function"?(...i)=>n(r(...i)):n(r),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},EL=(t,e)=>t.isLoading&&t.isFetching&&!e,TL=(t,e)=>t?.suspense&&e.isPending,t0=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function PL(t,e,n){const r=vL(),i=bL(),s=nn(),o=s.defaultQueryOptions(t);s.getDefaultOptions().queries?._experimental_beforeQuery?.(o),o._optimisticResults=r?"isRestoring":"optimistic",CL(o),xL(o,i),SL(i);const l=!s.getQueryCache().get(o.queryHash),[u]=M.useState(()=>new e(s,o)),d=u.getOptimisticResult(o),h=!r&&t.subscribed!==!1;if(M.useSyncExternalStore(M.useCallback(f=>{const m=h?u.subscribe(Rt.batchCalls(f)):gn;return u.updateResult(),m},[u,h]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),M.useEffect(()=>{u.setOptions(o)},[o,u]),TL(o,d))throw t0(o,u,i);if(kL({result:d,errorResetBoundary:i,throwOnError:o.throwOnError,query:s.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw d.error;return s.getDefaultOptions().queries?._experimental_afterQuery?.(o,d),o.experimental_prefetchInRender&&!To&&EL(d,r)&&(l?t0(o,u,i):s.getQueryCache().get(o.queryHash)?.promise)?.catch(gn).finally(()=>{u.updateResult()}),o.notifyOnChangeProps?d:u.trackResult(d)}function St(t,e){return PL(t,lL)}function Pi(t,e){const n=nn(),[r]=M.useState(()=>new pL(n,t));M.useEffect(()=>{r.setOptions(t)},[r,t]);const i=M.useSyncExternalStore(M.useCallback(o=>r.subscribe(Rt.batchCalls(o)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),s=M.useCallback((o,l)=>{r.mutate(o,l).catch(gn)},[r]);if(i.error&&Tk(r.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:s,mutateAsync:i.mutate}}function Ot({name:t,size:e=18,className:n,strokeWidth:r=1.75}){const i={width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:r,strokeLinecap:"round",strokeLinejoin:"round",className:n,"aria-hidden":!0};switch(t){case"board":return w.jsxs("svg",{...i,children:[w.jsx("rect",{x:"3",y:"4",width:"6",height:"16",rx:"1"}),w.jsx("rect",{x:"11",y:"4",width:"10",height:"16",rx:"1"})]});case"table":return w.jsxs("svg",{...i,children:[w.jsx("rect",{x:"3",y:"4",width:"18",height:"16",rx:"1"}),w.jsx("path",{d:"M3 10h18M9 4v16M15 4v16"})]});case"calendar":return w.jsxs("svg",{...i,children:[w.jsx("rect",{x:"3",y:"5",width:"18",height:"16",rx:"2"}),w.jsx("path",{d:"M16 3v4M8 3v4M3 11h18"})]});case"calendar-stack":return w.jsxs("svg",{...i,children:[w.jsx("rect",{x:"4",y:"6",width:"16",height:"14",rx:"2",fill:"none"}),w.jsx("path",{d:"M14 4v4M10 4v4M4 12h16"}),w.jsx("rect",{x:"2",y:"4",width:"16",height:"14",rx:"2",fill:"none",stroke:"currentColor",strokeWidth:"1.2"}),w.jsx("path",{d:"M12 2v4M8 2v4M2 10h16",strokeWidth:"1.2"})]});case"dashboard":return w.jsx("svg",{...i,children:w.jsx("path",{d:"M4 14h4v6H4zM10 10h4v10h-4zM16 6h4v14h-4z"})});case"map":return w.jsxs("svg",{...i,children:[w.jsx("path",{d:"M12 21s7-5.373 7-11a7 7 0 10-14 0c0 5.627 7 11 7 11z"}),w.jsx("circle",{cx:"12",cy:"10",r:"2.5"})]});case"map-pin":return w.jsxs("svg",{...i,children:[w.jsx("path",{d:"M12 21s7-5.373 7-11a7 7 0 10-14 0c0 5.627 7 11 7 11z"}),w.jsx("circle",{cx:"12",cy:"10",r:"1.5"})]});case"edit":return w.jsxs("svg",{...i,children:[w.jsx("path",{d:"M12 20h9"}),w.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 113 3L7 19l-4 1 1-4 12.5-12.5z"})]});case"archive":return w.jsxs("svg",{...i,children:[w.jsx("rect",{x:"3",y:"4",width:"18",height:"4",rx:"1"}),w.jsx("path",{d:"M7 8h10v9a2 2 0 01-2 2H9a2 2 0 01-2-2V8z"}),w.jsx("path",{d:"M10 12h4"})]});case"trash":return w.jsxs("svg",{...i,children:[w.jsx("path",{d:"M3 6h18"}),w.jsx("path",{d:"M8 6l1-2h6l1 2"}),w.jsx("rect",{x:"6",y:"6",width:"12",height:"14",rx:"2"}),w.jsx("path",{d:"M10 11v6M14 11v6"})]});case"comment":return w.jsx("svg",{...i,children:w.jsx("path",{d:"M21 15a4 4 0 01-4 4H8l-5 3V7a4 4 0 014-4h10a4 4 0 014 4z"})});case"paperclip":return w.jsx("svg",{...i,children:w.jsx("path",{d:"M21.44 11.05l-8.49 8.49a6 6 0 01-8.49-8.49l9.19-9.19a4 4 0 115.66 5.66L9.05 18.78a2 2 0 01-2.83-2.83l8.49-8.49"})});case"phone":return w.jsx("svg",{...i,children:w.jsx("path",{d:"M22 16.92v3a2 2 0 01-2.18 2 19.8 19.8 0 01-8.63-3.07 19.5 19.5 0 01-6-6A19.8 19.8 0 012.08 4.18 2 2 0 014.06 2h3a2 2 0 012 1.72c.12.9.33 1.77.63 2.6a2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.48-1.15a2 2 0 012.11-.45c.83.3 1.7.51 2.6.63A2 2 0 0122 16.92z"})});case"mail":return w.jsxs("svg",{...i,children:[w.jsx("path",{d:"M4 4h16a2 2 0 012 2v12a2 2 0 01-2 2H4a2 2 0 01-2-2V6a2 2 0 012-2z"}),w.jsx("path",{d:"M22 6l-10 7L2 6"})]});case"arrow-right":return w.jsx("svg",{...i,children:w.jsx("path",{d:"M5 12h14M13 5l7 7-7 7"})});case"x":return w.jsx("svg",{...i,children:w.jsx("path",{d:"M18 6L6 18M6 6l12 12"})});case"plus":return w.jsx("svg",{...i,children:w.jsx("path",{d:"M12 5v14M5 12h14"})});case"more":return w.jsxs("svg",{...i,children:[w.jsx("circle",{cx:"12",cy:"12",r:"1"}),w.jsx("circle",{cx:"12",cy:"5",r:"1"}),w.jsx("circle",{cx:"12",cy:"19",r:"1"})]});case"menu":return w.jsx("svg",{...i,children:w.jsx("path",{d:"M3 6h18M3 12h18M3 18h18"})});default:return null}}const ML="modulepreload",OL=function(t){return"/Project-managment-app/"+t},n0={},yn=function(e,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");i=Promise.allSettled(n.map(u=>{if(u=OL(u),u in n0)return;n0[u]=!0;const d=u.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${h}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":ML,d||(f.as="script"),f.crossOrigin="",f.href=u,l&&f.setAttribute("nonce",l),document.head.appendChild(f),d)return new Promise((m,g)=>{f.addEventListener("load",m),f.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},NL=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>yn(async()=>{const{default:r}=await Promise.resolve().then(()=>Ja);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class Iy extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class LL extends Iy{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class r0 extends Iy{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class i0 extends Iy{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var zm;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(zm||(zm={}));var RL=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(h){try{d(r.next(h))}catch(f){o(f)}}function u(h){try{d(r.throw(h))}catch(f){o(f)}}function d(h){h.done?s(h.value):i(h.value).then(l,u)}d((r=r.apply(t,e||[])).next())})};class DL{constructor(e,{headers:n={},customFetch:r,region:i=zm.Any}={}){this.url=e,this.headers=n,this.region=i,this.fetch=NL(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return RL(this,void 0,void 0,function*(){try{const{headers:i,method:s,body:o}=n;let l={},{region:u}=n;u||(u=this.region);const d=new URL(`${this.url}/${e}`);u&&u!=="any"&&(l["x-region"]=u,d.searchParams.set("forceFunctionRegion",u));let h;o&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",h=o):typeof o=="string"?(l["Content-Type"]="text/plain",h=o):typeof FormData<"u"&&o instanceof FormData?h=o:(l["Content-Type"]="application/json",h=JSON.stringify(o)));const f=yield this.fetch(d.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),i),body:h}).catch(v=>{throw new LL(v)}),m=f.headers.get("x-relay-error");if(m&&m==="true")throw new r0(f);if(!f.ok)throw new i0(f);let g=((r=f.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),_;return g==="application/json"?_=yield f.json():g==="application/octet-stream"?_=yield f.blob():g==="text/event-stream"?_=f:g==="multipart/form-data"?_=yield f.formData():_=yield f.text(),{data:_,error:null,response:f}}catch(i){return{data:null,error:i,response:i instanceof i0||i instanceof r0?i.context:void 0}}})}}var Rn={},jy={},Mh={},Uu={},Oh={},Nh={},AL=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Ba=AL();const IL=Ba.fetch,Ak=Ba.fetch.bind(Ba),Ik=Ba.Headers,jL=Ba.Request,zL=Ba.Response,Ja=Object.freeze(Object.defineProperty({__proto__:null,Headers:Ik,Request:jL,Response:zL,default:Ak,fetch:IL},Symbol.toStringTag,{value:"Module"})),BL=zT(Ja);var Lh={};Object.defineProperty(Lh,"__esModule",{value:!0});let FL=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Lh.default=FL;var jk=Gn&&Gn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Nh,"__esModule",{value:!0});const $L=jk(BL),UL=jk(Lh);let VL=class{constructor(e){var n,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(n=e.shouldThrowOnError)!==null&&n!==void 0?n:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=$L.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=new Headers(this.headers),this.headers.set(e,n),this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let i=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var o,l,u,d;let h=null,f=null,m=null,g=s.status,_=s.statusText;if(s.ok){if(this.method!=="HEAD"){const k=await s.text();k===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((o=this.headers.get("Accept"))===null||o===void 0)&&o.includes("application/vnd.pgrst.plan+text"))?f=k:f=JSON.parse(k))}const x=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),S=(u=s.headers.get("content-range"))===null||u===void 0?void 0:u.split("/");x&&S&&S.length>1&&(m=parseInt(S[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(h={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,m=null,g=406,_="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const x=await s.text();try{h=JSON.parse(x),Array.isArray(h)&&s.status===404&&(f=[],h=null,g=200,_="OK")}catch{s.status===404&&x===""?(g=204,_="No Content"):h={message:x}}if(h&&this.isMaybeSingle&&(!((d=h?.details)===null||d===void 0)&&d.includes("0 rows"))&&(h=null,g=200,_="OK"),h&&this.shouldThrowOnError)throw new UL.default(h)}return{error:h,data:f,count:m,status:g,statusText:_}});return this.shouldThrowOnError||(i=i.catch(s=>{var o,l,u;return{error:{message:`${(o=s?.name)!==null&&o!==void 0?o:"FetchError"}: ${s?.message}`,details:`${(l=s?.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(u=s?.code)!==null&&u!==void 0?u:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,n)}returns(){return this}overrideTypes(){return this}};Nh.default=VL;var HL=Gn&&Gn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Oh,"__esModule",{value:!0});const qL=HL(Nh);let WL=class extends qL.default{select(e){let n=!1;const r=(e??"*").split("").map(i=>/\s/.test(i)&&!n?"":(i==='"'&&(n=!n),i)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:n=!0,nullsFirst:r,foreignTable:i,referencedTable:s=i}={}){const o=s?`${s}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:r=n}={}){const i=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,n,{foreignTable:r,referencedTable:i=r}={}){const s=typeof i>"u"?"offset":`${i}.offset`,o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(o,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:n=!1,settings:r=!1,buffers:i=!1,wal:s=!1,format:o="text"}={}){var l;const u=[e?"analyze":null,n?"verbose":null,r?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${d}"; options=${u};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};Oh.default=WL;var KL=Gn&&Gn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Uu,"__esModule",{value:!0});const ZL=KL(Oh);let QL=class extends ZL.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const r=Array.from(new Set(n)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:r,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${s}fts${o}.${n}`),this}match(e){return Object.entries(e).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(e,n,r){return this.url.searchParams.append(e,`not.${n}.${r}`),this}or(e,{foreignTable:n,referencedTable:r=n}={}){const i=r?`${r}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,n,r){return this.url.searchParams.append(e,`${n}.${r}`),this}};Uu.default=QL;var GL=Gn&&Gn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Mh,"__esModule",{value:!0});const Cl=GL(Uu);let JL=class{constructor(e,{headers:n={},schema:r,fetch:i}){this.url=e,this.headers=new Headers(n),this.schema=r,this.fetch=i}select(e,{head:n=!1,count:r}={}){const i=n?"HEAD":"GET";let s=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!s?"":(l==='"'&&(s=!s),l)).join("");return this.url.searchParams.set("select",o),r&&this.headers.append("Prefer",`count=${r}`),new Cl.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:n,defaultToNull:r=!0}={}){var i;const s="POST";if(n&&this.headers.append("Prefer",`count=${n}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((l,u)=>l.concat(Object.keys(u)),[]);if(o.length>0){const l=[...new Set(o)].map(u=>`"${u}"`);this.url.searchParams.set("columns",l.join(","))}}return new Cl.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}upsert(e,{onConflict:n,ignoreDuplicates:r=!1,count:i,defaultToNull:s=!0}={}){var o;const l="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),n!==void 0&&this.url.searchParams.set("on_conflict",n),i&&this.headers.append("Prefer",`count=${i}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const u=e.reduce((d,h)=>d.concat(Object.keys(h)),[]);if(u.length>0){const d=[...new Set(u)].map(h=>`"${h}"`);this.url.searchParams.set("columns",d.join(","))}}return new Cl.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(e,{count:n}={}){var r;const i="PATCH";return n&&this.headers.append("Prefer",`count=${n}`),new Cl.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var n;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new Cl.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}};Mh.default=JL;var zk=Gn&&Gn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(jy,"__esModule",{value:!0});const YL=zk(Mh),XL=zk(Uu);let eR=class Bk{constructor(e,{headers:n={},schema:r,fetch:i}={}){this.url=e,this.headers=new Headers(n),this.schemaName=r,this.fetch=i}from(e){const n=new URL(`${this.url}/${e}`);return new YL.default(n,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Bk(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:i=!1,count:s}={}){var o;let l;const u=new URL(`${this.url}/rpc/${e}`);let d;r||i?(l=r?"HEAD":"GET",Object.entries(n).filter(([f,m])=>m!==void 0).map(([f,m])=>[f,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([f,m])=>{u.searchParams.append(f,m)})):(l="POST",d=n);const h=new Headers(this.headers);return s&&h.set("Prefer",`count=${s}`),new XL.default({method:l,url:u,headers:h,schema:this.schemaName,body:d,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};jy.default=eR;var Ya=Gn&&Gn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Rn,"__esModule",{value:!0});Rn.PostgrestError=Rn.PostgrestBuilder=Rn.PostgrestTransformBuilder=Rn.PostgrestFilterBuilder=Rn.PostgrestQueryBuilder=Rn.PostgrestClient=void 0;const Fk=Ya(jy);Rn.PostgrestClient=Fk.default;const $k=Ya(Mh);Rn.PostgrestQueryBuilder=$k.default;const Uk=Ya(Uu);Rn.PostgrestFilterBuilder=Uk.default;const Vk=Ya(Oh);Rn.PostgrestTransformBuilder=Vk.default;const Hk=Ya(Nh);Rn.PostgrestBuilder=Hk.default;const qk=Ya(Lh);Rn.PostgrestError=qk.default;var tR=Rn.default={PostgrestClient:Fk.default,PostgrestQueryBuilder:$k.default,PostgrestFilterBuilder:Uk.default,PostgrestTransformBuilder:Vk.default,PostgrestBuilder:Hk.default,PostgrestError:qk.default};const{PostgrestClient:nR,PostgrestQueryBuilder:BU,PostgrestFilterBuilder:FU,PostgrestTransformBuilder:$U,PostgrestBuilder:UU,PostgrestError:VU}=tR;class rR{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const r=n.node,i=parseInt(r.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const r=this.getWebSocketConstructor();return new r(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const iR="2.15.5",sR=`realtime-js/${iR}`,oR="1.0.0",Bm=1e4,aR=1e3,lR=100;var ql;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(ql||(ql={}));var Tt;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Tt||(Tt={}));var Mr;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Mr||(Mr={}));var Fm;(function(t){t.websocket="websocket"})(Fm||(Fm={}));var no;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(no||(no={}));class uR{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const i=n.getUint8(1),s=n.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(e.slice(o,o+i));o=o+i;const u=r.decode(e.slice(o,o+s));o=o+s;const d=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:u,payload:d}}}class Wk{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ye;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Ye||(Ye={}));const s0=(t,e,n={})=>{var r;const i=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((s,o)=>(s[o]=cR(o,t,e,i),s),{})},cR=(t,e,n,r)=>{const i=e.find(l=>l.name===t),s=i?.type,o=n[t];return s&&!r.includes(s)?Kk(s,o):$m(o)},Kk=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return pR(e,n)}switch(t){case Ye.bool:return dR(e);case Ye.float4:case Ye.float8:case Ye.int2:case Ye.int4:case Ye.int8:case Ye.numeric:case Ye.oid:return hR(e);case Ye.json:case Ye.jsonb:return fR(e);case Ye.timestamp:return mR(e);case Ye.abstime:case Ye.date:case Ye.daterange:case Ye.int4range:case Ye.int8range:case Ye.money:case Ye.reltime:case Ye.text:case Ye.time:case Ye.timestamptz:case Ye.timetz:case Ye.tsrange:case Ye.tstzrange:return $m(e);default:return $m(e)}},$m=t=>t,dR=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},hR=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},fR=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},pR=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let s;const o=t.slice(1,n);try{s=JSON.parse("["+o+"]")}catch{s=o?o.split(","):[]}return s.map(l=>Kk(e,l))}return t},mR=t=>typeof t=="string"?t.replace(" ","T"):t,Zk=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class tp{constructor(e,n,r={},i=Bm){this.channel=e,this.event=n,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var o0;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(o0||(o0={}));class Wl{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=n?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},i=>{const{onJoin:s,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Wl.syncState(this.state,i,s,o),this.pendingDiffs.forEach(u=>{this.state=Wl.syncDiff(this.state,u,s,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},i=>{const{onJoin:s,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Wl.syncDiff(this.state,i,s,o),l())}),this.onJoin((i,s,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:o})}),this.onLeave((i,s,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,i){const s=this.cloneDeep(e),o=this.transformState(n),l={},u={};return this.map(s,(d,h)=>{o[d]||(u[d]=h)}),this.map(o,(d,h)=>{const f=s[d];if(f){const m=h.map(x=>x.presence_ref),g=f.map(x=>x.presence_ref),_=h.filter(x=>g.indexOf(x.presence_ref)<0),v=f.filter(x=>m.indexOf(x.presence_ref)<0);_.length>0&&(l[d]=_),v.length>0&&(u[d]=v)}else l[d]=h}),this.syncDiff(s,{joins:l,leaves:u},r,i)}static syncDiff(e,n,r,i){const{joins:s,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(s,(l,u)=>{var d;const h=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(u),h.length>0){const f=e[l].map(g=>g.presence_ref),m=h.filter(g=>f.indexOf(g.presence_ref)<0);e[l].unshift(...m)}r(l,h,u)}),this.map(o,(l,u)=>{let d=e[l];if(!d)return;const h=u.map(f=>f.presence_ref);d=d.filter(f=>h.indexOf(f.presence_ref)<0),e[l]=d,i(l,d,u),d.length===0&&delete e[l]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const i=e[r];return"metas"in i?n[r]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):n[r]=i,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var a0;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(a0||(a0={}));var Kl;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Kl||(Kl={}));var pi;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(pi||(pi={}));class zy{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=Tt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new tp(this,Mr.join,this.params,this.timeout),this.rejoinTimer=new Wk(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Tt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Tt.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Tt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Tt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Tt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Mr.reply,{},(i,s)=>{this._trigger(this._replyEventName(s),i)}),this.presence=new Wl(this),this.broadcastEndpointURL=Zk(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,i,s;if(this.socket.isConnected()||this.socket.connect(),this.state==Tt.closed){const{config:{broadcast:o,presence:l,private:u}}=this.params,d=(i=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(g=>g.filter))!==null&&i!==void 0?i:[],h=!!this.bindings[Kl.PRESENCE]&&this.bindings[Kl.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,f={},m={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:h}),postgres_changes:d,private:u};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(g=>e?.(pi.CHANNEL_ERROR,g)),this._onClose(()=>e?.(pi.CLOSED)),this.updateJoinPayload(Object.assign({config:m},f)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:g})=>{var _;if(this.socket.setAuth(),g===void 0){e?.(pi.SUBSCRIBED);return}else{const v=this.bindings.postgres_changes,x=(_=v?.length)!==null&&_!==void 0?_:0,S=[];for(let k=0;k<x;k++){const C=v[k],{filter:{event:R,schema:N,table:P,filter:T}}=C,D=g&&g[k];if(D&&D.event===R&&D.schema===N&&D.table===P&&D.filter===T)S.push(Object.assign(Object.assign({},C),{id:D.id}));else{this.unsubscribe(),this.state=Tt.errored,e?.(pi.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=S,e&&e(pi.SUBSCRIBED);return}}).receive("error",g=>{this.state=Tt.errored,e?.(pi.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{e?.(pi.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this.state===Tt.joined&&e===Kl.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,n,r)}async send(e,n={}){var r,i;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:o}=e,u={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((i=d.body)===null||i===void 0?void 0:i.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var o,l,u;const d=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((u=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||u===void 0)&&u.ack)&&s("ok"),d.receive("ok",()=>s("ok")),d.receive("error",()=>s("error")),d.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Tt.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Mr.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(i=>{r=new tp(this,Mr.leave,{},e),r.receive("ok",()=>{n(),i("ok")}).receive("timeout",()=>{n(),i("timed out")}).receive("error",()=>{i("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Tt.closed,this.bindings={}}async _fetchWithTimeout(e,n,r){const i=new AbortController,s=setTimeout(()=>i.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:i.signal}));return clearTimeout(s),o}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new tp(this,e,n,r);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>lR){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var i,s;const o=e.toLocaleLowerCase(),{close:l,error:u,leave:d,join:h}=Mr;if(r&&[l,u,d,h].indexOf(o)>=0&&r!==this._joinRef())return;let m=this._onMessage(o,n,r);if(n&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(g=>{var _,v,x;return((_=g.filter)===null||_===void 0?void 0:_.event)==="*"||((x=(v=g.filter)===null||v===void 0?void 0:v.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===o}).map(g=>g.callback(m,r)):(s=this.bindings[o])===null||s===void 0||s.filter(g=>{var _,v,x,S,k,C;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in g){const R=g.id,N=(_=g.filter)===null||_===void 0?void 0:_.event;return R&&((v=n.ids)===null||v===void 0?void 0:v.includes(R))&&(N==="*"||N?.toLocaleLowerCase()===((x=n.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const R=(k=(S=g?.filter)===null||S===void 0?void 0:S.event)===null||k===void 0?void 0:k.toLocaleLowerCase();return R==="*"||R===((C=n?.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===o}).map(g=>{if(typeof m=="object"&&"ids"in m){const _=m.data,{schema:v,table:x,commit_timestamp:S,type:k,errors:C}=_;m=Object.assign(Object.assign({},{schema:v,table:x,commit_timestamp:S,eventType:k,new:{},old:{},errors:C}),this._getPayloadRecords(_))}g.callback(m,r)})}_isClosed(){return this.state===Tt.closed}_isJoined(){return this.state===Tt.joined}_isJoining(){return this.state===Tt.joining}_isLeaving(){return this.state===Tt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const i=e.toLocaleLowerCase(),s={type:i,filter:n,callback:r};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&zy.isEqual(i.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Mr.close,{},e)}_onError(e){this._on(Mr.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Tt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=s0(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=s0(e.columns,e.old_record)),n}}const np=()=>{},Rc={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},gR=[1e3,2e3,5e3,1e4],yR=1e4,vR=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class _R{constructor(e,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Bm,this.transport=null,this.heartbeatIntervalMs=Rc.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=np,this.ref=0,this.reconnectTimer=null,this.logger=np,this.conn=null,this.sendBuffer=[],this.serializer=new uR,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>{let s;return i?s=i:typeof fetch>"u"?s=(...o)=>yn(async()=>{const{default:l}=await Promise.resolve().then(()=>Ja);return{default:l}},void 0).then(({default:l})=>l(...o)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):s=fetch,(...o)=>s(...o)},!(!((r=n?.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${Fm.websocket}`,this.httpEndpoint=Zk(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=rR.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:oR}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case ql.connecting:return no.Connecting;case ql.open:return no.Open;case ql.closing:return no.Closing;default:return no.Closed}}isConnected(){return this.connectionState()===no.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const r=`realtime:${e}`,i=this.getChannels().find(s=>s.topic===r);if(i)return i;{const s=new zy(`realtime:${e}`,n,this);return this.channels.push(s),s}}push(e){const{topic:n,event:r,payload:i,ref:s}=e,o=()=>{this.encode(e,l=>{var u;(u=this.conn)===null||u===void 0||u.send(l)})};this.log("push",`${n} ${r} (${s})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(aR,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},Rc.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:i,payload:s,ref:o}=n,l=o?`(${o})`:"",u=s.status||"";this.log("receive",`${u} ${r} ${i} ${l}`.trim(),s),this.channels.filter(d=>d._isMember(r)).forEach(d=>d._trigger(i,s,o)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Mr.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",i=new URLSearchParams(n);return`${e}${r}${i}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([vR],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n;e?n=e:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const i={access_token:n,version:sR};n&&r.updateJoinPayload(i),r.joinedOnce&&r._isJoined()&&r._push(Mr.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(n)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new Wk(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Rc.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,r,i,s,o,l,u,d,h;if(this.transport=(n=e?.transport)!==null&&n!==void 0?n:null,this.timeout=(r=e?.timeout)!==null&&r!==void 0?r:Bm,this.heartbeatIntervalMs=(i=e?.heartbeatIntervalMs)!==null&&i!==void 0?i:Rc.HEARTBEAT_INTERVAL,this.worker=(s=e?.worker)!==null&&s!==void 0?s:!1,this.accessToken=(o=e?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=e?.heartbeatCallback)!==null&&l!==void 0?l:np,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=e?.reconnectAfterMs)!==null&&u!==void 0?u:f=>gR[f-1]||yR,this.encode=(d=e?.encode)!==null&&d!==void 0?d:(f,m)=>m(JSON.stringify(f)),this.decode=(h=e?.decode)!==null&&h!==void 0?h:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class By extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Pt(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class wR extends By{constructor(e,n,r){super(e),this.name="StorageApiError",this.status=n,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Um extends By{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var bR=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(h){try{d(r.next(h))}catch(f){o(f)}}function u(h){try{d(r.throw(h))}catch(f){o(f)}}function d(h){h.done?s(h.value):i(h.value).then(l,u)}d((r=r.apply(t,e||[])).next())})};const Qk=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>yn(async()=>{const{default:r}=await Promise.resolve().then(()=>Ja);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},xR=()=>bR(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield yn(()=>Promise.resolve().then(()=>Ja),void 0)).Response:Response}),Vm=t=>{if(Array.isArray(t))return t.map(n=>Vm(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const i=n.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[i]=Vm(r)}),e},SR=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var jo=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(h){try{d(r.next(h))}catch(f){o(f)}}function u(h){try{d(r.throw(h))}catch(f){o(f)}}function d(h){h.done?s(h.value):i(h.value).then(l,u)}d((r=r.apply(t,e||[])).next())})};const rp=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),kR=(t,e,n)=>jo(void 0,void 0,void 0,function*(){const r=yield xR();t instanceof r&&!n?.noResolveJson?t.json().then(i=>{const s=t.status||500,o=i?.statusCode||s+"";e(new wR(rp(i),s,o))}).catch(i=>{e(new Um(rp(i),i))}):e(new Um(rp(t),t))}),CR=(t,e,n,r)=>{const i={method:t,headers:e?.headers||{}};return t==="GET"||!r?i:(SR(r)?(i.headers=Object.assign({"Content-Type":"application/json"},e?.headers),i.body=JSON.stringify(r)):i.body=r,e?.duplex&&(i.duplex=e.duplex),Object.assign(Object.assign({},i),n))};function Vu(t,e,n,r,i,s){return jo(this,void 0,void 0,function*(){return new Promise((o,l)=>{t(n,CR(e,r,i,s)).then(u=>{if(!u.ok)throw u;return r?.noResolveJson?u:u.json()}).then(u=>o(u)).catch(u=>kR(u,l,r))})})}function Ud(t,e,n,r){return jo(this,void 0,void 0,function*(){return Vu(t,"GET",e,n,r)})}function Vr(t,e,n,r,i){return jo(this,void 0,void 0,function*(){return Vu(t,"POST",e,r,i,n)})}function Hm(t,e,n,r,i){return jo(this,void 0,void 0,function*(){return Vu(t,"PUT",e,r,i,n)})}function ER(t,e,n,r){return jo(this,void 0,void 0,function*(){return Vu(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function Gk(t,e,n,r,i){return jo(this,void 0,void 0,function*(){return Vu(t,"DELETE",e,r,i,n)})}var pn=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(h){try{d(r.next(h))}catch(f){o(f)}}function u(h){try{d(r.throw(h))}catch(f){o(f)}}function d(h){h.done?s(h.value):i(h.value).then(l,u)}d((r=r.apply(t,e||[])).next())})};const TR={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},l0={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class PR{constructor(e,n={},r,i){this.shouldThrowOnError=!1,this.url=e,this.headers=n,this.bucketId=r,this.fetch=Qk(i)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,n,r,i){return pn(this,void 0,void 0,function*(){try{let s;const o=Object.assign(Object.assign({},l0),i);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const u=o.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),u&&s.append("metadata",this.encodeMetadata(u)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.append("cacheControl",o.cacheControl),u&&s.append("metadata",this.encodeMetadata(u))):(s=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,u&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(u)))),i?.headers&&(l=Object.assign(Object.assign({},l),i.headers));const d=this._removeEmptyFolders(n),h=this._getFinalPath(d),f=yield(e=="PUT"?Hm:Vr)(this.fetch,`${this.url}/object/${h}`,s,Object.assign({headers:l},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:f.Id,fullPath:f.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Pt(s))return{data:null,error:s};throw s}})}upload(e,n,r){return pn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,i){return pn(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),o=this._getFinalPath(s),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",n);try{let u;const d=Object.assign({upsert:l0.upsert},i),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&r instanceof Blob?(u=new FormData,u.append("cacheControl",d.cacheControl),u.append("",r)):typeof FormData<"u"&&r instanceof FormData?(u=r,u.append("cacheControl",d.cacheControl)):(u=r,h["cache-control"]=`max-age=${d.cacheControl}`,h["content-type"]=d.contentType);const f=yield Hm(this.fetch,l.toString(),u,{headers:h});return{data:{path:s,fullPath:f.Key},error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(Pt(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(e,n){return pn(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const i=Object.assign({},this.headers);n?.upsert&&(i["x-upsert"]="true");const s=yield Vr(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:i}),o=new URL(this.url+s.url),l=o.searchParams.get("token");if(!l)throw new By("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Pt(r))return{data:null,error:r};throw r}})}update(e,n,r){return pn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return pn(this,void 0,void 0,function*(){try{return{data:yield Vr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r?.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Pt(i))return{data:null,error:i};throw i}})}copy(e,n,r){return pn(this,void 0,void 0,function*(){try{return{data:{path:(yield Vr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Pt(i))return{data:null,error:i};throw i}})}createSignedUrl(e,n,r){return pn(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),s=yield Vr(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:n},r?.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Pt(i))return{data:null,error:i};throw i}})}createSignedUrls(e,n,r){return pn(this,void 0,void 0,function*(){try{const i=yield Vr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),s=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${s}`):null})),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Pt(i))return{data:null,error:i};throw i}})}download(e,n){return pn(this,void 0,void 0,function*(){const i=typeof n?.transform<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString(n?.transform||{}),o=s?`?${s}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield Ud(this.fetch,`${this.url}/${i}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Pt(l))return{data:null,error:l};throw l}})}info(e){return pn(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield Ud(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Vm(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Pt(r))return{data:null,error:r};throw r}})}exists(e){return pn(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield ER(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Pt(r)&&r instanceof Um){const i=r.originalError;if([400,404].includes(i?.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),i=[],s=n?.download?`download=${n.download===!0?"":n.download}`:"";s!==""&&i.push(s);const l=typeof n?.transform<"u"?"render/image":"object",u=this.transformOptsToQueryString(n?.transform||{});u!==""&&i.push(u);let d=i.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${d}`)}}}remove(e){return pn(this,void 0,void 0,function*(){try{return{data:yield Gk(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Pt(n))return{data:null,error:n};throw n}})}list(e,n,r){return pn(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},TR),n),{prefix:e||""});return{data:yield Vr(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Pt(i))return{data:null,error:i};throw i}})}listV2(e,n){return pn(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield Vr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},n),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Pt(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const MR="2.12.1",OR={"X-Client-Info":`storage-js/${MR}`};var Go=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(h){try{d(r.next(h))}catch(f){o(f)}}function u(h){try{d(r.throw(h))}catch(f){o(f)}}function d(h){h.done?s(h.value):i(h.value).then(l,u)}d((r=r.apply(t,e||[])).next())})};class NR{constructor(e,n={},r,i){this.shouldThrowOnError=!1;const s=new URL(e);i?.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href,this.headers=Object.assign(Object.assign({},OR),n),this.fetch=Qk(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Go(this,void 0,void 0,function*(){try{return{data:yield Ud(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Pt(e))return{data:null,error:e};throw e}})}getBucket(e){return Go(this,void 0,void 0,function*(){try{return{data:yield Ud(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Pt(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return Go(this,void 0,void 0,function*(){try{return{data:yield Vr(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Pt(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return Go(this,void 0,void 0,function*(){try{return{data:yield Hm(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Pt(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Go(this,void 0,void 0,function*(){try{return{data:yield Vr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Pt(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Go(this,void 0,void 0,function*(){try{return{data:yield Gk(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Pt(n))return{data:null,error:n};throw n}})}}class LR extends NR{constructor(e,n={},r,i){super(e,n,r,i)}from(e){return new PR(this.url,this.headers,e,this.fetch)}}const RR="2.57.4";let Ll="";typeof Deno<"u"?Ll="deno":typeof document<"u"?Ll="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ll="react-native":Ll="node";const DR={"X-Client-Info":`supabase-js-${Ll}/${RR}`},AR={headers:DR},IR={schema:"public"},jR={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},zR={};var BR=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(h){try{d(r.next(h))}catch(f){o(f)}}function u(h){try{d(r.throw(h))}catch(f){o(f)}}function d(h){h.done?s(h.value):i(h.value).then(l,u)}d((r=r.apply(t,e||[])).next())})};const FR=t=>{let e;return t?e=t:typeof fetch>"u"?e=Ak:e=fetch,(...n)=>e(...n)},$R=()=>typeof Headers>"u"?Ik:Headers,UR=(t,e,n)=>{const r=FR(n),i=$R();return(s,o)=>BR(void 0,void 0,void 0,function*(){var l;const u=(l=yield e())!==null&&l!==void 0?l:t;let d=new i(o?.headers);return d.has("apikey")||d.set("apikey",t),d.has("Authorization")||d.set("Authorization",`Bearer ${u}`),r(s,Object.assign(Object.assign({},o),{headers:d}))})};var VR=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(h){try{d(r.next(h))}catch(f){o(f)}}function u(h){try{d(r.throw(h))}catch(f){o(f)}}function d(h){h.done?s(h.value):i(h.value).then(l,u)}d((r=r.apply(t,e||[])).next())})};function HR(t){return t.endsWith("/")?t:t+"/"}function qR(t,e){var n,r;const{db:i,auth:s,realtime:o,global:l}=t,{db:u,auth:d,realtime:h,global:f}=e,m={db:Object.assign(Object.assign({},u),i),auth:Object.assign(Object.assign({},d),s),realtime:Object.assign(Object.assign({},h),o),storage:{},global:Object.assign(Object.assign(Object.assign({},f),l),{headers:Object.assign(Object.assign({},(n=f?.headers)!==null&&n!==void 0?n:{}),(r=l?.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>VR(this,void 0,void 0,function*(){return""})};return t.accessToken?m.accessToken=t.accessToken:delete m.accessToken,m}function WR(t){const e=t?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(HR(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Jk="2.71.1",ra=30*1e3,qm=3,ip=qm*ra,KR="http://localhost:9999",ZR="supabase.auth.token",QR={"X-Client-Info":`gotrue-js/${Jk}`},Wm="X-Supabase-Api-Version",Yk={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},GR=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,JR=10*60*1e3;class Fy extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function Me(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class YR extends Fy{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function XR(t){return Me(t)&&t.name==="AuthApiError"}class Xk extends Fy{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Ls extends Fy{constructor(e,n,r,i){super(e,r,i),this.name=n,this.status=r}}class qi extends Ls{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function eD(t){return Me(t)&&t.name==="AuthSessionMissingError"}class Dc extends Ls{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ac extends Ls{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ic extends Ls{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function tD(t){return Me(t)&&t.name==="AuthImplicitGrantRedirectError"}class u0 extends Ls{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Km extends Ls{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function sp(t){return Me(t)&&t.name==="AuthRetryableFetchError"}class c0 extends Ls{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class Zm extends Ls{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Vd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),d0=` 	
\r=`.split(""),nD=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<d0.length;e+=1)t[d0[e].charCodeAt(0)]=-2;for(let e=0;e<Vd.length;e+=1)t[Vd[e].charCodeAt(0)]=e;return t})();function h0(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(Vd[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(Vd[r]),e.queuedBits-=6}}function e1(t,e,n){const r=nD[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function f0(t){const e=[],n=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=o=>{sD(o,r,n)};for(let o=0;o<t.length;o+=1)e1(t.charCodeAt(o),i,s);return e.join("")}function rD(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function iD(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const i=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|i)+65536,n+=1}rD(r,e)}}function sD(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function oD(t){const e=[],n={queue:0,queuedBits:0},r=i=>{e.push(i)};for(let i=0;i<t.length;i+=1)e1(t.charCodeAt(i),n,r);return new Uint8Array(e)}function aD(t){const e=[];return iD(t,n=>e.push(n)),new Uint8Array(e)}function lD(t){const e=[],n={queue:0,queuedBits:0},r=i=>{e.push(i)};return t.forEach(i=>h0(i,n,r)),h0(null,n,r),e.join("")}function uD(t){return Math.round(Date.now()/1e3)+t}function cD(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Cr=()=>typeof window<"u"&&typeof document<"u",Zs={tested:!1,writable:!1},t1=()=>{if(!Cr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Zs.tested)return Zs.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Zs.tested=!0,Zs.writable=!0}catch{Zs.tested=!0,Zs.writable=!1}return Zs.writable};function dD(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((i,s)=>{e[s]=i})}catch{}return n.searchParams.forEach((r,i)=>{e[i]=r}),e}const n1=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>yn(async()=>{const{default:r}=await Promise.resolve().then(()=>Ja);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},hD=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",ia=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Qs=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Vi=async(t,e)=>{await t.removeItem(e)};class Rh{constructor(){this.promise=new Rh.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Rh.promiseConstructor=Promise;function op(t){const e=t.split(".");if(e.length!==3)throw new Zm("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!GR.test(e[r]))throw new Zm("JWT not in base64url format");return{header:JSON.parse(f0(e[0])),payload:JSON.parse(f0(e[1])),signature:oD(e[2]),raw:{header:e[0],payload:e[1]}}}async function fD(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function pD(t,e){return new Promise((r,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const o=await t(s);if(!e(s,null,o)){r(o);return}}catch(o){if(!e(s,o)){i(o);return}}})()})}function mD(t){return("0"+t.toString(16)).substr(-2)}function gD(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let i="";for(let s=0;s<56;s++)i+=n.charAt(Math.floor(Math.random()*r));return i}return crypto.getRandomValues(e),Array.from(e,mD).join("")}async function yD(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),i=new Uint8Array(r);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function vD(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await yD(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Jo(t,e,n=!1){const r=gD();let i=r;n&&(i+="/PASSWORD_RECOVERY"),await ia(t,`${e}-code-verifier`,i);const s=await vD(r);return[s,r===s?"plain":"s256"]}const _D=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function wD(t){const e=t.headers.get(Wm);if(!e||!e.match(_D))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function bD(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function xD(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const SD=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Yo(t){if(!SD.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function ap(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function p0(t){return JSON.parse(JSON.stringify(t))}var kD=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};const Ys=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),CD=[502,503,504];async function m0(t){var e;if(!hD(t))throw new Km(Ys(t),0);if(CD.includes(t.status))throw new Km(Ys(t),t.status);let n;try{n=await t.json()}catch(s){throw new Xk(Ys(s),s)}let r;const i=wD(t);if(i&&i.getTime()>=Yk["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new c0(Ys(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new qi}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new c0(Ys(n),t.status,n.weak_password.reasons);throw new YR(Ys(n),t.status||500,r)}const ED=(t,e,n,r)=>{const i={method:t,headers:e?.headers||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),i.body=JSON.stringify(r),Object.assign(Object.assign({},i),n))};async function Be(t,e,n,r){var i;const s=Object.assign({},r?.headers);s[Wm]||(s[Wm]=Yk["2024-01-01"].name),r?.jwt&&(s.Authorization=`Bearer ${r.jwt}`);const o=(i=r?.query)!==null&&i!==void 0?i:{};r?.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",u=await TD(t,e,n+l,{headers:s,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(u):{data:Object.assign({},u),error:null}}async function TD(t,e,n,r,i,s){const o=ED(e,r,i,s);let l;try{l=await t(n,Object.assign({},o))}catch(u){throw console.error(u),new Km(Ys(u),0)}if(l.ok||await m0(l),r?.noResolveJson)return l;try{return await l.json()}catch(u){await m0(u)}}function hi(t){var e;let n=null;ND(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=uD(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function g0(t){const e=hi(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function es(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function PD(t){return{data:t,error:null}}function MD(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:i,verification_type:s}=t,o=kD(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:n,hashed_token:r,redirect_to:i,verification_type:s},u=Object.assign({},o);return{data:{properties:l,user:u},error:null}}function OD(t){return t}function ND(t){return t.access_token&&t.refresh_token&&t.expires_in}const lp=["global","local","others"];var LD=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};class RD{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=n1(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=lp[0]){if(lp.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${lp.join(", ")}`);try{return await Be(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Me(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await Be(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:es})}catch(r){if(Me(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=LD(e,["options"]),i=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(i.new_email=r?.newEmail,delete i.newEmail),await Be(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:MD,redirectTo:n?.redirectTo})}catch(n){if(Me(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await Be(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:es})}catch(n){if(Me(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,i,s,o,l,u;try{const d={nextPage:null,lastPage:0,total:0},h=await Be(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e?.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(s=(i=e?.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:OD});if(h.error)throw h.error;const f=await h.json(),m=(o=h.headers.get("x-total-count"))!==null&&o!==void 0?o:0,g=(u=(l=h.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&u!==void 0?u:[];return g.length>0&&(g.forEach(_=>{const v=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(_.split(";")[1].split("=")[1]);d[`${x}Page`]=v}),d.total=parseInt(m)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(Me(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Yo(e);try{return await Be(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:es})}catch(n){if(Me(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){Yo(e);try{return await Be(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:es})}catch(r){if(Me(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){Yo(e);try{return await Be(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:es})}catch(r){if(Me(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Yo(e.userId);try{const{data:n,error:r}=await Be(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:n,error:r}}catch(n){if(Me(n))return{data:null,error:n};throw n}}async _deleteFactor(e){Yo(e.userId),Yo(e.id);try{return{data:await Be(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(Me(n))return{data:null,error:n};throw n}}}function y0(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function DD(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Xo={debug:!!(globalThis&&t1()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class r1 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class AD extends r1{}async function ID(t,e,n){Xo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Xo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async i=>{if(i){Xo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,i.name);try{return await n()}finally{Xo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,i.name)}}else{if(e===0)throw Xo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new AD(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Xo.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}DD();const jD={url:KR,storageKey:ZR,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:QR,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function v0(t,e,n){return await n()}const ea={};class xu{constructor(e){var n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=xu.nextInstanceID,xu.nextInstanceID+=1,this.instanceID>0&&Cr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},jD),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new RD({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=n1(i.fetch),this.lock=i.lock||v0,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:Cr()&&(!((n=globalThis?.navigator)===null||n===void 0)&&n.locks)?this.lock=ID:this.lock=v0,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:t1()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=y0(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=y0(this.memoryStorage)),Cr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var e,n;return(n=(e=ea[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){ea[this.storageKey]=Object.assign(Object.assign({},ea[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=ea[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){ea[this.storageKey]=Object.assign(Object.assign({},ea[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Jk}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=dD(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),Cr()&&this.detectSessionInUrl&&r!=="none"){const{data:i,error:s}=await this._getSessionFromURL(n,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),tD(s)){const u=(e=s.details)===null||e===void 0?void 0:e.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:o,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Me(n)?{error:n}:{error:new Xk("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,i;try{const s=await Be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e?.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(i=e?.options)===null||i===void 0?void 0:i.captchaToken}},xform:hi}),{data:o,error:l}=s;if(l||!o)return{data:{user:null,session:null},error:l};const u=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:d,session:u},error:null}}catch(s){if(Me(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var n,r,i;try{let s;if("email"in e){const{email:h,password:f,options:m}=e;let g=null,_=null;this.flowType==="pkce"&&([g,_]=await Jo(this.storage,this.storageKey)),s=await Be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m?.emailRedirectTo,body:{email:h,password:f,data:(n=m?.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:m?.captchaToken},code_challenge:g,code_challenge_method:_},xform:hi})}else if("phone"in e){const{phone:h,password:f,options:m}=e;s=await Be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:f,data:(r=m?.data)!==null&&r!==void 0?r:{},channel:(i=m?.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:m?.captchaToken}},xform:hi})}else throw new Ac("You must provide either an email or phone number and a password");const{data:o,error:l}=s;if(l||!o)return{data:{user:null,session:null},error:l};const u=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:d,session:u},error:null}}catch(s){if(Me(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let n;if("email"in e){const{email:s,password:o,options:l}=e;n=await Be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:g0})}else if("phone"in e){const{phone:s,password:o,options:l}=e;n=await Be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:g0})}else throw new Ac("You must provide either an email or phone number and a password");const{data:r,error:i}=n;return i?{data:{user:null,session:null},error:i}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Dc}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:i})}catch(n){if(Me(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,i,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;if(n==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(e){var n,r,i,s,o,l,u,d,h,f,m,g;let _,v;if("message"in e)_=e.message,v=e.signature;else{const{chain:x,wallet:S,statement:k,options:C}=e;let R;if(Cr())if(typeof S=="object")R=S;else{const P=window;if("solana"in P&&typeof P.solana=="object"&&("signIn"in P.solana&&typeof P.solana.signIn=="function"||"signMessage"in P.solana&&typeof P.solana.signMessage=="function"))R=P.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!C?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");R=S}const N=new URL((n=C?.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in R&&R.signIn){const P=await R.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},C?.signInWithSolana),{version:"1",domain:N.host,uri:N.href}),k?{statement:k}:null));let T;if(Array.isArray(P)&&P[0]&&typeof P[0]=="object")T=P[0];else if(P&&typeof P=="object"&&"signedMessage"in P&&"signature"in P)T=P;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)_=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),v=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in R)||typeof R.signMessage!="function"||!("publicKey"in R)||typeof R!="object"||!R.publicKey||!("toBase58"in R.publicKey)||typeof R.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");_=[`${N.host} wants you to sign in with your Solana account:`,R.publicKey.toBase58(),...k?["",k,""]:[""],"Version: 1",`URI: ${N.href}`,`Issued At: ${(i=(r=C?.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=C?.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${C.signInWithSolana.notBefore}`]:[],...!((o=C?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${C.signInWithSolana.expirationTime}`]:[],...!((l=C?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${C.signInWithSolana.chainId}`]:[],...!((u=C?.signInWithSolana)===null||u===void 0)&&u.nonce?[`Nonce: ${C.signInWithSolana.nonce}`]:[],...!((d=C?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${C.signInWithSolana.requestId}`]:[],...!((f=(h=C?.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||f===void 0)&&f.length?["Resources",...C.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const P=await R.signMessage(new TextEncoder().encode(_),"utf8");if(!P||!(P instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=P}}try{const{data:x,error:S}=await Be(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:_,signature:lD(v)},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(g=e.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:hi});if(S)throw S;return!x||!x.session||!x.user?{data:{user:null,session:null},error:new Dc}:(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),{data:Object.assign({},x),error:S})}catch(x){if(Me(x))return{data:{user:null,session:null},error:x};throw x}}async _exchangeCodeForSession(e){const n=await Qs(this.storage,`${this.storageKey}-code-verifier`),[r,i]=(n??"").split("/");try{const{data:s,error:o}=await Be(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:hi});if(await Vi(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Dc}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:o})}catch(s){if(Me(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:n,provider:r,token:i,access_token:s,nonce:o}=e,l=await Be(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,access_token:s,nonce:o,gotrue_meta_security:{captcha_token:n?.captchaToken}},xform:hi}),{data:u,error:d}=l;return d?{data:{user:null,session:null},error:d}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new Dc}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:d})}catch(n){if(Me(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,i,s,o;try{if("email"in e){const{email:l,options:u}=e;let d=null,h=null;this.flowType==="pkce"&&([d,h]=await Jo(this.storage,this.storageKey));const{error:f}=await Be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=u?.data)!==null&&n!==void 0?n:{},create_user:(r=u?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:u?.captchaToken},code_challenge:d,code_challenge_method:h},redirectTo:u?.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in e){const{phone:l,options:u}=e,{data:d,error:h}=await Be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=u?.data)!==null&&i!==void 0?i:{},create_user:(s=u?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:u?.captchaToken},channel:(o=u?.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:d?.message_id},error:h}}throw new Ac("You must provide either an email or phone number.")}catch(l){if(Me(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var n,r;try{let i,s;"options"in e&&(i=(n=e.options)===null||n===void 0?void 0:n.redirectTo,s=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await Be(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:hi});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const u=o.session,d=o.user;return u?.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),{data:{user:d,session:u},error:null}}catch(i){if(Me(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var n,r,i;try{let s=null,o=null;return this.flowType==="pkce"&&([s,o]=await Jo(this.storage,this.storageKey)),await Be(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((i=e?.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:o}),headers:this.headers,xform:PD})}catch(s){if(Me(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new qi;const{error:i}=await Be(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(Me(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:i,options:s}=e,{error:o}=await Be(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:i,gotrue_meta_security:{captcha_token:s?.captchaToken}},redirectTo:s?.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:i,options:s}=e,{data:o,error:l}=await Be(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:i,gotrue_meta_security:{captcha_token:s?.captchaToken}}});return{data:{user:null,session:null,messageId:o?.message_id},error:l}}throw new Ac("You must provide either an email or phone number and a type")}catch(n){if(Me(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Qs(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<ip:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const o=await Qs(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=ap()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(u,d,h)=>(!o&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(u,d,h))})}return{data:{session:e},error:null}}const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:es}):await this._useSession(async n=>{var r,i,s;const{data:o,error:l}=n;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new qi}:await Be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:es})})}catch(n){if(Me(n))return eD(n)&&(await this._removeSession(),await Vi(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:i,error:s}=r;if(s)throw s;if(!i.session)throw new qi;const o=i.session;let l=null,u=null;this.flowType==="pkce"&&e.email!=null&&([l,u]=await Jo(this.storage,this.storageKey));const{data:d,error:h}=await Be(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:u}),jwt:o.access_token,xform:es});if(h)throw h;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(Me(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new qi;const n=Date.now()/1e3;let r=n,i=!0,s=null;const{payload:o}=op(e.access_token);if(o.exp&&(r=o.exp,i=r<=n),i){const{session:l,error:u}=await this._callRefreshToken(e.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!l)return{data:{user:null,session:null},error:null};s=l}else{const{data:l,error:u}=await this._getUser(e.access_token);if(u)throw u;s={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(n){if(Me(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:o,error:l}=n;if(l)throw l;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!e?.refresh_token)throw new qi;const{session:i,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(Me(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!Cr())throw new Ic("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ic(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new u0("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ic("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new u0("No code detected.");const{data:k,error:C}=await this._exchangeCodeForSession(e.code);if(C)throw C;const R=new URL(window.location.href);return R.searchParams.delete("code"),window.history.replaceState(window.history.state,"",R.toString()),{data:{session:k.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:i,access_token:s,refresh_token:o,expires_in:l,expires_at:u,token_type:d}=e;if(!s||!l||!o||!d)throw new Ic("No session defined in URL");const h=Math.round(Date.now()/1e3),f=parseInt(l);let m=h+f;u&&(m=parseInt(u));const g=m-h;g*1e3<=ra&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${f}s`);const _=m-f;h-_>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_,m,h):h-_<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",_,m,h);const{data:v,error:x}=await this._getUser(s);if(x)throw x;const S={provider_token:r,provider_refresh_token:i,access_token:s,expires_in:f,expires_at:m,refresh_token:o,token_type:d,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:S,redirectType:e.type},error:null}}catch(r){if(Me(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Qs(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:i,error:s}=n;if(s)return{error:s};const o=(r=i.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(XR(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Vi(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=cD(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,i;try{const{data:{session:s},error:o}=n;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,n={}){let r=null,i=null;this.flowType==="pkce"&&([r,i]=await Jo(this.storage,this.storageKey,!0));try{return await Be(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(s){if(Me(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(Me(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:i}=await this._useSession(async s=>{var o,l,u,d,h;const{data:f,error:m}=s;if(m)throw m;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(u=e.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await Be(this.fetch,"GET",g,{headers:this.headers,jwt:(h=(d=f.session)===null||d===void 0?void 0:d.access_token)!==null&&h!==void 0?h:void 0})});if(i)throw i;return Cr()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r?.url),{data:{provider:e.provider,url:r?.url},error:null}}catch(r){if(Me(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,i;const{data:s,error:o}=n;if(o)throw o;return await Be(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0})})}catch(n){if(Me(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await pD(async i=>(i>0&&await fD(200*Math.pow(2,i-1)),this._debug(n,"refreshing attempt",i),await Be(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:hi})),(i,s)=>{const o=200*Math.pow(2,i);return s&&sp(s)&&Date.now()+o-r<ra})}catch(r){if(this._debug(n,"error",r),Me(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),Cr()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const i=await Qs(this.storage,this.storageKey);if(i&&this.userStorage){let o=await Qs(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},await ia(this.userStorage,this.storageKey+"-user",o)),i.user=(e=o?.user)!==null&&e!==void 0?e:ap()}else if(i&&!i.user&&!i.user){const o=await Qs(this.storage,this.storageKey+"-user");o&&o?.user?(i.user=o.user,await Vi(this.storage,this.storageKey+"-user"),await ia(this.storage,this.storageKey,i)):i.user=ap()}if(this._debug(r,"session from storage",i),!this._isValidSession(i)){this._debug(r,"session is not valid"),i!==null&&await this._removeSession();return}const s=((n=i.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<ip;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${ip}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(console.error(o),sp(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(i.access_token);!l&&o?.user?(i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(r,"error",i),console.error(i);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new qi;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Rh;const{data:s,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!s.session)throw new qi;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const l={session:s.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(s){if(this._debug(i,"error",s),Me(s)){const o={session:null,error:s};return sp(s)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,n,r=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const s=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,n)}catch(u){s.push(u)}});if(await Promise.all(o),s.length>0){for(let l=0;l<s.length;l+=1)console.error(s[l]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const n=Object.assign({},e),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await ia(this.userStorage,this.storageKey+"-user",{user:n.user});const i=Object.assign({},n);delete i.user;const s=p0(i);await ia(this.storage,this.storageKey,s)}else{const i=p0(n);await ia(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await Vi(this.storage,this.storageKey),await Vi(this.storage,this.storageKey+"-code-verifier"),await Vi(this.storage,this.storageKey+"-user"),this.userStorage&&await Vi(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Cr()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ra);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((r.expires_at*1e3-e)/ra);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${ra}ms, refresh threshold is ${qm} ticks`),i<=qm&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof r1)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Cr()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const i=[`provider=${encodeURIComponent(n)}`];if(r?.redirectTo&&i.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&i.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[s,o]=await Jo(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(l.toString())}if(r?.queryParams){const s=new URLSearchParams(r.queryParams);i.push(s.toString())}return r?.skipBrowserRedirect&&i.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:i,error:s}=n;return s?{data:null,error:s}:await Be(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=i?.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Me(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,i;const{data:s,error:o}=n;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:u,error:d}=await Be(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((i=u?.totp)===null||i===void 0)&&i.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),{data:u,error:null})})}catch(n){if(Me(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:s}=n;if(s)return{data:null,error:s};const{data:o,error:l}=await Be(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=i?.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(n){if(Me(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:i,error:s}=n;return s?{data:null,error:s}:await Be(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=i?.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Me(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=e?.factors||[],i=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),s=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:i,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:i},error:s}=e;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=op(i.access_token);let l=null;o.aal&&(l=o.aal);let u=l;((r=(n=i.user.factors)===null||n===void 0?void 0:n.filter(f=>f.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(u="aal2");const h=o.amr||[];return{data:{currentLevel:l,nextLevel:u,currentAuthenticationMethods:h},error:null}}))}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(l=>l.kid===e);if(r)return r;const i=Date.now();if(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+JR>i)return r;const{data:s,error:o}=await Be(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,r=s.keys.find(l=>l.kid===e),!r)?null:r}async getClaims(e,n={}){try{let r=e;if(!r){const{data:g,error:_}=await this.getSession();if(_||!g.session)return{data:null,error:_};r=g.session.access_token}const{header:i,payload:s,signature:o,raw:{header:l,payload:u}}=op(r);n?.allowExpired||bD(s.exp);const d=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,n?.keys?{keys:n.keys}:n?.jwks);if(!d){const{error:g}=await this.getUser(r);if(g)throw g;return{data:{claims:s,header:i,signature:o},error:null}}const h=xD(i.alg),f=await crypto.subtle.importKey("jwk",d,h,!0,["verify"]);if(!await crypto.subtle.verify(h,f,o,aD(`${l}.${u}`)))throw new Zm("Invalid JWT signature");return{data:{claims:s,header:i,signature:o},error:null}}catch(r){if(Me(r))return{data:null,error:r};throw r}}}xu.nextInstanceID=0;const zD=xu;class BD extends zD{constructor(e){super(e)}}var FD=function(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(h){try{d(r.next(h))}catch(f){o(f)}}function u(h){try{d(r.throw(h))}catch(f){o(f)}}function d(h){h.done?s(h.value):i(h.value).then(l,u)}d((r=r.apply(t,e||[])).next())})};class $D{constructor(e,n,r){var i,s,o;this.supabaseUrl=e,this.supabaseKey=n;const l=WR(e);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const u=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:IR,realtime:zR,auth:Object.assign(Object.assign({},jR),{storageKey:u}),global:AR},h=qR(r??{},d);this.storageKey=(i=h.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=h.global.headers)!==null&&s!==void 0?s:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(f,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=UR(n,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new nR(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new LR(this.storageUrl.href,this.headers,this.fetch,r?.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new DL(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return FD(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:i,userStorage:s,storageKey:o,flowType:l,lock:u,debug:d},h,f){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new BD({url:this.authUrl.href,headers:Object.assign(Object.assign({},m),h),storageKey:o,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:i,userStorage:s,flowType:l,lock:u,debug:d,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(g=>g.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new _R(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r?.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const UD=(t,e,n)=>new $D(t,e,n);function VD(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}VD()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");let up=null;function be(){const t="https://lvplhlzzwtrqjdxhjrkd.supabase.co",e="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx2cGxobHp6d3RycWpkeGhqcmtkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg1OTgwMTYsImV4cCI6MjA3NDE3NDAxNn0.dYv3xVKcVT0LyQlzFTJMkIkN3JENXRAY0fLD7_igOd4";if(!up){const n=typeof window<"u"?window.location.origin:"https://gerbriel.github.io",r=n.includes("github.io");console.log(`Initializing Supabase client for: ${n}`),console.log(`Environment: production, GitHub Pages: ${r}`),up=UD(t,e,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!1},db:{schema:"public"},global:{headers:{"X-Client-Info":"tryed-web-app","X-Requested-With":"XMLHttpRequest","User-Agent":"tryed/1.0",...r?{Origin:n,Referer:n+"/Project-managment-app/","X-Forwarded-Host":"gerbriel.github.io","X-GitHub-Pages":"true"}:{}}},realtime:{params:{eventsPerSecond:10}}})}return up}async function Ni(t){const e=be(),{data:n,error:r}=await e.from("boards").select("id, workspace_id, name").eq("workspace_id",t).order("name",{ascending:!0});if(r)throw r;return n||[]}async function HD(t){const e=be(),{data:n,error:r}=await e.from("lists").select("id, board_id, name, position").eq("board_id",t).order("position",{ascending:!0});if(r)throw r;return n??[]}async function qD(t,e){const n=be();console.log("Creating board - workspace ID:",t,"name:",e);const r={workspace_id:t,name:e};console.log("Creating board with payload:",r);const{data:i,error:s}=await n.from("boards").insert(r).select("id, workspace_id, name").single();if(s)throw console.error("Board creation error:",s),s;return console.log("Board created successfully:",i),i}async function WD(t,e){const n=be(),{data:r,error:i}=await n.from("boards").update(e).eq("id",t).select("id, workspace_id, name").single();if(i)throw i;return r}async function KD(t){const e=be(),{error:n}=await e.from("boards").delete().eq("id",t);if(n)throw n}async function ZD(t){const e=be(),{data:n,error:r}=await e.from("boards").select("workspace_id").eq("id",t).single();if(r)throw r;const i=n.workspace_id;let{data:s,error:o}=await e.from("boards").select("id").eq("workspace_id",i).eq("name","Archive").maybeSingle();if(o&&o.code!=="PGRST116")throw o;if(!s){const{data:x,error:S}=await e.from("boards").insert({workspace_id:i,name:"Archive"}).select("id").single();if(S)throw S;s=x}let{data:l,error:u}=await e.from("lists").select("id").eq("board_id",s.id).eq("name","Archived").maybeSingle();if(u&&u.code!=="PGRST116")throw u;if(!l){const{data:x,error:S}=await e.from("lists").insert({board_id:s.id,name:"Archived",position:1}).select("id").single();if(S)throw S;l=x}const{data:d,error:h}=await e.from("cards").select("id").eq("board_id",t);if(h)throw h;const{data:f,error:m}=await e.from("cards").select("position").eq("list_id",l.id).order("position",{ascending:!1}).limit(1).maybeSingle();if(m&&m.code!=="PGRST116")throw m;let g=(f?.position??0)+1;for(const x of d||[]){const{error:S}=await e.from("cards").update({board_id:s.id,list_id:l.id,position:g++}).eq("id",x.id);if(S)throw S}const{error:_}=await e.from("lists").delete().eq("board_id",t);if(_)throw _;const{error:v}=await e.from("boards").delete().eq("id",t);if(v)throw v}function QD(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return M.useMemo(()=>r=>{e.forEach(i=>i(r))},e)}const Dh=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Xa(t){const e=Object.prototype.toString.call(t);return e==="[object Window]"||e==="[object global]"}function $y(t){return"nodeType"in t}function En(t){var e,n;return t?Xa(t)?t:$y(t)&&(e=(n=t.ownerDocument)==null?void 0:n.defaultView)!=null?e:window:window}function Uy(t){const{Document:e}=En(t);return t instanceof e}function Hu(t){return Xa(t)?!1:t instanceof En(t).HTMLElement}function i1(t){return t instanceof En(t).SVGElement}function el(t){return t?Xa(t)?t.document:$y(t)?Uy(t)?t:Hu(t)||i1(t)?t.ownerDocument:document:document:document}const Ar=Dh?M.useLayoutEffect:M.useEffect;function Ah(t){const e=M.useRef(t);return Ar(()=>{e.current=t}),M.useCallback(function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.current==null?void 0:e.current(...r)},[])}function GD(){const t=M.useRef(null),e=M.useCallback((r,i)=>{t.current=setInterval(r,i)},[]),n=M.useCallback(()=>{t.current!==null&&(clearInterval(t.current),t.current=null)},[]);return[e,n]}function Su(t,e){e===void 0&&(e=[t]);const n=M.useRef(t);return Ar(()=>{n.current!==t&&(n.current=t)},e),n}function qu(t,e){const n=M.useRef();return M.useMemo(()=>{const r=t(n.current);return n.current=r,r},[...e])}function Hd(t){const e=Ah(t),n=M.useRef(null),r=M.useCallback(i=>{i!==n.current&&e?.(i,n.current),n.current=i},[]);return[n,r]}function qd(t){const e=M.useRef();return M.useEffect(()=>{e.current=t},[t]),e.current}let cp={};function Wu(t,e){return M.useMemo(()=>{if(e)return e;const n=cp[t]==null?0:cp[t]+1;return cp[t]=n,t+"-"+n},[t,e])}function s1(t){return function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.reduce((s,o)=>{const l=Object.entries(o);for(const[u,d]of l){const h=s[u];h!=null&&(s[u]=h+t*d)}return s},{...e})}}const Ta=s1(1),ku=s1(-1);function JD(t){return"clientX"in t&&"clientY"in t}function Ih(t){if(!t)return!1;const{KeyboardEvent:e}=En(t.target);return e&&t instanceof e}function YD(t){if(!t)return!1;const{TouchEvent:e}=En(t.target);return e&&t instanceof e}function Wd(t){if(YD(t)){if(t.touches&&t.touches.length){const{clientX:e,clientY:n}=t.touches[0];return{x:e,y:n}}else if(t.changedTouches&&t.changedTouches.length){const{clientX:e,clientY:n}=t.changedTouches[0];return{x:e,y:n}}}return JD(t)?{x:t.clientX,y:t.clientY}:null}const Gr=Object.freeze({Translate:{toString(t){if(!t)return;const{x:e,y:n}=t;return"translate3d("+(e?Math.round(e):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(t){if(!t)return;const{scaleX:e,scaleY:n}=t;return"scaleX("+e+") scaleY("+n+")"}},Transform:{toString(t){if(t)return[Gr.Translate.toString(t),Gr.Scale.toString(t)].join(" ")}},Transition:{toString(t){let{property:e,duration:n,easing:r}=t;return e+" "+n+"ms "+r}}}),_0="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function XD(t){return t.matches(_0)?t:t.querySelector(_0)}const eA={display:"none"};function tA(t){let{id:e,value:n}=t;return q.createElement("div",{id:e,style:eA},n)}function nA(t){let{id:e,announcement:n,ariaLiveType:r="assertive"}=t;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return q.createElement("div",{id:e,style:i,role:"status","aria-live":r,"aria-atomic":!0},n)}function rA(){const[t,e]=M.useState("");return{announce:M.useCallback(r=>{r!=null&&e(r)},[]),announcement:t}}const o1=M.createContext(null);function iA(t){const e=M.useContext(o1);M.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(t)},[t,e])}function sA(){const[t]=M.useState(()=>new Set),e=M.useCallback(r=>(t.add(r),()=>t.delete(r)),[t]);return[M.useCallback(r=>{let{type:i,event:s}=r;t.forEach(o=>{var l;return(l=o[i])==null?void 0:l.call(o,s)})},[t]),e]}const oA={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},aA={onDragStart(t){let{active:e}=t;return"Picked up draggable item "+e.id+"."},onDragOver(t){let{active:e,over:n}=t;return n?"Draggable item "+e.id+" was moved over droppable area "+n.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(t){let{active:e,over:n}=t;return n?"Draggable item "+e.id+" was dropped over droppable area "+n.id:"Draggable item "+e.id+" was dropped."},onDragCancel(t){let{active:e}=t;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function lA(t){let{announcements:e=aA,container:n,hiddenTextDescribedById:r,screenReaderInstructions:i=oA}=t;const{announce:s,announcement:o}=rA(),l=Wu("DndLiveRegion"),[u,d]=M.useState(!1);if(M.useEffect(()=>{d(!0)},[]),iA(M.useMemo(()=>({onDragStart(f){let{active:m}=f;s(e.onDragStart({active:m}))},onDragMove(f){let{active:m,over:g}=f;e.onDragMove&&s(e.onDragMove({active:m,over:g}))},onDragOver(f){let{active:m,over:g}=f;s(e.onDragOver({active:m,over:g}))},onDragEnd(f){let{active:m,over:g}=f;s(e.onDragEnd({active:m,over:g}))},onDragCancel(f){let{active:m,over:g}=f;s(e.onDragCancel({active:m,over:g}))}}),[s,e])),!u)return null;const h=q.createElement(q.Fragment,null,q.createElement(tA,{id:r,value:i.draggable}),q.createElement(nA,{id:l,announcement:o}));return n?Wr.createPortal(h,n):h}var Nt;(function(t){t.DragStart="dragStart",t.DragMove="dragMove",t.DragEnd="dragEnd",t.DragCancel="dragCancel",t.DragOver="dragOver",t.RegisterDroppable="registerDroppable",t.SetDroppableDisabled="setDroppableDisabled",t.UnregisterDroppable="unregisterDroppable"})(Nt||(Nt={}));function Kd(){}function Qm(t,e){return M.useMemo(()=>({sensor:t,options:e??{}}),[t,e])}function a1(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return M.useMemo(()=>[...e].filter(r=>r!=null),[...e])}const Ir=Object.freeze({x:0,y:0});function l1(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function uA(t,e){const n=Wd(t);if(!n)return"0 0";const r={x:(n.x-e.left)/e.width*100,y:(n.y-e.top)/e.height*100};return r.x+"% "+r.y+"%"}function u1(t,e){let{data:{value:n}}=t,{data:{value:r}}=e;return n-r}function cA(t,e){let{data:{value:n}}=t,{data:{value:r}}=e;return r-n}function Gm(t){let{left:e,top:n,height:r,width:i}=t;return[{x:e,y:n},{x:e+i,y:n},{x:e,y:n+r},{x:e+i,y:n+r}]}function c1(t,e){if(!t||t.length===0)return null;const[n]=t;return n[e]}const dA=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const i=Gm(e),s=[];for(const o of r){const{id:l}=o,u=n.get(l);if(u){const d=Gm(u),h=i.reduce((m,g,_)=>m+l1(d[_],g),0),f=Number((h/4).toFixed(4));s.push({id:l,data:{droppableContainer:o,value:f}})}}return s.sort(u1)};function hA(t,e){const n=Math.max(e.top,t.top),r=Math.max(e.left,t.left),i=Math.min(e.left+e.width,t.left+t.width),s=Math.min(e.top+e.height,t.top+t.height),o=i-r,l=s-n;if(r<i&&n<s){const u=e.width*e.height,d=t.width*t.height,h=o*l,f=h/(u+d-h);return Number(f.toFixed(4))}return 0}const fA=t=>{let{collisionRect:e,droppableRects:n,droppableContainers:r}=t;const i=[];for(const s of r){const{id:o}=s,l=n.get(o);if(l){const u=hA(l,e);u>0&&i.push({id:o,data:{droppableContainer:s,value:u}})}}return i.sort(cA)};function pA(t,e){const{top:n,left:r,bottom:i,right:s}=e;return n<=t.y&&t.y<=i&&r<=t.x&&t.x<=s}const mA=t=>{let{droppableContainers:e,droppableRects:n,pointerCoordinates:r}=t;if(!r)return[];const i=[];for(const s of e){const{id:o}=s,l=n.get(o);if(l&&pA(r,l)){const d=Gm(l).reduce((f,m)=>f+l1(r,m),0),h=Number((d/4).toFixed(4));i.push({id:o,data:{droppableContainer:s,value:h}})}}return i.sort(u1)};function gA(t,e,n){return{...t,scaleX:e&&n?e.width/n.width:1,scaleY:e&&n?e.height/n.height:1}}function d1(t,e){return t&&e?{x:t.left-e.left,y:t.top-e.top}:Ir}function yA(t){return function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];return i.reduce((o,l)=>({...o,top:o.top+t*l.y,bottom:o.bottom+t*l.y,left:o.left+t*l.x,right:o.right+t*l.x}),{...n})}}const vA=yA(1);function h1(t){if(t.startsWith("matrix3d(")){const e=t.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(t.startsWith("matrix(")){const e=t.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function _A(t,e,n){const r=h1(e);if(!r)return t;const{scaleX:i,scaleY:s,x:o,y:l}=r,u=t.left-o-(1-i)*parseFloat(n),d=t.top-l-(1-s)*parseFloat(n.slice(n.indexOf(" ")+1)),h=i?t.width/i:t.width,f=s?t.height/s:t.height;return{width:h,height:f,top:d,right:u+h,bottom:d+f,left:u}}const wA={ignoreTransform:!1};function tl(t,e){e===void 0&&(e=wA);let n=t.getBoundingClientRect();if(e.ignoreTransform){const{transform:d,transformOrigin:h}=En(t).getComputedStyle(t);d&&(n=_A(n,d,h))}const{top:r,left:i,width:s,height:o,bottom:l,right:u}=n;return{top:r,left:i,width:s,height:o,bottom:l,right:u}}function w0(t){return tl(t,{ignoreTransform:!0})}function bA(t){const e=t.innerWidth,n=t.innerHeight;return{top:0,left:0,right:e,bottom:n,width:e,height:n}}function xA(t,e){return e===void 0&&(e=En(t).getComputedStyle(t)),e.position==="fixed"}function SA(t,e){e===void 0&&(e=En(t).getComputedStyle(t));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const s=e[i];return typeof s=="string"?n.test(s):!1})}function jh(t,e){const n=[];function r(i){if(e!=null&&n.length>=e||!i)return n;if(Uy(i)&&i.scrollingElement!=null&&!n.includes(i.scrollingElement))return n.push(i.scrollingElement),n;if(!Hu(i)||i1(i)||n.includes(i))return n;const s=En(t).getComputedStyle(i);return i!==t&&SA(i,s)&&n.push(i),xA(i,s)?n:r(i.parentNode)}return t?r(t):n}function f1(t){const[e]=jh(t,1);return e??null}function dp(t){return!Dh||!t?null:Xa(t)?t:$y(t)?Uy(t)||t===el(t).scrollingElement?window:Hu(t)?t:null:null}function p1(t){return Xa(t)?t.scrollX:t.scrollLeft}function m1(t){return Xa(t)?t.scrollY:t.scrollTop}function Jm(t){return{x:p1(t),y:m1(t)}}var Bt;(function(t){t[t.Forward=1]="Forward",t[t.Backward=-1]="Backward"})(Bt||(Bt={}));function g1(t){return!Dh||!t?!1:t===document.scrollingElement}function y1(t){const e={x:0,y:0},n=g1(t)?{height:window.innerHeight,width:window.innerWidth}:{height:t.clientHeight,width:t.clientWidth},r={x:t.scrollWidth-n.width,y:t.scrollHeight-n.height},i=t.scrollTop<=e.y,s=t.scrollLeft<=e.x,o=t.scrollTop>=r.y,l=t.scrollLeft>=r.x;return{isTop:i,isLeft:s,isBottom:o,isRight:l,maxScroll:r,minScroll:e}}const kA={x:.2,y:.2};function CA(t,e,n,r,i){let{top:s,left:o,right:l,bottom:u}=n;r===void 0&&(r=10),i===void 0&&(i=kA);const{isTop:d,isBottom:h,isLeft:f,isRight:m}=y1(t),g={x:0,y:0},_={x:0,y:0},v={height:e.height*i.y,width:e.width*i.x};return!d&&s<=e.top+v.height?(g.y=Bt.Backward,_.y=r*Math.abs((e.top+v.height-s)/v.height)):!h&&u>=e.bottom-v.height&&(g.y=Bt.Forward,_.y=r*Math.abs((e.bottom-v.height-u)/v.height)),!m&&l>=e.right-v.width?(g.x=Bt.Forward,_.x=r*Math.abs((e.right-v.width-l)/v.width)):!f&&o<=e.left+v.width&&(g.x=Bt.Backward,_.x=r*Math.abs((e.left+v.width-o)/v.width)),{direction:g,speed:_}}function EA(t){if(t===document.scrollingElement){const{innerWidth:s,innerHeight:o}=window;return{top:0,left:0,right:s,bottom:o,width:s,height:o}}const{top:e,left:n,right:r,bottom:i}=t.getBoundingClientRect();return{top:e,left:n,right:r,bottom:i,width:t.clientWidth,height:t.clientHeight}}function v1(t){return t.reduce((e,n)=>Ta(e,Jm(n)),Ir)}function TA(t){return t.reduce((e,n)=>e+p1(n),0)}function PA(t){return t.reduce((e,n)=>e+m1(n),0)}function _1(t,e){if(e===void 0&&(e=tl),!t)return;const{top:n,left:r,bottom:i,right:s}=e(t);f1(t)&&(i<=0||s<=0||n>=window.innerHeight||r>=window.innerWidth)&&t.scrollIntoView({block:"center",inline:"center"})}const MA=[["x",["left","right"],TA],["y",["top","bottom"],PA]];class Vy{constructor(e,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=jh(n),i=v1(r);this.rect={...e},this.width=e.width,this.height=e.height;for(const[s,o,l]of MA)for(const u of o)Object.defineProperty(this,u,{get:()=>{const d=l(r),h=i[s]-d;return this.rect[u]+h},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Zl{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=e}add(e,n,r){var i;(i=this.target)==null||i.addEventListener(e,n,r),this.listeners.push([e,n,r])}}function OA(t){const{EventTarget:e}=En(t);return t instanceof e?t:el(t)}function hp(t,e){const n=Math.abs(t.x),r=Math.abs(t.y);return typeof e=="number"?Math.sqrt(n**2+r**2)>e:"x"in e&&"y"in e?n>e.x&&r>e.y:"x"in e?n>e.x:"y"in e?r>e.y:!1}var lr;(function(t){t.Click="click",t.DragStart="dragstart",t.Keydown="keydown",t.ContextMenu="contextmenu",t.Resize="resize",t.SelectionChange="selectionchange",t.VisibilityChange="visibilitychange"})(lr||(lr={}));function b0(t){t.preventDefault()}function NA(t){t.stopPropagation()}var Ue;(function(t){t.Space="Space",t.Down="ArrowDown",t.Right="ArrowRight",t.Left="ArrowLeft",t.Up="ArrowUp",t.Esc="Escape",t.Enter="Enter",t.Tab="Tab"})(Ue||(Ue={}));const w1={start:[Ue.Space,Ue.Enter],cancel:[Ue.Esc],end:[Ue.Space,Ue.Enter,Ue.Tab]},LA=(t,e)=>{let{currentCoordinates:n}=e;switch(t.code){case Ue.Right:return{...n,x:n.x+25};case Ue.Left:return{...n,x:n.x-25};case Ue.Down:return{...n,y:n.y+25};case Ue.Up:return{...n,y:n.y-25}}};class Hy{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:n}}=e;this.props=e,this.listeners=new Zl(el(n)),this.windowListeners=new Zl(En(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(lr.Resize,this.handleCancel),this.windowListeners.add(lr.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(lr.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:n}=this.props,r=e.node.current;r&&_1(r),n(Ir)}handleKeyDown(e){if(Ih(e)){const{active:n,context:r,options:i}=this.props,{keyboardCodes:s=w1,coordinateGetter:o=LA,scrollBehavior:l="smooth"}=i,{code:u}=e;if(s.end.includes(u)){this.handleEnd(e);return}if(s.cancel.includes(u)){this.handleCancel(e);return}const{collisionRect:d}=r.current,h=d?{x:d.left,y:d.top}:Ir;this.referenceCoordinates||(this.referenceCoordinates=h);const f=o(e,{active:n,context:r.current,currentCoordinates:h});if(f){const m=ku(f,h),g={x:0,y:0},{scrollableAncestors:_}=r.current;for(const v of _){const x=e.code,{isTop:S,isRight:k,isLeft:C,isBottom:R,maxScroll:N,minScroll:P}=y1(v),T=EA(v),D={x:Math.min(x===Ue.Right?T.right-T.width/2:T.right,Math.max(x===Ue.Right?T.left:T.left+T.width/2,f.x)),y:Math.min(x===Ue.Down?T.bottom-T.height/2:T.bottom,Math.max(x===Ue.Down?T.top:T.top+T.height/2,f.y))},j=x===Ue.Right&&!k||x===Ue.Left&&!C,O=x===Ue.Down&&!R||x===Ue.Up&&!S;if(j&&D.x!==f.x){const F=v.scrollLeft+m.x,Z=x===Ue.Right&&F<=N.x||x===Ue.Left&&F>=P.x;if(Z&&!m.y){v.scrollTo({left:F,behavior:l});return}Z?g.x=v.scrollLeft-F:g.x=x===Ue.Right?v.scrollLeft-N.x:v.scrollLeft-P.x,g.x&&v.scrollBy({left:-g.x,behavior:l});break}else if(O&&D.y!==f.y){const F=v.scrollTop+m.y,Z=x===Ue.Down&&F<=N.y||x===Ue.Up&&F>=P.y;if(Z&&!m.x){v.scrollTo({top:F,behavior:l});return}Z?g.y=v.scrollTop-F:g.y=x===Ue.Down?v.scrollTop-N.y:v.scrollTop-P.y,g.y&&v.scrollBy({top:-g.y,behavior:l});break}}this.handleMove(e,Ta(ku(f,this.referenceCoordinates),g))}}}handleMove(e,n){const{onMove:r}=this.props;e.preventDefault(),r(n)}handleEnd(e){const{onEnd:n}=this.props;e.preventDefault(),this.detach(),n()}handleCancel(e){const{onCancel:n}=this.props;e.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Hy.activators=[{eventName:"onKeyDown",handler:(t,e,n)=>{let{keyboardCodes:r=w1,onActivation:i}=e,{active:s}=n;const{code:o}=t.nativeEvent;if(r.start.includes(o)){const l=s.activatorNode.current;return l&&t.target!==l?!1:(t.preventDefault(),i?.({event:t.nativeEvent}),!0)}return!1}}];function x0(t){return!!(t&&"distance"in t)}function S0(t){return!!(t&&"delay"in t)}class qy{constructor(e,n,r){var i;r===void 0&&(r=OA(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=n;const{event:s}=e,{target:o}=s;this.props=e,this.events=n,this.document=el(o),this.documentListeners=new Zl(this.document),this.listeners=new Zl(r),this.windowListeners=new Zl(En(o)),this.initialCoordinates=(i=Wd(s))!=null?i:Ir,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(lr.Resize,this.handleCancel),this.windowListeners.add(lr.DragStart,b0),this.windowListeners.add(lr.VisibilityChange,this.handleCancel),this.windowListeners.add(lr.ContextMenu,b0),this.documentListeners.add(lr.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(S0(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(x0(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,n){const{active:r,onPending:i}=this.props;i(r,e,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:e}=this,{onStart:n}=this.props;e&&(this.activated=!0,this.documentListeners.add(lr.Click,NA,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(lr.SelectionChange,this.removeTextSelection),n(e))}handleMove(e){var n;const{activated:r,initialCoordinates:i,props:s}=this,{onMove:o,options:{activationConstraint:l}}=s;if(!i)return;const u=(n=Wd(e))!=null?n:Ir,d=ku(i,u);if(!r&&l){if(x0(l)){if(l.tolerance!=null&&hp(d,l.tolerance))return this.handleCancel();if(hp(d,l.distance))return this.handleStart()}if(S0(l)&&hp(d,l.tolerance))return this.handleCancel();this.handlePending(l,d);return}e.cancelable&&e.preventDefault(),o(u)}handleEnd(){const{onAbort:e,onEnd:n}=this.props;this.detach(),this.activated||e(this.props.active),n()}handleCancel(){const{onAbort:e,onCancel:n}=this.props;this.detach(),this.activated||e(this.props.active),n()}handleKeydown(e){e.code===Ue.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const RA={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class zh extends qy{constructor(e){const{event:n}=e,r=el(n.target);super(e,RA,r)}}zh.activators=[{eventName:"onPointerDown",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;return!n.isPrimary||n.button!==0?!1:(r?.({event:n}),!0)}}];const DA={move:{name:"mousemove"},end:{name:"mouseup"}};var Ym;(function(t){t[t.RightClick=2]="RightClick"})(Ym||(Ym={}));class AA extends qy{constructor(e){super(e,DA,el(e.event.target))}}AA.activators=[{eventName:"onMouseDown",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;return n.button===Ym.RightClick?!1:(r?.({event:n}),!0)}}];const fp={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class IA extends qy{constructor(e){super(e,fp)}static setup(){return window.addEventListener(fp.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(fp.move.name,e)};function e(){}}}IA.activators=[{eventName:"onTouchStart",handler:(t,e)=>{let{nativeEvent:n}=t,{onActivation:r}=e;const{touches:i}=n;return i.length>1?!1:(r?.({event:n}),!0)}}];var Ql;(function(t){t[t.Pointer=0]="Pointer",t[t.DraggableRect=1]="DraggableRect"})(Ql||(Ql={}));var Zd;(function(t){t[t.TreeOrder=0]="TreeOrder",t[t.ReversedTreeOrder=1]="ReversedTreeOrder"})(Zd||(Zd={}));function jA(t){let{acceleration:e,activator:n=Ql.Pointer,canScroll:r,draggingRect:i,enabled:s,interval:o=5,order:l=Zd.TreeOrder,pointerCoordinates:u,scrollableAncestors:d,scrollableAncestorRects:h,delta:f,threshold:m}=t;const g=BA({delta:f,disabled:!s}),[_,v]=GD(),x=M.useRef({x:0,y:0}),S=M.useRef({x:0,y:0}),k=M.useMemo(()=>{switch(n){case Ql.Pointer:return u?{top:u.y,bottom:u.y,left:u.x,right:u.x}:null;case Ql.DraggableRect:return i}},[n,i,u]),C=M.useRef(null),R=M.useCallback(()=>{const P=C.current;if(!P)return;const T=x.current.x*S.current.x,D=x.current.y*S.current.y;P.scrollBy(T,D)},[]),N=M.useMemo(()=>l===Zd.TreeOrder?[...d].reverse():d,[l,d]);M.useEffect(()=>{if(!s||!d.length||!k){v();return}for(const P of N){if(r?.(P)===!1)continue;const T=d.indexOf(P),D=h[T];if(!D)continue;const{direction:j,speed:O}=CA(P,D,k,e,m);for(const F of["x","y"])g[F][j[F]]||(O[F]=0,j[F]=0);if(O.x>0||O.y>0){v(),C.current=P,_(R,o),x.current=O,S.current=j;return}}x.current={x:0,y:0},S.current={x:0,y:0},v()},[e,R,r,v,s,o,JSON.stringify(k),JSON.stringify(g),_,d,N,h,JSON.stringify(m)])}const zA={x:{[Bt.Backward]:!1,[Bt.Forward]:!1},y:{[Bt.Backward]:!1,[Bt.Forward]:!1}};function BA(t){let{delta:e,disabled:n}=t;const r=qd(e);return qu(i=>{if(n||!r||!i)return zA;const s={x:Math.sign(e.x-r.x),y:Math.sign(e.y-r.y)};return{x:{[Bt.Backward]:i.x[Bt.Backward]||s.x===-1,[Bt.Forward]:i.x[Bt.Forward]||s.x===1},y:{[Bt.Backward]:i.y[Bt.Backward]||s.y===-1,[Bt.Forward]:i.y[Bt.Forward]||s.y===1}}},[n,e,r])}function FA(t,e){const n=e!=null?t.get(e):void 0,r=n?n.node.current:null;return qu(i=>{var s;return e==null?null:(s=r??i)!=null?s:null},[r,e])}function $A(t,e){return M.useMemo(()=>t.reduce((n,r)=>{const{sensor:i}=r,s=i.activators.map(o=>({eventName:o.eventName,handler:e(o.handler,r)}));return[...n,...s]},[]),[t,e])}var Cu;(function(t){t[t.Always=0]="Always",t[t.BeforeDragging=1]="BeforeDragging",t[t.WhileDragging=2]="WhileDragging"})(Cu||(Cu={}));var Xm;(function(t){t.Optimized="optimized"})(Xm||(Xm={}));const k0=new Map;function UA(t,e){let{dragging:n,dependencies:r,config:i}=e;const[s,o]=M.useState(null),{frequency:l,measure:u,strategy:d}=i,h=M.useRef(t),f=x(),m=Su(f),g=M.useCallback(function(S){S===void 0&&(S=[]),!m.current&&o(k=>k===null?S:k.concat(S.filter(C=>!k.includes(C))))},[m]),_=M.useRef(null),v=qu(S=>{if(f&&!n)return k0;if(!S||S===k0||h.current!==t||s!=null){const k=new Map;for(let C of t){if(!C)continue;if(s&&s.length>0&&!s.includes(C.id)&&C.rect.current){k.set(C.id,C.rect.current);continue}const R=C.node.current,N=R?new Vy(u(R),R):null;C.rect.current=N,N&&k.set(C.id,N)}return k}return S},[t,s,n,f,u]);return M.useEffect(()=>{h.current=t},[t]),M.useEffect(()=>{f||g()},[n,f]),M.useEffect(()=>{s&&s.length>0&&o(null)},[JSON.stringify(s)]),M.useEffect(()=>{f||typeof l!="number"||_.current!==null||(_.current=setTimeout(()=>{g(),_.current=null},l))},[l,f,g,...r]),{droppableRects:v,measureDroppableContainers:g,measuringScheduled:s!=null};function x(){switch(d){case Cu.Always:return!1;case Cu.BeforeDragging:return n;default:return!n}}}function Wy(t,e){return qu(n=>t?n||(typeof e=="function"?e(t):t):null,[e,t])}function VA(t,e){return Wy(t,e)}function HA(t){let{callback:e,disabled:n}=t;const r=Ah(e),i=M.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(r)},[r,n]);return M.useEffect(()=>()=>i?.disconnect(),[i]),i}function Bh(t){let{callback:e,disabled:n}=t;const r=Ah(e),i=M.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(r)},[n]);return M.useEffect(()=>()=>i?.disconnect(),[i]),i}function qA(t){return new Vy(tl(t),t)}function C0(t,e,n){e===void 0&&(e=qA);const[r,i]=M.useState(null);function s(){i(u=>{if(!t)return null;if(t.isConnected===!1){var d;return(d=u??n)!=null?d:null}const h=e(t);return JSON.stringify(u)===JSON.stringify(h)?u:h})}const o=HA({callback(u){if(t)for(const d of u){const{type:h,target:f}=d;if(h==="childList"&&f instanceof HTMLElement&&f.contains(t)){s();break}}}}),l=Bh({callback:s});return Ar(()=>{s(),t?(l?.observe(t),o?.observe(document.body,{childList:!0,subtree:!0})):(l?.disconnect(),o?.disconnect())},[t]),r}function WA(t){const e=Wy(t);return d1(t,e)}const E0=[];function KA(t){const e=M.useRef(t),n=qu(r=>t?r&&r!==E0&&t&&e.current&&t.parentNode===e.current.parentNode?r:jh(t):E0,[t]);return M.useEffect(()=>{e.current=t},[t]),n}function ZA(t){const[e,n]=M.useState(null),r=M.useRef(t),i=M.useCallback(s=>{const o=dp(s.target);o&&n(l=>l?(l.set(o,Jm(o)),new Map(l)):null)},[]);return M.useEffect(()=>{const s=r.current;if(t!==s){o(s);const l=t.map(u=>{const d=dp(u);return d?(d.addEventListener("scroll",i,{passive:!0}),[d,Jm(d)]):null}).filter(u=>u!=null);n(l.length?new Map(l):null),r.current=t}return()=>{o(t),o(s)};function o(l){l.forEach(u=>{const d=dp(u);d?.removeEventListener("scroll",i)})}},[i,t]),M.useMemo(()=>t.length?e?Array.from(e.values()).reduce((s,o)=>Ta(s,o),Ir):v1(t):Ir,[t,e])}function T0(t,e){e===void 0&&(e=[]);const n=M.useRef(null);return M.useEffect(()=>{n.current=null},e),M.useEffect(()=>{const r=t!==Ir;r&&!n.current&&(n.current=t),!r&&n.current&&(n.current=null)},[t]),n.current?ku(t,n.current):Ir}function QA(t){M.useEffect(()=>{if(!Dh)return;const e=t.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of e)n?.()}},t.map(e=>{let{sensor:n}=e;return n}))}function GA(t,e){return M.useMemo(()=>t.reduce((n,r)=>{let{eventName:i,handler:s}=r;return n[i]=o=>{s(o,e)},n},{}),[t,e])}function b1(t){return M.useMemo(()=>t?bA(t):null,[t])}const P0=[];function JA(t,e){e===void 0&&(e=tl);const[n]=t,r=b1(n?En(n):null),[i,s]=M.useState(P0);function o(){s(()=>t.length?t.map(u=>g1(u)?r:new Vy(e(u),u)):P0)}const l=Bh({callback:o});return Ar(()=>{l?.disconnect(),o(),t.forEach(u=>l?.observe(u))},[t]),i}function x1(t){if(!t)return null;if(t.children.length>1)return t;const e=t.children[0];return Hu(e)?e:t}function YA(t){let{measure:e}=t;const[n,r]=M.useState(null),i=M.useCallback(d=>{for(const{target:h}of d)if(Hu(h)){r(f=>{const m=e(h);return f?{...f,width:m.width,height:m.height}:m});break}},[e]),s=Bh({callback:i}),o=M.useCallback(d=>{const h=x1(d);s?.disconnect(),h&&s?.observe(h),r(h?e(h):null)},[e,s]),[l,u]=Hd(o);return M.useMemo(()=>({nodeRef:l,rect:n,setRef:u}),[n,l,u])}const XA=[{sensor:zh,options:{}},{sensor:Hy,options:{}}],eI={current:{}},ad={draggable:{measure:w0},droppable:{measure:w0,strategy:Cu.WhileDragging,frequency:Xm.Optimized},dragOverlay:{measure:tl}};class Gl extends Map{get(e){var n;return e!=null&&(n=super.get(e))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:n}=e;return!n})}getNodeFor(e){var n,r;return(n=(r=this.get(e))==null?void 0:r.node.current)!=null?n:void 0}}const tI={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Gl,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Kd},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:ad,measureDroppableContainers:Kd,windowRect:null,measuringScheduled:!1},S1={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Kd,draggableNodes:new Map,over:null,measureDroppableContainers:Kd},Ku=M.createContext(S1),k1=M.createContext(tI);function nI(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Gl}}}function rI(t,e){switch(e.type){case Nt.DragStart:return{...t,draggable:{...t.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case Nt.DragMove:return t.draggable.active==null?t:{...t,draggable:{...t.draggable,translate:{x:e.coordinates.x-t.draggable.initialCoordinates.x,y:e.coordinates.y-t.draggable.initialCoordinates.y}}};case Nt.DragEnd:case Nt.DragCancel:return{...t,draggable:{...t.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Nt.RegisterDroppable:{const{element:n}=e,{id:r}=n,i=new Gl(t.droppable.containers);return i.set(r,n),{...t,droppable:{...t.droppable,containers:i}}}case Nt.SetDroppableDisabled:{const{id:n,key:r,disabled:i}=e,s=t.droppable.containers.get(n);if(!s||r!==s.key)return t;const o=new Gl(t.droppable.containers);return o.set(n,{...s,disabled:i}),{...t,droppable:{...t.droppable,containers:o}}}case Nt.UnregisterDroppable:{const{id:n,key:r}=e,i=t.droppable.containers.get(n);if(!i||r!==i.key)return t;const s=new Gl(t.droppable.containers);return s.delete(n),{...t,droppable:{...t.droppable,containers:s}}}default:return t}}function iI(t){let{disabled:e}=t;const{active:n,activatorEvent:r,draggableNodes:i}=M.useContext(Ku),s=qd(r),o=qd(n?.id);return M.useEffect(()=>{if(!e&&!r&&s&&o!=null){if(!Ih(s)||document.activeElement===s.target)return;const l=i.get(o);if(!l)return;const{activatorNode:u,node:d}=l;if(!u.current&&!d.current)return;requestAnimationFrame(()=>{for(const h of[u.current,d.current]){if(!h)continue;const f=XD(h);if(f){f.focus();break}}})}},[r,e,i,o,s]),null}function C1(t,e){let{transform:n,...r}=e;return t!=null&&t.length?t.reduce((i,s)=>s({transform:i,...r}),n):n}function sI(t){return M.useMemo(()=>({draggable:{...ad.draggable,...t?.draggable},droppable:{...ad.droppable,...t?.droppable},dragOverlay:{...ad.dragOverlay,...t?.dragOverlay}}),[t?.draggable,t?.droppable,t?.dragOverlay])}function oI(t){let{activeNode:e,measure:n,initialRect:r,config:i=!0}=t;const s=M.useRef(!1),{x:o,y:l}=typeof i=="boolean"?{x:i,y:i}:i;Ar(()=>{if(!o&&!l||!e){s.current=!1;return}if(s.current||!r)return;const d=e?.node.current;if(!d||d.isConnected===!1)return;const h=n(d),f=d1(h,r);if(o||(f.x=0),l||(f.y=0),s.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const m=f1(d);m&&m.scrollBy({top:f.y,left:f.x})}},[e,o,l,r,n])}const Fh=M.createContext({...Ir,scaleX:1,scaleY:1});var Qi;(function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initializing=1]="Initializing",t[t.Initialized=2]="Initialized"})(Qi||(Qi={}));const E1=M.memo(function(e){var n,r,i,s;let{id:o,accessibility:l,autoScroll:u=!0,children:d,sensors:h=XA,collisionDetection:f=fA,measuring:m,modifiers:g,..._}=e;const v=M.useReducer(rI,void 0,nI),[x,S]=v,[k,C]=sA(),[R,N]=M.useState(Qi.Uninitialized),P=R===Qi.Initialized,{draggable:{active:T,nodes:D,translate:j},droppable:{containers:O}}=x,F=T!=null?D.get(T):null,Z=M.useRef({initial:null,translated:null}),se=M.useMemo(()=>{var at;return T!=null?{id:T,data:(at=F?.data)!=null?at:eI,rect:Z}:null},[T,F]),oe=M.useRef(null),[ye,ue]=M.useState(null),[Te,H]=M.useState(null),ne=Su(_,Object.values(_)),G=Wu("DndDescribedBy",o),$=M.useMemo(()=>O.getEnabled(),[O]),K=sI(m),{droppableRects:ie,measureDroppableContainers:re,measuringScheduled:te}=UA($,{dragging:P,dependencies:[j.x,j.y],config:K.droppable}),ee=FA(D,T),Se=M.useMemo(()=>Te?Wd(Te):null,[Te]),Re=ji(),Ce=VA(ee,K.draggable.measure);oI({activeNode:T!=null?D.get(T):null,config:Re.layoutShiftCompensation,initialRect:Ce,measure:K.draggable.measure});const Oe=C0(ee,K.draggable.measure,Ce),et=C0(ee?ee.parentElement:null),De=M.useRef({activatorEvent:null,active:null,activeNode:ee,collisionRect:null,collisions:null,droppableRects:ie,draggableNodes:D,draggingNode:null,draggingNodeRect:null,droppableContainers:O,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),gt=O.getNodeFor((n=De.current.over)==null?void 0:n.id),rn=YA({measure:K.dragOverlay.measure}),Tn=(r=rn.nodeRef.current)!=null?r:ee,kt=P?(i=rn.rect)!=null?i:Oe:null,Ct=!!(rn.nodeRef.current&&rn.rect),Pn=WA(Ct?null:Oe),Li=b1(Tn?En(Tn):null),$n=KA(P?gt??ee:null),jr=JA($n),ei=C1(g,{transform:{x:j.x-Pn.x,y:j.y-Pn.y,scaleX:1,scaleY:1},activatorEvent:Te,active:se,activeNodeRect:Oe,containerNodeRect:et,draggingNodeRect:kt,over:De.current.over,overlayNodeRect:rn.rect,scrollableAncestors:$n,scrollableAncestorRects:jr,windowRect:Li}),Is=Se?Ta(Se,j):null,er=ZA($n),ti=T0(er),Ri=T0(er,[Oe]),Un=Ta(ei,ti),At=kt?vA(kt,ei):null,qt=se&&At?f({active:se,collisionRect:At,droppableRects:ie,droppableContainers:$,pointerCoordinates:Is}):null,Di=c1(qt,"id"),[sn,Bo]=M.useState(null),Vn=Ct?ei:Ta(ei,Ri),Ai=gA(Vn,(s=sn?.rect)!=null?s:null,Oe),ni=M.useRef(null),js=M.useCallback((at,Wt)=>{let{sensor:It,options:tr}=Wt;if(oe.current==null)return;const Kt=D.get(oe.current);if(!Kt)return;const yt=at.nativeEvent,Zt=new It({active:oe.current,activeNode:Kt,event:yt,options:tr,context:De,onAbort(ft){if(!D.get(ft))return;const{onDragAbort:z}=ne.current,U={id:ft};z?.(U),k({type:"onDragAbort",event:U})},onPending(ft,I,z,U){if(!D.get(ft))return;const{onDragPending:W}=ne.current,he={id:ft,constraint:I,initialCoordinates:z,offset:U};W?.(he),k({type:"onDragPending",event:he})},onStart(ft){const I=oe.current;if(I==null)return;const z=D.get(I);if(!z)return;const{onDragStart:U}=ne.current,Q={activatorEvent:yt,active:{id:I,data:z.data,rect:Z}};Wr.unstable_batchedUpdates(()=>{U?.(Q),N(Qi.Initializing),S({type:Nt.DragStart,initialCoordinates:ft,active:I}),k({type:"onDragStart",event:Q}),ue(ni.current),H(yt)})},onMove(ft){S({type:Nt.DragMove,coordinates:ft})},onEnd:nr(Nt.DragEnd),onCancel:nr(Nt.DragCancel)});ni.current=Zt;function nr(ft){return async function(){const{active:z,collisions:U,over:Q,scrollAdjustedTranslate:W}=De.current;let he=null;if(z&&W){const{cancelDrop:ve}=ne.current;he={activatorEvent:yt,active:z,collisions:U,delta:W,over:Q},ft===Nt.DragEnd&&typeof ve=="function"&&await Promise.resolve(ve(he))&&(ft=Nt.DragCancel)}oe.current=null,Wr.unstable_batchedUpdates(()=>{S({type:ft}),N(Qi.Uninitialized),Bo(null),ue(null),H(null),ni.current=null;const ve=ft===Nt.DragEnd?"onDragEnd":"onDragCancel";if(he){const ce=ne.current[ve];ce?.(he),k({type:ve,event:he})}})}}},[D]),ri=M.useCallback((at,Wt)=>(It,tr)=>{const Kt=It.nativeEvent,yt=D.get(tr);if(oe.current!==null||!yt||Kt.dndKit||Kt.defaultPrevented)return;const Zt={active:yt};at(It,Wt.options,Zt)===!0&&(Kt.dndKit={capturedBy:Wt.sensor},oe.current=tr,js(It,Wt))},[D,js]),zs=$A(h,ri);QA(h),Ar(()=>{Oe&&R===Qi.Initializing&&N(Qi.Initialized)},[Oe,R]),M.useEffect(()=>{const{onDragMove:at}=ne.current,{active:Wt,activatorEvent:It,collisions:tr,over:Kt}=De.current;if(!Wt||!It)return;const yt={active:Wt,activatorEvent:It,collisions:tr,delta:{x:Un.x,y:Un.y},over:Kt};Wr.unstable_batchedUpdates(()=>{at?.(yt),k({type:"onDragMove",event:yt})})},[Un.x,Un.y]),M.useEffect(()=>{const{active:at,activatorEvent:Wt,collisions:It,droppableContainers:tr,scrollAdjustedTranslate:Kt}=De.current;if(!at||oe.current==null||!Wt||!Kt)return;const{onDragOver:yt}=ne.current,Zt=tr.get(Di),nr=Zt&&Zt.rect.current?{id:Zt.id,rect:Zt.rect.current,data:Zt.data,disabled:Zt.disabled}:null,ft={active:at,activatorEvent:Wt,collisions:It,delta:{x:Kt.x,y:Kt.y},over:nr};Wr.unstable_batchedUpdates(()=>{Bo(nr),yt?.(ft),k({type:"onDragOver",event:ft})})},[Di]),Ar(()=>{De.current={activatorEvent:Te,active:se,activeNode:ee,collisionRect:At,collisions:qt,droppableRects:ie,draggableNodes:D,draggingNode:Tn,draggingNodeRect:kt,droppableContainers:O,over:sn,scrollableAncestors:$n,scrollAdjustedTranslate:Un},Z.current={initial:kt,translated:At}},[se,ee,qt,At,D,Tn,kt,ie,O,sn,$n,Un]),jA({...Re,delta:j,draggingRect:At,pointerCoordinates:Is,scrollableAncestors:$n,scrollableAncestorRects:jr});const Ii=M.useMemo(()=>({active:se,activeNode:ee,activeNodeRect:Oe,activatorEvent:Te,collisions:qt,containerNodeRect:et,dragOverlay:rn,draggableNodes:D,droppableContainers:O,droppableRects:ie,over:sn,measureDroppableContainers:re,scrollableAncestors:$n,scrollableAncestorRects:jr,measuringConfiguration:K,measuringScheduled:te,windowRect:Li}),[se,ee,Oe,Te,qt,et,rn,D,O,ie,sn,re,$n,jr,K,te,Li]),Bs=M.useMemo(()=>({activatorEvent:Te,activators:zs,active:se,activeNodeRect:Oe,ariaDescribedById:{draggable:G},dispatch:S,draggableNodes:D,over:sn,measureDroppableContainers:re}),[Te,zs,se,Oe,S,G,D,sn,re]);return q.createElement(o1.Provider,{value:C},q.createElement(Ku.Provider,{value:Bs},q.createElement(k1.Provider,{value:Ii},q.createElement(Fh.Provider,{value:Ai},d)),q.createElement(iI,{disabled:l?.restoreFocus===!1})),q.createElement(lA,{...l,hiddenTextDescribedById:G}));function ji(){const at=ye?.autoScrollEnabled===!1,Wt=typeof u=="object"?u.enabled===!1:u===!1,It=P&&!at&&!Wt;return typeof u=="object"?{...u,enabled:It}:{enabled:It}}}),aI=M.createContext(null),M0="button",lI="Draggable";function uI(t){let{id:e,data:n,disabled:r=!1,attributes:i}=t;const s=Wu(lI),{activators:o,activatorEvent:l,active:u,activeNodeRect:d,ariaDescribedById:h,draggableNodes:f,over:m}=M.useContext(Ku),{role:g=M0,roleDescription:_="draggable",tabIndex:v=0}=i??{},x=u?.id===e,S=M.useContext(x?Fh:aI),[k,C]=Hd(),[R,N]=Hd(),P=GA(o,e),T=Su(n);Ar(()=>(f.set(e,{id:e,key:s,node:k,activatorNode:R,data:T}),()=>{const j=f.get(e);j&&j.key===s&&f.delete(e)}),[f,e]);const D=M.useMemo(()=>({role:g,tabIndex:v,"aria-disabled":r,"aria-pressed":x&&g===M0?!0:void 0,"aria-roledescription":_,"aria-describedby":h.draggable}),[r,g,v,x,_,h.draggable]);return{active:u,activatorEvent:l,activeNodeRect:d,attributes:D,isDragging:x,listeners:r?void 0:P,node:k,over:m,setNodeRef:C,setActivatorNodeRef:N,transform:S}}function T1(){return M.useContext(k1)}const cI="Droppable",dI={timeout:25};function P1(t){let{data:e,disabled:n=!1,id:r,resizeObserverConfig:i}=t;const s=Wu(cI),{active:o,dispatch:l,over:u,measureDroppableContainers:d}=M.useContext(Ku),h=M.useRef({disabled:n}),f=M.useRef(!1),m=M.useRef(null),g=M.useRef(null),{disabled:_,updateMeasurementsFor:v,timeout:x}={...dI,...i},S=Su(v??r),k=M.useCallback(()=>{if(!f.current){f.current=!0;return}g.current!=null&&clearTimeout(g.current),g.current=setTimeout(()=>{d(Array.isArray(S.current)?S.current:[S.current]),g.current=null},x)},[x]),C=Bh({callback:k,disabled:_||!o}),R=M.useCallback((D,j)=>{C&&(j&&(C.unobserve(j),f.current=!1),D&&C.observe(D))},[C]),[N,P]=Hd(R),T=Su(e);return M.useEffect(()=>{!C||!N.current||(C.disconnect(),f.current=!1,C.observe(N.current))},[N,C]),M.useEffect(()=>(l({type:Nt.RegisterDroppable,element:{id:r,key:s,disabled:n,node:N,rect:m,data:T}}),()=>l({type:Nt.UnregisterDroppable,key:s,id:r})),[r]),M.useEffect(()=>{n!==h.current.disabled&&(l({type:Nt.SetDroppableDisabled,id:r,key:s,disabled:n}),h.current.disabled=n)},[r,s,n,l]),{active:o,rect:m,isOver:u?.id===r,node:N,over:u,setNodeRef:P}}function hI(t){let{animation:e,children:n}=t;const[r,i]=M.useState(null),[s,o]=M.useState(null),l=qd(n);return!n&&!r&&l&&i(l),Ar(()=>{if(!s)return;const u=r?.key,d=r?.props.id;if(u==null||d==null){i(null);return}Promise.resolve(e(d,s)).then(()=>{i(null)})},[e,r,s]),q.createElement(q.Fragment,null,n,r?M.cloneElement(r,{ref:o}):null)}const fI={x:0,y:0,scaleX:1,scaleY:1};function pI(t){let{children:e}=t;return q.createElement(Ku.Provider,{value:S1},q.createElement(Fh.Provider,{value:fI},e))}const mI={position:"fixed",touchAction:"none"},gI=t=>Ih(t)?"transform 250ms ease":void 0,yI=M.forwardRef((t,e)=>{let{as:n,activatorEvent:r,adjustScale:i,children:s,className:o,rect:l,style:u,transform:d,transition:h=gI}=t;if(!l)return null;const f=i?d:{...d,scaleX:1,scaleY:1},m={...mI,width:l.width,height:l.height,top:l.top,left:l.left,transform:Gr.Transform.toString(f),transformOrigin:i&&r?uA(r,l):void 0,transition:typeof h=="function"?h(r):h,...u};return q.createElement(n,{className:o,style:m,ref:e},s)}),vI=t=>e=>{let{active:n,dragOverlay:r}=e;const i={},{styles:s,className:o}=t;if(s!=null&&s.active)for(const[l,u]of Object.entries(s.active))u!==void 0&&(i[l]=n.node.style.getPropertyValue(l),n.node.style.setProperty(l,u));if(s!=null&&s.dragOverlay)for(const[l,u]of Object.entries(s.dragOverlay))u!==void 0&&r.node.style.setProperty(l,u);return o!=null&&o.active&&n.node.classList.add(o.active),o!=null&&o.dragOverlay&&r.node.classList.add(o.dragOverlay),function(){for(const[u,d]of Object.entries(i))n.node.style.setProperty(u,d);o!=null&&o.active&&n.node.classList.remove(o.active)}},_I=t=>{let{transform:{initial:e,final:n}}=t;return[{transform:Gr.Transform.toString(e)},{transform:Gr.Transform.toString(n)}]},wI={duration:250,easing:"ease",keyframes:_I,sideEffects:vI({styles:{active:{opacity:"0"}}})};function bI(t){let{config:e,draggableNodes:n,droppableContainers:r,measuringConfiguration:i}=t;return Ah((s,o)=>{if(e===null)return;const l=n.get(s);if(!l)return;const u=l.node.current;if(!u)return;const d=x1(o);if(!d)return;const{transform:h}=En(o).getComputedStyle(o),f=h1(h);if(!f)return;const m=typeof e=="function"?e:xI(e);return _1(u,i.draggable.measure),m({active:{id:s,data:l.data,node:u,rect:i.draggable.measure(u)},draggableNodes:n,dragOverlay:{node:o,rect:i.dragOverlay.measure(d)},droppableContainers:r,measuringConfiguration:i,transform:f})})}function xI(t){const{duration:e,easing:n,sideEffects:r,keyframes:i}={...wI,...t};return s=>{let{active:o,dragOverlay:l,transform:u,...d}=s;if(!e)return;const h={x:l.rect.left-o.rect.left,y:l.rect.top-o.rect.top},f={scaleX:u.scaleX!==1?o.rect.width*u.scaleX/l.rect.width:1,scaleY:u.scaleY!==1?o.rect.height*u.scaleY/l.rect.height:1},m={x:u.x-h.x,y:u.y-h.y,...f},g=i({...d,active:o,dragOverlay:l,transform:{initial:u,final:m}}),[_]=g,v=g[g.length-1];if(JSON.stringify(_)===JSON.stringify(v))return;const x=r?.({active:o,dragOverlay:l,...d}),S=l.node.animate(g,{duration:e,easing:n,fill:"forwards"});return new Promise(k=>{S.onfinish=()=>{x?.(),k()}})}}let O0=0;function SI(t){return M.useMemo(()=>{if(t!=null)return O0++,O0},[t])}const kI=q.memo(t=>{let{adjustScale:e=!1,children:n,dropAnimation:r,style:i,transition:s,modifiers:o,wrapperElement:l="div",className:u,zIndex:d=999}=t;const{activatorEvent:h,active:f,activeNodeRect:m,containerNodeRect:g,draggableNodes:_,droppableContainers:v,dragOverlay:x,over:S,measuringConfiguration:k,scrollableAncestors:C,scrollableAncestorRects:R,windowRect:N}=T1(),P=M.useContext(Fh),T=SI(f?.id),D=C1(o,{activatorEvent:h,active:f,activeNodeRect:m,containerNodeRect:g,draggingNodeRect:x.rect,over:S,overlayNodeRect:x.rect,scrollableAncestors:C,scrollableAncestorRects:R,transform:P,windowRect:N}),j=Wy(m),O=bI({config:r,draggableNodes:_,droppableContainers:v,measuringConfiguration:k}),F=j?x.setRef:void 0;return q.createElement(pI,null,q.createElement(hI,{animation:O},f&&T?q.createElement(yI,{key:T,id:f.id,ref:F,as:l,activatorEvent:h,adjustScale:e,className:u,transition:s,rect:j,style:{zIndex:d,...i},transform:D},n):null))});function Ky(t,e,n){const r=t.slice();return r.splice(n<0?r.length+n:n,0,r.splice(e,1)[0]),r}function CI(t,e){return t.reduce((n,r,i)=>{const s=e.get(r);return s&&(n[i]=s),n},Array(t.length))}function jc(t){return t!==null&&t>=0}function EI(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function TI(t){return typeof t=="boolean"?{draggable:t,droppable:t}:t}const zc={scaleX:1,scaleY:1},PI=t=>{var e;let{rects:n,activeNodeRect:r,activeIndex:i,overIndex:s,index:o}=t;const l=(e=n[i])!=null?e:r;if(!l)return null;const u=MI(n,o,i);if(o===i){const d=n[s];return d?{x:i<s?d.left+d.width-(l.left+l.width):d.left-l.left,y:0,...zc}:null}return o>i&&o<=s?{x:-l.width-u,y:0,...zc}:o<i&&o>=s?{x:l.width+u,y:0,...zc}:{x:0,y:0,...zc}};function MI(t,e,n){const r=t[e],i=t[e-1],s=t[e+1];return!r||!i&&!s?0:n<e?i?r.left-(i.left+i.width):s.left-(r.left+r.width):s?s.left-(r.left+r.width):r.left-(i.left+i.width)}const M1=t=>{let{rects:e,activeIndex:n,overIndex:r,index:i}=t;const s=Ky(e,r,n),o=e[i],l=s[i];return!l||!o?null:{x:l.left-o.left,y:l.top-o.top,scaleX:l.width/o.width,scaleY:l.height/o.height}},Bc={scaleX:1,scaleY:1},O1=t=>{var e;let{activeIndex:n,activeNodeRect:r,index:i,rects:s,overIndex:o}=t;const l=(e=s[n])!=null?e:r;if(!l)return null;if(i===n){const d=s[o];return d?{x:0,y:n<o?d.top+d.height-(l.top+l.height):d.top-l.top,...Bc}:null}const u=OI(s,i,n);return i>n&&i<=o?{x:0,y:-l.height-u,...Bc}:i<n&&i>=o?{x:0,y:l.height+u,...Bc}:{x:0,y:0,...Bc}};function OI(t,e,n){const r=t[e],i=t[e-1],s=t[e+1];return r?n<e?i?r.top-(i.top+i.height):s?s.top-(r.top+r.height):0:s?s.top-(r.top+r.height):i?r.top-(i.top+i.height):0:0}const N1="Sortable",L1=q.createContext({activeIndex:-1,containerId:N1,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:M1,disabled:{draggable:!1,droppable:!1}});function Zy(t){let{children:e,id:n,items:r,strategy:i=M1,disabled:s=!1}=t;const{active:o,dragOverlay:l,droppableRects:u,over:d,measureDroppableContainers:h}=T1(),f=Wu(N1,n),m=l.rect!==null,g=M.useMemo(()=>r.map(P=>typeof P=="object"&&"id"in P?P.id:P),[r]),_=o!=null,v=o?g.indexOf(o.id):-1,x=d?g.indexOf(d.id):-1,S=M.useRef(g),k=!EI(g,S.current),C=x!==-1&&v===-1||k,R=TI(s);Ar(()=>{k&&_&&h(g)},[k,g,_,h]),M.useEffect(()=>{S.current=g},[g]);const N=M.useMemo(()=>({activeIndex:v,containerId:f,disabled:R,disableTransforms:C,items:g,overIndex:x,useDragOverlay:m,sortedRects:CI(g,u),strategy:i}),[v,f,R.draggable,R.droppable,C,g,x,u,m,i]);return q.createElement(L1.Provider,{value:N},e)}const NI=t=>{let{id:e,items:n,activeIndex:r,overIndex:i}=t;return Ky(n,r,i).indexOf(e)},LI=t=>{let{containerId:e,isSorting:n,wasDragging:r,index:i,items:s,newIndex:o,previousItems:l,previousContainerId:u,transition:d}=t;return!d||!r||l!==s&&i===o?!1:n?!0:o!==i&&e===u},RI={duration:200,easing:"ease"},R1="transform",DI=Gr.Transition.toString({property:R1,duration:0,easing:"linear"}),AI={roleDescription:"sortable"};function II(t){let{disabled:e,index:n,node:r,rect:i}=t;const[s,o]=M.useState(null),l=M.useRef(n);return Ar(()=>{if(!e&&n!==l.current&&r.current){const u=i.current;if(u){const d=tl(r.current,{ignoreTransform:!0}),h={x:u.left-d.left,y:u.top-d.top,scaleX:u.width/d.width,scaleY:u.height/d.height};(h.x||h.y)&&o(h)}}n!==l.current&&(l.current=n)},[e,n,r,i]),M.useEffect(()=>{s&&o(null)},[s]),s}function Qy(t){let{animateLayoutChanges:e=LI,attributes:n,disabled:r,data:i,getNewIndex:s=NI,id:o,strategy:l,resizeObserverConfig:u,transition:d=RI}=t;const{items:h,containerId:f,activeIndex:m,disabled:g,disableTransforms:_,sortedRects:v,overIndex:x,useDragOverlay:S,strategy:k}=M.useContext(L1),C=jI(r,g),R=h.indexOf(o),N=M.useMemo(()=>({sortable:{containerId:f,index:R,items:h},...i}),[f,i,R,h]),P=M.useMemo(()=>h.slice(h.indexOf(o)),[h,o]),{rect:T,node:D,isOver:j,setNodeRef:O}=P1({id:o,data:N,disabled:C.droppable,resizeObserverConfig:{updateMeasurementsFor:P,...u}}),{active:F,activatorEvent:Z,activeNodeRect:se,attributes:oe,setNodeRef:ye,listeners:ue,isDragging:Te,over:H,setActivatorNodeRef:ne,transform:G}=uI({id:o,data:N,attributes:{...AI,...n},disabled:C.draggable}),$=QD(O,ye),K=!!F,ie=K&&!_&&jc(m)&&jc(x),re=!S&&Te,te=re&&ie?G:null,Se=ie?te??(l??k)({rects:v,activeNodeRect:se,activeIndex:m,overIndex:x,index:R}):null,Re=jc(m)&&jc(x)?s({id:o,items:h,activeIndex:m,overIndex:x}):R,Ce=F?.id,Oe=M.useRef({activeId:Ce,items:h,newIndex:Re,containerId:f}),et=h!==Oe.current.items,De=e({active:F,containerId:f,isDragging:Te,isSorting:K,id:o,index:R,items:h,newIndex:Oe.current.newIndex,previousItems:Oe.current.items,previousContainerId:Oe.current.containerId,transition:d,wasDragging:Oe.current.activeId!=null}),gt=II({disabled:!De,index:R,node:D,rect:T});return M.useEffect(()=>{K&&Oe.current.newIndex!==Re&&(Oe.current.newIndex=Re),f!==Oe.current.containerId&&(Oe.current.containerId=f),h!==Oe.current.items&&(Oe.current.items=h)},[K,Re,f,h]),M.useEffect(()=>{if(Ce===Oe.current.activeId)return;if(Ce!=null&&Oe.current.activeId==null){Oe.current.activeId=Ce;return}const Tn=setTimeout(()=>{Oe.current.activeId=Ce},50);return()=>clearTimeout(Tn)},[Ce]),{active:F,activeIndex:m,attributes:oe,data:N,rect:T,index:R,newIndex:Re,items:h,isOver:j,isSorting:K,isDragging:Te,listeners:ue,node:D,overIndex:x,over:H,setNodeRef:$,setActivatorNodeRef:ne,setDroppableNodeRef:O,setDraggableNodeRef:ye,transform:gt??Se,transition:rn()};function rn(){if(gt||et&&Oe.current.newIndex===R)return DI;if(!(re&&!Ih(Z)||!d)&&(K||De))return Gr.Transition.toString({...d,property:R1})}}function jI(t,e){var n,r;return typeof t=="boolean"?{draggable:t,droppable:!1}:{draggable:(n=t?.draggable)!=null?n:e.draggable,droppable:(r=t?.droppable)!=null?r:e.droppable}}function Qd(t){if(!t)return!1;const e=t.data.current;return!!(e&&"sortable"in e&&typeof e.sortable=="object"&&"containerId"in e.sortable&&"items"in e.sortable&&"index"in e.sortable)}const zI=[Ue.Down,Ue.Right,Ue.Up,Ue.Left],BI=(t,e)=>{let{context:{active:n,collisionRect:r,droppableRects:i,droppableContainers:s,over:o,scrollableAncestors:l}}=e;if(zI.includes(t.code)){if(t.preventDefault(),!n||!r)return;const u=[];s.getEnabled().forEach(f=>{if(!f||f!=null&&f.disabled)return;const m=i.get(f.id);if(m)switch(t.code){case Ue.Down:r.top<m.top&&u.push(f);break;case Ue.Up:r.top>m.top&&u.push(f);break;case Ue.Left:r.left>m.left&&u.push(f);break;case Ue.Right:r.left<m.left&&u.push(f);break}});const d=dA({collisionRect:r,droppableRects:i,droppableContainers:u});let h=c1(d,"id");if(h===o?.id&&d.length>1&&(h=d[1].id),h!=null){const f=s.get(n.id),m=s.get(h),g=m?i.get(m.id):null,_=m?.node.current;if(_&&g&&f&&m){const x=jh(_).some((P,T)=>l[T]!==P),S=D1(f,m),k=FI(f,m),C=x||!S?{x:0,y:0}:{x:k?r.width-g.width:0,y:k?r.height-g.height:0},R={x:g.left,y:g.top};return C.x&&C.y?R:ku(R,C)}}}};function D1(t,e){return!Qd(t)||!Qd(e)?!1:t.data.current.sortable.containerId===e.data.current.sortable.containerId}function FI(t,e){return!Qd(t)||!Qd(e)||!D1(t,e)?!1:t.data.current.sortable.index<e.data.current.sortable.index}function $I(){const{boardId:t}=Io(),e=Ns(),n=Th(),r=nn(),[i,s]=q.useState(()=>{try{return localStorage.getItem("sidebarCollapsed")==="1"}catch{return!1}});q.useEffect(()=>{try{localStorage.setItem("sidebarCollapsed",i?"1":"0")}catch{}const v=i?40:224;document.documentElement.style.setProperty("--sidebar-w",v+"px")},[i]);const[o,l]=q.useState(!1),u=St({queryKey:["boards"],queryFn:()=>Ni("2a8f10d6-4368-43db-ab1d-ab783ec6e935")}),[d,h]=q.useState(null);q.useEffect(()=>{if(!u.data)return;const v="sidebar.boardOrder",x=["New Leads","Quoted","Nurture Leads","Dealer Orders","Engineering","Permitting","Order Confirmation","Manufacturing & Delivery","Archive","Lost Leads"];try{const C=localStorage.getItem(v);if(C){const R=JSON.parse(C),N=new Map(u.data.map(T=>[String(T.id),T])),P=R.map(T=>N.get(T)).filter(Boolean);for(const T of u.data)R.includes(String(T.id))||P.push(T);h(P);return}}catch{}const S=new Map(u.data.map(C=>[C.name,C])),k=[];for(const C of x){const R=S.get(C);R&&(k.push(R),S.delete(C))}for(const C of S.values())k.push(C);h(k)},[u.data]);const f=a1(Qm(zh,{activationConstraint:{distance:6}}),Qm(Hy,{coordinateGetter:BI})),m=q.useCallback(async v=>{h(v);const x=v.map(C=>String(C.id));try{localStorage.setItem("sidebar.boardOrder",JSON.stringify(x))}catch{}const S=v[0]?.workspace_id,k=v.every(C=>String(C.workspace_id)===String(S));if(S&&k)try{console.log("Board reorder requested but not persisted:",x)}catch(C){console.warn("Board reorder persistence failed:",C)}r.invalidateQueries({queryKey:["myBoards"]})},[r]);function g(v){const{active:x,over:S}=v;if(!S||x.id===S.id||!d)return;const k=d.findIndex(N=>String(N.id)===String(x.id)),C=d.findIndex(N=>String(N.id)===String(S.id));if(k<0||C<0)return;const R=Ky(d,k,C);m(R)}const _=({to:v,label:x,icon:S})=>{const k=e.pathname===v;return w.jsxs(Ph,{to:v,className:"flex items-center gap-2 px-3 py-2 rounded-md text-sm "+(k?"bg-accent/15 text-accent":"text-fg-subtle hover:text-fg hover:bg-bg-inset"),title:x,children:[S,!i&&w.jsx("span",{children:x})]})};return w.jsxs(w.Fragment,{children:[o&&w.jsx("div",{className:"fixed inset-0 bg-black/50 z-20 lg:hidden",onClick:()=>l(!1)}),w.jsx("button",{className:"fixed top-4 left-4 z-40 lg:hidden w-10 h-10 flex items-center justify-center rounded-md bg-surface border border-app/60 shadow-sm",onClick:()=>l(!o),"aria-label":"Toggle sidebar",children:w.jsx(Ot,{name:o?"x":"menu",size:20})}),w.jsxs("aside",{className:`fixed top-0 left-0 h-screen z-30 bg-surface border-r border-app/60 shadow-sm flex flex-col transition-transform duration-300 ease-in-out ${o?"translate-x-0":"-translate-x-full"} lg:translate-x-0`,style:{width:"var(--sidebar-w, 224px)"},children:[w.jsxs("div",{className:"h-12 flex items-center justify-between px-2",children:[!i&&w.jsx("div",{className:"px-2 font-semibold",children:"Navigation"}),w.jsx("button",{className:"w-8 h-8 grid place-items-center text-fg-subtle hover:text-fg","aria-label":i?"Expand sidebar":"Collapse sidebar",onClick:()=>s(v=>!v),children:w.jsx("div",{className:i?"":"rotate-180",children:w.jsx(Ot,{name:"arrow-right"})})})]}),w.jsxs("div",{className:"px-2 py-2 space-y-1 overflow-y-auto flex-1",children:[w.jsx(_,{to:"/",label:"Home"}),w.jsxs("div",{className:"mt-2",children:[!i&&w.jsx("div",{className:"px-2 text-xs uppercase tracking-wide text-fg-muted mb-1",children:"Boards"}),w.jsxs("div",{className:"flex flex-col gap-1",children:[u.isLoading&&w.jsx("div",{className:"px-3 py-2 text-fg-muted text-sm",children:"Loading"}),!!d&&d.length>0&&w.jsx(E1,{sensors:f,onDragEnd:g,children:w.jsx(Zy,{items:d.map(v=>String(v.id)),strategy:O1,children:d.map(v=>w.jsx(UI,{id:String(v.id),board:v,collapsed:i,to:`/b/${v.id}/board`,label:String(v.name),allBoards:d||[],onArchive:async()=>{try{await ZD(v.id);const x=(d??[]).filter(S=>String(S.id)!==String(v.id));await m(x),r.invalidateQueries({queryKey:["myBoards"]}),t===String(v.id)&&n("/")}catch(x){console.error(x),alert("Failed to archive board. Check console for details.")}}},String(v.id)))})}),u.data&&u.data.length===0&&w.jsx("div",{className:"px-3 py-2 text-fg-muted text-sm",children:"No boards"})]})]})]}),w.jsx("div",{className:"p-2 border-t border-app/60",children:w.jsxs("div",{className:"flex gap-2",children:[w.jsxs("button",{className:"flex-1 h-9 inline-flex items-center justify-center gap-2 rounded-md bg-accent/10 text-accent hover:bg-accent/15",onClick:async()=>{try{const v=d?.[0]?.workspace_id;if(!v){alert("No workspace detected. Create a workspace first via seed or UI.");return}const x=prompt("New board name?")?.trim();if(!x)return;console.log("Creating board with workspace ID:",v,"and name:",x);const S=await qD(v,x);console.log("Board created successfully:",S);const k=[...d??[]];k.push(S),await m(k),r.invalidateQueries({queryKey:["myBoards"]});try{n(`/b/${S.id}/board`)}catch{}}catch(v){console.error("Board creation failed:",v);const x=v instanceof Error?v.message:String(v);x.includes("Host validation failed")||x.includes("Host is not supported")?alert("Supabase host validation error. Please add localhost:5174 to your Supabase project's allowed origins in the Authentication settings."):alert(`Failed to create board: ${x}`)}},"aria-label":"Create board",title:"Create board",children:[w.jsx(Ot,{name:"plus"}),!i&&w.jsx("span",{children:"New Board"})]}),w.jsx("button",{className:"w-9 h-9 inline-flex items-center justify-center rounded-md text-danger hover:bg-danger/10",onClick:async()=>{try{const v=t;if(!v){alert("Open a board to delete it, or select a board in the list first.");return}if(d?.find(C=>String(C.id)===String(v))?.name!=="Archive"){alert("Only Archive boards can be permanently deleted. Use Archive from the context menu to archive this board instead.");return}if(!confirm("Delete this Archive board and all its lists/cards permanently? This cannot be undone."))return;await KD(v);const k=(d??[]).filter(C=>String(C.id)!==String(v));await m(k),r.invalidateQueries({queryKey:["myBoards"]});try{n("/")}catch{}}catch(v){console.error(v),alert("Failed to delete board. It might be protected by RLS or missing permissions.")}},"aria-label":"Delete current board",title:"Delete current board (Archive boards only)",children:w.jsx(Ot,{name:"trash"})})]})})]})]})}function UI({id:t,to:e,label:n,collapsed:r,board:i,onArchive:s,allBoards:o}){const{attributes:l,listeners:u,setNodeRef:d,transform:h,transition:f,isDragging:m}=Qy({id:t}),[g,_]=q.useState(null),[v,x]=q.useState(!1),[S,k]=q.useState(n),C=q.useRef(null),R=q.useRef(null),N=nn();q.useEffect(()=>{v&&R.current&&(R.current.focus(),R.current.select())},[v]),q.useEffect(()=>{if(!g)return;const O=F=>{const Z=C.current;if(!Z)return _(null);Z.contains(F.target)||_(null)};return document.addEventListener("mousedown",O),()=>document.removeEventListener("mousedown",O)},[g]);const P=async()=>{if(!S.trim()||S===n){x(!1),k(n);return}try{await WD(i.id,{name:S.trim()}),N.invalidateQueries({queryKey:["boards"]}),x(!1)}catch(O){console.error("Failed to rename board:",O),alert("Failed to rename board"),k(n),x(!1)}},T={transform:Gr.Transform.toString(h),transition:f,opacity:m?.5:1},j=Ns().pathname===e;return w.jsxs("div",{ref:O=>{d(O),C.current=O},style:T,...l,className:"relative",children:[w.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-md text-sm group "+(j?"bg-accent/15 text-accent":"text-fg-subtle hover:text-fg hover:bg-bg-inset"),title:n,...u,children:[w.jsx(Ot,{name:"board",size:16}),!r&&(v?w.jsx("input",{ref:R,type:"text",value:S,onChange:O=>k(O.target.value),onBlur:P,onKeyDown:O=>{O.key==="Enter"&&(O.preventDefault(),P()),O.key==="Escape"&&(O.preventDefault(),x(!1),k(n))},className:"bg-bg-inset border border-border rounded px-2 py-1 text-sm flex-1 min-w-0",onClick:O=>O.stopPropagation(),onMouseDown:O=>O.stopPropagation(),autoFocus:!0}):w.jsxs(w.Fragment,{children:[w.jsx(Ph,{to:e,className:"flex-1 min-w-0",onDoubleClick:O=>{O.preventDefault(),O.stopPropagation(),x(!0)},children:w.jsx("span",{className:"truncate block",children:n})}),w.jsx("button",{className:"opacity-0 group-hover:opacity-100 w-6 h-6 flex items-center justify-center rounded hover:bg-bg-inset/50 transition-opacity",onClick:O=>{O.preventDefault(),O.stopPropagation(),O.currentTarget.getBoundingClientRect(),_({x:-160,y:0})},title:"Board options",children:w.jsx(Ot,{name:"more",size:14})})]}))]}),g&&w.jsxs("div",{className:"absolute z-50 bg-bg-card text-fg border border-border rounded-md shadow-lg text-sm",style:{right:10,top:g.y,minWidth:160},onClick:O=>O.stopPropagation(),children:[w.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-bg-inset",onClick:()=>{x(!0),_(null)},children:"Rename board"}),w.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-bg-inset",onClick:()=>{const O=o.find(F=>F.name==="Archive");O?window.location.href=`/b/${O.id}/board`:alert("Archive board not found. Please create an Archive board first."),_(null)},children:"Go to Archive"}),i.name!=="Archive"&&w.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-bg-inset text-red-500",onClick:async()=>{await s(),_(null)},children:"Archive board"})]})]})}function VI(t){const e=document.documentElement;t==="dark"?e.classList.add("dark"):e.classList.remove("dark")}function HI(){const t=localStorage.getItem("tryed-theme");return t==="light"||t==="dark"?t:window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function A1(){const[t,e]=M.useState(!1),[n,r]=M.useState(()=>HI());return M.useEffect(()=>{VI(n),localStorage.setItem("tryed-theme",n)},[n]),w.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:w.jsxs("div",{className:"relative",children:[w.jsx("button",{onClick:()=>e(i=>!i),"aria-label":"Theme",className:"h-10 w-10 rounded-full bg-neutral-900 border border-neutral-800 text-neutral-200 flex items-center justify-center shadow-lg hover:bg-neutral-800",title:"Theme",children:n==="dark"?"":""}),t&&w.jsxs("div",{className:"absolute bottom-12 right-0 w-40 rounded-md border border-neutral-700 bg-neutral-900 text-neutral-200 shadow-xl p-2",children:[w.jsx("div",{className:"text-xs text-neutral-400 px-2 pb-1",children:"Appearance"}),w.jsx("button",{onClick:()=>{r("light"),e(!1)},className:`w-full text-left px-2 py-1 rounded hover:bg-neutral-800 ${n==="light"?"bg-neutral-800":""}`,children:"Light"}),w.jsx("button",{onClick:()=>{r("dark"),e(!1)},className:`mt-1 w-full text-left px-2 py-1 rounded hover:bg-neutral-800 ${n==="dark"?"bg-neutral-800":""}`,children:"Dark"})]})]})})}const qI=({isOpen:t,onClose:e})=>t?w.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",children:w.jsxs("div",{className:"bg-background text-foreground border border-border rounded-lg shadow-xl w-full max-w-md",children:[w.jsx("div",{className:"p-4 border-b border-border",children:w.jsx("h2",{className:"text-base font-semibold",children:"Move List"})}),w.jsxs("div",{className:"p-4 space-y-4",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm mb-1",children:"List"}),w.jsx("select",{className:"w-full px-2 py-2 rounded border border-input bg-background",disabled:!0,children:w.jsx("option",{children:"Feature wiring pending"})})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm mb-1",children:"Target board"}),w.jsx("select",{className:"w-full px-2 py-2 rounded border border-input bg-background",disabled:!0,children:w.jsx("option",{children:"Feature wiring pending"})})]}),w.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[w.jsx("input",{type:"checkbox",className:"rounded",disabled:!0}),"Move cards with the list"]})]}),w.jsx("div",{className:"p-4 border-t border-border flex justify-end gap-2",children:w.jsx("button",{onClick:e,className:"px-3 py-2 rounded hover:bg-muted",children:"Close"})})]})}):null;function WI(){const[t,e]=q.useState(!1);return w.jsxs("div",{className:"min-h-screen bg-app text-app",children:[w.jsx($I,{}),w.jsxs("div",{className:"lg:pl-[var(--sidebar-w,224px)] pl-0",children:[w.jsx(CN,{}),w.jsx(A1,{})]}),w.jsx(qI,{isOpen:t,onClose:()=>e(!1),onSuccess:()=>{}})]})}async function wr(t,e,n){try{const r=be(),i=await r.auth.getUser();await r.from("activity").insert({card_id:t,type:e,meta:n||{},actor_id:i.data.user?.id})}catch(r){console.warn("Failed to log activity:",r)}}async function KI(t,e,n){e.trim()!==n.trim()&&await wr(t,"update.title",{from:e,to:n})}async function I1(t){await wr(t,"update.description")}async function j1(t,e,n,r,i){(e!==n||r!==i)&&await wr(t,"update.dates",{fromStart:e,toStart:n,fromEnd:r,toEnd:i})}async function ZI(t,e,n,r,i,s,o){(e!==n||r!==i||s!==o)&&await wr(t,"update.location",{fromAddress:e,toAddress:n,fromLat:r,toLat:i,fromLng:s,toLng:o})}async function eg(t,e,n,r){await wr(t,"move.list",{fromListId:e,toListId:n,fromListName:e,toListName:n})}async function tg(t,e,n,r,i,s){await wr(t,"move.board",{fromBoardId:e,toBoardId:n,fromListId:r,toListId:i,fromBoardName:e,toBoardName:n})}async function Gd(t,e,n,r,i){await wr(t,e==="add"?"label.add":"label.remove",{labelId:n,labelName:r,labelColor:i})}async function QI(t,e,n,r,i,s,o){await wr(t,e==="add"?"attachment.add":e==="remove"?"attachment.remove":"attachment.rename",{attachmentId:r,name:n,url:i,size:s,from:o,to:e==="rename"?n:void 0})}async function GI(t,e,n,r){await wr(t,e==="add"?"checklist.add":"checklist.remove",{checklistId:n,checklistTitle:r})}async function JI(t,e,n,r,i,s){await wr(t,e==="add"?"checklist.item.add":e==="remove"?"checklist.item.remove":e==="toggle"?"checklist.item.toggle":"checklist.item.update",{itemId:n,text:r,done:i,checklistId:s})}async function ld(t,e){await wr(t,e==="archive"?"card.archive":e==="restore"?"card.restore":"card.delete")}const Xs=Object.freeze(Object.defineProperty({__proto__:null,logAttachmentOperation:QI,logBoardMove:tg,logCardActivity:wr,logCardMove:eg,logCardStateChange:ld,logChecklistItemOperation:JI,logChecklistOperation:GI,logDateUpdate:j1,logDescriptionUpdate:I1,logLabelOperation:Gd,logLocationUpdate:ZI,logTitleUpdate:KI},Symbol.toStringTag,{value:"Module"})),Pa=t=>{if(t?.code==="42703"||t?.code==="PGRST204"||t?.code==="PGRST205")return!0;const e=(t?.message||"").toLowerCase();return e.includes("column")&&e.includes("location_")};async function z1(t){const e=be(),{data:n}=await e.from("cards").select("board_id, list_id").eq("id",t.cardId).single(),r=n?.board_id,i=n?.list_id;try{const{error:s}=await e.rpc("move_card",{p_card_id:t.cardId,p_to_board:t.toBoardId,p_to_list:t.toListId,p_position:t.position});if(s)throw s;r!==t.toBoardId?await tg(t.cardId,r,t.toBoardId,i,t.toListId):i!==t.toListId&&await eg(t.cardId,i,t.toListId)}catch(s){if(s.code==="42501"||s.message?.includes("row-level security")){console.warn("RPC move_card failed due to RLS, falling back to direct update");const{error:o}=await e.from("cards").update({board_id:t.toBoardId,list_id:t.toListId,position:t.position,updated_at:new Date().toISOString()}).eq("id",t.cardId);if(o)throw o;r!==t.toBoardId?await tg(t.cardId,r,t.toBoardId,i,t.toListId):i!==t.toListId&&await eg(t.cardId,i,t.toListId);return}throw s}}async function Gy(t){const e=be(),r=await e.from("cards").select(`
    id, workspace_id, board_id, list_id, title, description, date_start, date_end, position, created_by, created_at, updated_at,
    card_field_values:card_field_values(field_id, value, custom_field_defs:custom_field_defs(name)),
    card_labels:card_labels(label_id, labels:labels(id, name, color)),
    attachments:attachments(id, mime, url, created_at),
    comments:comments(id, author_id, created_at),
    checklists:checklists(id, checklist_items:checklist_items(id, done))
  `).eq("board_id",t).order("position",{ascending:!0});if(r.error)throw r.error;const i=r.data??[],s=await e.from("cards").select("id, location_lat, location_lng, location_address").eq("board_id",t);if(!s.error&&Array.isArray(s.data)){const o=new Map;for(const l of s.data)o.set(l.id,l);for(const l of i){const u=o.get(l.id);u&&(l.location_lat=u.location_lat,l.location_lng=u.location_lng,l.location_address=u.location_address)}}else if(s.error&&!Pa(s.error))throw s.error;return i}async function ng(t){const e=be(),n=`
    id, workspace_id, board_id, list_id, title, description, date_start, date_end, position, created_by, created_at, updated_at,
    card_field_values:card_field_values(field_id, value, custom_field_defs:custom_field_defs(name)),
    card_labels:card_labels(label_id, labels:labels(id, name, color)),
    attachments:attachments(id, mime, url, created_at),
    comments:comments(id, author_id, created_at),
    checklists:checklists(id, checklist_items:checklist_items(id, done)),
    boards:boards(name)
  `,{data:r,error:i}=await e.from("cards").select(n).eq("workspace_id",t).not("date_start","is",null).not("date_end","is",null).order("date_start",{ascending:!0});if(i)throw i;return r??[]}async function B1(t,e,n){const r=be(),{error:i}=await r.from("cards").update({date_start:e||null,date_end:n||null}).eq("id",t);if(i)throw i}async function F1(t){const e=be(),{error:n}=await e.from("cards").update({list_id:t.listId,position:t.position}).eq("id",t.cardId);if(n)throw n}async function $1(t,e="New card"){const n=be(),{data:r}=await n.auth.getSession(),i=r.session?.user.id;if(!i)throw new Error("Not signed in");const{data:s,error:o}=await n.from("boards").select("id, workspace_id").eq("id",t).maybeSingle();if(o)throw o;if(!s)throw new Error("Board not found");let{data:l,error:u}=await n.from("lists").select("id, position").eq("board_id",t).order("position",{ascending:!0}).limit(1).maybeSingle();if(u&&u.code!=="PGRST116")throw u;if(!l){const{data:_,error:v}=await n.from("lists").insert({board_id:t,name:"Backlog",position:1}).select("id, position").single();if(v)throw v;l=_}const{data:d,error:h}=await n.from("cards").select("position").eq("list_id",l.id).order("position",{ascending:!1}).limit(1).maybeSingle();if(h&&h.code!=="PGRST116")throw h;const f=(d?.position??0)+1,{data:m,error:g}=await n.from("cards").insert({workspace_id:s.workspace_id,board_id:t,list_id:l.id,title:e,description:null,date_start:null,date_end:null,position:f,created_by:i}).select("id").single();if(g)throw g;return{id:m.id}}async function YI(t){const e=be(),{error:n}=await e.from("cards").delete().eq("id",t);if(n)throw n}async function U1(t){const e=be(),{data:n,error:r}=await e.from("cards").select("workspace_id").eq("id",t).maybeSingle();if(r)throw r;if(!n)throw new Error("Card not found");const i=n.workspace_id;let{data:s,error:o}=await e.from("boards").select("id").eq("workspace_id",i).eq("name","Archive").maybeSingle();if(o&&o.code!=="PGRST116")throw o;if(!s){const{data:g,error:_}=await e.from("boards").insert({workspace_id:i,name:"Archive"}).select("id").single();if(_)throw _;s=g}let{data:l,error:u}=await e.from("lists").select("id").eq("board_id",s.id).eq("name","Archived").maybeSingle();if(u&&u.code!=="PGRST116")throw u;if(!l){const{data:g,error:_}=await e.from("lists").insert({board_id:s.id,name:"Archived",position:1}).select("id").single();if(_)throw _;l=g}const{data:d,error:h}=await e.from("cards").select("position").eq("list_id",l.id).order("position",{ascending:!1}).limit(1).maybeSingle();if(h&&h.code!=="PGRST116")throw h;const f=(d?.position??0)+1,{error:m}=await e.from("cards").update({board_id:s.id,list_id:l.id,position:f}).eq("id",t);if(m)throw m}async function V1(t,e){console.log("updateCardLocation called with:",{cardId:t,args:e});const n=be();let r=null;try{const{data:s}=await n.from("cards").select("location_lat, location_lng, location_address").eq("id",t).maybeSingle();r=s}catch(s){if(Pa(s))return console.warn("Location columns not available for activity logging - migration needed"),{skippedDueToMissingColumns:!0}}const i={};if(typeof e.lat<"u"&&(i.location_lat=e.lat),typeof e.lng<"u"&&(i.location_lng=e.lng),typeof e.address<"u"&&(i.location_address=e.address),Object.keys(i).length>0&&(i.updated_at=new Date().toISOString()),console.log("updateCardLocation payload:",i),Object.keys(i).length===0){console.log("updateCardLocation: Empty payload, skipping");return}try{const{data:s,error:o}=await n.from("cards").update(i).eq("id",t).select("id, location_lat, location_lng, location_address").maybeSingle();if(o){if(console.error("updateCardLocation error:",o),Pa(o))return console.warn("Location columns not found in DB. Apply schema and refresh."),{skippedDueToMissingColumns:!0};throw o}if(r)try{const{logLocationUpdate:l}=await yn(async()=>{const{logLocationUpdate:u}=await Promise.resolve().then(()=>Xs);return{logLocationUpdate:u}},void 0);await l(t,r?.location_address,e.address??null,r?.location_lat,e.lat??null,r?.location_lng,e.lng??null)}catch(l){console.warn("Failed to log location activity:",l)}console.log("updateCardLocation: Success",s)}catch(s){if(Pa(s))return console.warn("Location columns missing, skipping location update"),{skippedDueToMissingColumns:!0};throw s}}async function Jy(t){const e=be();try{const{data:n,error:r}=await e.from("cards").select("id, title, location_lat, location_lng").eq("board_id",t).not("location_lat","is",null).not("location_lng","is",null);if(r){if(Pa(r))return console.warn("Location columns not found in database. Please run location migration."),[];throw r}return(n||[]).filter(i=>typeof i.location_lat=="number"&&typeof i.location_lng=="number").map(i=>({id:i.id,title:i.title,lat:i.location_lat,lng:i.location_lng}))}catch(n){return Pa(n)?(console.warn("Location columns not available:",n.message),[]):(console.error("getBoardLocations error:",n),[])}}const rg=Object.freeze(Object.defineProperty({__proto__:null,archiveCard:U1,createCardInBoard:$1,deleteCard:YI,getBoardLocations:Jy,getCardsByBoard:Gy,getCardsWithDates:ng,moveCard:z1,updateCardDates:B1,updateCardLocation:V1,updateCardPosition:F1},Symbol.toStringTag,{value:"Module"}));async function XI(t){const e=be(),{data:n,error:r}=await e.from("lists").select("id, board_id, name, position").eq("board_id",t).order("position",{ascending:!0});if(r)throw r;return n??[]}async function ej(t,e){const n=be(),{error:r}=await n.from("lists").update({name:e}).eq("id",t);if(r)throw r}async function tj(t,e="New List"){const n=be(),{data:r,error:i}=await n.from("lists").select("position").eq("board_id",t).order("position",{ascending:!1}).limit(1).maybeSingle();if(i&&i.code!=="PGRST116")throw i;const s=(r?.position??0)+1,{data:o,error:l}=await n.from("lists").insert({board_id:t,name:e,position:s}).select("id").single();if(l)throw l;return o}async function nj(t){const e=be(),{error:n}=await e.from("lists").delete().eq("id",t);if(n)throw n}async function rj(t){const e=be(),{data:n,error:r}=await e.from("lists").select("id, board_id, boards:boards(id, workspace_id)").eq("id",t).maybeSingle();if(r)throw r;if(!n)throw new Error("List not found");n.board_id;const i=n.boards?.workspace_id;let{data:s,error:o}=await e.from("boards").select("id").eq("workspace_id",i).eq("name","Archive").maybeSingle();if(o&&o.code!=="PGRST116")throw o;if(!s){const{data:v,error:x}=await e.from("boards").insert({workspace_id:i,name:"Archive"}).select("id").single();if(x)throw x;s=v}let{data:l,error:u}=await e.from("lists").select("id, position").eq("board_id",s.id).eq("name","Archived").maybeSingle();if(u&&u.code!=="PGRST116")throw u;if(!l){const{data:v,error:x}=await e.from("lists").insert({board_id:s.id,name:"Archived",position:1}).select("id, position").single();if(x)throw x;l=v}const{data:d,error:h}=await e.from("cards").select("position").eq("list_id",l.id).order("position",{ascending:!1}).limit(1).maybeSingle();if(h&&h.code!=="PGRST116")throw h;let f=(d?.position??0)+1;const{data:m,error:g}=await e.from("cards").select("id").eq("list_id",t);if(g)throw g;for(const v of m||[]){const{error:x}=await e.from("cards").update({board_id:s.id,list_id:l.id,position:f++}).eq("id",v.id);if(x)throw x}const{error:_}=await e.from("lists").delete().eq("id",t);if(_)throw _}async function ij(t,e){const n=be(),{data:r,error:i}=await n.from("lists").select("position").eq("board_id",e).order("position",{ascending:!1}).limit(1).maybeSingle();if(i&&i.code!=="PGRST116")throw i;const s=(r?.position??0)+1,{error:o}=await n.from("lists").update({board_id:e,position:s}).eq("id",t);if(o)throw o;const{error:l}=await n.from("cards").update({board_id:e}).eq("list_id",t);if(l)throw l}function ig({boardId:t}){const e=Ns(),[n,r]=q.useState(!1),s=St({queryKey:["boards"],queryFn:()=>Ni("2a8f10d6-4368-43db-ab1d-ab783ec6e935"),retry:1}).data?.find(g=>g.id===t)?.workspace_id||"2a8f10d6-4368-43db-ab1d-ab783ec6e935",o=[{key:"board",name:"Board",icon:"board",to:`/b/${t}/board`},{key:"calendar",name:"Calendar",icon:"calendar",to:`/b/${t}/calendar`},{key:"master-calendar",name:"Master Calendar",icon:"calendar-stack",to:`/w/${s}/calendar`},{key:"dashboard",name:"Dashboard",icon:"dashboard",to:`/b/${t}/dashboard`},{key:"map",name:"Map",icon:"map",to:`/b/${t}/map`}],l=g=>e.pathname===g,u=88,d=210,h=330,f=o.length>1?o.length-1:1,m=g=>(d+(h-d)*(g/f))*(Math.PI/180);return w.jsx("div",{className:"fixed bottom-4 md:bottom-6 left-1/2 -translate-x-1/2 z-30 select-none",children:w.jsxs("div",{className:"relative w-[0px] h-[0px]",children:[o.map((g,_)=>{const v=m(_),x=Math.cos(v)*u,S=Math.sin(v)*u,k=n?{transform:`translate(${x}px, ${S}px)`}:{transform:"translate(0px, 0px)"},C=`absolute -translate-x-1/2 -translate-y-1/2 transition-transform duration-200 ease-out ${n?"opacity-100":"opacity-0 pointer-events-none"}`;return w.jsx(Ph,{to:g.to,title:g.name,className:`${C} w-9 md:w-10 h-9 md:h-10 flex items-center justify-center rounded-full text-base md:text-lg shadow border will-change-transform hover:scale-110 ${l(g.to)?"bg-accent/20 text-accent border-accent/40":"bg-surface-2 hover:bg-surface-3 border-app text-muted hover:text-app"}`,style:k,onClick:()=>r(!1),children:w.jsx(Ot,{name:g.icon,size:16})},g.key)}),w.jsx("button",{className:"absolute left-0 top-0 -translate-x-1/2 -translate-y-1/2 w-10 md:w-12 h-10 md:h-12 rounded-full bg-accent text-white shadow-lg hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-accent/60 text-lg md:text-xl",onClick:()=>r(g=>!g),"aria-label":n?"Close view switcher":"Open view switcher",children:n?"":""})]})})}function $h(){const t=Ns(),e=Io(),n=nn(),r=/^\/b\/.+\/(board|table|calendar|dashboard|map)$/.test(t.pathname),i=e.boardId,s=async()=>{if(i)try{await $1(i,"New card"),await n.invalidateQueries({queryKey:["cards",i]})}catch(l){console.error("Failed to create card",l),alert("Failed to create card. Check console for details.")}},o=async()=>{if(i)try{await tj(i,"New List"),await n.invalidateQueries({queryKey:["lists",i]})}catch(l){console.error("Failed to create list",l),alert("Failed to create list. Check console for details.")}};return w.jsxs("div",{className:"h-12 bg-surface border-b border-app flex items-center px-4 gap-3",children:[w.jsx("div",{className:"lg:hidden w-10"})," ",w.jsx(Ph,{to:"/",className:"font-semibold accent",children:"tryed"}),w.jsx("div",{className:"ml-auto flex items-center gap-2 md:gap-3",children:r&&w.jsxs(w.Fragment,{children:[w.jsxs("button",{onClick:s,className:"px-2 md:px-3 py-1.5 rounded-md bg-accent text-white text-xs md:text-sm hover:opacity-90",title:"Create a new card in this board",children:[w.jsx("span",{className:"hidden md:inline",children:"New Card"}),w.jsx("span",{className:"md:hidden",children:"Card"})]}),w.jsxs("button",{onClick:o,className:"px-2 md:px-3 py-1.5 rounded-md bg-accent/90 text-white text-xs md:text-sm hover:opacity-90",title:"Create a new list in this board",children:[w.jsx("span",{className:"hidden md:inline",children:"New List"}),w.jsx("span",{className:"md:hidden",children:"List"})]})]})}),r&&i?w.jsx(ig,{boardId:i}):null]})}function sj(){const t=Th(),{workspaceId:e}=Io(),n=St({queryKey:["boards",e],queryFn:()=>Ni(String(e)),enabled:!!e});return e?w.jsx("div",{className:"flex gap-2",children:(n.data??[]).map(r=>w.jsx("button",{className:"px-3 py-1 rounded bg-surface-2 hover:bg-surface border border-app",onClick:()=>t(`/b/${r.id}/board`),children:r.name},r.id))}):null}function oj(){return w.jsxs("div",{className:"min-h-screen bg-app text-app",children:[w.jsx($h,{}),w.jsxs("div",{className:"p-4",children:[w.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"Workspace"}),w.jsx(sj,{}),w.jsx("div",{className:"mt-6 text-muted",children:"TODO: Views and workspace content"})]})]})}function aj(){const t=Th(),e=St({queryKey:["my-boards"],queryFn:()=>Ni("2a8f10d6-4368-43db-ab1d-ab783ec6e935")});return w.jsxs("div",{className:"min-h-screen bg-app text-app",children:[w.jsx($h,{}),w.jsxs("div",{className:"p-6",children:[w.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"Your boards"}),e.isLoading?w.jsx("div",{className:"text-muted",children:"Loading"}):e.error?w.jsx("div",{className:"text-red-500",children:"Failed to load boards."}):w.jsx("div",{className:"flex gap-3 flex-wrap",children:(e.data??[]).map(n=>w.jsx("button",{className:"px-4 py-2 rounded bg-surface border border-app hover:bg-surface-2",onClick:()=>t(`/b/${n.id}/board`),children:n.name},n.id))})]})]})}function lj(){const[t,e]=q.useState(!1),[n,r]=q.useState(null),[i,s]=q.useState(null),o="https://lvplhlzzwtrqjdxhjrkd.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx2cGxobHp6d3RycWpkeGhqcmtkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg1OTgwMTYsImV4cCI6MjA3NDE3NDAxNn0.dYv3xVKcVT0LyQlzFTJMkIkN3JENXRAY0fLD7_igOd4";return q.useEffect(()=>{e(!!l),(async()=>{try{const u=be(),{data:d}=await u.auth.getSession();r(d.session??null);const h=await Ni("2a8f10d6-4368-43db-ab1d-ab783ec6e935");s(h.length)}catch(u){console.error(u)}})()},[o,l]),w.jsxs("div",{className:"min-h-screen bg-app text-app p-6",children:[w.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"Dev Status"}),w.jsxs("div",{className:"space-y-2 text-sm",children:[w.jsxs("div",{children:[w.jsx("span",{className:"font-medium",children:"Env present:"})," ",t?"Yes":"No (set VITE_SUPABASE_URL and VITE_SUPABASE_ANON_KEY)"]}),w.jsxs("div",{children:[w.jsx("span",{className:"font-medium",children:"Session:"})," ",n?"Signed in":"No session"]}),w.jsxs("div",{children:[w.jsx("span",{className:"font-medium",children:"Boards readable:"})," ",i===null?"":i]})]})]})}function sg({title:t,overdue:e,card:n,editingTitle:r,titleInputValue:i,onTitleInputChange:s,onTitleCommit:o,onTitleCancel:l}){nn();let u,d;const h=!!n?.location_lat&&!!n?.location_lng,f=n?.location_address;if(n?.card_field_values&&Array.isArray(n.card_field_values))for(const N of n.card_field_values){const T=(Array.isArray(N.custom_field_defs)?N.custom_field_defs[0]:N.custom_field_defs)?.name?.toLowerCase?.();if(T)try{const j=(typeof N.value=="string"?JSON.parse(N.value):N.value)?.value;if(!j)continue;!u&&T.includes("phone")&&(u=String(j)),!d&&T.includes("email")&&(d=String(j))}catch{}}const m=[];if(n?.card_labels)for(const N of n.card_labels){const P=Array.isArray(N.labels)?N.labels[0]:N.labels;P&&m.push({id:P.id,name:String(P.name??""),color:String(P.color??"#666")})}const g=n?.comments?.length??0,_=n?.attachments?.length??0;let v=0,x=0;if(n?.checklists)for(const N of n.checklists){const P=N.checklist_items??[];x+=P.length,v+=P.filter(T=>T.done).length}const S=n?.date_start?new Date(n.date_start):null,k=n?.date_end?new Date(n.date_end):null,C=N=>N.toLocaleDateString(),R=e?"rgba(239,68,68,0.7)":m[0]?.color??"var(--color-primary, #727cf5)";return w.jsxs("div",{className:"rounded-2xl border border-border bg-bg-card text-fg min-h-[250px] overflow-hidden transition-transform duration-150 will-change-transform hover:scale-[1.02] shadow-card",children:[w.jsx("div",{className:"h-1 w-full",style:{backgroundColor:R}}),w.jsxs("div",{className:"p-2",children:[w.jsx("div",{className:"flex items-start gap-2",children:w.jsx("div",{className:"flex-1 font-medium leading-snug",children:r?w.jsx("input",{autoFocus:!0,className:"w-full bg-transparent border-0 rounded px-1 py-0.5 outline-none focus:outline-none focus:ring-0",value:i??t,onChange:N=>s?.(N.target.value),onBlur:()=>o?.(),onKeyDown:N=>{N.key==="Enter"&&o?.(),N.key==="Escape"&&l?.()},onClick:N=>N.stopPropagation()}):w.jsx("span",{children:t})})}),m.length>0&&w.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:m.map(N=>w.jsx("span",{className:"inline-block h-3 rounded-sm px-1 text-[10px] font-medium text-white",style:{backgroundColor:N.color},title:N.name,children:N.name?.length<=8?N.name:""},N.id))}),(S||k)&&w.jsxs("div",{className:"mt-2 text-xs text-fg-muted flex items-center gap-2",children:[S&&w.jsxs("span",{className:"flex items-center gap-1",children:[w.jsx(Ot,{name:"calendar",size:14})," ",C(S)]}),k&&w.jsxs("span",{className:"flex items-center gap-1",children:[w.jsx(Ot,{name:"arrow-right",size:14})," ",C(k)]}),e&&w.jsx("span",{className:"ml-auto px-1.5 py-0.5 rounded bg-danger/15 text-danger",children:"Overdue"})]}),(u||d||h)&&w.jsxs("div",{className:"mt-3 text-xs text-fg-muted space-y-1",children:[u&&w.jsxs("div",{className:"flex items-center gap-1",children:[w.jsx(Ot,{name:"phone",size:14})," ",u]}),d&&w.jsxs("div",{className:"flex items-center gap-1",children:[w.jsx(Ot,{name:"mail",size:14})," ",d]}),h&&w.jsxs("div",{className:"flex items-center gap-1",title:f||"Location set",children:[w.jsx(Ot,{name:"map-pin",size:14}),w.jsx("span",{className:"truncate",children:f||"Location set"})]})]}),(x>0||g>0||_>0)&&w.jsxs("div",{className:"mt-3 text-xs text-fg-muted flex items-center gap-3",children:[x>0&&w.jsxs("span",{title:"Checklist progress",className:"flex items-center gap-1",children:[" ",v,"/",x]}),g>0&&w.jsxs("span",{title:"Comments",className:"flex items-center gap-1",children:[w.jsx(Ot,{name:"comment",size:14})," ",g]}),_>0&&w.jsxs("span",{title:"Attachments",className:"flex items-center gap-1",children:[w.jsx(Ot,{name:"paperclip",size:14})," ",_]})]})]})]})}async function uj(t){const e=be(),{data:n,error:r}=await e.from("labels").select("id, name, color").eq("workspace_id",t).order("name",{ascending:!0});if(r)throw r;return n??[]}async function cj(t,e){const n=be(),{error:r}=await n.from("card_labels").insert({card_id:t,label_id:e});if(r&&r.code!=="23505")throw r;if(!r||r.code==="23505")try{const{data:i}=await n.from("labels").select("name, color").eq("id",e).single();await Gd(t,"add",e,i?.name,i?.color)}catch{await Gd(t,"add",e)}}async function dj(t,e){const n=be(),{data:r}=await n.from("labels").select("name, color").eq("id",e).single(),{error:i}=await n.from("card_labels").delete().eq("card_id",t).eq("label_id",e);if(i)throw i;await Gd(t,"remove",e,r?.name,r?.color)}function hj({workspaceId:t,cardId:e,selectedLabelIds:n}){const r=nn(),i=St({queryKey:["labels",t],queryFn:()=>uj(t),enabled:!!t}),s=Pi({mutationFn:u=>cj(e,u),onSuccess:()=>{r.invalidateQueries({predicate:u=>Array.isArray(u.queryKey)&&u.queryKey.includes("card")}),r.invalidateQueries({predicate:u=>Array.isArray(u.queryKey)&&u.queryKey.includes("cards")})}}),o=Pi({mutationFn:u=>dj(e,u),onSuccess:()=>{r.invalidateQueries({predicate:u=>Array.isArray(u.queryKey)&&u.queryKey.includes("card")}),r.invalidateQueries({predicate:u=>Array.isArray(u.queryKey)&&u.queryKey.includes("cards")})}});if(i.isLoading)return w.jsx("div",{className:"text-muted text-sm",children:"Loading labels"});if(i.error)return w.jsx("div",{className:"text-red-500 text-sm",children:"Failed to load labels"});const l=i.data??[];return w.jsx("div",{className:"flex flex-wrap gap-2",children:l.map(u=>{const d=n.includes(u.id);return w.jsx("button",{type:"button",className:`px-2 py-1 rounded text-xs font-medium border ${d?"border-white/70":"border-app"}`,title:u.name,style:{backgroundColor:u.color,color:"white"},onClick:()=>d?o.mutate(u.id):s.mutate(u.id),children:u.name},u.id)})})}function fj({cardId:t,start:e,end:n}){const r=nn(),[i,s]=q.useState(e??""),[o,l]=q.useState(n??"");q.useEffect(()=>s(e?e.slice(0,10):""),[e]),q.useEffect(()=>l(n?n.slice(0,10):""),[n]);const u=Pi({mutationFn:async d=>{const h=be(),f=e?e.slice(0,10):null,m=n?n.slice(0,10):null,{error:g}=await h.from("cards").update(d).eq("id",t);if(g)throw g;await j1(t,f,d.date_start,m,d.date_end)},onSuccess:async()=>{await r.invalidateQueries({predicate:d=>Array.isArray(d.queryKey)&&d.queryKey.includes("cards")}),await r.invalidateQueries({predicate:d=>Array.isArray(d.queryKey)&&d.queryKey.includes("card")})}});return w.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[w.jsx("input",{type:"date",className:"rounded border border-app bg-surface-2 px-2 py-1",value:i,onChange:d=>{const h=d.target.value||"";s(h),u.mutate({date_start:h||null,date_end:o||null})}}),w.jsx("span",{children:""}),w.jsx("input",{type:"date",className:"rounded border border-app bg-surface-2 px-2 py-1",value:o,onChange:d=>{const h=d.target.value||"";l(h),u.mutate({date_start:i||null,date_end:h||null})}})]})}function Jt(t){this.content=t}Jt.prototype={constructor:Jt,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return-1},get:function(t){var e=this.find(t);return e==-1?void 0:this.content[e+1]},update:function(t,e,n){var r=n&&n!=t?this.remove(n):this,i=r.find(t),s=r.content.slice();return i==-1?s.push(n||t,e):(s[i+1]=e,n&&(s[i]=n)),new Jt(s)},remove:function(t){var e=this.find(t);if(e==-1)return this;var n=this.content.slice();return n.splice(e,2),new Jt(n)},addToStart:function(t,e){return new Jt([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var n=this.remove(t).content.slice();return n.push(t,e),new Jt(n)},addBefore:function(t,e,n){var r=this.remove(e),i=r.content.slice(),s=r.find(t);return i.splice(s==-1?i.length:s,0,e,n),new Jt(i)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return t=Jt.from(t),t.size?new Jt(t.content.concat(this.subtract(t).content)):this},append:function(t){return t=Jt.from(t),t.size?new Jt(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=Jt.from(t);for(var n=0;n<t.content.length;n+=2)e=e.remove(t.content[n]);return e},toObject:function(){var t={};return this.forEach(function(e,n){t[e]=n}),t},get size(){return this.content.length>>1}};Jt.from=function(t){if(t instanceof Jt)return t;var e=[];if(t)for(var n in t)e.push(n,t[n]);return new Jt(e)};function H1(t,e,n){for(let r=0;;r++){if(r==t.childCount||r==e.childCount)return t.childCount==e.childCount?null:n;let i=t.child(r),s=e.child(r);if(i==s){n+=i.nodeSize;continue}if(!i.sameMarkup(s))return n;if(i.isText&&i.text!=s.text){for(let o=0;i.text[o]==s.text[o];o++)n++;return n}if(i.content.size||s.content.size){let o=H1(i.content,s.content,n+1);if(o!=null)return o}n+=i.nodeSize}}function q1(t,e,n,r){for(let i=t.childCount,s=e.childCount;;){if(i==0||s==0)return i==s?null:{a:n,b:r};let o=t.child(--i),l=e.child(--s),u=o.nodeSize;if(o==l){n-=u,r-=u;continue}if(!o.sameMarkup(l))return{a:n,b:r};if(o.isText&&o.text!=l.text){let d=0,h=Math.min(o.text.length,l.text.length);for(;d<h&&o.text[o.text.length-d-1]==l.text[l.text.length-d-1];)d++,n--,r--;return{a:n,b:r}}if(o.content.size||l.content.size){let d=q1(o.content,l.content,n-1,r-1);if(d)return d}n-=u,r-=u}}class Y{constructor(e,n){if(this.content=e,this.size=n||0,n==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,n,r,i=0,s){for(let o=0,l=0;l<n;o++){let u=this.content[o],d=l+u.nodeSize;if(d>e&&r(u,i+l,s||null,o)!==!1&&u.content.size){let h=l+1;u.nodesBetween(Math.max(0,e-h),Math.min(u.content.size,n-h),r,i+h)}l=d}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,n,r,i){let s="",o=!0;return this.nodesBetween(e,n,(l,u)=>{let d=l.isText?l.text.slice(Math.max(e,u)-u,n-u):l.isLeaf?i?typeof i=="function"?i(l):i:l.type.spec.leafText?l.type.spec.leafText(l):"":"";l.isBlock&&(l.isLeaf&&d||l.isTextblock)&&r&&(o?o=!1:s+=r),s+=d},0),s}append(e){if(!e.size)return this;if(!this.size)return e;let n=this.lastChild,r=e.firstChild,i=this.content.slice(),s=0;for(n.isText&&n.sameMarkup(r)&&(i[i.length-1]=n.withText(n.text+r.text),s=1);s<e.content.length;s++)i.push(e.content[s]);return new Y(i,this.size+e.size)}cut(e,n=this.size){if(e==0&&n==this.size)return this;let r=[],i=0;if(n>e)for(let s=0,o=0;o<n;s++){let l=this.content[s],u=o+l.nodeSize;u>e&&((o<e||u>n)&&(l.isText?l=l.cut(Math.max(0,e-o),Math.min(l.text.length,n-o)):l=l.cut(Math.max(0,e-o-1),Math.min(l.content.size,n-o-1))),r.push(l),i+=l.nodeSize),o=u}return new Y(r,i)}cutByIndex(e,n){return e==n?Y.empty:e==0&&n==this.content.length?this:new Y(this.content.slice(e,n))}replaceChild(e,n){let r=this.content[e];if(r==n)return this;let i=this.content.slice(),s=this.size+n.nodeSize-r.nodeSize;return i[e]=n,new Y(i,s)}addToStart(e){return new Y([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new Y(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let n=0;n<this.content.length;n++)if(!this.content[n].eq(e.content[n]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let n=this.content[e];if(!n)throw new RangeError("Index "+e+" out of range for "+this);return n}maybeChild(e){return this.content[e]||null}forEach(e){for(let n=0,r=0;n<this.content.length;n++){let i=this.content[n];e(i,r,n),r+=i.nodeSize}}findDiffStart(e,n=0){return H1(this,e,n)}findDiffEnd(e,n=this.size,r=e.size){return q1(this,e,n,r)}findIndex(e){if(e==0)return Fc(0,e);if(e==this.size)return Fc(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,r=0;;n++){let i=this.child(n),s=r+i.nodeSize;if(s>=e)return s==e?Fc(n+1,s):Fc(n,r);r=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,n){if(!n)return Y.empty;if(!Array.isArray(n))throw new RangeError("Invalid input for Fragment.fromJSON");return new Y(n.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return Y.empty;let n,r=0;for(let i=0;i<e.length;i++){let s=e[i];r+=s.nodeSize,i&&s.isText&&e[i-1].sameMarkup(s)?(n||(n=e.slice(0,i)),n[n.length-1]=s.withText(n[n.length-1].text+s.text)):n&&n.push(s)}return new Y(n||e,r)}static from(e){if(!e)return Y.empty;if(e instanceof Y)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new Y([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Y.empty=new Y([],0);const pp={index:0,offset:0};function Fc(t,e){return pp.index=t,pp.offset=e,pp}function Jd(t,e){if(t===e)return!0;if(!(t&&typeof t=="object")||!(e&&typeof e=="object"))return!1;let n=Array.isArray(t);if(Array.isArray(e)!=n)return!1;if(n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!Jd(t[r],e[r]))return!1}else{for(let r in t)if(!(r in e)||!Jd(t[r],e[r]))return!1;for(let r in e)if(!(r in t))return!1}return!0}let Ge=class og{constructor(e,n){this.type=e,this.attrs=n}addToSet(e){let n,r=!1;for(let i=0;i<e.length;i++){let s=e[i];if(this.eq(s))return e;if(this.type.excludes(s.type))n||(n=e.slice(0,i));else{if(s.type.excludes(this.type))return e;!r&&s.type.rank>this.type.rank&&(n||(n=e.slice(0,i)),n.push(this),r=!0),n&&n.push(s)}}return n||(n=e.slice()),r||n.push(this),n}removeFromSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e}isInSet(e){for(let n=0;n<e.length;n++)if(this.eq(e[n]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Jd(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[n.type];if(!r)throw new RangeError(`There is no mark type ${n.type} in this schema`);let i=r.create(n.attrs);return r.checkAttrs(i.attrs),i}static sameSet(e,n){if(e==n)return!0;if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(n[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return og.none;if(e instanceof og)return[e];let n=e.slice();return n.sort((r,i)=>r.type.rank-i.type.rank),n}};Ge.none=[];class Yd extends Error{}class le{constructor(e,n,r){this.content=e,this.openStart=n,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,n){let r=K1(this.content,e+this.openStart,n);return r&&new le(r,this.openStart,this.openEnd)}removeBetween(e,n){return new le(W1(this.content,e+this.openStart,n+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,n){if(!n)return le.empty;let r=n.openStart||0,i=n.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new le(Y.fromJSON(e,n.content),r,i)}static maxOpen(e,n=!0){let r=0,i=0;for(let s=e.firstChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.firstChild)r++;for(let s=e.lastChild;s&&!s.isLeaf&&(n||!s.type.spec.isolating);s=s.lastChild)i++;return new le(e,r,i)}}le.empty=new le(Y.empty,0,0);function W1(t,e,n){let{index:r,offset:i}=t.findIndex(e),s=t.maybeChild(r),{index:o,offset:l}=t.findIndex(n);if(i==e||s.isText){if(l!=n&&!t.child(o).isText)throw new RangeError("Removing non-flat range");return t.cut(0,e).append(t.cut(n))}if(r!=o)throw new RangeError("Removing non-flat range");return t.replaceChild(r,s.copy(W1(s.content,e-i-1,n-i-1)))}function K1(t,e,n,r){let{index:i,offset:s}=t.findIndex(e),o=t.maybeChild(i);if(s==e||o.isText)return r&&!r.canReplace(i,i,n)?null:t.cut(0,e).append(n).append(t.cut(e));let l=K1(o.content,e-s-1,n,o);return l&&t.replaceChild(i,o.copy(l))}function pj(t,e,n){if(n.openStart>t.depth)throw new Yd("Inserted content deeper than insertion position");if(t.depth-n.openStart!=e.depth-n.openEnd)throw new Yd("Inconsistent open depths");return Z1(t,e,n,0)}function Z1(t,e,n,r){let i=t.index(r),s=t.node(r);if(i==e.index(r)&&r<t.depth-n.openStart){let o=Z1(t,e,n,r+1);return s.copy(s.content.replaceChild(i,o))}else if(n.content.size)if(!n.openStart&&!n.openEnd&&t.depth==r&&e.depth==r){let o=t.parent,l=o.content;return yo(o,l.cut(0,t.parentOffset).append(n.content).append(l.cut(e.parentOffset)))}else{let{start:o,end:l}=mj(n,t);return yo(s,G1(t,o,l,e,r))}else return yo(s,Xd(t,e,r))}function Q1(t,e){if(!e.type.compatibleContent(t.type))throw new Yd("Cannot join "+e.type.name+" onto "+t.type.name)}function ag(t,e,n){let r=t.node(n);return Q1(r,e.node(n)),r}function go(t,e){let n=e.length-1;n>=0&&t.isText&&t.sameMarkup(e[n])?e[n]=t.withText(e[n].text+t.text):e.push(t)}function Jl(t,e,n,r){let i=(e||t).node(n),s=0,o=e?e.index(n):i.childCount;t&&(s=t.index(n),t.depth>n?s++:t.textOffset&&(go(t.nodeAfter,r),s++));for(let l=s;l<o;l++)go(i.child(l),r);e&&e.depth==n&&e.textOffset&&go(e.nodeBefore,r)}function yo(t,e){return t.type.checkContent(e),t.copy(e)}function G1(t,e,n,r,i){let s=t.depth>i&&ag(t,e,i+1),o=r.depth>i&&ag(n,r,i+1),l=[];return Jl(null,t,i,l),s&&o&&e.index(i)==n.index(i)?(Q1(s,o),go(yo(s,G1(t,e,n,r,i+1)),l)):(s&&go(yo(s,Xd(t,e,i+1)),l),Jl(e,n,i,l),o&&go(yo(o,Xd(n,r,i+1)),l)),Jl(r,null,i,l),new Y(l)}function Xd(t,e,n){let r=[];if(Jl(null,t,n,r),t.depth>n){let i=ag(t,e,n+1);go(yo(i,Xd(t,e,n+1)),r)}return Jl(e,null,n,r),new Y(r)}function mj(t,e){let n=e.depth-t.openStart,i=e.node(n).copy(t.content);for(let s=n-1;s>=0;s--)i=e.node(s).copy(Y.from(i));return{start:i.resolveNoCache(t.openStart+n),end:i.resolveNoCache(i.content.size-t.openEnd-n)}}class Eu{constructor(e,n,r){this.pos=e,this.path=n,this.parentOffset=r,this.depth=n.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,n=this.index(this.depth);if(n==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(n);return r?e.child(n).cut(r):i}get nodeBefore(){let e=this.index(this.depth),n=this.pos-this.path[this.path.length-1];return n?this.parent.child(e).cut(0,n):e==0?null:this.parent.child(e-1)}posAtIndex(e,n){n=this.resolveDepth(n);let r=this.path[n*3],i=n==0?0:this.path[n*3-1]+1;for(let s=0;s<e;s++)i+=r.child(s).nodeSize;return i}marks(){let e=this.parent,n=this.index();if(e.content.size==0)return Ge.none;if(this.textOffset)return e.child(n).marks;let r=e.maybeChild(n-1),i=e.maybeChild(n);if(!r){let l=r;r=i,i=l}let s=r.marks;for(var o=0;o<s.length;o++)s[o].type.spec.inclusive===!1&&(!i||!s[o].isInSet(i.marks))&&(s=s[o--].removeFromSet(s));return s}marksAcross(e){let n=this.parent.maybeChild(this.index());if(!n||!n.isInline)return null;let r=n.marks,i=e.parent.maybeChild(e.index());for(var s=0;s<r.length;s++)r[s].type.spec.inclusive===!1&&(!i||!r[s].isInSet(i.marks))&&(r=r[s--].removeFromSet(r));return r}sharedDepth(e){for(let n=this.depth;n>0;n--)if(this.start(n)<=e&&this.end(n)>=e)return n;return 0}blockRange(e=this,n){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!n||n(this.node(r))))return new eh(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let n=1;n<=this.depth;n++)e+=(e?"/":"")+this.node(n).type.name+"_"+this.index(n-1);return e+":"+this.parentOffset}static resolve(e,n){if(!(n>=0&&n<=e.content.size))throw new RangeError("Position "+n+" out of range");let r=[],i=0,s=n;for(let o=e;;){let{index:l,offset:u}=o.content.findIndex(s),d=s-u;if(r.push(o,l,i+u),!d||(o=o.child(l),o.isText))break;s=d-1,i+=u+1}return new Eu(n,r,s)}static resolveCached(e,n){let r=N0.get(e);if(r)for(let s=0;s<r.elts.length;s++){let o=r.elts[s];if(o.pos==n)return o}else N0.set(e,r=new gj);let i=r.elts[r.i]=Eu.resolve(e,n);return r.i=(r.i+1)%yj,i}}class gj{constructor(){this.elts=[],this.i=0}}const yj=12,N0=new WeakMap;class eh{constructor(e,n,r){this.$from=e,this.$to=n,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const vj=Object.create(null);let vs=class lg{constructor(e,n,r,i=Ge.none){this.type=e,this.attrs=n,this.marks=i,this.content=r||Y.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,n,r,i=0){this.content.nodesBetween(e,n,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,n,r,i){return this.content.textBetween(e,n,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,n,r){return this.type==e&&Jd(this.attrs,n||e.defaultAttrs||vj)&&Ge.sameSet(this.marks,r||Ge.none)}copy(e=null){return e==this.content?this:new lg(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new lg(this.type,this.attrs,this.content,e)}cut(e,n=this.content.size){return e==0&&n==this.content.size?this:this.copy(this.content.cut(e,n))}slice(e,n=this.content.size,r=!1){if(e==n)return le.empty;let i=this.resolve(e),s=this.resolve(n),o=r?0:i.sharedDepth(n),l=i.start(o),d=i.node(o).content.cut(i.pos-l,s.pos-l);return new le(d,i.depth-o,s.depth-o)}replace(e,n,r){return pj(this.resolve(e),this.resolve(n),r)}nodeAt(e){for(let n=this;;){let{index:r,offset:i}=n.content.findIndex(e);if(n=n.maybeChild(r),!n)return null;if(i==e||n.isText)return n;e-=i+1}}childAfter(e){let{index:n,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(n),index:n,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:n,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(n),index:n,offset:r};let i=this.content.child(n-1);return{node:i,index:n-1,offset:r-i.nodeSize}}resolve(e){return Eu.resolveCached(this,e)}resolveNoCache(e){return Eu.resolve(this,e)}rangeHasMark(e,n,r){let i=!1;return n>e&&this.nodesBetween(e,n,s=>(r.isInSet(s.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),J1(this.marks,e)}contentMatchAt(e){let n=this.type.contentMatch.matchFragment(this.content,0,e);if(!n)throw new Error("Called contentMatchAt on a node with invalid content");return n}canReplace(e,n,r=Y.empty,i=0,s=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,i,s),l=o&&o.matchFragment(this.content,n);if(!l||!l.validEnd)return!1;for(let u=i;u<s;u++)if(!this.type.allowsMarks(r.child(u).marks))return!1;return!0}canReplaceWith(e,n,r,i){if(i&&!this.type.allowsMarks(i))return!1;let s=this.contentMatchAt(e).matchType(r),o=s&&s.matchFragment(this.content,n);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Ge.none;for(let n=0;n<this.marks.length;n++){let r=this.marks[n];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!Ge.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(n=>n.type.name)}`);this.content.forEach(n=>n.check())}toJSON(){let e={type:this.type.name};for(let n in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(n=>n.toJSON())),e}static fromJSON(e,n){if(!n)throw new RangeError("Invalid input for Node.fromJSON");let r;if(n.marks){if(!Array.isArray(n.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=n.marks.map(e.markFromJSON)}if(n.type=="text"){if(typeof n.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(n.text,r)}let i=Y.fromJSON(e,n.content),s=e.nodeType(n.type).create(n.attrs,i,r);return s.type.checkAttrs(s.attrs),s}};vs.prototype.text=void 0;class th extends vs{constructor(e,n,r,i){if(super(e,n,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):J1(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,n){return this.text.slice(e,n)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new th(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new th(this.type,this.attrs,e,this.marks)}cut(e=0,n=this.text.length){return e==0&&n==this.text.length?this:this.withText(this.text.slice(e,n))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function J1(t,e){for(let n=t.length-1;n>=0;n--)e=t[n].type.name+"("+e+")";return e}class Mo{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,n){let r=new _j(e,n);if(r.next==null)return Mo.empty;let i=Y1(r);r.next&&r.err("Unexpected trailing text");let s=Ej(Cj(i));return Tj(s,r),s}matchType(e){for(let n=0;n<this.next.length;n++)if(this.next[n].type==e)return this.next[n].next;return null}matchFragment(e,n=0,r=e.childCount){let i=this;for(let s=n;i&&s<r;s++)i=i.matchType(e.child(s).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:n}=this.next[e];if(!(n.isText||n.hasRequiredAttrs()))return n}return null}compatible(e){for(let n=0;n<this.next.length;n++)for(let r=0;r<e.next.length;r++)if(this.next[n].type==e.next[r].type)return!0;return!1}fillBefore(e,n=!1,r=0){let i=[this];function s(o,l){let u=o.matchFragment(e,r);if(u&&(!n||u.validEnd))return Y.from(l.map(d=>d.createAndFill()));for(let d=0;d<o.next.length;d++){let{type:h,next:f}=o.next[d];if(!(h.isText||h.hasRequiredAttrs())&&i.indexOf(f)==-1){i.push(f);let m=s(f,l.concat(h));if(m)return m}}return null}return s(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let n=this.computeWrapping(e);return this.wrapCache.push(e,n),n}computeWrapping(e){let n=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),s=i.match;if(s.matchType(e)){let o=[];for(let l=i;l.type;l=l.via)o.push(l.type);return o.reverse()}for(let o=0;o<s.next.length;o++){let{type:l,next:u}=s.next[o];!l.isLeaf&&!l.hasRequiredAttrs()&&!(l.name in n)&&(!i.type||u.validEnd)&&(r.push({match:l.contentMatch,type:l,via:i}),n[l.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function n(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&n(r.next[i].next)}return n(this),e.map((r,i)=>{let s=i+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)s+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return s}).join(`
`)}}Mo.empty=new Mo(!0);class _j{constructor(e,n){this.string=e,this.nodeTypes=n,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function Y1(t){let e=[];do e.push(wj(t));while(t.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function wj(t){let e=[];do e.push(bj(t));while(t.next&&t.next!=")"&&t.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function bj(t){let e=kj(t);for(;;)if(t.eat("+"))e={type:"plus",expr:e};else if(t.eat("*"))e={type:"star",expr:e};else if(t.eat("?"))e={type:"opt",expr:e};else if(t.eat("{"))e=xj(t,e);else break;return e}function L0(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function xj(t,e){let n=L0(t),r=n;return t.eat(",")&&(t.next!="}"?r=L0(t):r=-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:e}}function Sj(t,e){let n=t.nodeTypes,r=n[e];if(r)return[r];let i=[];for(let s in n){let o=n[s];o.isInGroup(e)&&i.push(o)}return i.length==0&&t.err("No node type or group '"+e+"' found"),i}function kj(t){if(t.eat("(")){let e=Y1(t);return t.eat(")")||t.err("Missing closing paren"),e}else if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=Sj(t,t.next).map(n=>(t.inline==null?t.inline=n.isInline:t.inline!=n.isInline&&t.err("Mixing inline and block content"),{type:"name",value:n}));return t.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function Cj(t){let e=[[]];return i(s(t,0),n()),e;function n(){return e.push([])-1}function r(o,l,u){let d={term:u,to:l};return e[o].push(d),d}function i(o,l){o.forEach(u=>u.to=l)}function s(o,l){if(o.type=="choice")return o.exprs.reduce((u,d)=>u.concat(s(d,l)),[]);if(o.type=="seq")for(let u=0;;u++){let d=s(o.exprs[u],l);if(u==o.exprs.length-1)return d;i(d,l=n())}else if(o.type=="star"){let u=n();return r(l,u),i(s(o.expr,u),u),[r(u)]}else if(o.type=="plus"){let u=n();return i(s(o.expr,l),u),i(s(o.expr,u),u),[r(u)]}else{if(o.type=="opt")return[r(l)].concat(s(o.expr,l));if(o.type=="range"){let u=l;for(let d=0;d<o.min;d++){let h=n();i(s(o.expr,u),h),u=h}if(o.max==-1)i(s(o.expr,u),u);else for(let d=o.min;d<o.max;d++){let h=n();r(u,h),i(s(o.expr,u),h),u=h}return[r(u)]}else{if(o.type=="name")return[r(l,void 0,o.value)];throw new Error("Unknown expr type")}}}}function X1(t,e){return e-t}function R0(t,e){let n=[];return r(e),n.sort(X1);function r(i){let s=t[i];if(s.length==1&&!s[0].term)return r(s[0].to);n.push(i);for(let o=0;o<s.length;o++){let{term:l,to:u}=s[o];!l&&n.indexOf(u)==-1&&r(u)}}}function Ej(t){let e=Object.create(null);return n(R0(t,0));function n(r){let i=[];r.forEach(o=>{t[o].forEach(({term:l,to:u})=>{if(!l)return;let d;for(let h=0;h<i.length;h++)i[h][0]==l&&(d=i[h][1]);R0(t,u).forEach(h=>{d||i.push([l,d=[]]),d.indexOf(h)==-1&&d.push(h)})})});let s=e[r.join(",")]=new Mo(r.indexOf(t.length-1)>-1);for(let o=0;o<i.length;o++){let l=i[o][1].sort(X1);s.next.push({type:i[o][0],next:e[l.join(",")]||n(l)})}return s}}function Tj(t,e){for(let n=0,r=[t];n<r.length;n++){let i=r[n],s=!i.validEnd,o=[];for(let l=0;l<i.next.length;l++){let{type:u,next:d}=i.next[l];o.push(u.name),s&&!(u.isText||u.hasRequiredAttrs())&&(s=!1),r.indexOf(d)==-1&&r.push(d)}s&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function eC(t){let e=Object.create(null);for(let n in t){let r=t[n];if(!r.hasDefault)return null;e[n]=r.default}return e}function tC(t,e){let n=Object.create(null);for(let r in t){let i=e&&e[r];if(i===void 0){let s=t[r];if(s.hasDefault)i=s.default;else throw new RangeError("No value supplied for attribute "+r)}n[r]=i}return n}function nC(t,e,n,r){for(let i in e)if(!(i in t))throw new RangeError(`Unsupported attribute ${i} for ${n} of type ${i}`);for(let i in t){let s=t[i];s.validate&&s.validate(e[i])}}function rC(t,e){let n=Object.create(null);if(e)for(let r in e)n[r]=new Mj(t,r,e[r]);return n}let D0=class iC{constructor(e,n,r){this.name=e,this.schema=n,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=rC(e,r.attrs),this.defaultAttrs=eC(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Mo.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:tC(this.attrs,e)}create(e=null,n,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new vs(this,this.computeAttrs(e),Y.from(n),Ge.setFrom(r))}createChecked(e=null,n,r){return n=Y.from(n),this.checkContent(n),new vs(this,this.computeAttrs(e),n,Ge.setFrom(r))}createAndFill(e=null,n,r){if(e=this.computeAttrs(e),n=Y.from(n),n.size){let o=this.contentMatch.fillBefore(n);if(!o)return null;n=o.append(n)}let i=this.contentMatch.matchFragment(n),s=i&&i.fillBefore(Y.empty,!0);return s?new vs(this,e,n.append(s),Ge.setFrom(r)):null}validContent(e){let n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){nC(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let n=0;n<e.length;n++)if(!this.allowsMarkType(e[n].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let n;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:Ge.none:e}static compile(e,n){let r=Object.create(null);e.forEach((s,o)=>r[s]=new iC(s,n,o));let i=n.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let s in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function Pj(t,e,n){let r=n.split("|");return i=>{let s=i===null?"null":typeof i;if(r.indexOf(s)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${s}`)}}class Mj{constructor(e,n,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?Pj(e,n,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class Uh{constructor(e,n,r,i){this.name=e,this.rank=n,this.schema=r,this.spec=i,this.attrs=rC(e,i.attrs),this.excluded=null;let s=eC(this.attrs);this.instance=s?new Ge(this,s):null}create(e=null){return!e&&this.instance?this.instance:new Ge(this,tC(this.attrs,e))}static compile(e,n){let r=Object.create(null),i=0;return e.forEach((s,o)=>r[s]=new Uh(s,i++,n,o)),r}removeFromSet(e){for(var n=0;n<e.length;n++)e[n].type==this&&(e=e.slice(0,n).concat(e.slice(n+1)),n--);return e}isInSet(e){for(let n=0;n<e.length;n++)if(e[n].type==this)return e[n]}checkAttrs(e){nC(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class sC{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let n=this.spec={};for(let i in e)n[i]=e[i];n.nodes=Jt.from(e.nodes),n.marks=Jt.from(e.marks||{}),this.nodes=D0.compile(this.spec.nodes,this),this.marks=Uh.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let s=this.nodes[i],o=s.spec.content||"",l=s.spec.marks;if(s.contentMatch=r[o]||(r[o]=Mo.parse(o,this.nodes)),s.inlineContent=s.contentMatch.inlineContent,s.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!s.isInline||!s.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=s}s.markSet=l=="_"?null:l?A0(this,l.split(" ")):l==""||!s.inlineContent?[]:null}for(let i in this.marks){let s=this.marks[i],o=s.spec.excludes;s.excluded=o==null?[s]:o==""?[]:A0(this,o.split(" "))}this.nodeFromJSON=i=>vs.fromJSON(this,i),this.markFromJSON=i=>Ge.fromJSON(this,i),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,n=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof D0){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(n,r,i)}text(e,n){let r=this.nodes.text;return new th(r,r.defaultAttrs,e,Ge.setFrom(n))}mark(e,n){return typeof e=="string"&&(e=this.marks[e]),e.create(n)}nodeType(e){let n=this.nodes[e];if(!n)throw new RangeError("Unknown node type: "+e);return n}}function A0(t,e){let n=[];for(let r=0;r<e.length;r++){let i=e[r],s=t.marks[i],o=s;if(s)n.push(s);else for(let l in t.marks){let u=t.marks[l];(i=="_"||u.spec.group&&u.spec.group.split(" ").indexOf(i)>-1)&&n.push(o=u)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return n}function Oj(t){return t.tag!=null}function Nj(t){return t.style!=null}class _s{constructor(e,n){this.schema=e,this.rules=n,this.tags=[],this.styles=[];let r=this.matchedStyles=[];n.forEach(i=>{if(Oj(i))this.tags.push(i);else if(Nj(i)){let s=/[^=]*/.exec(i.style)[0];r.indexOf(s)<0&&r.push(s),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let s=e.nodes[i.node];return s.contentMatch.matchType(s)})}parse(e,n={}){let r=new j0(this,n,!1);return r.addAll(e,Ge.none,n.from,n.to),r.finish()}parseSlice(e,n={}){let r=new j0(this,n,!0);return r.addAll(e,Ge.none,n.from,n.to),le.maxOpen(r.finish())}matchTag(e,n,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let s=this.tags[i];if(Dj(e,s.tag)&&(s.namespace===void 0||e.namespaceURI==s.namespace)&&(!s.context||n.matchesContext(s.context))){if(s.getAttrs){let o=s.getAttrs(e);if(o===!1)continue;s.attrs=o||void 0}return s}}}matchStyle(e,n,r,i){for(let s=i?this.styles.indexOf(i)+1:0;s<this.styles.length;s++){let o=this.styles[s],l=o.style;if(!(l.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||l.length>e.length&&(l.charCodeAt(e.length)!=61||l.slice(e.length+1)!=n))){if(o.getAttrs){let u=o.getAttrs(n);if(u===!1)continue;o.attrs=u||void 0}return o}}}static schemaRules(e){let n=[];function r(i){let s=i.priority==null?50:i.priority,o=0;for(;o<n.length;o++){let l=n[o];if((l.priority==null?50:l.priority)<s)break}n.splice(o,0,i)}for(let i in e.marks){let s=e.marks[i].spec.parseDOM;s&&s.forEach(o=>{r(o=z0(o)),o.mark||o.ignore||o.clearMark||(o.mark=i)})}for(let i in e.nodes){let s=e.nodes[i].spec.parseDOM;s&&s.forEach(o=>{r(o=z0(o)),o.node||o.ignore||o.mark||(o.node=i)})}return n}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new _s(e,_s.schemaRules(e)))}}const oC={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Lj={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},aC={ol:!0,ul:!0},Tu=1,ug=2,Yl=4;function I0(t,e,n){return e!=null?(e?Tu:0)|(e==="full"?ug:0):t&&t.whitespace=="pre"?Tu|ug:n&~Yl}class $c{constructor(e,n,r,i,s,o){this.type=e,this.attrs=n,this.marks=r,this.solid=i,this.options=o,this.content=[],this.activeMarks=Ge.none,this.match=s||(o&Yl?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let n=this.type.contentMatch.fillBefore(Y.from(e));if(n)this.match=this.type.contentMatch.matchFragment(n);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Tu)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let s=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=s.withText(s.text.slice(0,s.text.length-i[0].length))}}let n=Y.from(this.content);return!e&&this.match&&(n=n.append(this.match.fillBefore(Y.empty,!0))),this.type?this.type.create(this.attrs,n,this.marks):n}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!oC.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class j0{constructor(e,n,r){this.parser=e,this.options=n,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=n.topNode,s,o=I0(null,n.preserveWhitespace,0)|(r?Yl:0);i?s=new $c(i.type,i.attrs,Ge.none,!0,n.topMatch||i.type.contentMatch,o):r?s=new $c(null,null,Ge.none,!0,null,o):s=new $c(e.schema.topNodeType,null,Ge.none,!0,null,o),this.nodes=[s],this.find=n.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,n){e.nodeType==3?this.addTextNode(e,n):e.nodeType==1&&this.addElement(e,n)}addTextNode(e,n){let r=e.nodeValue,i=this.top,s=i.options&ug?"full":this.localPreserveWS||(i.options&Tu)>0;if(s==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(s)s!=="full"?r=r.replace(/\r?\n|\r/g," "):r=r.replace(/\r\n?/g,`
`);else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let o=i.content[i.content.length-1],l=e.previousSibling;(!o||l&&l.nodeName=="BR"||o.isText&&/[ \t\r\n\u000c]$/.test(o.text))&&(r=r.slice(1))}r&&this.insertNode(this.parser.schema.text(r),n,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,n,r){let i=this.localPreserveWS,s=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let o=e.nodeName.toLowerCase(),l;aC.hasOwnProperty(o)&&this.parser.normalizeLists&&Rj(e);let u=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(l=this.parser.matchTag(e,this,r));e:if(u?u.ignore:Lj.hasOwnProperty(o))this.findInside(e),this.ignoreFallback(e,n);else if(!u||u.skip||u.closeParent){u&&u.closeParent?this.open=Math.max(0,this.open-1):u&&u.skip.nodeType&&(e=u.skip);let d,h=this.needsBlock;if(oC.hasOwnProperty(o))s.content.length&&s.content[0].isInline&&this.open&&(this.open--,s=this.top),d=!0,s.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,n);break e}let f=u&&u.skip?n:this.readStyles(e,n);f&&this.addAll(e,f),d&&this.sync(s),this.needsBlock=h}else{let d=this.readStyles(e,n);d&&this.addElementByRule(e,u,d,u.consuming===!1?l:void 0)}this.localPreserveWS=i}leafFallback(e,n){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),n)}ignoreFallback(e,n){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),n,!0)}readStyles(e,n){let r=e.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let s=this.parser.matchedStyles[i],o=r.getPropertyValue(s);if(o)for(let l=void 0;;){let u=this.parser.matchStyle(s,o,this,l);if(!u)break;if(u.ignore)return null;if(u.clearMark?n=n.filter(d=>!u.clearMark(d)):n=n.concat(this.parser.schema.marks[u.mark].create(u.attrs)),u.consuming===!1)l=u;else break}}return n}addElementByRule(e,n,r,i){let s,o;if(n.node)if(o=this.parser.schema.nodes[n.node],o.isLeaf)this.insertNode(o.create(n.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let u=this.enter(o,n.attrs||null,r,n.preserveWhitespace);u&&(s=!0,r=u)}else{let u=this.parser.schema.marks[n.mark];r=r.concat(u.create(n.attrs))}let l=this.top;if(o&&o.isLeaf)this.findInside(e);else if(i)this.addElement(e,r,i);else if(n.getContent)this.findInside(e),n.getContent(e,this.parser.schema).forEach(u=>this.insertNode(u,r,!1));else{let u=e;typeof n.contentElement=="string"?u=e.querySelector(n.contentElement):typeof n.contentElement=="function"?u=n.contentElement(e):n.contentElement&&(u=n.contentElement),this.findAround(e,u,!0),this.addAll(u,r),this.findAround(e,u,!1)}s&&this.sync(l)&&this.open--}addAll(e,n,r,i){let s=r||0;for(let o=r?e.childNodes[r]:e.firstChild,l=i==null?null:e.childNodes[i];o!=l;o=o.nextSibling,++s)this.findAtPoint(e,s),this.addDOM(o,n);this.findAtPoint(e,s)}findPlace(e,n,r){let i,s;for(let o=this.open,l=0;o>=0;o--){let u=this.nodes[o],d=u.findWrapping(e);if(d&&(!i||i.length>d.length+l)&&(i=d,s=u,!d.length))break;if(u.solid){if(r)break;l+=2}}if(!i)return null;this.sync(s);for(let o=0;o<i.length;o++)n=this.enterInner(i[o],null,n,!1);return n}insertNode(e,n,r){if(e.isInline&&this.needsBlock&&!this.top.type){let s=this.textblockFromContext();s&&(n=this.enterInner(s,null,n))}let i=this.findPlace(e,n,r);if(i){this.closeExtra();let s=this.top;s.match&&(s.match=s.match.matchType(e.type));let o=Ge.none;for(let l of i.concat(e.marks))(s.type?s.type.allowsMarkType(l.type):B0(l.type,e.type))&&(o=l.addToSet(o));return s.content.push(e.mark(o)),!0}return!1}enter(e,n,r,i){let s=this.findPlace(e.create(n),r,!1);return s&&(s=this.enterInner(e,n,r,!0,i)),s}enterInner(e,n,r,i=!1,s){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(e);let l=I0(e,s,o.options);o.options&Yl&&o.content.length==0&&(l|=Yl);let u=Ge.none;return r=r.filter(d=>(o.type?o.type.allowsMarkType(d.type):B0(d.type,e))?(u=d.addToSet(u),!1):!0),this.nodes.push(new $c(e,n,u,i,null,l)),this.open++,r}closeExtra(e=!1){let n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)this.nodes[n-1].content.push(this.nodes[n].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let n=this.open;n>=0;n--){if(this.nodes[n]==e)return this.open=n,!0;this.localPreserveWS&&(this.nodes[n].options|=Tu)}return!1}get currentPos(){this.closeExtra();let e=0;for(let n=this.open;n>=0;n--){let r=this.nodes[n].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;n&&e++}return e}findAtPoint(e,n){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==n&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].pos==null&&e.nodeType==1&&e.contains(this.find[n].node)&&(this.find[n].pos=this.currentPos)}findAround(e,n,r){if(e!=n&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&n.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&(this.find[n].pos=this.currentPos-(e.nodeValue.length-this.find[n].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let n=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),s=-(r?r.depth+1:0)+(i?0:1),o=(l,u)=>{for(;l>=0;l--){let d=n[l];if(d==""){if(l==n.length-1||l==0)continue;for(;u>=s;u--)if(o(l-1,u))return!0;return!1}else{let h=u>0||u==0&&i?this.nodes[u].type:r&&u>=s?r.node(u-s).type:null;if(!h||h.name!=d&&!h.isInGroup(d))return!1;u--}}return!0};return o(n.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let n=e.depth;n>=0;n--){let r=e.node(n).contentMatchAt(e.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let n in this.parser.schema.nodes){let r=this.parser.schema.nodes[n];if(r.isTextblock&&r.defaultAttrs)return r}}}function Rj(t){for(let e=t.firstChild,n=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&aC.hasOwnProperty(r)&&n?(n.appendChild(e),e=n):r=="li"?n=e:r&&(n=null)}}function Dj(t,e){return(t.matches||t.msMatchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector).call(t,e)}function z0(t){let e={};for(let n in t)e[n]=t[n];return e}function B0(t,e){let n=e.schema.nodes;for(let r in n){let i=n[r];if(!i.allowsMarkType(t))continue;let s=[],o=l=>{s.push(l);for(let u=0;u<l.edgeCount;u++){let{type:d,next:h}=l.edge(u);if(d==e||s.indexOf(h)<0&&o(h))return!0}};if(o(i.contentMatch))return!0}}class zo{constructor(e,n){this.nodes=e,this.marks=n}serializeFragment(e,n={},r){r||(r=mp(n).createDocumentFragment());let i=r,s=[];return e.forEach(o=>{if(s.length||o.marks.length){let l=0,u=0;for(;l<s.length&&u<o.marks.length;){let d=o.marks[u];if(!this.marks[d.type.name]){u++;continue}if(!d.eq(s[l][0])||d.type.spec.spanning===!1)break;l++,u++}for(;l<s.length;)i=s.pop()[1];for(;u<o.marks.length;){let d=o.marks[u++],h=this.serializeMark(d,o.isInline,n);h&&(s.push([d,i]),i.appendChild(h.dom),i=h.contentDOM||h.dom)}}i.appendChild(this.serializeNodeInner(o,n))}),r}serializeNodeInner(e,n){let{dom:r,contentDOM:i}=ud(mp(n),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,n,i)}return r}serializeNode(e,n={}){let r=this.serializeNodeInner(e,n);for(let i=e.marks.length-1;i>=0;i--){let s=this.serializeMark(e.marks[i],e.isInline,n);s&&((s.contentDOM||s.dom).appendChild(r),r=s.dom)}return r}serializeMark(e,n,r={}){let i=this.marks[e.type.name];return i&&ud(mp(r),i(e,n),null,e.attrs)}static renderSpec(e,n,r=null,i){return ud(e,n,r,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new zo(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let n=F0(e.nodes);return n.text||(n.text=r=>r.text),n}static marksFromSchema(e){return F0(e.marks)}}function F0(t){let e={};for(let n in t){let r=t[n].spec.toDOM;r&&(e[n]=r)}return e}function mp(t){return t.document||window.document}const $0=new WeakMap;function Aj(t){let e=$0.get(t);return e===void 0&&$0.set(t,e=Ij(t)),e}function Ij(t){let e=null;function n(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let i=0;i<r.length;i++)n(r[i]);else for(let i in r)n(r[i])}return n(t),e}function ud(t,e,n,r){if(typeof e=="string")return{dom:t.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],s;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(s=Aj(r))&&s.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o=i.indexOf(" ");o>0&&(n=i.slice(0,o),i=i.slice(o+1));let l,u=n?t.createElementNS(n,i):t.createElement(i),d=e[1],h=1;if(d&&typeof d=="object"&&d.nodeType==null&&!Array.isArray(d)){h=2;for(let f in d)if(d[f]!=null){let m=f.indexOf(" ");m>0?u.setAttributeNS(f.slice(0,m),f.slice(m+1),d[f]):f=="style"&&u.style?u.style.cssText=d[f]:u.setAttribute(f,d[f])}}for(let f=h;f<e.length;f++){let m=e[f];if(m===0){if(f<e.length-1||f>h)throw new RangeError("Content hole must be the only child of its parent node");return{dom:u,contentDOM:u}}else{let{dom:g,contentDOM:_}=ud(t,m,n,r);if(u.appendChild(g),_){if(l)throw new RangeError("Multiple content holes");l=_}}}return{dom:u,contentDOM:l}}const lC=65535,uC=Math.pow(2,16);function jj(t,e){return t+e*uC}function U0(t){return t&lC}function zj(t){return(t-(t&lC))/uC}const cC=1,dC=2,cd=4,hC=8;class cg{constructor(e,n,r){this.pos=e,this.delInfo=n,this.recover=r}get deleted(){return(this.delInfo&hC)>0}get deletedBefore(){return(this.delInfo&(cC|cd))>0}get deletedAfter(){return(this.delInfo&(dC|cd))>0}get deletedAcross(){return(this.delInfo&cd)>0}}class Wn{constructor(e,n=!1){if(this.ranges=e,this.inverted=n,!e.length&&Wn.empty)return Wn.empty}recover(e){let n=0,r=U0(e);if(!this.inverted)for(let i=0;i<r;i++)n+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+n+zj(e)}mapResult(e,n=1){return this._map(e,n,!1)}map(e,n=1){return this._map(e,n,!0)}_map(e,n,r){let i=0,s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let u=this.ranges[l]-(this.inverted?i:0);if(u>e)break;let d=this.ranges[l+s],h=this.ranges[l+o],f=u+d;if(e<=f){let m=d?e==u?-1:e==f?1:n:n,g=u+i+(m<0?0:h);if(r)return g;let _=e==(n<0?u:f)?null:jj(l/3,e-u),v=e==u?dC:e==f?cC:cd;return(n<0?e!=u:e!=f)&&(v|=hC),new cg(g,v,_)}i+=h-d}return r?e+i:new cg(e+i,0,null)}touches(e,n){let r=0,i=U0(n),s=this.inverted?2:1,o=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let u=this.ranges[l]-(this.inverted?r:0);if(u>e)break;let d=this.ranges[l+s],h=u+d;if(e<=h&&l==i*3)return!0;r+=this.ranges[l+o]-d}return!1}forEach(e){let n=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,s=0;i<this.ranges.length;i+=3){let o=this.ranges[i],l=o-(this.inverted?s:0),u=o+(this.inverted?0:s),d=this.ranges[i+n],h=this.ranges[i+r];e(l,l+d,u,u+h),s+=h-d}}invert(){return new Wn(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?Wn.empty:new Wn(e<0?[0,-e,0]:[0,0,e])}}Wn.empty=new Wn([]);class Pu{constructor(e,n,r=0,i=e?e.length:0){this.mirror=n,this.from=r,this.to=i,this._maps=e||[],this.ownData=!(e||n)}get maps(){return this._maps}slice(e=0,n=this.maps.length){return new Pu(this._maps,this.mirror,e,n)}appendMap(e,n){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),n!=null&&this.setMirror(this._maps.length-1,n)}appendMapping(e){for(let n=0,r=this._maps.length;n<e._maps.length;n++){let i=e.getMirror(n);this.appendMap(e._maps[n],i!=null&&i<n?r+i:void 0)}}getMirror(e){if(this.mirror){for(let n=0;n<this.mirror.length;n++)if(this.mirror[n]==e)return this.mirror[n+(n%2?-1:1)]}}setMirror(e,n){this.mirror||(this.mirror=[]),this.mirror.push(e,n)}appendMappingInverted(e){for(let n=e.maps.length-1,r=this._maps.length+e._maps.length;n>=0;n--){let i=e.getMirror(n);this.appendMap(e._maps[n].invert(),i!=null&&i>n?r-i-1:void 0)}}invert(){let e=new Pu;return e.appendMappingInverted(this),e}map(e,n=1){if(this.mirror)return this._map(e,n,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,n);return e}mapResult(e,n=1){return this._map(e,n,!1)}_map(e,n,r){let i=0;for(let s=this.from;s<this.to;s++){let o=this._maps[s],l=o.mapResult(e,n);if(l.recover!=null){let u=this.getMirror(s);if(u!=null&&u>s&&u<this.to){s=u,e=this._maps[u].recover(l.recover);continue}}i|=l.delInfo,e=l.pos}return r?e:new cg(e,i,null)}}const gp=Object.create(null);class hn{getMap(){return Wn.empty}merge(e){return null}static fromJSON(e,n){if(!n||!n.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=gp[n.stepType];if(!r)throw new RangeError(`No step type ${n.stepType} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in gp)throw new RangeError("Duplicate use of step JSON ID "+e);return gp[e]=n,n.prototype.jsonID=e,n}}class xt{constructor(e,n){this.doc=e,this.failed=n}static ok(e){return new xt(e,null)}static fail(e){return new xt(null,e)}static fromReplace(e,n,r,i){try{return xt.ok(e.replace(n,r,i))}catch(s){if(s instanceof Yd)return xt.fail(s.message);throw s}}}function Yy(t,e,n){let r=[];for(let i=0;i<t.childCount;i++){let s=t.child(i);s.content.size&&(s=s.copy(Yy(s.content,e,s))),s.isInline&&(s=e(s,n,i)),r.push(s)}return Y.fromArray(r)}class ss extends hn{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),s=new le(Yy(n.content,(o,l)=>!o.isAtom||!l.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),i),n.openStart,n.openEnd);return xt.fromReplace(e,this.from,this.to,s)}invert(){return new Kr(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new ss(n.pos,r.pos,this.mark)}merge(e){return e instanceof ss&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ss(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new ss(n.from,n.to,e.markFromJSON(n.mark))}}hn.jsonID("addMark",ss);class Kr extends hn{constructor(e,n,r){super(),this.from=e,this.to=n,this.mark=r}apply(e){let n=e.slice(this.from,this.to),r=new le(Yy(n.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),n.openStart,n.openEnd);return xt.fromReplace(e,this.from,this.to,r)}invert(){return new ss(this.from,this.to,this.mark)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new Kr(n.pos,r.pos,this.mark)}merge(e){return e instanceof Kr&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Kr(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Kr(n.from,n.to,e.markFromJSON(n.mark))}}hn.jsonID("removeMark",Kr);class as extends hn{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return xt.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.addToSet(n.marks));return xt.fromReplace(e,this.pos,this.pos+1,new le(Y.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);if(n){let r=this.mark.addToSet(n.marks);if(r.length==n.marks.length){for(let i=0;i<n.marks.length;i++)if(!n.marks[i].isInSet(r))return new as(this.pos,n.marks[i]);return new as(this.pos,this.mark)}}return new Oo(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new as(n.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new as(n.pos,e.markFromJSON(n.mark))}}hn.jsonID("addNodeMark",as);class Oo extends hn{constructor(e,n){super(),this.pos=e,this.mark=n}apply(e){let n=e.nodeAt(this.pos);if(!n)return xt.fail("No node at mark step's position");let r=n.type.create(n.attrs,null,this.mark.removeFromSet(n.marks));return xt.fromReplace(e,this.pos,this.pos+1,new le(Y.from(r),0,n.isLeaf?0:1))}invert(e){let n=e.nodeAt(this.pos);return!n||!this.mark.isInSet(n.marks)?this:new as(this.pos,this.mark)}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Oo(n.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Oo(n.pos,e.markFromJSON(n.mark))}}hn.jsonID("removeNodeMark",Oo);class Ft extends hn{constructor(e,n,r,i=!1){super(),this.from=e,this.to=n,this.slice=r,this.structure=i}apply(e){return this.structure&&dg(e,this.from,this.to)?xt.fail("Structure replace would overwrite content"):xt.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new Wn([this.from,this.to-this.from,this.slice.size])}invert(e){return new Ft(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deletedAcross&&r.deletedAcross?null:new Ft(n.pos,Math.max(n.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof Ft)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let n=this.slice.size+e.slice.size==0?le.empty:new le(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new Ft(this.from,this.to+(e.to-e.from),n,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let n=this.slice.size+e.slice.size==0?le.empty:new le(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new Ft(e.from,this.to,n,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new Ft(n.from,n.to,le.fromJSON(e,n.slice),!!n.structure)}}hn.jsonID("replace",Ft);class Ut extends hn{constructor(e,n,r,i,s,o,l=!1){super(),this.from=e,this.to=n,this.gapFrom=r,this.gapTo=i,this.slice=s,this.insert=o,this.structure=l}apply(e){if(this.structure&&(dg(e,this.from,this.gapFrom)||dg(e,this.gapTo,this.to)))return xt.fail("Structure gap-replace would overwrite content");let n=e.slice(this.gapFrom,this.gapTo);if(n.openStart||n.openEnd)return xt.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,n.content);return r?xt.fromReplace(e,this.from,this.to,r):xt.fail("Content does not fit in gap")}getMap(){return new Wn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let n=this.gapTo-this.gapFrom;return new Ut(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=this.from==this.gapFrom?n.pos:e.map(this.gapFrom,-1),s=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return n.deletedAcross&&r.deletedAcross||i<n.pos||s>r.pos?null:new Ut(n.pos,r.pos,i,s,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,n){if(typeof n.from!="number"||typeof n.to!="number"||typeof n.gapFrom!="number"||typeof n.gapTo!="number"||typeof n.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new Ut(n.from,n.to,n.gapFrom,n.gapTo,le.fromJSON(e,n.slice),n.insert,!!n.structure)}}hn.jsonID("replaceAround",Ut);function dg(t,e,n){let r=t.resolve(e),i=n-e,s=r.depth;for(;i>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,i--;if(i>0){let o=r.node(s).maybeChild(r.indexAfter(s));for(;i>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,i--}}return!1}function Bj(t,e,n,r){let i=[],s=[],o,l;t.doc.nodesBetween(e,n,(u,d,h)=>{if(!u.isInline)return;let f=u.marks;if(!r.isInSet(f)&&h.type.allowsMarkType(r.type)){let m=Math.max(d,e),g=Math.min(d+u.nodeSize,n),_=r.addToSet(f);for(let v=0;v<f.length;v++)f[v].isInSet(_)||(o&&o.to==m&&o.mark.eq(f[v])?o.to=g:i.push(o=new Kr(m,g,f[v])));l&&l.to==m?l.to=g:s.push(l=new ss(m,g,r))}}),i.forEach(u=>t.step(u)),s.forEach(u=>t.step(u))}function Fj(t,e,n,r){let i=[],s=0;t.doc.nodesBetween(e,n,(o,l)=>{if(!o.isInline)return;s++;let u=null;if(r instanceof Uh){let d=o.marks,h;for(;h=r.isInSet(d);)(u||(u=[])).push(h),d=h.removeFromSet(d)}else r?r.isInSet(o.marks)&&(u=[r]):u=o.marks;if(u&&u.length){let d=Math.min(l+o.nodeSize,n);for(let h=0;h<u.length;h++){let f=u[h],m;for(let g=0;g<i.length;g++){let _=i[g];_.step==s-1&&f.eq(i[g].style)&&(m=_)}m?(m.to=d,m.step=s):i.push({style:f,from:Math.max(l,e),to:d,step:s})}}}),i.forEach(o=>t.step(new Kr(o.from,o.to,o.style)))}function Xy(t,e,n,r=n.contentMatch,i=!0){let s=t.doc.nodeAt(e),o=[],l=e+1;for(let u=0;u<s.childCount;u++){let d=s.child(u),h=l+d.nodeSize,f=r.matchType(d.type);if(!f)o.push(new Ft(l,h,le.empty));else{r=f;for(let m=0;m<d.marks.length;m++)n.allowsMarkType(d.marks[m].type)||t.step(new Kr(l,h,d.marks[m]));if(i&&d.isText&&n.whitespace!="pre"){let m,g=/\r?\n|\r/g,_;for(;m=g.exec(d.text);)_||(_=new le(Y.from(n.schema.text(" ",n.allowedMarks(d.marks))),0,0)),o.push(new Ft(l+m.index,l+m.index+m[0].length,_))}}l=h}if(!r.validEnd){let u=r.fillBefore(Y.empty,!0);t.replace(l,l,new le(u,0,0))}for(let u=o.length-1;u>=0;u--)t.step(o[u])}function $j(t,e,n){return(e==0||t.canReplace(e,t.childCount))&&(n==t.childCount||t.canReplace(0,n))}function nl(t){let n=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let r=t.depth;;--r){let i=t.$from.node(r),s=t.$from.index(r),o=t.$to.indexAfter(r);if(r<t.depth&&i.canReplace(s,o,n))return r;if(r==0||i.type.spec.isolating||!$j(i,s,o))break}return null}function Uj(t,e,n){let{$from:r,$to:i,depth:s}=e,o=r.before(s+1),l=i.after(s+1),u=o,d=l,h=Y.empty,f=0;for(let _=s,v=!1;_>n;_--)v||r.index(_)>0?(v=!0,h=Y.from(r.node(_).copy(h)),f++):u--;let m=Y.empty,g=0;for(let _=s,v=!1;_>n;_--)v||i.after(_+1)<i.end(_)?(v=!0,m=Y.from(i.node(_).copy(m)),g++):d++;t.step(new Ut(u,d,o,l,new le(h.append(m),f,g),h.size-f,!0))}function ev(t,e,n=null,r=t){let i=Vj(t,e),s=i&&Hj(r,e);return s?i.map(V0).concat({type:e,attrs:n}).concat(s.map(V0)):null}function V0(t){return{type:t,attrs:null}}function Vj(t,e){let{parent:n,startIndex:r,endIndex:i}=t,s=n.contentMatchAt(r).findWrapping(e);if(!s)return null;let o=s.length?s[0]:e;return n.canReplaceWith(r,i,o)?s:null}function Hj(t,e){let{parent:n,startIndex:r,endIndex:i}=t,s=n.child(r),o=e.contentMatch.findWrapping(s.type);if(!o)return null;let u=(o.length?o[o.length-1]:e).contentMatch;for(let d=r;u&&d<i;d++)u=u.matchType(n.child(d).type);return!u||!u.validEnd?null:o}function qj(t,e,n){let r=Y.empty;for(let o=n.length-1;o>=0;o--){if(r.size){let l=n[o].type.contentMatch.matchFragment(r);if(!l||!l.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=Y.from(n[o].type.create(n[o].attrs,r))}let i=e.start,s=e.end;t.step(new Ut(i,s,i,s,new le(r,0,0),n.length,!0))}function Wj(t,e,n,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=t.steps.length;t.doc.nodesBetween(e,n,(o,l)=>{let u=typeof i=="function"?i(o):i;if(o.isTextblock&&!o.hasMarkup(r,u)&&Kj(t.doc,t.mapping.slice(s).map(l),r)){let d=null;if(r.schema.linebreakReplacement){let g=r.whitespace=="pre",_=!!r.contentMatch.matchType(r.schema.linebreakReplacement);g&&!_?d=!1:!g&&_&&(d=!0)}d===!1&&pC(t,o,l,s),Xy(t,t.mapping.slice(s).map(l,1),r,void 0,d===null);let h=t.mapping.slice(s),f=h.map(l,1),m=h.map(l+o.nodeSize,1);return t.step(new Ut(f,m,f+1,m-1,new le(Y.from(r.create(u,null,o.marks)),0,0),1,!0)),d===!0&&fC(t,o,l,s),!1}})}function fC(t,e,n,r){e.forEach((i,s)=>{if(i.isText){let o,l=/\r?\n|\r/g;for(;o=l.exec(i.text);){let u=t.mapping.slice(r).map(n+1+s+o.index);t.replaceWith(u,u+1,e.type.schema.linebreakReplacement.create())}}})}function pC(t,e,n,r){e.forEach((i,s)=>{if(i.type==i.type.schema.linebreakReplacement){let o=t.mapping.slice(r).map(n+1+s);t.replaceWith(o,o+1,e.type.schema.text(`
`))}})}function Kj(t,e,n){let r=t.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,n)}function Zj(t,e,n,r,i){let s=t.doc.nodeAt(e);if(!s)throw new RangeError("No node at given position");n||(n=s.type);let o=n.create(r,null,i||s.marks);if(s.isLeaf)return t.replaceWith(e,e+s.nodeSize,o);if(!n.validContent(s.content))throw new RangeError("Invalid content for node type "+n.name);t.step(new Ut(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new le(Y.from(o),0,0),1,!0))}function xi(t,e,n=1,r){let i=t.resolve(e),s=i.depth-n,o=r&&r[r.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let d=i.depth-1,h=n-2;d>s;d--,h--){let f=i.node(d),m=i.index(d);if(f.type.spec.isolating)return!1;let g=f.content.cutByIndex(m,f.childCount),_=r&&r[h+1];_&&(g=g.replaceChild(0,_.type.create(_.attrs)));let v=r&&r[h]||f;if(!f.canReplace(m+1,f.childCount)||!v.type.validContent(g))return!1}let l=i.indexAfter(s),u=r&&r[0];return i.node(s).canReplaceWith(l,l,u?u.type:i.node(s+1).type)}function Qj(t,e,n=1,r){let i=t.doc.resolve(e),s=Y.empty,o=Y.empty;for(let l=i.depth,u=i.depth-n,d=n-1;l>u;l--,d--){s=Y.from(i.node(l).copy(s));let h=r&&r[d];o=Y.from(h?h.type.create(h.attrs,o):i.node(l).copy(o))}t.step(new Ft(e,e,new le(s.append(o),n,n),!0))}function Rs(t,e){let n=t.resolve(e),r=n.index();return mC(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function Gj(t,e){e.content.size||t.type.compatibleContent(e.type);let n=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let i=0;i<e.childCount;i++){let s=e.child(i),o=s.type==r?t.type.schema.nodes.text:s.type;if(n=n.matchType(o),!n||!t.type.allowsMarks(s.marks))return!1}return n.validEnd}function mC(t,e){return!!(t&&e&&!t.isLeaf&&Gj(t,e))}function Vh(t,e,n=-1){let r=t.resolve(e);for(let i=r.depth;;i--){let s,o,l=r.index(i);if(i==r.depth?(s=r.nodeBefore,o=r.nodeAfter):n>0?(s=r.node(i+1),l++,o=r.node(i).maybeChild(l)):(s=r.node(i).maybeChild(l-1),o=r.node(i+1)),s&&!s.isTextblock&&mC(s,o)&&r.node(i).canReplace(l,l+1))return e;if(i==0)break;e=n<0?r.before(i):r.after(i)}}function Jj(t,e,n){let r=null,{linebreakReplacement:i}=t.doc.type.schema,s=t.doc.resolve(e-n),o=s.node().type;if(i&&o.inlineContent){let h=o.whitespace=="pre",f=!!o.contentMatch.matchType(i);h&&!f?r=!1:!h&&f&&(r=!0)}let l=t.steps.length;if(r===!1){let h=t.doc.resolve(e+n);pC(t,h.node(),h.before(),l)}o.inlineContent&&Xy(t,e+n-1,o,s.node().contentMatchAt(s.index()),r==null);let u=t.mapping.slice(l),d=u.map(e-n);if(t.step(new Ft(d,u.map(e+n,-1),le.empty,!0)),r===!0){let h=t.doc.resolve(d);fC(t,h.node(),h.before(),t.steps.length)}return t}function Yj(t,e,n){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),n))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let s=r.index(i);if(r.node(i).canReplaceWith(s,s,n))return r.before(i+1);if(s>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let s=r.indexAfter(i);if(r.node(i).canReplaceWith(s,s,n))return r.after(i+1);if(s<r.node(i).childCount)return null}return null}function gC(t,e,n){let r=t.resolve(e);if(!n.content.size)return e;let i=n.content;for(let s=0;s<n.openStart;s++)i=i.firstChild.content;for(let s=1;s<=(n.openStart==0&&n.size?2:1);s++)for(let o=r.depth;o>=0;o--){let l=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,u=r.index(o)+(l>0?1:0),d=r.node(o),h=!1;if(s==1)h=d.canReplace(u,u,i);else{let f=d.contentMatchAt(u).findWrapping(i.firstChild.type);h=f&&d.canReplaceWith(u,u,f[0])}if(h)return l==0?r.pos:l<0?r.before(o+1):r.after(o+1)}return null}function Hh(t,e,n=e,r=le.empty){if(e==n&&!r.size)return null;let i=t.resolve(e),s=t.resolve(n);return yC(i,s,r)?new Ft(e,n,r):new Xj(i,s,r).fit()}function yC(t,e,n){return!n.openStart&&!n.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),n.content)}class Xj{constructor(e,n,r){this.$from=e,this.$to=n,this.unplaced=r,this.frontier=[],this.placed=Y.empty;for(let i=0;i<=e.depth;i++){let s=e.node(i);this.frontier.push({type:s.type,match:s.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=Y.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let d=this.findFittable();d?this.placeNodes(d):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let s=this.placed,o=r.depth,l=i.depth;for(;o&&l&&s.childCount==1;)s=s.firstChild.content,o--,l--;let u=new le(s,o,l);return e>-1?new Ut(r.pos,e,this.$to.pos,this.$to.end(),u,n):u.size||r.pos!=this.$to.pos?new Ft(r.pos,i.pos,u):null}findFittable(){let e=this.unplaced.openStart;for(let n=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let s=n.firstChild;if(n.childCount>1&&(i=0),s.type.spec.isolating&&i<=r){e=r;break}n=s.content}for(let n=1;n<=2;n++)for(let r=n==1?e:this.unplaced.openStart;r>=0;r--){let i,s=null;r?(s=yp(this.unplaced.content,r-1).firstChild,i=s.content):i=this.unplaced.content;let o=i.firstChild;for(let l=this.depth;l>=0;l--){let{type:u,match:d}=this.frontier[l],h,f=null;if(n==1&&(o?d.matchType(o.type)||(f=d.fillBefore(Y.from(o),!1)):s&&u.compatibleContent(s.type)))return{sliceDepth:r,frontierDepth:l,parent:s,inject:f};if(n==2&&o&&(h=d.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:l,parent:s,wrap:h};if(s&&d.matchType(s.type))break}}}openMore(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=yp(e,n);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new le(e,n+1,Math.max(r,i.size+n>=e.size-r?n+1:0)),!0)}dropNode(){let{content:e,openStart:n,openEnd:r}=this.unplaced,i=yp(e,n);if(i.childCount<=1&&n>0){let s=e.size-n<=n+i.size;this.unplaced=new le(Rl(e,n-1,1),n-1,s?n-1:r)}else this.unplaced=new le(Rl(e,n,1),n,r)}placeNodes({sliceDepth:e,frontierDepth:n,parent:r,inject:i,wrap:s}){for(;this.depth>n;)this.closeFrontierNode();if(s)for(let v=0;v<s.length;v++)this.openFrontierNode(s[v]);let o=this.unplaced,l=r?r.content:o.content,u=o.openStart-e,d=0,h=[],{match:f,type:m}=this.frontier[n];if(i){for(let v=0;v<i.childCount;v++)h.push(i.child(v));f=f.matchFragment(i)}let g=l.size+e-(o.content.size-o.openEnd);for(;d<l.childCount;){let v=l.child(d),x=f.matchType(v.type);if(!x)break;d++,(d>1||u==0||v.content.size)&&(f=x,h.push(vC(v.mark(m.allowedMarks(v.marks)),d==1?u:0,d==l.childCount?g:-1)))}let _=d==l.childCount;_||(g=-1),this.placed=Dl(this.placed,n,Y.from(h)),this.frontier[n].match=f,_&&g<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let v=0,x=l;v<g;v++){let S=x.lastChild;this.frontier.push({type:S.type,match:S.contentMatchAt(S.childCount)}),x=S.content}this.unplaced=_?e==0?le.empty:new le(Rl(o.content,e-1,1),e-1,g<0?o.openEnd:e-1):new le(Rl(o.content,e,d),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],n;if(!e.type.isTextblock||!vp(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(n=this.findCloseLevel(this.$to))&&n.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let n=Math.min(this.depth,e.depth);n>=0;n--){let{match:r,type:i}=this.frontier[n],s=n<e.depth&&e.end(n+1)==e.pos+(e.depth-(n+1)),o=vp(e,n,i,r,s);if(o){for(let l=n-1;l>=0;l--){let{match:u,type:d}=this.frontier[l],h=vp(e,l,d,u,!0);if(!h||h.childCount)continue e}return{depth:n,fit:o,move:s?e.doc.resolve(e.after(n+1)):e}}}}close(e){let n=this.findCloseLevel(e);if(!n)return null;for(;this.depth>n.depth;)this.closeFrontierNode();n.fit.childCount&&(this.placed=Dl(this.placed,n.depth,n.fit)),e=n.move;for(let r=n.depth+1;r<=e.depth;r++){let i=e.node(r),s=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,s)}return e}openFrontierNode(e,n=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=Dl(this.placed,this.depth,Y.from(e.create(n,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let n=this.frontier.pop().match.fillBefore(Y.empty,!0);n.childCount&&(this.placed=Dl(this.placed,this.frontier.length,n))}}function Rl(t,e,n){return e==0?t.cutByIndex(n,t.childCount):t.replaceChild(0,t.firstChild.copy(Rl(t.firstChild.content,e-1,n)))}function Dl(t,e,n){return e==0?t.append(n):t.replaceChild(t.childCount-1,t.lastChild.copy(Dl(t.lastChild.content,e-1,n)))}function yp(t,e){for(let n=0;n<e;n++)t=t.firstChild.content;return t}function vC(t,e,n){if(e<=0)return t;let r=t.content;return e>1&&(r=r.replaceChild(0,vC(r.firstChild,e-1,r.childCount==1?n-1:0))),e>0&&(r=t.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(t.type.contentMatch.matchFragment(r).fillBefore(Y.empty,!0)))),t.copy(r)}function vp(t,e,n,r,i){let s=t.node(e),o=i?t.indexAfter(e):t.index(e);if(o==s.childCount&&!n.compatibleContent(s.type))return null;let l=r.fillBefore(s.content,!0,o);return l&&!e2(n,s.content,o)?l:null}function e2(t,e,n){for(let r=n;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}function t2(t){return t.spec.defining||t.spec.definingForContent}function n2(t,e,n,r){if(!r.size)return t.deleteRange(e,n);let i=t.doc.resolve(e),s=t.doc.resolve(n);if(yC(i,s,r))return t.step(new Ft(e,n,r));let o=wC(i,t.doc.resolve(n));o[o.length-1]==0&&o.pop();let l=-(i.depth+1);o.unshift(l);for(let m=i.depth,g=i.pos-1;m>0;m--,g--){let _=i.node(m).type.spec;if(_.defining||_.definingAsContext||_.isolating)break;o.indexOf(m)>-1?l=m:i.before(m)==g&&o.splice(1,0,-m)}let u=o.indexOf(l),d=[],h=r.openStart;for(let m=r.content,g=0;;g++){let _=m.firstChild;if(d.push(_),g==r.openStart)break;m=_.content}for(let m=h-1;m>=0;m--){let g=d[m],_=t2(g.type);if(_&&!g.sameMarkup(i.node(Math.abs(l)-1)))h=m;else if(_||!g.type.isTextblock)break}for(let m=r.openStart;m>=0;m--){let g=(m+h+1)%(r.openStart+1),_=d[g];if(_)for(let v=0;v<o.length;v++){let x=o[(v+u)%o.length],S=!0;x<0&&(S=!1,x=-x);let k=i.node(x-1),C=i.index(x-1);if(k.canReplaceWith(C,C,_.type,_.marks))return t.replace(i.before(x),S?s.after(x):n,new le(_C(r.content,0,r.openStart,g),g,r.openEnd))}}let f=t.steps.length;for(let m=o.length-1;m>=0&&(t.replace(e,n,r),!(t.steps.length>f));m--){let g=o[m];g<0||(e=i.before(g),n=s.after(g))}}function _C(t,e,n,r,i){if(e<n){let s=t.firstChild;t=t.replaceChild(0,s.copy(_C(s.content,e+1,n,r,s)))}if(e>r){let s=i.contentMatchAt(0),o=s.fillBefore(t).append(t);t=o.append(s.matchFragment(o).fillBefore(Y.empty,!0))}return t}function r2(t,e,n,r){if(!r.isInline&&e==n&&t.doc.resolve(e).parent.content.size){let i=Yj(t.doc,e,r.type);i!=null&&(e=n=i)}t.replaceRange(e,n,new le(Y.from(r),0,0))}function i2(t,e,n){let r=t.doc.resolve(e),i=t.doc.resolve(n),s=wC(r,i);for(let o=0;o<s.length;o++){let l=s[o],u=o==s.length-1;if(u&&l==0||r.node(l).type.contentMatch.validEnd)return t.delete(r.start(l),i.end(l));if(l>0&&(u||r.node(l-1).canReplace(r.index(l-1),i.indexAfter(l-1))))return t.delete(r.before(l),i.after(l))}for(let o=1;o<=r.depth&&o<=i.depth;o++)if(e-r.start(o)==r.depth-o&&n>r.end(o)&&i.end(o)-n!=i.depth-o&&r.start(o-1)==i.start(o-1)&&r.node(o-1).canReplace(r.index(o-1),i.index(o-1)))return t.delete(r.before(o),n);t.delete(e,n)}function wC(t,e){let n=[],r=Math.min(t.depth,e.depth);for(let i=r;i>=0;i--){let s=t.start(i);if(s<t.pos-(t.depth-i)||e.end(i)>e.pos+(e.depth-i)||t.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(s==e.start(i)||i==t.depth&&i==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==s-1)&&n.push(i)}return n}class Ma extends hn{constructor(e,n,r){super(),this.pos=e,this.attr=n,this.value=r}apply(e){let n=e.nodeAt(this.pos);if(!n)return xt.fail("No node at attribute step's position");let r=Object.create(null);for(let s in n.attrs)r[s]=n.attrs[s];r[this.attr]=this.value;let i=n.type.create(r,null,n.marks);return xt.fromReplace(e,this.pos,this.pos+1,new le(Y.from(i),0,n.isLeaf?0:1))}getMap(){return Wn.empty}invert(e){return new Ma(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let n=e.mapResult(this.pos,1);return n.deletedAfter?null:new Ma(n.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.pos!="number"||typeof n.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Ma(n.pos,n.attr,n.value)}}hn.jsonID("attr",Ma);class Mu extends hn{constructor(e,n){super(),this.attr=e,this.value=n}apply(e){let n=Object.create(null);for(let i in e.attrs)n[i]=e.attrs[i];n[this.attr]=this.value;let r=e.type.create(n,e.content,e.marks);return xt.ok(r)}getMap(){return Wn.empty}invert(e){return new Mu(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,n){if(typeof n.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Mu(n.attr,n.value)}}hn.jsonID("docAttr",Mu);let Fa=class extends Error{};Fa=function t(e){let n=Error.call(this,e);return n.__proto__=t.prototype,n};Fa.prototype=Object.create(Error.prototype);Fa.prototype.constructor=Fa;Fa.prototype.name="TransformError";class s2{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Pu}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let n=this.maybeStep(e);if(n.failed)throw new Fa(n.failed);return this}maybeStep(e){let n=e.apply(this.doc);return n.failed||this.addStep(e,n.doc),n}get docChanged(){return this.steps.length>0}addStep(e,n){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=n}replace(e,n=e,r=le.empty){let i=Hh(this.doc,e,n,r);return i&&this.step(i),this}replaceWith(e,n,r){return this.replace(e,n,new le(Y.from(r),0,0))}delete(e,n){return this.replace(e,n,le.empty)}insert(e,n){return this.replaceWith(e,e,n)}replaceRange(e,n,r){return n2(this,e,n,r),this}replaceRangeWith(e,n,r){return r2(this,e,n,r),this}deleteRange(e,n){return i2(this,e,n),this}lift(e,n){return Uj(this,e,n),this}join(e,n=1){return Jj(this,e,n),this}wrap(e,n){return qj(this,e,n),this}setBlockType(e,n=e,r,i=null){return Wj(this,e,n,r,i),this}setNodeMarkup(e,n,r=null,i){return Zj(this,e,n,r,i),this}setNodeAttribute(e,n,r){return this.step(new Ma(e,n,r)),this}setDocAttribute(e,n){return this.step(new Mu(e,n)),this}addNodeMark(e,n){return this.step(new as(e,n)),this}removeNodeMark(e,n){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(n instanceof Ge)n.isInSet(r.marks)&&this.step(new Oo(e,n));else{let i=r.marks,s,o=[];for(;s=n.isInSet(i);)o.push(new Oo(e,s)),i=s.removeFromSet(i);for(let l=o.length-1;l>=0;l--)this.step(o[l])}return this}split(e,n=1,r){return Qj(this,e,n,r),this}addMark(e,n,r){return Bj(this,e,n,r),this}removeMark(e,n,r){return Fj(this,e,n,r),this}clearIncompatible(e,n,r){return Xy(this,e,n,r),this}}const _p=Object.create(null);class Ne{constructor(e,n,r){this.$anchor=e,this.$head=n,this.ranges=r||[new o2(e.min(n),e.max(n))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let n=0;n<e.length;n++)if(e[n].$from.pos!=e[n].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,n=le.empty){let r=n.content.lastChild,i=null;for(let l=0;l<n.openEnd;l++)i=r,r=r.lastChild;let s=e.steps.length,o=this.ranges;for(let l=0;l<o.length;l++){let{$from:u,$to:d}=o[l],h=e.mapping.slice(s);e.replaceRange(h.map(u.pos),h.map(d.pos),l?le.empty:n),l==0&&W0(e,s,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,n){let r=e.steps.length,i=this.ranges;for(let s=0;s<i.length;s++){let{$from:o,$to:l}=i[s],u=e.mapping.slice(r),d=u.map(o.pos),h=u.map(l.pos);s?e.deleteRange(d,h):(e.replaceRangeWith(d,h,n),W0(e,r,n.isInline?-1:1))}}static findFrom(e,n,r=!1){let i=e.parent.inlineContent?new Ee(e):sa(e.node(0),e.parent,e.pos,e.index(),n,r);if(i)return i;for(let s=e.depth-1;s>=0;s--){let o=n<0?sa(e.node(0),e.node(s),e.before(s+1),e.index(s),n,r):sa(e.node(0),e.node(s),e.after(s+1),e.index(s)+1,n,r);if(o)return o}return null}static near(e,n=1){return this.findFrom(e,n)||this.findFrom(e,-n)||new Qn(e.node(0))}static atStart(e){return sa(e,e,0,0,1)||new Qn(e)}static atEnd(e){return sa(e,e,e.content.size,e.childCount,-1)||new Qn(e)}static fromJSON(e,n){if(!n||!n.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=_p[n.type];if(!r)throw new RangeError(`No selection type ${n.type} defined`);return r.fromJSON(e,n)}static jsonID(e,n){if(e in _p)throw new RangeError("Duplicate use of selection JSON ID "+e);return _p[e]=n,n.prototype.jsonID=e,n}getBookmark(){return Ee.between(this.$anchor,this.$head).getBookmark()}}Ne.prototype.visible=!0;class o2{constructor(e,n){this.$from=e,this.$to=n}}let H0=!1;function q0(t){!H0&&!t.parent.inlineContent&&(H0=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class Ee extends Ne{constructor(e,n=e){q0(e),q0(n),super(e,n)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,n){let r=e.resolve(n.map(this.head));if(!r.parent.inlineContent)return Ne.near(r);let i=e.resolve(n.map(this.anchor));return new Ee(i.parent.inlineContent?i:r,r)}replace(e,n=le.empty){if(super.replace(e,n),n==le.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof Ee&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new qh(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,n){if(typeof n.anchor!="number"||typeof n.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Ee(e.resolve(n.anchor),e.resolve(n.head))}static create(e,n,r=n){let i=e.resolve(n);return new this(i,r==n?i:e.resolve(r))}static between(e,n,r){let i=e.pos-n.pos;if((!r||i)&&(r=i>=0?1:-1),!n.parent.inlineContent){let s=Ne.findFrom(n,r,!0)||Ne.findFrom(n,-r,!0);if(s)n=s.$head;else return Ne.near(n,r)}return e.parent.inlineContent||(i==0?e=n:(e=(Ne.findFrom(e,-r,!0)||Ne.findFrom(e,r,!0)).$anchor,e.pos<n.pos!=i<0&&(e=n))),new Ee(e,n)}}Ne.jsonID("text",Ee);class qh{constructor(e,n){this.anchor=e,this.head=n}map(e){return new qh(e.map(this.anchor),e.map(this.head))}resolve(e){return Ee.between(e.resolve(this.anchor),e.resolve(this.head))}}class _e extends Ne{constructor(e){let n=e.nodeAfter,r=e.node(0).resolve(e.pos+n.nodeSize);super(e,r),this.node=n}map(e,n){let{deleted:r,pos:i}=n.mapResult(this.anchor),s=e.resolve(i);return r?Ne.near(s):new _e(s)}content(){return new le(Y.from(this.node),0,0)}eq(e){return e instanceof _e&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new tv(this.anchor)}static fromJSON(e,n){if(typeof n.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new _e(e.resolve(n.anchor))}static create(e,n){return new _e(e.resolve(n))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}_e.prototype.visible=!1;Ne.jsonID("node",_e);class tv{constructor(e){this.anchor=e}map(e){let{deleted:n,pos:r}=e.mapResult(this.anchor);return n?new qh(r,r):new tv(r)}resolve(e){let n=e.resolve(this.anchor),r=n.nodeAfter;return r&&_e.isSelectable(r)?new _e(n):Ne.near(n)}}class Qn extends Ne{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,n=le.empty){if(n==le.empty){e.delete(0,e.doc.content.size);let r=Ne.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,n)}toJSON(){return{type:"all"}}static fromJSON(e){return new Qn(e)}map(e){return new Qn(e)}eq(e){return e instanceof Qn}getBookmark(){return a2}}Ne.jsonID("all",Qn);const a2={map(){return this},resolve(t){return new Qn(t)}};function sa(t,e,n,r,i,s=!1){if(e.inlineContent)return Ee.create(t,n);for(let o=r-(i>0?0:1);i>0?o<e.childCount:o>=0;o+=i){let l=e.child(o);if(l.isAtom){if(!s&&_e.isSelectable(l))return _e.create(t,n-(i<0?l.nodeSize:0))}else{let u=sa(t,l,n+i,i<0?l.childCount:0,i,s);if(u)return u}n+=l.nodeSize*i}return null}function W0(t,e,n){let r=t.steps.length-1;if(r<e)return;let i=t.steps[r];if(!(i instanceof Ft||i instanceof Ut))return;let s=t.mapping.maps[r],o;s.forEach((l,u,d,h)=>{o==null&&(o=h)}),t.setSelection(Ne.near(t.doc.resolve(o),n))}const K0=1,Uc=2,Z0=4;class l2 extends s2{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|K0)&~Uc,this.storedMarks=null,this}get selectionSet(){return(this.updated&K0)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Uc,this}ensureMarks(e){return Ge.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Uc)>0}addStep(e,n){super.addStep(e,n),this.updated=this.updated&~Uc,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,n=!0){let r=this.selection;return n&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Ge.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,n,r){let i=this.doc.type.schema;if(n==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=n),r=r??n,!e)return this.deleteRange(n,r);let s=this.storedMarks;if(!s){let o=this.doc.resolve(n);s=r==n?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(n,r,i.text(e,s)),this.selection.empty||this.setSelection(Ne.near(this.selection.$to)),this}}setMeta(e,n){return this.meta[typeof e=="string"?e:e.key]=n,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=Z0,this}get scrolledIntoView(){return(this.updated&Z0)>0}}function Q0(t,e){return!e||!t?t:t.bind(e)}class Al{constructor(e,n,r){this.name=e,this.init=Q0(n.init,r),this.apply=Q0(n.apply,r)}}const u2=[new Al("doc",{init(t){return t.doc||t.schema.topNodeType.createAndFill()},apply(t){return t.doc}}),new Al("selection",{init(t,e){return t.selection||Ne.atStart(e.doc)},apply(t){return t.selection}}),new Al("storedMarks",{init(t){return t.storedMarks||null},apply(t,e,n,r){return r.selection.$cursor?t.storedMarks:null}}),new Al("scrollToSelection",{init(){return 0},apply(t,e){return t.scrolledIntoView?e+1:e}})];class wp{constructor(e,n){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=u2.slice(),n&&n.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Al(r.key,r.spec.state,r))})}}class _a{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,n=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=n){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let n=[e],r=this.applyInner(e),i=null;for(;;){let s=!1;for(let o=0;o<this.config.plugins.length;o++){let l=this.config.plugins[o];if(l.spec.appendTransaction){let u=i?i[o].n:0,d=i?i[o].state:this,h=u<n.length&&l.spec.appendTransaction.call(l,u?n.slice(u):n,d,r);if(h&&r.filterTransaction(h,o)){if(h.setMeta("appendedTransaction",e),!i){i=[];for(let f=0;f<this.config.plugins.length;f++)i.push(f<o?{state:r,n:n.length}:{state:this,n:0})}n.push(h),r=r.applyInner(h),s=!0}i&&(i[o]={state:r,n:n.length})}}if(!s)return{state:r,transactions:n}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let n=new _a(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let s=r[i];n[s.name]=s.apply(e,this[s.name],this,n)}return n}get tr(){return new l2(this)}static create(e){let n=new wp(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new _a(n);for(let i=0;i<n.fields.length;i++)r[n.fields[i].name]=n.fields[i].init(e,r);return r}reconfigure(e){let n=new wp(this.schema,e.plugins),r=n.fields,i=new _a(n);for(let s=0;s<r.length;s++){let o=r[s].name;i[o]=this.hasOwnProperty(o)?this[o]:r[s].init(e,i)}return i}toJSON(e){let n={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(n.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],s=i.spec.state;s&&s.toJSON&&(n[r]=s.toJSON.call(i,this[i.key]))}return n}static fromJSON(e,n,r){if(!n)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new wp(e.schema,e.plugins),s=new _a(i);return i.fields.forEach(o=>{if(o.name=="doc")s.doc=vs.fromJSON(e.schema,n.doc);else if(o.name=="selection")s.selection=Ne.fromJSON(s.doc,n.selection);else if(o.name=="storedMarks")n.storedMarks&&(s.storedMarks=n.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let l in r){let u=r[l],d=u.spec.state;if(u.key==o.name&&d&&d.fromJSON&&Object.prototype.hasOwnProperty.call(n,l)){s[o.name]=d.fromJSON.call(u,e,n[l],s);return}}s[o.name]=o.init(e,s)}}),s}}function bC(t,e,n){for(let r in t){let i=t[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=bC(i,e,{})),n[r]=i}return n}class Fn{constructor(e){this.spec=e,this.props={},e.props&&bC(e.props,this,this.props),this.key=e.key?e.key.key:xC("plugin")}getState(e){return e[this.key]}}const bp=Object.create(null);function xC(t){return t in bp?t+"$"+ ++bp[t]:(bp[t]=0,t+"$")}class Xr{constructor(e="key"){this.key=xC(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Yt=function(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e},$a=function(t){let e=t.assignedSlot||t.parentNode;return e&&e.nodeType==11?e.host:e};let hg=null;const mi=function(t,e,n){let r=hg||(hg=document.createRange());return r.setEnd(t,n??t.nodeValue.length),r.setStart(t,e||0),r},c2=function(){hg=null},No=function(t,e,n,r){return n&&(G0(t,e,n,r,-1)||G0(t,e,n,r,1))},d2=/^(img|br|input|textarea|hr)$/i;function G0(t,e,n,r,i){for(var s;;){if(t==n&&e==r)return!0;if(e==(i<0?0:hr(t))){let o=t.parentNode;if(!o||o.nodeType!=1||Zu(t)||d2.test(t.nodeName)||t.contentEditable=="false")return!1;e=Yt(t)+(i<0?0:1),t=o}else if(t.nodeType==1){let o=t.childNodes[e+(i<0?-1:0)];if(o.nodeType==1&&o.contentEditable=="false")if(!((s=o.pmViewDesc)===null||s===void 0)&&s.ignoreForSelection)e+=i;else return!1;else t=o,e=i<0?hr(t):0}else return!1}}function hr(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function h2(t,e){for(;;){if(t.nodeType==3&&e)return t;if(t.nodeType==1&&e>0){if(t.contentEditable=="false")return null;t=t.childNodes[e-1],e=hr(t)}else if(t.parentNode&&!Zu(t))e=Yt(t),t=t.parentNode;else return null}}function f2(t,e){for(;;){if(t.nodeType==3&&e<t.nodeValue.length)return t;if(t.nodeType==1&&e<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[e],e=0}else if(t.parentNode&&!Zu(t))e=Yt(t)+1,t=t.parentNode;else return null}}function p2(t,e,n){for(let r=e==0,i=e==hr(t);r||i;){if(t==n)return!0;let s=Yt(t);if(t=t.parentNode,!t)return!1;r=r&&s==0,i=i&&s==hr(t)}}function Zu(t){let e;for(let n=t;n&&!(e=n.pmViewDesc);n=n.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==t||e.contentDOM==t)}const Wh=function(t){return t.focusNode&&No(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)};function ro(t,e){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=t,n.key=n.code=e,n}function m2(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function g2(t,e,n){if(t.caretPositionFromPoint)try{let r=t.caretPositionFromPoint(e,n);if(r)return{node:r.offsetNode,offset:Math.min(hr(r.offsetNode),r.offset)}}catch{}if(t.caretRangeFromPoint){let r=t.caretRangeFromPoint(e,n);if(r)return{node:r.startContainer,offset:Math.min(hr(r.startContainer),r.startOffset)}}}const Jr=typeof navigator<"u"?navigator:null,J0=typeof document<"u"?document:null,Ds=Jr&&Jr.userAgent||"",fg=/Edge\/(\d+)/.exec(Ds),SC=/MSIE \d/.exec(Ds),pg=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ds),zn=!!(SC||pg||fg),ws=SC?document.documentMode:pg?+pg[1]:fg?+fg[1]:0,gr=!zn&&/gecko\/(\d+)/i.test(Ds);gr&&+(/Firefox\/(\d+)/.exec(Ds)||[0,0])[1];const mg=!zn&&/Chrome\/(\d+)/.exec(Ds),cn=!!mg,kC=mg?+mg[1]:0,_n=!zn&&!!Jr&&/Apple Computer/.test(Jr.vendor),Ua=_n&&(/Mobile\/\w+/.test(Ds)||!!Jr&&Jr.maxTouchPoints>2),ur=Ua||(Jr?/Mac/.test(Jr.platform):!1),y2=Jr?/Win/.test(Jr.platform):!1,_i=/Android \d/.test(Ds),Qu=!!J0&&"webkitFontSmoothing"in J0.documentElement.style,v2=Qu?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function _2(t){let e=t.defaultView&&t.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.documentElement.clientWidth,top:0,bottom:t.documentElement.clientHeight}}function di(t,e){return typeof t=="number"?t:t[e]}function w2(t){let e=t.getBoundingClientRect(),n=e.width/t.offsetWidth||1,r=e.height/t.offsetHeight||1;return{left:e.left,right:e.left+t.clientWidth*n,top:e.top,bottom:e.top+t.clientHeight*r}}function Y0(t,e,n){let r=t.someProp("scrollThreshold")||0,i=t.someProp("scrollMargin")||5,s=t.dom.ownerDocument;for(let o=n||t.dom;o;){if(o.nodeType!=1){o=$a(o);continue}let l=o,u=l==s.body,d=u?_2(s):w2(l),h=0,f=0;if(e.top<d.top+di(r,"top")?f=-(d.top-e.top+di(i,"top")):e.bottom>d.bottom-di(r,"bottom")&&(f=e.bottom-e.top>d.bottom-d.top?e.top+di(i,"top")-d.top:e.bottom-d.bottom+di(i,"bottom")),e.left<d.left+di(r,"left")?h=-(d.left-e.left+di(i,"left")):e.right>d.right-di(r,"right")&&(h=e.right-d.right+di(i,"right")),h||f)if(u)s.defaultView.scrollBy(h,f);else{let g=l.scrollLeft,_=l.scrollTop;f&&(l.scrollTop+=f),h&&(l.scrollLeft+=h);let v=l.scrollLeft-g,x=l.scrollTop-_;e={left:e.left-v,top:e.top-x,right:e.right-v,bottom:e.bottom-x}}let m=u?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(m))break;o=m=="absolute"?o.offsetParent:$a(o)}}function b2(t){let e=t.dom.getBoundingClientRect(),n=Math.max(0,e.top),r,i;for(let s=(e.left+e.right)/2,o=n+1;o<Math.min(innerHeight,e.bottom);o+=5){let l=t.root.elementFromPoint(s,o);if(!l||l==t.dom||!t.dom.contains(l))continue;let u=l.getBoundingClientRect();if(u.top>=n-20){r=l,i=u.top;break}}return{refDOM:r,refTop:i,stack:CC(t.dom)}}function CC(t){let e=[],n=t.ownerDocument;for(let r=t;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),t!=n);r=$a(r));return e}function x2({refDOM:t,refTop:e,stack:n}){let r=t?t.getBoundingClientRect().top:0;EC(n,r==0?0:r-e)}function EC(t,e){for(let n=0;n<t.length;n++){let{dom:r,top:i,left:s}=t[n];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=s&&(r.scrollLeft=s)}}let ta=null;function S2(t){if(t.setActive)return t.setActive();if(ta)return t.focus(ta);let e=CC(t);t.focus(ta==null?{get preventScroll(){return ta={preventScroll:!0},!0}}:void 0),ta||(ta=!1,EC(e,0))}function TC(t,e){let n,r=2e8,i,s=0,o=e.top,l=e.top,u,d;for(let h=t.firstChild,f=0;h;h=h.nextSibling,f++){let m;if(h.nodeType==1)m=h.getClientRects();else if(h.nodeType==3)m=mi(h).getClientRects();else continue;for(let g=0;g<m.length;g++){let _=m[g];if(_.top<=o&&_.bottom>=l){o=Math.max(_.bottom,o),l=Math.min(_.top,l);let v=_.left>e.left?_.left-e.left:_.right<e.left?e.left-_.right:0;if(v<r){n=h,r=v,i=v&&n.nodeType==3?{left:_.right<e.left?_.right:_.left,top:e.top}:e,h.nodeType==1&&v&&(s=f+(e.left>=(_.left+_.right)/2?1:0));continue}}else _.top>e.top&&!u&&_.left<=e.left&&_.right>=e.left&&(u=h,d={left:Math.max(_.left,Math.min(_.right,e.left)),top:_.top});!n&&(e.left>=_.right&&e.top>=_.top||e.left>=_.left&&e.top>=_.bottom)&&(s=f+1)}}return!n&&u&&(n=u,i=d,r=0),n&&n.nodeType==3?k2(n,i):!n||r&&n.nodeType==1?{node:t,offset:s}:TC(n,i)}function k2(t,e){let n=t.nodeValue.length,r=document.createRange();for(let i=0;i<n;i++){r.setEnd(t,i+1),r.setStart(t,i);let s=Wi(r,1);if(s.top!=s.bottom&&nv(e,s))return{node:t,offset:i+(e.left>=(s.left+s.right)/2?1:0)}}return{node:t,offset:0}}function nv(t,e){return t.left>=e.left-1&&t.left<=e.right+1&&t.top>=e.top-1&&t.top<=e.bottom+1}function C2(t,e){let n=t.parentNode;return n&&/^li$/i.test(n.nodeName)&&e.left<t.getBoundingClientRect().left?n:t}function E2(t,e,n){let{node:r,offset:i}=TC(e,n),s=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();s=o.left!=o.right&&n.left>(o.left+o.right)/2?1:-1}return t.docView.posFromDOM(r,i,s)}function T2(t,e,n,r){let i=-1;for(let s=e,o=!1;s!=t.dom;){let l=t.docView.nearestDesc(s,!0),u;if(!l)return null;if(l.dom.nodeType==1&&(l.node.isBlock&&l.parent||!l.contentDOM)&&((u=l.dom.getBoundingClientRect()).width||u.height)&&(l.node.isBlock&&l.parent&&!/^T(R|BODY|HEAD|FOOT)$/.test(l.dom.nodeName)&&(!o&&u.left>r.left||u.top>r.top?i=l.posBefore:(!o&&u.right<r.left||u.bottom<r.top)&&(i=l.posAfter),o=!0),!l.contentDOM&&i<0&&!l.node.isText))return(l.node.isBlock?r.top<(u.top+u.bottom)/2:r.left<(u.left+u.right)/2)?l.posBefore:l.posAfter;s=l.dom.parentNode}return i>-1?i:t.docView.posFromDOM(e,n,-1)}function PC(t,e,n){let r=t.childNodes.length;if(r&&n.top<n.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-n.top)/(n.bottom-n.top))-2)),s=i;;){let o=t.childNodes[s];if(o.nodeType==1){let l=o.getClientRects();for(let u=0;u<l.length;u++){let d=l[u];if(nv(e,d))return PC(o,e,d)}}if((s=(s+1)%r)==i)break}return t}function P2(t,e){let n=t.dom.ownerDocument,r,i=0,s=g2(n,e.left,e.top);s&&({node:r,offset:i}=s);let o=(t.root.elementFromPoint?t.root:n).elementFromPoint(e.left,e.top),l;if(!o||!t.dom.contains(o.nodeType!=1?o.parentNode:o)){let d=t.dom.getBoundingClientRect();if(!nv(e,d)||(o=PC(t.dom,e,d),!o))return null}if(_n)for(let d=o;r&&d;d=$a(d))d.draggable&&(r=void 0);if(o=C2(o,e),r){if(gr&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let h=r.childNodes[i],f;h.nodeName=="IMG"&&(f=h.getBoundingClientRect()).right<=e.left&&f.bottom>e.top&&i++}let d;Qu&&i&&r.nodeType==1&&(d=r.childNodes[i-1]).nodeType==1&&d.contentEditable=="false"&&d.getBoundingClientRect().top>=e.top&&i--,r==t.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?l=t.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(l=T2(t,r,i,e))}l==null&&(l=E2(t,o,e));let u=t.docView.nearestDesc(o,!0);return{pos:l,inside:u?u.posAtStart-u.border:-1}}function X0(t){return t.top<t.bottom||t.left<t.right}function Wi(t,e){let n=t.getClientRects();if(n.length){let r=n[e<0?0:n.length-1];if(X0(r))return r}return Array.prototype.find.call(n,X0)||t.getBoundingClientRect()}const M2=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function MC(t,e,n){let{node:r,offset:i,atom:s}=t.docView.domFromPos(e,n<0?-1:1),o=Qu||gr;if(r.nodeType==3)if(o&&(M2.test(r.nodeValue)||(n<0?!i:i==r.nodeValue.length))){let u=Wi(mi(r,i,i),n);if(gr&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let d=Wi(mi(r,i-1,i-1),-1);if(d.top==u.top){let h=Wi(mi(r,i,i+1),-1);if(h.top!=u.top)return El(h,h.left<d.left)}}return u}else{let u=i,d=i,h=n<0?1:-1;return n<0&&!i?(d++,h=-1):n>=0&&i==r.nodeValue.length?(u--,h=1):n<0?u--:d++,El(Wi(mi(r,u,d),h),h<0)}if(!t.state.doc.resolve(e-(s||0)).parent.inlineContent){if(s==null&&i&&(n<0||i==hr(r))){let u=r.childNodes[i-1];if(u.nodeType==1)return xp(u.getBoundingClientRect(),!1)}if(s==null&&i<hr(r)){let u=r.childNodes[i];if(u.nodeType==1)return xp(u.getBoundingClientRect(),!0)}return xp(r.getBoundingClientRect(),n>=0)}if(s==null&&i&&(n<0||i==hr(r))){let u=r.childNodes[i-1],d=u.nodeType==3?mi(u,hr(u)-(o?0:1)):u.nodeType==1&&(u.nodeName!="BR"||!u.nextSibling)?u:null;if(d)return El(Wi(d,1),!1)}if(s==null&&i<hr(r)){let u=r.childNodes[i];for(;u.pmViewDesc&&u.pmViewDesc.ignoreForCoords;)u=u.nextSibling;let d=u?u.nodeType==3?mi(u,0,o?0:1):u.nodeType==1?u:null:null;if(d)return El(Wi(d,-1),!0)}return El(Wi(r.nodeType==3?mi(r):r,-n),n>=0)}function El(t,e){if(t.width==0)return t;let n=e?t.left:t.right;return{top:t.top,bottom:t.bottom,left:n,right:n}}function xp(t,e){if(t.height==0)return t;let n=e?t.top:t.bottom;return{top:n,bottom:n,left:t.left,right:t.right}}function OC(t,e,n){let r=t.state,i=t.root.activeElement;r!=e&&t.updateState(e),i!=t.dom&&t.focus();try{return n()}finally{r!=e&&t.updateState(r),i!=t.dom&&i&&i.focus()}}function O2(t,e,n){let r=e.selection,i=n=="up"?r.$from:r.$to;return OC(t,e,()=>{let{node:s}=t.docView.domFromPos(i.pos,n=="up"?-1:1);for(;;){let l=t.docView.nearestDesc(s,!0);if(!l)break;if(l.node.isBlock){s=l.contentDOM||l.dom;break}s=l.dom.parentNode}let o=MC(t,i.pos,1);for(let l=s.firstChild;l;l=l.nextSibling){let u;if(l.nodeType==1)u=l.getClientRects();else if(l.nodeType==3)u=mi(l,0,l.nodeValue.length).getClientRects();else continue;for(let d=0;d<u.length;d++){let h=u[d];if(h.bottom>h.top+1&&(n=="up"?o.top-h.top>(h.bottom-o.top)*2:h.bottom-o.bottom>(o.bottom-h.top)*2))return!1}}return!0})}const N2=/[\u0590-\u08ac]/;function L2(t,e,n){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,s=!i,o=i==r.parent.content.size,l=t.domSelection();return l?!N2.test(r.parent.textContent)||!l.modify?n=="left"||n=="backward"?s:o:OC(t,e,()=>{let{focusNode:u,focusOffset:d,anchorNode:h,anchorOffset:f}=t.domSelectionRange(),m=l.caretBidiLevel;l.modify("move",n,"character");let g=r.depth?t.docView.domAfterPos(r.before()):t.dom,{focusNode:_,focusOffset:v}=t.domSelectionRange(),x=_&&!g.contains(_.nodeType==1?_:_.parentNode)||u==_&&d==v;try{l.collapse(h,f),u&&(u!=h||d!=f)&&l.extend&&l.extend(u,d)}catch{}return m!=null&&(l.caretBidiLevel=m),x}):r.pos==r.start()||r.pos==r.end()}let eb=null,tb=null,nb=!1;function R2(t,e,n){return eb==e&&tb==n?nb:(eb=e,tb=n,nb=n=="up"||n=="down"?O2(t,e,n):L2(t,e,n))}const yr=0,rb=1,co=2,Yr=3;class Gu{constructor(e,n,r,i){this.parent=e,this.children=n,this.dom=r,this.contentDOM=i,this.dirty=yr,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,n,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let n=0;n<this.children.length;n++)e+=this.children[n].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let n=0,r=this.posAtStart;;n++){let i=this.children[n];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,n,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let s,o;if(e==this.contentDOM)s=e.childNodes[n-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.previousSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.previousSibling;return s?this.posBeforeChild(o)+o.size:this.posAtStart}else{let s,o;if(e==this.contentDOM)s=e.childNodes[n];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.nextSibling}for(;s&&!((o=s.pmViewDesc)&&o.parent==this);)s=s.nextSibling;return s?this.posBeforeChild(o):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=n>Yt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(n==0)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!1;break}if(s.previousSibling)break}if(i==null&&n==e.childNodes.length)for(let s=e;;s=s.parentNode){if(s==this.dom){i=!0;break}if(s.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,n=!1){for(let r=!0,i=e;i;i=i.parentNode){let s=this.getDesc(i),o;if(s&&(!n||s.node))if(r&&(o=s.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return s}}getDesc(e){let n=e.pmViewDesc;for(let r=n;r;r=r.parent)if(r==this)return n}posFromDOM(e,n,r){for(let i=e;i;i=i.parentNode){let s=this.getDesc(i);if(s)return s.localPosFromDOM(e,n,r)}return-1}descAt(e){for(let n=0,r=0;n<this.children.length;n++){let i=this.children[n],s=r+i.size;if(r==e&&s!=r){for(;!i.border&&i.children.length;)for(let o=0;o<i.children.length;o++){let l=i.children[o];if(l.size){i=l;break}}return i}if(e<s)return i.descAt(e-r-i.border);r=s}}domFromPos(e,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let s=0;r<this.children.length;r++){let o=this.children[r],l=s+o.size;if(l>e||o instanceof LC){i=e-s;break}s=l}if(i)return this.children[r].domFromPos(i-this.children[r].border,n);for(let s;r&&!(s=this.children[r-1]).size&&s instanceof NC&&s.side>=0;r--);if(n<=0){let s,o=!0;for(;s=r?this.children[r-1]:null,!(!s||s.dom.parentNode==this.contentDOM);r--,o=!1);return s&&n&&o&&!s.border&&!s.domAtom?s.domFromPos(s.size,n):{node:this.contentDOM,offset:s?Yt(s.dom)+1:0}}else{let s,o=!0;for(;s=r<this.children.length?this.children[r]:null,!(!s||s.dom.parentNode==this.contentDOM);r++,o=!1);return s&&o&&!s.border&&!s.domAtom?s.domFromPos(0,n):{node:this.contentDOM,offset:s?Yt(s.dom):this.contentDOM.childNodes.length}}}parseRange(e,n,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,s=-1;for(let o=r,l=0;;l++){let u=this.children[l],d=o+u.size;if(i==-1&&e<=d){let h=o+u.border;if(e>=h&&n<=d-u.border&&u.node&&u.contentDOM&&this.contentDOM.contains(u.contentDOM))return u.parseRange(e,n,h);e=o;for(let f=l;f>0;f--){let m=this.children[f-1];if(m.size&&m.dom.parentNode==this.contentDOM&&!m.emptyChildAt(1)){i=Yt(m.dom)+1;break}e-=m.size}i==-1&&(i=0)}if(i>-1&&(d>n||l==this.children.length-1)){n=d;for(let h=l+1;h<this.children.length;h++){let f=this.children[h];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){s=Yt(f.dom);break}n+=f.size}s==-1&&(s=this.contentDOM.childNodes.length);break}o=d}return{node:this.contentDOM,from:e,to:n,fromOffset:i,toOffset:s}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[e<0?0:this.children.length-1];return n.size==0||n.emptyChildAt(e)}domAfterPos(e){let{node:n,offset:r}=this.domFromPos(e,0);if(n.nodeType!=1||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]}setSelection(e,n,r,i=!1){let s=Math.min(e,n),o=Math.max(e,n);for(let g=0,_=0;g<this.children.length;g++){let v=this.children[g],x=_+v.size;if(s>_&&o<x)return v.setSelection(e-_-v.border,n-_-v.border,r,i);_=x}let l=this.domFromPos(e,e?-1:1),u=n==e?l:this.domFromPos(n,n?-1:1),d=r.root.getSelection(),h=r.domSelectionRange(),f=!1;if((gr||_n)&&e==n){let{node:g,offset:_}=l;if(g.nodeType==3){if(f=!!(_&&g.nodeValue[_-1]==`
`),f&&_==g.nodeValue.length)for(let v=g,x;v;v=v.parentNode){if(x=v.nextSibling){x.nodeName=="BR"&&(l=u={node:x.parentNode,offset:Yt(x)+1});break}let S=v.pmViewDesc;if(S&&S.node&&S.node.isBlock)break}}else{let v=g.childNodes[_-1];f=v&&(v.nodeName=="BR"||v.contentEditable=="false")}}if(gr&&h.focusNode&&h.focusNode!=u.node&&h.focusNode.nodeType==1){let g=h.focusNode.childNodes[h.focusOffset];g&&g.contentEditable=="false"&&(i=!0)}if(!(i||f&&_n)&&No(l.node,l.offset,h.anchorNode,h.anchorOffset)&&No(u.node,u.offset,h.focusNode,h.focusOffset))return;let m=!1;if((d.extend||e==n)&&!(f&&gr)){d.collapse(l.node,l.offset);try{e!=n&&d.extend(u.node,u.offset),m=!0}catch{}}if(!m){if(e>n){let _=l;l=u,u=_}let g=document.createRange();g.setEnd(u.node,u.offset),g.setStart(l.node,l.offset),d.removeAllRanges(),d.addRange(g)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,n){for(let r=0,i=0;i<this.children.length;i++){let s=this.children[i],o=r+s.size;if(r==o?e<=o&&n>=r:e<o&&n>r){let l=r+s.border,u=o-s.border;if(e>=l&&n<=u){this.dirty=e==r||n==o?co:rb,e==l&&n==u&&(s.contentLost||s.dom.parentNode!=this.contentDOM)?s.dirty=Yr:s.markDirty(e-l,n-l);return}else s.dirty=s.dom==s.contentDOM&&s.dom.parentNode==this.contentDOM&&!s.children.length?co:Yr}r=o}this.dirty=co}markParentsDirty(){let e=1;for(let n=this.parent;n;n=n.parent,e++){let r=e==1?co:rb;n.dirty<r&&(n.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class NC extends Gu{constructor(e,n,r,i){let s,o=n.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!s)return i;if(s.parent)return s.parent.posBeforeChild(s)})),!n.type.spec.raw){if(o.nodeType!=1){let l=document.createElement("span");l.appendChild(o),o=l}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=n,this.widget=n,s=this}matchesWidget(e){return this.dirty==yr&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let n=this.widget.spec.stopEvent;return n?n(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class D2 extends Gu{constructor(e,n,r,i){super(e,[],n,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,n){return e!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Lo extends Gu{constructor(e,n,r,i,s){super(e,[],r,i),this.mark=n,this.spec=s}static create(e,n,r,i){let s=i.nodeViews[n.type.name],o=s&&s(n,i,r);return(!o||!o.dom)&&(o=zo.renderSpec(document,n.type.spec.toDOM(n,r),null,n.attrs)),new Lo(e,n,o.dom,o.contentDOM||o.dom,o)}parseRule(){return this.dirty&Yr||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Yr&&this.mark.eq(e)}markDirty(e,n){if(super.markDirty(e,n),this.dirty!=yr){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=yr}}slice(e,n,r){let i=Lo.create(this.parent,this.mark,!0,r),s=this.children,o=this.size;n<o&&(s=yg(s,n,o,r)),e>0&&(s=yg(s,0,e,r));for(let l=0;l<s.length;l++)s[l].parent=i;return i.children=s,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class bs extends Gu{constructor(e,n,r,i,s,o,l,u,d){super(e,[],s,o),this.node=n,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=l}static create(e,n,r,i,s,o){let l=s.nodeViews[n.type.name],u,d=l&&l(n,s,()=>{if(!u)return o;if(u.parent)return u.parent.posBeforeChild(u)},r,i),h=d&&d.dom,f=d&&d.contentDOM;if(n.isText){if(!h)h=document.createTextNode(n.text);else if(h.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else h||({dom:h,contentDOM:f}=zo.renderSpec(document,n.type.spec.toDOM(n),null,n.attrs));!f&&!n.isText&&h.nodeName!="BR"&&(h.hasAttribute("contenteditable")||(h.contentEditable="false"),n.type.spec.draggable&&(h.draggable=!0));let m=h;return h=AC(h,r,n),d?u=new A2(e,n,r,i,h,f||null,m,d,s,o+1):n.isText?new Kh(e,n,r,i,h,m,s):new bs(e,n,r,i,h,f||null,m,s,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let n=this.children.length-1;n>=0;n--){let r=this.children[n];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>Y.empty)}return e}matchesNode(e,n,r){return this.dirty==yr&&e.eq(this.node)&&nh(n,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,n){let r=this.node.inlineContent,i=n,s=e.composing?this.localCompositionInfo(e,n):null,o=s&&s.pos>-1?s:null,l=s&&s.pos<0,u=new j2(this,o&&o.node,e);F2(this.node,this.innerDeco,(d,h,f)=>{d.spec.marks?u.syncToMarks(d.spec.marks,r,e):d.type.side>=0&&!f&&u.syncToMarks(h==this.node.childCount?Ge.none:this.node.child(h).marks,r,e),u.placeWidget(d,e,i)},(d,h,f,m)=>{u.syncToMarks(d.marks,r,e);let g;u.findNodeMatch(d,h,f,m)||l&&e.state.selection.from>i&&e.state.selection.to<i+d.nodeSize&&(g=u.findIndexWithChild(s.node))>-1&&u.updateNodeAt(d,h,f,g,e)||u.updateNextNode(d,h,f,e,m,i)||u.addNode(d,h,f,e,i),i+=d.nodeSize}),u.syncToMarks([],r,e),this.node.isTextblock&&u.addTextblockHacks(),u.destroyRest(),(u.changed||this.dirty==co)&&(o&&this.protectLocalComposition(e,o),RC(this.contentDOM,this.children,e),Ua&&$2(this.dom))}localCompositionInfo(e,n){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof Ee)||r<n||i>n+this.node.content.size)return null;let s=e.input.compositionNode;if(!s||!this.dom.contains(s.parentNode))return null;if(this.node.inlineContent){let o=s.nodeValue,l=U2(this.node.content,o,r-n,i-n);return l<0?null:{node:s,pos:l,text:o}}else return{node:s,pos:-1,text:""}}protectLocalComposition(e,{node:n,pos:r,text:i}){if(this.getDesc(n))return;let s=n;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let o=new D2(this,s,n,i);e.input.compositionNodes.push(o),this.children=yg(this.children,r,r+i.length,e,o)}update(e,n,r,i){return this.dirty==Yr||!e.sameMarkup(this.node)?!1:(this.updateInner(e,n,r,i),!0)}updateInner(e,n,r,i){this.updateOuterDeco(n),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=yr}updateOuterDeco(e){if(nh(e,this.outerDeco))return;let n=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=DC(this.dom,this.nodeDOM,gg(this.outerDeco,this.node,n),gg(e,this.node,n)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.nodeDOM.draggable=!0))}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.nodeDOM.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function ib(t,e,n,r,i){AC(r,e,t);let s=new bs(void 0,t,e,n,r,r,r,i,0);return s.contentDOM&&s.updateChildren(i,0),s}class Kh extends bs{constructor(e,n,r,i,s,o,l){super(e,n,r,i,s,null,o,l,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,n,r,i){return this.dirty==Yr||this.dirty!=yr&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(n),(this.dirty!=yr||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=yr,!0)}inParent(){let e=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,n,r){return e==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(e,n,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,n,r){let i=this.node.cut(e,n),s=document.createTextNode(i.text);return new Kh(this.parent,i,this.outerDeco,this.innerDeco,s,s,r)}markDirty(e,n){super.markDirty(e,n),this.dom!=this.nodeDOM&&(e==0||n==this.nodeDOM.nodeValue.length)&&(this.dirty=Yr)}get domAtom(){return!1}isText(e){return this.node.text==e}}class LC extends Gu{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==yr&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class A2 extends bs{constructor(e,n,r,i,s,o,l,u,d,h){super(e,n,r,i,s,o,l,d,h),this.spec=u}update(e,n,r,i){if(this.dirty==Yr)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let s=this.spec.update(e,n,r);return s&&this.updateInner(e,n,r,i),s}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,n,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,n,r,i){this.spec.setSelection?this.spec.setSelection(e,n,r.root):super.setSelection(e,n,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function RC(t,e,n){let r=t.firstChild,i=!1;for(let s=0;s<e.length;s++){let o=e[s],l=o.dom;if(l.parentNode==t){for(;l!=r;)r=sb(r),i=!0;r=r.nextSibling}else i=!0,t.insertBefore(l,r);if(o instanceof Lo){let u=r?r.previousSibling:t.lastChild;RC(o.contentDOM,o.children,n),r=u?u.nextSibling:t.firstChild}}for(;r;)r=sb(r),i=!0;i&&n.trackWrites==t&&(n.trackWrites=null)}const Xl=function(t){t&&(this.nodeName=t)};Xl.prototype=Object.create(null);const ho=[new Xl];function gg(t,e,n){if(t.length==0)return ho;let r=n?ho[0]:new Xl,i=[r];for(let s=0;s<t.length;s++){let o=t[s].type.attrs;if(o){o.nodeName&&i.push(r=new Xl(o.nodeName));for(let l in o){let u=o[l];u!=null&&(n&&i.length==1&&i.push(r=new Xl(e.isInline?"span":"div")),l=="class"?r.class=(r.class?r.class+" ":"")+u:l=="style"?r.style=(r.style?r.style+";":"")+u:l!="nodeName"&&(r[l]=u))}}}return i}function DC(t,e,n,r){if(n==ho&&r==ho)return e;let i=e;for(let s=0;s<r.length;s++){let o=r[s],l=n[s];if(s){let u;l&&l.nodeName==o.nodeName&&i!=t&&(u=i.parentNode)&&u.nodeName.toLowerCase()==o.nodeName||(u=document.createElement(o.nodeName),u.pmIsDeco=!0,u.appendChild(i),l=ho[0]),i=u}I2(i,l||ho[0],o)}return i}function I2(t,e,n){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in n)&&t.removeAttribute(r);for(let r in n)r!="class"&&r!="style"&&r!="nodeName"&&n[r]!=e[r]&&t.setAttribute(r,n[r]);if(e.class!=n.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=n.class?n.class.split(" ").filter(Boolean):[];for(let s=0;s<r.length;s++)i.indexOf(r[s])==-1&&t.classList.remove(r[s]);for(let s=0;s<i.length;s++)r.indexOf(i[s])==-1&&t.classList.add(i[s]);t.classList.length==0&&t.removeAttribute("class")}if(e.style!=n.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)t.style.removeProperty(i[1])}n.style&&(t.style.cssText+=n.style)}}function AC(t,e,n){return DC(t,t,ho,gg(e,n,t.nodeType!=1))}function nh(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].type.eq(e[n].type))return!1;return!0}function sb(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class j2{constructor(e,n,r){this.lock=n,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=z2(e.node.content,e)}destroyBetween(e,n){if(e!=n){for(let r=e;r<n;r++)this.top.children[r].destroy();this.top.children.splice(e,n-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,n,r){let i=0,s=this.stack.length>>1,o=Math.min(s,e.length);for(;i<o&&(i==s-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<s;)this.destroyRest(),this.top.dirty=yr,this.index=this.stack.pop(),this.top=this.stack.pop(),s--;for(;s<e.length;){this.stack.push(this.top,this.index+1);let l=-1;for(let u=this.index;u<Math.min(this.index+3,this.top.children.length);u++){let d=this.top.children[u];if(d.matchesMark(e[s])&&!this.isLocked(d.dom)){l=u;break}}if(l>-1)l>this.index&&(this.changed=!0,this.destroyBetween(this.index,l)),this.top=this.top.children[this.index];else{let u=Lo.create(this.top,e[s],n,r);this.top.children.splice(this.index,0,u),this.top=u,this.changed=!0}this.index=0,s++}}findNodeMatch(e,n,r,i){let s=-1,o;if(i>=this.preMatch.index&&(o=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&o.matchesNode(e,n,r))s=this.top.children.indexOf(o,this.index);else for(let l=this.index,u=Math.min(this.top.children.length,l+5);l<u;l++){let d=this.top.children[l];if(d.matchesNode(e,n,r)&&!this.preMatch.matched.has(d)){s=l;break}}return s<0?!1:(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(e,n,r,i,s){let o=this.top.children[i];return o.dirty==Yr&&o.dom==o.contentDOM&&(o.dirty=co),o.update(e,n,r,s)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let n=e.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=n}}updateNextNode(e,n,r,i,s,o){for(let l=this.index;l<this.top.children.length;l++){let u=this.top.children[l];if(u instanceof bs){let d=this.preMatch.matched.get(u);if(d!=null&&d!=s)return!1;let h=u.dom,f,m=this.isLocked(h)&&!(e.isText&&u.node&&u.node.isText&&u.nodeDOM.nodeValue==e.text&&u.dirty!=Yr&&nh(n,u.outerDeco));if(!m&&u.update(e,n,r,i))return this.destroyBetween(this.index,l),u.dom!=h&&(this.changed=!0),this.index++,!0;if(!m&&(f=this.recreateWrapper(u,e,n,r,i,o)))return this.destroyBetween(this.index,l),this.top.children[this.index]=f,f.contentDOM&&(f.dirty=co,f.updateChildren(i,o+1),f.dirty=yr),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,n,r,i,s,o){if(e.dirty||n.isAtom||!e.children.length||!e.node.content.eq(n.content)||!nh(r,e.outerDeco)||!i.eq(e.innerDeco))return null;let l=bs.create(this.top,n,r,i,s,o);if(l.contentDOM){l.children=e.children,e.children=[];for(let u of l.children)u.parent=l}return e.destroy(),l}addNode(e,n,r,i,s){let o=bs.create(this.top,e,n,r,i,s);o.contentDOM&&o.updateChildren(i,s+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,n,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let s=new NC(this.top,e,n,r);this.top.children.splice(this.index++,0,s),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],n=this.top;for(;e instanceof Lo;)n=e,e=n.children[n.children.length-1];(!e||!(e instanceof Kh)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((_n||cn)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(e,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new LC(this.top,[],r,null);n!=this.top?n.children.push(i):n.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function z2(t,e){let n=e,r=n.children.length,i=t.childCount,s=new Map,o=[];e:for(;i>0;){let l;for(;;)if(r){let d=n.children[r-1];if(d instanceof Lo)n=d,r=d.children.length;else{l=d,r--;break}}else{if(n==e)break e;r=n.parent.children.indexOf(n),n=n.parent}let u=l.node;if(u){if(u!=t.child(i-1))break;--i,s.set(l,i),o.push(l)}}return{index:i,matched:s,matches:o.reverse()}}function B2(t,e){return t.type.side-e.type.side}function F2(t,e,n,r){let i=e.locals(t),s=0;if(i.length==0){for(let d=0;d<t.childCount;d++){let h=t.child(d);r(h,i,e.forChild(s,h),d),s+=h.nodeSize}return}let o=0,l=[],u=null;for(let d=0;;){let h,f;for(;o<i.length&&i[o].to==s;){let x=i[o++];x.widget&&(h?(f||(f=[h])).push(x):h=x)}if(h)if(f){f.sort(B2);for(let x=0;x<f.length;x++)n(f[x],d,!!u)}else n(h,d,!!u);let m,g;if(u)g=-1,m=u,u=null;else if(d<t.childCount)g=d,m=t.child(d++);else break;for(let x=0;x<l.length;x++)l[x].to<=s&&l.splice(x--,1);for(;o<i.length&&i[o].from<=s&&i[o].to>s;)l.push(i[o++]);let _=s+m.nodeSize;if(m.isText){let x=_;o<i.length&&i[o].from<x&&(x=i[o].from);for(let S=0;S<l.length;S++)l[S].to<x&&(x=l[S].to);x<_&&(u=m.cut(x-s),m=m.cut(0,x-s),_=x,g=-1)}else for(;o<i.length&&i[o].to<_;)o++;let v=m.isInline&&!m.isLeaf?l.filter(x=>!x.inline):l.slice();r(m,v,e.forChild(s,m),g),s=_}}function $2(t){if(t.nodeName=="UL"||t.nodeName=="OL"){let e=t.style.cssText;t.style.cssText=e+"; list-style: square !important",window.getComputedStyle(t).listStyle,t.style.cssText=e}}function U2(t,e,n,r){for(let i=0,s=0;i<t.childCount&&s<=r;){let o=t.child(i++),l=s;if(s+=o.nodeSize,!o.isText)continue;let u=o.text;for(;i<t.childCount;){let d=t.child(i++);if(s+=d.nodeSize,!d.isText)break;u+=d.text}if(s>=n){if(s>=r&&u.slice(r-e.length-l,r-l)==e)return r-e.length;let d=l<r?u.lastIndexOf(e,r-l-1):-1;if(d>=0&&d+e.length+l>=n)return l+d;if(n==r&&u.length>=r+e.length-l&&u.slice(r-l,r-l+e.length)==e)return r}}return-1}function yg(t,e,n,r,i){let s=[];for(let o=0,l=0;o<t.length;o++){let u=t[o],d=l,h=l+=u.size;d>=n||h<=e?s.push(u):(d<e&&s.push(u.slice(0,e-d,r)),i&&(s.push(i),i=void 0),h>n&&s.push(u.slice(n-d,u.size,r)))}return s}function rv(t,e=null){let n=t.domSelectionRange(),r=t.state.doc;if(!n.focusNode)return null;let i=t.docView.nearestDesc(n.focusNode),s=i&&i.size==0,o=t.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(o<0)return null;let l=r.resolve(o),u,d;if(Wh(n)){for(u=o;i&&!i.node;)i=i.parent;let f=i.node;if(i&&f.isAtom&&_e.isSelectable(f)&&i.parent&&!(f.isInline&&p2(n.focusNode,n.focusOffset,i.dom))){let m=i.posBefore;d=new _e(o==m?l:r.resolve(m))}}else{if(n instanceof t.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let f=o,m=o;for(let g=0;g<n.rangeCount;g++){let _=n.getRangeAt(g);f=Math.min(f,t.docView.posFromDOM(_.startContainer,_.startOffset,1)),m=Math.max(m,t.docView.posFromDOM(_.endContainer,_.endOffset,-1))}if(f<0)return null;[u,o]=m==t.state.selection.anchor?[m,f]:[f,m],l=r.resolve(o)}else u=t.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(u<0)return null}let h=r.resolve(u);if(!d){let f=e=="pointer"||t.state.selection.head<l.pos&&!s?1:-1;d=iv(t,h,l,f)}return d}function IC(t){return t.editable?t.hasFocus():zC(t)&&document.activeElement&&document.activeElement.contains(t.dom)}function Si(t,e=!1){let n=t.state.selection;if(jC(t,n),!!IC(t)){if(!e&&t.input.mouseDown&&t.input.mouseDown.allowDefault&&cn){let r=t.domSelectionRange(),i=t.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&No(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){t.input.mouseDown.delayedSelectionSync=!0,t.domObserver.setCurSelection();return}}if(t.domObserver.disconnectSelection(),t.cursorWrapper)H2(t);else{let{anchor:r,head:i}=n,s,o;ob&&!(n instanceof Ee)&&(n.$from.parent.inlineContent||(s=ab(t,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(o=ab(t,n.to))),t.docView.setSelection(r,i,t,e),ob&&(s&&lb(s),o&&lb(o)),n.visible?t.dom.classList.remove("ProseMirror-hideselection"):(t.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&V2(t))}t.domObserver.setCurSelection(),t.domObserver.connectSelection()}}const ob=_n||cn&&kC<63;function ab(t,e){let{node:n,offset:r}=t.docView.domFromPos(e,0),i=r<n.childNodes.length?n.childNodes[r]:null,s=r?n.childNodes[r-1]:null;if(_n&&i&&i.contentEditable=="false")return Sp(i);if((!i||i.contentEditable=="false")&&(!s||s.contentEditable=="false")){if(i)return Sp(i);if(s)return Sp(s)}}function Sp(t){return t.contentEditable="true",_n&&t.draggable&&(t.draggable=!1,t.wasDraggable=!0),t}function lb(t){t.contentEditable="false",t.wasDraggable&&(t.draggable=!0,t.wasDraggable=null)}function V2(t){let e=t.dom.ownerDocument;e.removeEventListener("selectionchange",t.input.hideSelectionGuard);let n=t.domSelectionRange(),r=n.anchorNode,i=n.anchorOffset;e.addEventListener("selectionchange",t.input.hideSelectionGuard=()=>{(n.anchorNode!=r||n.anchorOffset!=i)&&(e.removeEventListener("selectionchange",t.input.hideSelectionGuard),setTimeout(()=>{(!IC(t)||t.state.selection.visible)&&t.dom.classList.remove("ProseMirror-hideselection")},20))})}function H2(t){let e=t.domSelection();if(!e)return;let n=t.cursorWrapper.dom,r=n.nodeName=="IMG";r?e.collapse(n.parentNode,Yt(n)+1):e.collapse(n,0),!r&&!t.state.selection.visible&&zn&&ws<=11&&(n.disabled=!0,n.disabled=!1)}function jC(t,e){if(e instanceof _e){let n=t.docView.descAt(e.from);n!=t.lastSelectedViewDesc&&(ub(t),n&&n.selectNode(),t.lastSelectedViewDesc=n)}else ub(t)}function ub(t){t.lastSelectedViewDesc&&(t.lastSelectedViewDesc.parent&&t.lastSelectedViewDesc.deselectNode(),t.lastSelectedViewDesc=void 0)}function iv(t,e,n,r){return t.someProp("createSelectionBetween",i=>i(t,e,n))||Ee.between(e,n,r)}function cb(t){return t.editable&&!t.hasFocus()?!1:zC(t)}function zC(t){let e=t.domSelectionRange();if(!e.anchorNode)return!1;try{return t.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(t.editable||t.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function q2(t){let e=t.docView.domFromPos(t.state.selection.anchor,0),n=t.domSelectionRange();return No(e.node,e.offset,n.anchorNode,n.anchorOffset)}function vg(t,e){let{$anchor:n,$head:r}=t.selection,i=e>0?n.max(r):n.min(r),s=i.parent.inlineContent?i.depth?t.doc.resolve(e>0?i.after():i.before()):null:i;return s&&Ne.findFrom(s,e)}function Gi(t,e){return t.dispatch(t.state.tr.setSelection(e).scrollIntoView()),!0}function db(t,e,n){let r=t.state.selection;if(r instanceof Ee)if(n.indexOf("s")>-1){let{$head:i}=r,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!s||s.isText||!s.isLeaf)return!1;let o=t.state.doc.resolve(i.pos+s.nodeSize*(e<0?-1:1));return Gi(t,new Ee(r.$anchor,o))}else if(r.empty){if(t.endOfTextblock(e>0?"forward":"backward")){let i=vg(t.state,e);return i&&i instanceof _e?Gi(t,i):!1}else if(!(ur&&n.indexOf("m")>-1)){let i=r.$head,s=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,o;if(!s||s.isText)return!1;let l=e<0?i.pos-s.nodeSize:i.pos;return s.isAtom||(o=t.docView.descAt(l))&&!o.contentDOM?_e.isSelectable(s)?Gi(t,new _e(e<0?t.state.doc.resolve(i.pos-s.nodeSize):i)):Qu?Gi(t,new Ee(t.state.doc.resolve(e<0?l:l+s.nodeSize))):!1:!1}}else return!1;else{if(r instanceof _e&&r.node.isInline)return Gi(t,new Ee(e>0?r.$to:r.$from));{let i=vg(t.state,e);return i?Gi(t,i):!1}}}function rh(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function eu(t,e){let n=t.pmViewDesc;return n&&n.size==0&&(e<0||t.nextSibling||t.nodeName!="BR")}function na(t,e){return e<0?W2(t):K2(t)}function W2(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i,s,o=!1;for(gr&&n.nodeType==1&&r<rh(n)&&eu(n.childNodes[r],-1)&&(o=!0);;)if(r>0){if(n.nodeType!=1)break;{let l=n.childNodes[r-1];if(eu(l,-1))i=n,s=--r;else if(l.nodeType==3)n=l,r=n.nodeValue.length;else break}}else{if(BC(n))break;{let l=n.previousSibling;for(;l&&eu(l,-1);)i=n.parentNode,s=Yt(l),l=l.previousSibling;if(l)n=l,r=rh(n);else{if(n=n.parentNode,n==t.dom)break;r=0}}}o?_g(t,n,r):i&&_g(t,i,s)}function K2(t){let e=t.domSelectionRange(),n=e.focusNode,r=e.focusOffset;if(!n)return;let i=rh(n),s,o;for(;;)if(r<i){if(n.nodeType!=1)break;let l=n.childNodes[r];if(eu(l,1))s=n,o=++r;else break}else{if(BC(n))break;{let l=n.nextSibling;for(;l&&eu(l,1);)s=l.parentNode,o=Yt(l)+1,l=l.nextSibling;if(l)n=l,r=0,i=rh(n);else{if(n=n.parentNode,n==t.dom)break;r=i=0}}}s&&_g(t,s,o)}function BC(t){let e=t.pmViewDesc;return e&&e.node&&e.node.isBlock}function Z2(t,e){for(;t&&e==t.childNodes.length&&!Zu(t);)e=Yt(t)+1,t=t.parentNode;for(;t&&e<t.childNodes.length;){let n=t.childNodes[e];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=0}}function Q2(t,e){for(;t&&!e&&!Zu(t);)e=Yt(t),t=t.parentNode;for(;t&&e;){let n=t.childNodes[e-1];if(n.nodeType==3)return n;if(n.nodeType==1&&n.contentEditable=="false")break;t=n,e=t.childNodes.length}}function _g(t,e,n){if(e.nodeType!=3){let s,o;(o=Z2(e,n))?(e=o,n=0):(s=Q2(e,n))&&(e=s,n=s.nodeValue.length)}let r=t.domSelection();if(!r)return;if(Wh(r)){let s=document.createRange();s.setEnd(e,n),s.setStart(e,n),r.removeAllRanges(),r.addRange(s)}else r.extend&&r.extend(e,n);t.domObserver.setCurSelection();let{state:i}=t;setTimeout(()=>{t.state==i&&Si(t)},50)}function hb(t,e){let n=t.state.doc.resolve(e);if(!(cn||y2)&&n.parent.inlineContent){let i=t.coordsAtPos(e);if(e>n.start()){let s=t.coordsAtPos(e-1),o=(s.top+s.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(s.left-i.left)>1)return s.left<i.left?"ltr":"rtl"}if(e<n.end()){let s=t.coordsAtPos(e+1),o=(s.top+s.bottom)/2;if(o>i.top&&o<i.bottom&&Math.abs(s.left-i.left)>1)return s.left>i.left?"ltr":"rtl"}}return getComputedStyle(t.dom).direction=="rtl"?"rtl":"ltr"}function fb(t,e,n){let r=t.state.selection;if(r instanceof Ee&&!r.empty||n.indexOf("s")>-1||ur&&n.indexOf("m")>-1)return!1;let{$from:i,$to:s}=r;if(!i.parent.inlineContent||t.endOfTextblock(e<0?"up":"down")){let o=vg(t.state,e);if(o&&o instanceof _e)return Gi(t,o)}if(!i.parent.inlineContent){let o=e<0?i:s,l=r instanceof Qn?Ne.near(o,e):Ne.findFrom(o,e);return l?Gi(t,l):!1}return!1}function pb(t,e){if(!(t.state.selection instanceof Ee))return!0;let{$head:n,$anchor:r,empty:i}=t.state.selection;if(!n.sameParent(r))return!0;if(!i)return!1;if(t.endOfTextblock(e>0?"forward":"backward"))return!0;let s=!n.textOffset&&(e<0?n.nodeBefore:n.nodeAfter);if(s&&!s.isText){let o=t.state.tr;return e<0?o.delete(n.pos-s.nodeSize,n.pos):o.delete(n.pos,n.pos+s.nodeSize),t.dispatch(o),!0}return!1}function mb(t,e,n){t.domObserver.stop(),e.contentEditable=n,t.domObserver.start()}function G2(t){if(!_n||t.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:n}=t.domSelectionRange();if(e&&e.nodeType==1&&n==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;mb(t,r,"true"),setTimeout(()=>mb(t,r,"false"),20)}return!1}function J2(t){let e="";return t.ctrlKey&&(e+="c"),t.metaKey&&(e+="m"),t.altKey&&(e+="a"),t.shiftKey&&(e+="s"),e}function Y2(t,e){let n=e.keyCode,r=J2(e);if(n==8||ur&&n==72&&r=="c")return pb(t,-1)||na(t,-1);if(n==46&&!e.shiftKey||ur&&n==68&&r=="c")return pb(t,1)||na(t,1);if(n==13||n==27)return!0;if(n==37||ur&&n==66&&r=="c"){let i=n==37?hb(t,t.state.selection.from)=="ltr"?-1:1:-1;return db(t,i,r)||na(t,i)}else if(n==39||ur&&n==70&&r=="c"){let i=n==39?hb(t,t.state.selection.from)=="ltr"?1:-1:1;return db(t,i,r)||na(t,i)}else{if(n==38||ur&&n==80&&r=="c")return fb(t,-1,r)||na(t,-1);if(n==40||ur&&n==78&&r=="c")return G2(t)||fb(t,1,r)||na(t,1);if(r==(ur?"m":"c")&&(n==66||n==73||n==89||n==90))return!0}return!1}function sv(t,e){t.someProp("transformCopied",g=>{e=g(e,t)});let n=[],{content:r,openStart:i,openEnd:s}=e;for(;i>1&&s>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,s--;let g=r.firstChild;n.push(g.type.name,g.attrs!=g.type.defaultAttrs?g.attrs:null),r=g.content}let o=t.someProp("clipboardSerializer")||zo.fromSchema(t.state.schema),l=qC(),u=l.createElement("div");u.appendChild(o.serializeFragment(r,{document:l}));let d=u.firstChild,h,f=0;for(;d&&d.nodeType==1&&(h=HC[d.nodeName.toLowerCase()]);){for(let g=h.length-1;g>=0;g--){let _=l.createElement(h[g]);for(;u.firstChild;)_.appendChild(u.firstChild);u.appendChild(_),f++}d=u.firstChild}d&&d.nodeType==1&&d.setAttribute("data-pm-slice",`${i} ${s}${f?` -${f}`:""} ${JSON.stringify(n)}`);let m=t.someProp("clipboardTextSerializer",g=>g(e,t))||e.content.textBetween(0,e.content.size,`

`);return{dom:u,text:m,slice:e}}function FC(t,e,n,r,i){let s=i.parent.type.spec.code,o,l;if(!n&&!e)return null;let u=!!e&&(r||s||!n);if(u){if(t.someProp("transformPastedText",m=>{e=m(e,s||r,t)}),s)return l=new le(Y.from(t.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0),t.someProp("transformPasted",m=>{l=m(l,t,!0)}),l;let f=t.someProp("clipboardTextParser",m=>m(e,i,r,t));if(f)l=f;else{let m=i.marks(),{schema:g}=t.state,_=zo.fromSchema(g);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(v=>{let x=o.appendChild(document.createElement("p"));v&&x.appendChild(_.serializeNode(g.text(v,m)))})}}else t.someProp("transformPastedHTML",f=>{n=f(n,t)}),o=nz(n),Qu&&rz(o);let d=o&&o.querySelector("[data-pm-slice]"),h=d&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(d.getAttribute("data-pm-slice")||"");if(h&&h[3])for(let f=+h[3];f>0;f--){let m=o.firstChild;for(;m&&m.nodeType!=1;)m=m.nextSibling;if(!m)break;o=m}if(l||(l=(t.someProp("clipboardParser")||t.someProp("domParser")||_s.fromSchema(t.state.schema)).parseSlice(o,{preserveWhitespace:!!(u||h),context:i,ruleFromNode(m){return m.nodeName=="BR"&&!m.nextSibling&&m.parentNode&&!X2.test(m.parentNode.nodeName)?{ignore:!0}:null}})),h)l=iz(gb(l,+h[1],+h[2]),h[4]);else if(l=le.maxOpen(ez(l.content,i),!0),l.openStart||l.openEnd){let f=0,m=0;for(let g=l.content.firstChild;f<l.openStart&&!g.type.spec.isolating;f++,g=g.firstChild);for(let g=l.content.lastChild;m<l.openEnd&&!g.type.spec.isolating;m++,g=g.lastChild);l=gb(l,f,m)}return t.someProp("transformPasted",f=>{l=f(l,t,u)}),l}const X2=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function ez(t,e){if(t.childCount<2)return t;for(let n=e.depth;n>=0;n--){let i=e.node(n).contentMatchAt(e.index(n)),s,o=[];if(t.forEach(l=>{if(!o)return;let u=i.findWrapping(l.type),d;if(!u)return o=null;if(d=o.length&&s.length&&UC(u,s,l,o[o.length-1],0))o[o.length-1]=d;else{o.length&&(o[o.length-1]=VC(o[o.length-1],s.length));let h=$C(l,u);o.push(h),i=i.matchType(h.type),s=u}}),o)return Y.from(o)}return t}function $C(t,e,n=0){for(let r=e.length-1;r>=n;r--)t=e[r].create(null,Y.from(t));return t}function UC(t,e,n,r,i){if(i<t.length&&i<e.length&&t[i]==e[i]){let s=UC(t,e,n,r.lastChild,i+1);if(s)return r.copy(r.content.replaceChild(r.childCount-1,s));if(r.contentMatchAt(r.childCount).matchType(i==t.length-1?n.type:t[i+1]))return r.copy(r.content.append(Y.from($C(n,t,i+1))))}}function VC(t,e){if(e==0)return t;let n=t.content.replaceChild(t.childCount-1,VC(t.lastChild,e-1)),r=t.contentMatchAt(t.childCount).fillBefore(Y.empty,!0);return t.copy(n.append(r))}function wg(t,e,n,r,i,s){let o=e<0?t.firstChild:t.lastChild,l=o.content;return t.childCount>1&&(s=0),i<r-1&&(l=wg(l,e,n,r,i+1,s)),i>=n&&(l=e<0?o.contentMatchAt(0).fillBefore(l,s<=i).append(l):l.append(o.contentMatchAt(o.childCount).fillBefore(Y.empty,!0))),t.replaceChild(e<0?0:t.childCount-1,o.copy(l))}function gb(t,e,n){return e<t.openStart&&(t=new le(wg(t.content,-1,e,t.openStart,0,t.openEnd),e,t.openEnd)),n<t.openEnd&&(t=new le(wg(t.content,1,n,t.openEnd,0,0),t.openStart,n)),t}const HC={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let yb=null;function qC(){return yb||(yb=document.implementation.createHTMLDocument("title"))}let kp=null;function tz(t){let e=window.trustedTypes;return e?(kp||(kp=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:n=>n})),kp.createHTML(t)):t}function nz(t){let e=/^(\s*<meta [^>]*>)*/.exec(t);e&&(t=t.slice(e[0].length));let n=qC().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(t),i;if((i=r&&HC[r[1].toLowerCase()])&&(t=i.map(s=>"<"+s+">").join("")+t+i.map(s=>"</"+s+">").reverse().join("")),n.innerHTML=tz(t),i)for(let s=0;s<i.length;s++)n=n.querySelector(i[s])||n;return n}function rz(t){let e=t.querySelectorAll(cn?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<e.length;n++){let r=e[n];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(t.ownerDocument.createTextNode(" "),r)}}function iz(t,e){if(!t.size)return t;let n=t.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return t}let{content:i,openStart:s,openEnd:o}=t;for(let l=r.length-2;l>=0;l-=2){let u=n.nodes[r[l]];if(!u||u.hasRequiredAttrs())break;i=Y.from(u.create(r[l+1],i)),s++,o++}return new le(i,s,o)}const wn={},bn={},sz={touchstart:!0,touchmove:!0};class oz{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function az(t){for(let e in wn){let n=wn[e];t.dom.addEventListener(e,t.input.eventHandlers[e]=r=>{uz(t,r)&&!ov(t,r)&&(t.editable||!(r.type in bn))&&n(t,r)},sz[e]?{passive:!0}:void 0)}_n&&t.dom.addEventListener("input",()=>null),bg(t)}function ls(t,e){t.input.lastSelectionOrigin=e,t.input.lastSelectionTime=Date.now()}function lz(t){t.domObserver.stop();for(let e in t.input.eventHandlers)t.dom.removeEventListener(e,t.input.eventHandlers[e]);clearTimeout(t.input.composingTimeout),clearTimeout(t.input.lastIOSEnterFallbackTimeout)}function bg(t){t.someProp("handleDOMEvents",e=>{for(let n in e)t.input.eventHandlers[n]||t.dom.addEventListener(n,t.input.eventHandlers[n]=r=>ov(t,r))})}function ov(t,e){return t.someProp("handleDOMEvents",n=>{let r=n[e.type];return r?r(t,e)||e.defaultPrevented:!1})}function uz(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target;n!=t.dom;n=n.parentNode)if(!n||n.nodeType==11||n.pmViewDesc&&n.pmViewDesc.stopEvent(e))return!1;return!0}function cz(t,e){!ov(t,e)&&wn[e.type]&&(t.editable||!(e.type in bn))&&wn[e.type](t,e)}bn.keydown=(t,e)=>{let n=e;if(t.input.shiftKey=n.keyCode==16||n.shiftKey,!KC(t,n)&&(t.input.lastKeyCode=n.keyCode,t.input.lastKeyCodeTime=Date.now(),!(_i&&cn&&n.keyCode==13)))if(n.keyCode!=229&&t.domObserver.forceFlush(),Ua&&n.keyCode==13&&!n.ctrlKey&&!n.altKey&&!n.metaKey){let r=Date.now();t.input.lastIOSEnter=r,t.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{t.input.lastIOSEnter==r&&(t.someProp("handleKeyDown",i=>i(t,ro(13,"Enter"))),t.input.lastIOSEnter=0)},200)}else t.someProp("handleKeyDown",r=>r(t,n))||Y2(t,n)?n.preventDefault():ls(t,"key")};bn.keyup=(t,e)=>{e.keyCode==16&&(t.input.shiftKey=!1)};bn.keypress=(t,e)=>{let n=e;if(KC(t,n)||!n.charCode||n.ctrlKey&&!n.altKey||ur&&n.metaKey)return;if(t.someProp("handleKeyPress",i=>i(t,n))){n.preventDefault();return}let r=t.state.selection;if(!(r instanceof Ee)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(n.charCode),s=()=>t.state.tr.insertText(i).scrollIntoView();!/[\r\n]/.test(i)&&!t.someProp("handleTextInput",o=>o(t,r.$from.pos,r.$to.pos,i,s))&&t.dispatch(s()),n.preventDefault()}};function Zh(t){return{left:t.clientX,top:t.clientY}}function dz(t,e){let n=e.x-t.clientX,r=e.y-t.clientY;return n*n+r*r<100}function av(t,e,n,r,i){if(r==-1)return!1;let s=t.state.doc.resolve(r);for(let o=s.depth+1;o>0;o--)if(t.someProp(e,l=>o>s.depth?l(t,n,s.nodeAfter,s.before(o),i,!0):l(t,n,s.node(o),s.before(o),i,!1)))return!0;return!1}function Oa(t,e,n){if(t.focused||t.focus(),t.state.selection.eq(e))return;let r=t.state.tr.setSelection(e);r.setMeta("pointer",!0),t.dispatch(r)}function hz(t,e){if(e==-1)return!1;let n=t.state.doc.resolve(e),r=n.nodeAfter;return r&&r.isAtom&&_e.isSelectable(r)?(Oa(t,new _e(n)),!0):!1}function fz(t,e){if(e==-1)return!1;let n=t.state.selection,r,i;n instanceof _e&&(r=n.node);let s=t.state.doc.resolve(e);for(let o=s.depth+1;o>0;o--){let l=o>s.depth?s.nodeAfter:s.node(o);if(_e.isSelectable(l)){r&&n.$from.depth>0&&o>=n.$from.depth&&s.before(n.$from.depth+1)==n.$from.pos?i=s.before(n.$from.depth):i=s.before(o);break}}return i!=null?(Oa(t,_e.create(t.state.doc,i)),!0):!1}function pz(t,e,n,r,i){return av(t,"handleClickOn",e,n,r)||t.someProp("handleClick",s=>s(t,e,r))||(i?fz(t,n):hz(t,n))}function mz(t,e,n,r){return av(t,"handleDoubleClickOn",e,n,r)||t.someProp("handleDoubleClick",i=>i(t,e,r))}function gz(t,e,n,r){return av(t,"handleTripleClickOn",e,n,r)||t.someProp("handleTripleClick",i=>i(t,e,r))||yz(t,n,r)}function yz(t,e,n){if(n.button!=0)return!1;let r=t.state.doc;if(e==-1)return r.inlineContent?(Oa(t,Ee.create(r,0,r.content.size)),!0):!1;let i=r.resolve(e);for(let s=i.depth+1;s>0;s--){let o=s>i.depth?i.nodeAfter:i.node(s),l=i.before(s);if(o.inlineContent)Oa(t,Ee.create(r,l+1,l+1+o.content.size));else if(_e.isSelectable(o))Oa(t,_e.create(r,l));else continue;return!0}}function lv(t){return ih(t)}const WC=ur?"metaKey":"ctrlKey";wn.mousedown=(t,e)=>{let n=e;t.input.shiftKey=n.shiftKey;let r=lv(t),i=Date.now(),s="singleClick";i-t.input.lastClick.time<500&&dz(n,t.input.lastClick)&&!n[WC]&&t.input.lastClick.button==n.button&&(t.input.lastClick.type=="singleClick"?s="doubleClick":t.input.lastClick.type=="doubleClick"&&(s="tripleClick")),t.input.lastClick={time:i,x:n.clientX,y:n.clientY,type:s,button:n.button};let o=t.posAtCoords(Zh(n));o&&(s=="singleClick"?(t.input.mouseDown&&t.input.mouseDown.done(),t.input.mouseDown=new vz(t,o,n,!!r)):(s=="doubleClick"?mz:gz)(t,o.pos,o.inside,n)?n.preventDefault():ls(t,"pointer"))};class vz{constructor(e,n,r,i){this.view=e,this.pos=n,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[WC],this.allowDefault=r.shiftKey;let s,o;if(n.inside>-1)s=e.state.doc.nodeAt(n.inside),o=n.inside;else{let h=e.state.doc.resolve(n.pos);s=h.parent,o=h.depth?h.before():0}const l=i?null:r.target,u=l?e.docView.nearestDesc(l,!0):null;this.target=u&&u.nodeDOM.nodeType==1?u.nodeDOM:null;let{selection:d}=e.state;(r.button==0&&s.type.spec.draggable&&s.type.spec.selectable!==!1||d instanceof _e&&d.from<=o&&d.to>o)&&(this.mightDrag={node:s,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&gr&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),ls(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Si(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(Zh(e))),this.updateAllowDefault(e),this.allowDefault||!n?ls(this.view,"pointer"):pz(this.view,n.pos,n.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||_n&&this.mightDrag&&!this.mightDrag.node.isAtom||cn&&!this.view.state.selection.visible&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(Oa(this.view,Ne.near(this.view.state.doc.resolve(n.pos))),e.preventDefault()):ls(this.view,"pointer")}move(e){this.updateAllowDefault(e),ls(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}wn.touchstart=t=>{t.input.lastTouch=Date.now(),lv(t),ls(t,"pointer")};wn.touchmove=t=>{t.input.lastTouch=Date.now(),ls(t,"pointer")};wn.contextmenu=t=>lv(t);function KC(t,e){return t.composing?!0:_n&&Math.abs(e.timeStamp-t.input.compositionEndedAt)<500?(t.input.compositionEndedAt=-2e8,!0):!1}const _z=_i?5e3:-1;bn.compositionstart=bn.compositionupdate=t=>{if(!t.composing){t.domObserver.flush();let{state:e}=t,n=e.selection.$to;if(e.selection instanceof Ee&&(e.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))t.markCursor=t.state.storedMarks||n.marks(),ih(t,!0),t.markCursor=null;else if(ih(t,!e.selection.empty),gr&&e.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let r=t.domSelectionRange();for(let i=r.focusNode,s=r.focusOffset;i&&i.nodeType==1&&s!=0;){let o=s<0?i.lastChild:i.childNodes[s-1];if(!o)break;if(o.nodeType==3){let l=t.domSelection();l&&l.collapse(o,o.nodeValue.length);break}else i=o,s=-1}}t.input.composing=!0}ZC(t,_z)};bn.compositionend=(t,e)=>{t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=e.timeStamp,t.input.compositionPendingChanges=t.domObserver.pendingRecords().length?t.input.compositionID:0,t.input.compositionNode=null,t.input.compositionPendingChanges&&Promise.resolve().then(()=>t.domObserver.flush()),t.input.compositionID++,ZC(t,20))};function ZC(t,e){clearTimeout(t.input.composingTimeout),e>-1&&(t.input.composingTimeout=setTimeout(()=>ih(t),e))}function QC(t){for(t.composing&&(t.input.composing=!1,t.input.compositionEndedAt=bz());t.input.compositionNodes.length>0;)t.input.compositionNodes.pop().markParentsDirty()}function wz(t){let e=t.domSelectionRange();if(!e.focusNode)return null;let n=h2(e.focusNode,e.focusOffset),r=f2(e.focusNode,e.focusOffset);if(n&&r&&n!=r){let i=r.pmViewDesc,s=t.domObserver.lastChangedTextNode;if(n==s||r==s)return s;if(!i||!i.isText(r.nodeValue))return r;if(t.input.compositionNode==r){let o=n.pmViewDesc;if(!(!o||!o.isText(n.nodeValue)))return r}}return n||r}function bz(){let t=document.createEvent("Event");return t.initEvent("event",!0,!0),t.timeStamp}function ih(t,e=!1){if(!(_i&&t.domObserver.flushingSoon>=0)){if(t.domObserver.forceFlush(),QC(t),e||t.docView&&t.docView.dirty){let n=rv(t),r=t.state.selection;return n&&!n.eq(r)?t.dispatch(t.state.tr.setSelection(n)):(t.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?t.dispatch(t.state.tr.deleteSelection()):t.updateState(t.state),!0}return!1}}function xz(t,e){if(!t.dom.parentNode)return;let n=t.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(e),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),t.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),t.focus()},50)}const Ou=zn&&ws<15||Ua&&v2<604;wn.copy=bn.cut=(t,e)=>{let n=e,r=t.state.selection,i=n.type=="cut";if(r.empty)return;let s=Ou?null:n.clipboardData,o=r.content(),{dom:l,text:u}=sv(t,o);s?(n.preventDefault(),s.clearData(),s.setData("text/html",l.innerHTML),s.setData("text/plain",u)):xz(t,l),i&&t.dispatch(t.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function Sz(t){return t.openStart==0&&t.openEnd==0&&t.content.childCount==1?t.content.firstChild:null}function kz(t,e){if(!t.dom.parentNode)return;let n=t.input.shiftKey||t.state.selection.$from.parent.type.spec.code,r=t.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=t.input.shiftKey&&t.input.lastKeyCode!=45;setTimeout(()=>{t.focus(),r.parentNode&&r.parentNode.removeChild(r),n?Nu(t,r.value,null,i,e):Nu(t,r.textContent,r.innerHTML,i,e)},50)}function Nu(t,e,n,r,i){let s=FC(t,e,n,r,t.state.selection.$from);if(t.someProp("handlePaste",u=>u(t,i,s||le.empty)))return!0;if(!s)return!1;let o=Sz(s),l=o?t.state.tr.replaceSelectionWith(o,r):t.state.tr.replaceSelection(s);return t.dispatch(l.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function GC(t){let e=t.getData("text/plain")||t.getData("Text");if(e)return e;let n=t.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}bn.paste=(t,e)=>{let n=e;if(t.composing&&!_i)return;let r=Ou?null:n.clipboardData,i=t.input.shiftKey&&t.input.lastKeyCode!=45;r&&Nu(t,GC(r),r.getData("text/html"),i,n)?n.preventDefault():kz(t,n)};class JC{constructor(e,n,r){this.slice=e,this.move=n,this.node=r}}const Cz=ur?"altKey":"ctrlKey";function YC(t,e){let n=t.someProp("dragCopies",r=>!r(e));return n??!e[Cz]}wn.dragstart=(t,e)=>{let n=e,r=t.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let i=t.state.selection,s=i.empty?null:t.posAtCoords(Zh(n)),o;if(!(s&&s.pos>=i.from&&s.pos<=(i instanceof _e?i.to-1:i.to))){if(r&&r.mightDrag)o=_e.create(t.state.doc,r.mightDrag.pos);else if(n.target&&n.target.nodeType==1){let f=t.docView.nearestDesc(n.target,!0);f&&f.node.type.spec.draggable&&f!=t.docView&&(o=_e.create(t.state.doc,f.posBefore))}}let l=(o||t.state.selection).content(),{dom:u,text:d,slice:h}=sv(t,l);(!n.dataTransfer.files.length||!cn||kC>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(Ou?"Text":"text/html",u.innerHTML),n.dataTransfer.effectAllowed="copyMove",Ou||n.dataTransfer.setData("text/plain",d),t.dragging=new JC(h,YC(t,n),o)};wn.dragend=t=>{let e=t.dragging;window.setTimeout(()=>{t.dragging==e&&(t.dragging=null)},50)};bn.dragover=bn.dragenter=(t,e)=>e.preventDefault();bn.drop=(t,e)=>{let n=e,r=t.dragging;if(t.dragging=null,!n.dataTransfer)return;let i=t.posAtCoords(Zh(n));if(!i)return;let s=t.state.doc.resolve(i.pos),o=r&&r.slice;o?t.someProp("transformPasted",_=>{o=_(o,t,!1)}):o=FC(t,GC(n.dataTransfer),Ou?null:n.dataTransfer.getData("text/html"),!1,s);let l=!!(r&&YC(t,n));if(t.someProp("handleDrop",_=>_(t,n,o||le.empty,l))){n.preventDefault();return}if(!o)return;n.preventDefault();let u=o?gC(t.state.doc,s.pos,o):s.pos;u==null&&(u=s.pos);let d=t.state.tr;if(l){let{node:_}=r;_?_.replace(d):d.deleteSelection()}let h=d.mapping.map(u),f=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,m=d.doc;if(f?d.replaceRangeWith(h,h,o.content.firstChild):d.replaceRange(h,h,o),d.doc.eq(m))return;let g=d.doc.resolve(h);if(f&&_e.isSelectable(o.content.firstChild)&&g.nodeAfter&&g.nodeAfter.sameMarkup(o.content.firstChild))d.setSelection(new _e(g));else{let _=d.mapping.map(u);d.mapping.maps[d.mapping.maps.length-1].forEach((v,x,S,k)=>_=k),d.setSelection(iv(t,g,d.doc.resolve(_)))}t.focus(),t.dispatch(d.setMeta("uiEvent","drop"))};wn.focus=t=>{t.input.lastFocus=Date.now(),t.focused||(t.domObserver.stop(),t.dom.classList.add("ProseMirror-focused"),t.domObserver.start(),t.focused=!0,setTimeout(()=>{t.docView&&t.hasFocus()&&!t.domObserver.currentSelection.eq(t.domSelectionRange())&&Si(t)},20))};wn.blur=(t,e)=>{let n=e;t.focused&&(t.domObserver.stop(),t.dom.classList.remove("ProseMirror-focused"),t.domObserver.start(),n.relatedTarget&&t.dom.contains(n.relatedTarget)&&t.domObserver.currentSelection.clear(),t.focused=!1)};wn.beforeinput=(t,e)=>{if(cn&&_i&&e.inputType=="deleteContentBackward"){t.domObserver.flushSoon();let{domChangeCount:r}=t.input;setTimeout(()=>{if(t.input.domChangeCount!=r||(t.dom.blur(),t.focus(),t.someProp("handleKeyDown",s=>s(t,ro(8,"Backspace")))))return;let{$cursor:i}=t.state.selection;i&&i.pos>0&&t.dispatch(t.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let t in bn)wn[t]=bn[t];function Lu(t,e){if(t==e)return!0;for(let n in t)if(t[n]!==e[n])return!1;for(let n in e)if(!(n in t))return!1;return!0}class sh{constructor(e,n){this.toDOM=e,this.spec=n||vo,this.side=this.spec.side||0}map(e,n,r,i){let{pos:s,deleted:o}=e.mapResult(n.from+i,this.side<0?-1:1);return o?null:new pr(s-r,s-r,this)}valid(){return!0}eq(e){return this==e||e instanceof sh&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Lu(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class xs{constructor(e,n){this.attrs=e,this.spec=n||vo}map(e,n,r,i){let s=e.map(n.from+i,this.spec.inclusiveStart?-1:1)-r,o=e.map(n.to+i,this.spec.inclusiveEnd?1:-1)-r;return s>=o?null:new pr(s,o,this)}valid(e,n){return n.from<n.to}eq(e){return this==e||e instanceof xs&&Lu(this.attrs,e.attrs)&&Lu(this.spec,e.spec)}static is(e){return e.type instanceof xs}destroy(){}}class uv{constructor(e,n){this.attrs=e,this.spec=n||vo}map(e,n,r,i){let s=e.mapResult(n.from+i,1);if(s.deleted)return null;let o=e.mapResult(n.to+i,-1);return o.deleted||o.pos<=s.pos?null:new pr(s.pos-r,o.pos-r,this)}valid(e,n){let{index:r,offset:i}=e.content.findIndex(n.from),s;return i==n.from&&!(s=e.child(r)).isText&&i+s.nodeSize==n.to}eq(e){return this==e||e instanceof uv&&Lu(this.attrs,e.attrs)&&Lu(this.spec,e.spec)}destroy(){}}class pr{constructor(e,n,r){this.from=e,this.to=n,this.type=r}copy(e,n){return new pr(e,n,this.type)}eq(e,n=0){return this.type.eq(e.type)&&this.from+n==e.from&&this.to+n==e.to}map(e,n,r){return this.type.map(e,this,n,r)}static widget(e,n,r){return new pr(e,e,new sh(n,r))}static inline(e,n,r,i){return new pr(e,n,new xs(r,i))}static node(e,n,r,i){return new pr(e,n,new uv(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof xs}get widget(){return this.type instanceof sh}}const oa=[],vo={};class Lt{constructor(e,n){this.local=e.length?e:oa,this.children=n.length?n:oa}static create(e,n){return n.length?oh(n,e,0,vo):ln}find(e,n,r){let i=[];return this.findInner(e??0,n??1e9,i,0,r),i}findInner(e,n,r,i,s){for(let o=0;o<this.local.length;o++){let l=this.local[o];l.from<=n&&l.to>=e&&(!s||s(l.spec))&&r.push(l.copy(l.from+i,l.to+i))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<n&&this.children[o+1]>e){let l=this.children[o]+1;this.children[o+2].findInner(e-l,n-l,r,i+l,s)}}map(e,n,r){return this==ln||e.maps.length==0?this:this.mapInner(e,n,0,0,r||vo)}mapInner(e,n,r,i,s){let o;for(let l=0;l<this.local.length;l++){let u=this.local[l].map(e,r,i);u&&u.type.valid(n,u)?(o||(o=[])).push(u):s.onRemove&&s.onRemove(this.local[l].spec)}return this.children.length?Ez(this.children,o||[],e,n,r,i,s):o?new Lt(o.sort(_o),oa):ln}add(e,n){return n.length?this==ln?Lt.create(e,n):this.addInner(e,n,0):this}addInner(e,n,r){let i,s=0;e.forEach((l,u)=>{let d=u+r,h;if(h=eE(n,l,d)){for(i||(i=this.children.slice());s<i.length&&i[s]<u;)s+=3;i[s]==u?i[s+2]=i[s+2].addInner(l,h,d+1):i.splice(s,0,u,u+l.nodeSize,oh(h,l,d+1,vo)),s+=3}});let o=XC(s?tE(n):n,-r);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||o.splice(l--,1);return new Lt(o.length?this.local.concat(o).sort(_o):this.local,i||this.children)}remove(e){return e.length==0||this==ln?this:this.removeInner(e,0)}removeInner(e,n){let r=this.children,i=this.local;for(let s=0;s<r.length;s+=3){let o,l=r[s]+n,u=r[s+1]+n;for(let h=0,f;h<e.length;h++)(f=e[h])&&f.from>l&&f.to<u&&(e[h]=null,(o||(o=[])).push(f));if(!o)continue;r==this.children&&(r=this.children.slice());let d=r[s+2].removeInner(o,l+1);d!=ln?r[s+2]=d:(r.splice(s,3),s-=3)}if(i.length){for(let s=0,o;s<e.length;s++)if(o=e[s])for(let l=0;l<i.length;l++)i[l].eq(o,n)&&(i==this.local&&(i=this.local.slice()),i.splice(l--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new Lt(i,r):ln}forChild(e,n){if(this==ln)return this;if(n.isLeaf)return Lt.empty;let r,i;for(let l=0;l<this.children.length;l+=3)if(this.children[l]>=e){this.children[l]==e&&(r=this.children[l+2]);break}let s=e+1,o=s+n.content.size;for(let l=0;l<this.local.length;l++){let u=this.local[l];if(u.from<o&&u.to>s&&u.type instanceof xs){let d=Math.max(s,u.from)-s,h=Math.min(o,u.to)-s;d<h&&(i||(i=[])).push(u.copy(d,h))}}if(i){let l=new Lt(i.sort(_o),oa);return r?new ts([l,r]):l}return r||ln}eq(e){if(this==e)return!0;if(!(e instanceof Lt)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(e.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0}locals(e){return cv(this.localsInner(e))}localsInner(e){if(this==ln)return oa;if(e.inlineContent||!this.local.some(xs.is))return this.local;let n=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof xs||n.push(this.local[r]);return n}forEachSet(e){e(this)}}Lt.empty=new Lt([],[]);Lt.removeOverlap=cv;const ln=Lt.empty;class ts{constructor(e){this.members=e}map(e,n){const r=this.members.map(i=>i.map(e,n,vo));return ts.from(r)}forChild(e,n){if(n.isLeaf)return Lt.empty;let r=[];for(let i=0;i<this.members.length;i++){let s=this.members[i].forChild(e,n);s!=ln&&(s instanceof ts?r=r.concat(s.members):r.push(s))}return ts.from(r)}eq(e){if(!(e instanceof ts)||e.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(e.members[n]))return!1;return!0}locals(e){let n,r=!0;for(let i=0;i<this.members.length;i++){let s=this.members[i].localsInner(e);if(s.length)if(!n)n=s;else{r&&(n=n.slice(),r=!1);for(let o=0;o<s.length;o++)n.push(s[o])}}return n?cv(r?n:n.sort(_o)):oa}static from(e){switch(e.length){case 0:return ln;case 1:return e[0];default:return new ts(e.every(n=>n instanceof Lt)?e:e.reduce((n,r)=>n.concat(r instanceof Lt?r:r.members),[]))}}forEachSet(e){for(let n=0;n<this.members.length;n++)this.members[n].forEachSet(e)}}function Ez(t,e,n,r,i,s,o){let l=t.slice();for(let d=0,h=s;d<n.maps.length;d++){let f=0;n.maps[d].forEach((m,g,_,v)=>{let x=v-_-(g-m);for(let S=0;S<l.length;S+=3){let k=l[S+1];if(k<0||m>k+h-f)continue;let C=l[S]+h-f;g>=C?l[S+1]=m<=C?-2:-1:m>=h&&x&&(l[S]+=x,l[S+1]+=x)}f+=x}),h=n.maps[d].map(h,-1)}let u=!1;for(let d=0;d<l.length;d+=3)if(l[d+1]<0){if(l[d+1]==-2){u=!0,l[d+1]=-1;continue}let h=n.map(t[d]+s),f=h-i;if(f<0||f>=r.content.size){u=!0;continue}let m=n.map(t[d+1]+s,-1),g=m-i,{index:_,offset:v}=r.content.findIndex(f),x=r.maybeChild(_);if(x&&v==f&&v+x.nodeSize==g){let S=l[d+2].mapInner(n,x,h+1,t[d]+s+1,o);S!=ln?(l[d]=f,l[d+1]=g,l[d+2]=S):(l[d+1]=-2,u=!0)}else u=!0}if(u){let d=Tz(l,t,e,n,i,s,o),h=oh(d,r,0,o);e=h.local;for(let f=0;f<l.length;f+=3)l[f+1]<0&&(l.splice(f,3),f-=3);for(let f=0,m=0;f<h.children.length;f+=3){let g=h.children[f];for(;m<l.length&&l[m]<g;)m+=3;l.splice(m,0,h.children[f],h.children[f+1],h.children[f+2])}}return new Lt(e.sort(_o),l)}function XC(t,e){if(!e||!t.length)return t;let n=[];for(let r=0;r<t.length;r++){let i=t[r];n.push(new pr(i.from+e,i.to+e,i.type))}return n}function Tz(t,e,n,r,i,s,o){function l(u,d){for(let h=0;h<u.local.length;h++){let f=u.local[h].map(r,i,d);f?n.push(f):o.onRemove&&o.onRemove(u.local[h].spec)}for(let h=0;h<u.children.length;h+=3)l(u.children[h+2],u.children[h]+d+1)}for(let u=0;u<t.length;u+=3)t[u+1]==-1&&l(t[u+2],e[u]+s+1);return n}function eE(t,e,n){if(e.isLeaf)return null;let r=n+e.nodeSize,i=null;for(let s=0,o;s<t.length;s++)(o=t[s])&&o.from>n&&o.to<r&&((i||(i=[])).push(o),t[s]=null);return i}function tE(t){let e=[];for(let n=0;n<t.length;n++)t[n]!=null&&e.push(t[n]);return e}function oh(t,e,n,r){let i=[],s=!1;e.forEach((l,u)=>{let d=eE(t,l,u+n);if(d){s=!0;let h=oh(d,l,n+u+1,r);h!=ln&&i.push(u,u+l.nodeSize,h)}});let o=XC(s?tE(t):t,-n).sort(_o);for(let l=0;l<o.length;l++)o[l].type.valid(e,o[l])||(r.onRemove&&r.onRemove(o[l].spec),o.splice(l--,1));return o.length||i.length?new Lt(o,i):ln}function _o(t,e){return t.from-e.from||t.to-e.to}function cv(t){let e=t;for(let n=0;n<e.length-1;n++){let r=e[n];if(r.from!=r.to)for(let i=n+1;i<e.length;i++){let s=e[i];if(s.from==r.from){s.to!=r.to&&(e==t&&(e=t.slice()),e[i]=s.copy(s.from,r.to),vb(e,i+1,s.copy(r.to,s.to)));continue}else{s.from<r.to&&(e==t&&(e=t.slice()),e[n]=r.copy(r.from,s.from),vb(e,i,r.copy(s.from,r.to)));break}}}return e}function vb(t,e,n){for(;e<t.length&&_o(n,t[e])>0;)e++;t.splice(e,0,n)}function Cp(t){let e=[];return t.someProp("decorations",n=>{let r=n(t.state);r&&r!=ln&&e.push(r)}),t.cursorWrapper&&e.push(Lt.create(t.state.doc,[t.cursorWrapper.deco])),ts.from(e)}const Pz={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},Mz=zn&&ws<=11;class Oz{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class Nz{constructor(e,n){this.view=e,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new Oz,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);zn&&ws<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),Mz&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,Pz)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let n=0;n<e.length;n++)this.queue.push(e[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(cb(this.view)){if(this.suppressingSelectionUpdates)return Si(this.view);if(zn&&ws<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&No(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let n=new Set,r;for(let s=e.focusNode;s;s=$a(s))n.add(s);for(let s=e.anchorNode;s;s=$a(s))if(n.has(s)){r=s;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let n=this.pendingRecords();n.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&cb(e)&&!this.ignoreSelectionChange(r),s=-1,o=-1,l=!1,u=[];if(e.editable)for(let h=0;h<n.length;h++){let f=this.registerMutation(n[h],u);f&&(s=s<0?f.from:Math.min(f.from,s),o=o<0?f.to:Math.max(f.to,o),f.typeOver&&(l=!0))}if(gr&&u.length){let h=u.filter(f=>f.nodeName=="BR");if(h.length==2){let[f,m]=h;f.parentNode&&f.parentNode.parentNode==m.parentNode?m.remove():f.remove()}else{let{focusNode:f}=this.currentSelection;for(let m of h){let g=m.parentNode;g&&g.nodeName=="LI"&&(!f||Dz(e,f)!=g)&&m.remove()}}}let d=null;s<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Wh(r)&&(d=rv(e))&&d.eq(Ne.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Si(e),this.currentSelection.set(r),e.scrollToSelection()):(s>-1||i)&&(s>-1&&(e.docView.markDirty(s,o),Lz(e)),this.handleDOMChange(s,o,l,u),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Si(e),this.currentSelection.set(r))}registerMutation(e,n){if(n.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let h=0;h<e.addedNodes.length;h++){let f=e.addedNodes[h];n.push(f),f.nodeType==3&&(this.lastChangedTextNode=f)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,s=e.nextSibling;if(zn&&ws<=11&&e.addedNodes.length)for(let h=0;h<e.addedNodes.length;h++){let{previousSibling:f,nextSibling:m}=e.addedNodes[h];(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(i=f),(!m||Array.prototype.indexOf.call(e.addedNodes,m)<0)&&(s=m)}let o=i&&i.parentNode==e.target?Yt(i)+1:0,l=r.localPosFromDOM(e.target,o,-1),u=s&&s.parentNode==e.target?Yt(s):e.target.childNodes.length,d=r.localPosFromDOM(e.target,u,1);return{from:l,to:d}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let _b=new WeakMap,wb=!1;function Lz(t){if(!_b.has(t)&&(_b.set(t,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(t.dom).whiteSpace)!==-1)){if(t.requiresGeckoHackNode=gr,wb)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),wb=!0}}function bb(t,e){let n=e.startContainer,r=e.startOffset,i=e.endContainer,s=e.endOffset,o=t.domAtPos(t.state.selection.anchor);return No(o.node,o.offset,i,s)&&([n,r,i,s]=[i,s,n,r]),{anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:s}}function Rz(t,e){if(e.getComposedRanges){let i=e.getComposedRanges(t.root)[0];if(i)return bb(t,i)}let n;function r(i){i.preventDefault(),i.stopImmediatePropagation(),n=i.getTargetRanges()[0]}return t.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),t.dom.removeEventListener("beforeinput",r,!0),n?bb(t,n):null}function Dz(t,e){for(let n=e.parentNode;n&&n!=t.dom;n=n.parentNode){let r=t.docView.nearestDesc(n,!0);if(r&&r.node.isBlock)return n}return null}function Az(t,e,n){let{node:r,fromOffset:i,toOffset:s,from:o,to:l}=t.docView.parseRange(e,n),u=t.domSelectionRange(),d,h=u.anchorNode;if(h&&t.dom.contains(h.nodeType==1?h:h.parentNode)&&(d=[{node:h,offset:u.anchorOffset}],Wh(u)||d.push({node:u.focusNode,offset:u.focusOffset})),cn&&t.input.lastKeyCode===8)for(let x=s;x>i;x--){let S=r.childNodes[x-1],k=S.pmViewDesc;if(S.nodeName=="BR"&&!k){s=x;break}if(!k||k.size)break}let f=t.state.doc,m=t.someProp("domParser")||_s.fromSchema(t.state.schema),g=f.resolve(o),_=null,v=m.parse(r,{topNode:g.parent,topMatch:g.parent.contentMatchAt(g.index()),topOpen:!0,from:i,to:s,preserveWhitespace:g.parent.type.whitespace=="pre"?"full":!0,findPositions:d,ruleFromNode:Iz,context:g});if(d&&d[0].pos!=null){let x=d[0].pos,S=d[1]&&d[1].pos;S==null&&(S=x),_={anchor:x+o,head:S+o}}return{doc:v,sel:_,from:o,to:l}}function Iz(t){let e=t.pmViewDesc;if(e)return e.parseRule();if(t.nodeName=="BR"&&t.parentNode){if(_n&&/^(ul|ol)$/i.test(t.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}else if(t.parentNode.lastChild==t||_n&&/^(tr|table)$/i.test(t.parentNode.nodeName))return{ignore:!0}}else if(t.nodeName=="IMG"&&t.getAttribute("mark-placeholder"))return{ignore:!0};return null}const jz=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|img|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function zz(t,e,n,r,i){let s=t.input.compositionPendingChanges||(t.composing?t.input.compositionID:0);if(t.input.compositionPendingChanges=0,e<0){let D=t.input.lastSelectionTime>Date.now()-50?t.input.lastSelectionOrigin:null,j=rv(t,D);if(j&&!t.state.selection.eq(j)){if(cn&&_i&&t.input.lastKeyCode===13&&Date.now()-100<t.input.lastKeyCodeTime&&t.someProp("handleKeyDown",F=>F(t,ro(13,"Enter"))))return;let O=t.state.tr.setSelection(j);D=="pointer"?O.setMeta("pointer",!0):D=="key"&&O.scrollIntoView(),s&&O.setMeta("composition",s),t.dispatch(O)}return}let o=t.state.doc.resolve(e),l=o.sharedDepth(n);e=o.before(l+1),n=t.state.doc.resolve(n).after(l+1);let u=t.state.selection,d=Az(t,e,n),h=t.state.doc,f=h.slice(d.from,d.to),m,g;t.input.lastKeyCode===8&&Date.now()-100<t.input.lastKeyCodeTime?(m=t.state.selection.to,g="end"):(m=t.state.selection.from,g="start"),t.input.lastKeyCode=null;let _=$z(f.content,d.doc.content,d.from,m,g);if(_&&t.input.domChangeCount++,(Ua&&t.input.lastIOSEnter>Date.now()-225||_i)&&i.some(D=>D.nodeType==1&&!jz.test(D.nodeName))&&(!_||_.endA>=_.endB)&&t.someProp("handleKeyDown",D=>D(t,ro(13,"Enter")))){t.input.lastIOSEnter=0;return}if(!_)if(r&&u instanceof Ee&&!u.empty&&u.$head.sameParent(u.$anchor)&&!t.composing&&!(d.sel&&d.sel.anchor!=d.sel.head))_={start:u.from,endA:u.to,endB:u.to};else{if(d.sel){let D=xb(t,t.state.doc,d.sel);if(D&&!D.eq(t.state.selection)){let j=t.state.tr.setSelection(D);s&&j.setMeta("composition",s),t.dispatch(j)}}return}t.state.selection.from<t.state.selection.to&&_.start==_.endB&&t.state.selection instanceof Ee&&(_.start>t.state.selection.from&&_.start<=t.state.selection.from+2&&t.state.selection.from>=d.from?_.start=t.state.selection.from:_.endA<t.state.selection.to&&_.endA>=t.state.selection.to-2&&t.state.selection.to<=d.to&&(_.endB+=t.state.selection.to-_.endA,_.endA=t.state.selection.to)),zn&&ws<=11&&_.endB==_.start+1&&_.endA==_.start&&_.start>d.from&&d.doc.textBetween(_.start-d.from-1,_.start-d.from+1)==" "&&(_.start--,_.endA--,_.endB--);let v=d.doc.resolveNoCache(_.start-d.from),x=d.doc.resolveNoCache(_.endB-d.from),S=h.resolve(_.start),k=v.sameParent(x)&&v.parent.inlineContent&&S.end()>=_.endA,C;if((Ua&&t.input.lastIOSEnter>Date.now()-225&&(!k||i.some(D=>D.nodeName=="DIV"||D.nodeName=="P"))||!k&&v.pos<d.doc.content.size&&(!v.sameParent(x)||!v.parent.inlineContent)&&!/\S/.test(d.doc.textBetween(v.pos,x.pos,"",""))&&(C=Ne.findFrom(d.doc.resolve(v.pos+1),1,!0))&&C.head>v.pos)&&t.someProp("handleKeyDown",D=>D(t,ro(13,"Enter")))){t.input.lastIOSEnter=0;return}if(t.state.selection.anchor>_.start&&Fz(h,_.start,_.endA,v,x)&&t.someProp("handleKeyDown",D=>D(t,ro(8,"Backspace")))){_i&&cn&&t.domObserver.suppressSelectionUpdates();return}cn&&_.endB==_.start&&(t.input.lastChromeDelete=Date.now()),_i&&!k&&v.start()!=x.start()&&x.parentOffset==0&&v.depth==x.depth&&d.sel&&d.sel.anchor==d.sel.head&&d.sel.head==_.endA&&(_.endB-=2,x=d.doc.resolveNoCache(_.endB-d.from),setTimeout(()=>{t.someProp("handleKeyDown",function(D){return D(t,ro(13,"Enter"))})},20));let R=_.start,N=_.endA,P=D=>{let j=D||t.state.tr.replace(R,N,d.doc.slice(_.start-d.from,_.endB-d.from));if(d.sel){let O=xb(t,j.doc,d.sel);O&&!(cn&&t.composing&&O.empty&&(_.start!=_.endB||t.input.lastChromeDelete<Date.now()-100)&&(O.head==R||O.head==j.mapping.map(N)-1)||zn&&O.empty&&O.head==R)&&j.setSelection(O)}return s&&j.setMeta("composition",s),j.scrollIntoView()},T;if(k){if(v.pos==x.pos){zn&&ws<=11&&v.parentOffset==0&&(t.domObserver.suppressSelectionUpdates(),setTimeout(()=>Si(t),20));let D=P(t.state.tr.delete(R,N)),j=h.resolve(_.start).marksAcross(h.resolve(_.endA));j&&D.ensureMarks(j),t.dispatch(D)}else if(_.endA==_.endB&&(T=Bz(v.parent.content.cut(v.parentOffset,x.parentOffset),S.parent.content.cut(S.parentOffset,_.endA-S.start())))){let D=P(t.state.tr);T.type=="add"?D.addMark(R,N,T.mark):D.removeMark(R,N,T.mark),t.dispatch(D)}else if(v.parent.child(v.index()).isText&&v.index()==x.index()-(x.textOffset?0:1)){let D=v.parent.textBetween(v.parentOffset,x.parentOffset),j=()=>P(t.state.tr.insertText(D,R,N));t.someProp("handleTextInput",O=>O(t,R,N,D,j))||t.dispatch(j())}}else t.dispatch(P())}function xb(t,e,n){return Math.max(n.anchor,n.head)>e.content.size?null:iv(t,e.resolve(n.anchor),e.resolve(n.head))}function Bz(t,e){let n=t.firstChild.marks,r=e.firstChild.marks,i=n,s=r,o,l,u;for(let h=0;h<r.length;h++)i=r[h].removeFromSet(i);for(let h=0;h<n.length;h++)s=n[h].removeFromSet(s);if(i.length==1&&s.length==0)l=i[0],o="add",u=h=>h.mark(l.addToSet(h.marks));else if(i.length==0&&s.length==1)l=s[0],o="remove",u=h=>h.mark(l.removeFromSet(h.marks));else return null;let d=[];for(let h=0;h<e.childCount;h++)d.push(u(e.child(h)));if(Y.from(d).eq(t))return{mark:l,type:o}}function Fz(t,e,n,r,i){if(n-e<=i.pos-r.pos||Ep(r,!0,!1)<i.pos)return!1;let s=t.resolve(e);if(!r.parent.isTextblock){let l=s.nodeAfter;return l!=null&&n==e+l.nodeSize}if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let o=t.resolve(Ep(s,!0,!0));return!o.parent.isTextblock||o.pos>n||Ep(o,!0,!1)<n?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function Ep(t,e,n){let r=t.depth,i=e?t.end():t.pos;for(;r>0&&(e||t.indexAfter(r)==t.node(r).childCount);)r--,i++,e=!1;if(n){let s=t.node(r).maybeChild(t.indexAfter(r));for(;s&&!s.isLeaf;)s=s.firstChild,i++}return i}function $z(t,e,n,r,i){let s=t.findDiffStart(e,n);if(s==null)return null;let{a:o,b:l}=t.findDiffEnd(e,n+t.size,n+e.size);if(i=="end"){let u=Math.max(0,s-Math.min(o,l));r-=o+u-s}if(o<s&&t.size<e.size){let u=r<=s&&r>=o?s-r:0;s-=u,s&&s<e.size&&Sb(e.textBetween(s-1,s+1))&&(s+=u?1:-1),l=s+(l-o),o=s}else if(l<s){let u=r<=s&&r>=l?s-r:0;s-=u,s&&s<t.size&&Sb(t.textBetween(s-1,s+1))&&(s+=u?1:-1),o=s+(o-l),l=s}return{start:s,endA:o,endB:l}}function Sb(t){if(t.length!=2)return!1;let e=t.charCodeAt(0),n=t.charCodeAt(1);return e>=56320&&e<=57343&&n>=55296&&n<=56319}class nE{constructor(e,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new oz,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(Pb),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=Eb(this),Cb(this),this.nodeViews=Tb(this),this.docView=ib(this.state.doc,kb(this),Cp(this),this.dom,this),this.domObserver=new Nz(this,(r,i,s,o)=>zz(this,r,i,s,o)),this.domObserver.start(),az(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let n in e)this._props[n]=e[n];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&bg(this);let n=this._props;this._props=e,e.plugins&&(e.plugins.forEach(Pb),this.directPlugins=e.plugins),this.updateStateInner(e.state,n)}setProps(e){let n={};for(let r in this._props)n[r]=this._props[r];n.state=this.state;for(let r in e)n[r]=e[r];this.update(n)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,n){var r;let i=this.state,s=!1,o=!1;e.storedMarks&&this.composing&&(QC(this),o=!0),this.state=e;let l=i.plugins!=e.plugins||this._props.plugins!=n.plugins;if(l||this._props.plugins!=n.plugins||this._props.nodeViews!=n.nodeViews){let g=Tb(this);Vz(g,this.nodeViews)&&(this.nodeViews=g,s=!0)}(l||n.handleDOMEvents!=this._props.handleDOMEvents)&&bg(this),this.editable=Eb(this),Cb(this);let u=Cp(this),d=kb(this),h=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",f=s||!this.docView.matchesNode(e.doc,d,u);(f||!e.selection.eq(i.selection))&&(o=!0);let m=h=="preserve"&&o&&this.dom.style.overflowAnchor==null&&b2(this);if(o){this.domObserver.stop();let g=f&&(zn||cn)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&Uz(i.selection,e.selection);if(f){let _=cn?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=wz(this)),(s||!this.docView.update(e.doc,d,u,this))&&(this.docView.updateOuterDeco(d),this.docView.destroy(),this.docView=ib(e.doc,d,u,this.dom,this)),_&&!this.trackWrites&&(g=!0)}g||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&q2(this))?Si(this,g):(jC(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),h=="reset"?this.dom.scrollTop=0:h=="to selection"?this.scrollToSelection():m&&x2(m)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",n=>n(this)))if(this.state.selection instanceof _e){let n=this.docView.domAfterPos(this.state.selection.from);n.nodeType==1&&Y0(this,n.getBoundingClientRect(),e)}else Y0(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let r=this.directPlugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let r=this.state.plugins[n];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let n=0;n<this.pluginViews.length;n++){let r=this.pluginViews[n];r.update&&r.update(this,e)}}updateDraggedNode(e,n){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let s=r.from+(this.state.doc.content.size-n.doc.content.size);(s>0&&this.state.doc.nodeAt(s))==r.node&&(i=s)}this.dragging=new JC(e.slice,e.move,i<0?void 0:_e.create(this.state.doc,i))}someProp(e,n){let r=this._props&&this._props[e],i;if(r!=null&&(i=n?n(r):r))return i;for(let o=0;o<this.directPlugins.length;o++){let l=this.directPlugins[o].props[e];if(l!=null&&(i=n?n(l):l))return i}let s=this.state.plugins;if(s)for(let o=0;o<s.length;o++){let l=s[o].props[e];if(l!=null&&(i=n?n(l):l))return i}}hasFocus(){if(zn){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&S2(this.dom),Si(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let n=this.dom.parentNode;n;n=n.parentNode)if(n.nodeType==9||n.nodeType==11&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n}return e||document}updateRoot(){this._root=null}posAtCoords(e){return P2(this,e)}coordsAtPos(e,n=1){return MC(this,e,n)}domAtPos(e,n=0){return this.docView.domFromPos(e,n)}nodeDOM(e){let n=this.docView.descAt(e);return n?n.nodeDOM:null}posAtDOM(e,n,r=-1){let i=this.docView.posFromDOM(e,n,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,n){return R2(this,n||this.state,e)}pasteHTML(e,n){return Nu(this,"",e,!1,n||new ClipboardEvent("paste"))}pasteText(e,n){return Nu(this,e,null,!0,n||new ClipboardEvent("paste"))}serializeForClipboard(e){return sv(this,e)}destroy(){this.docView&&(lz(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Cp(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,c2())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return cz(this,e)}domSelectionRange(){let e=this.domSelection();return e?_n&&this.root.nodeType===11&&m2(this.dom.ownerDocument)==this.dom&&Rz(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}nE.prototype.dispatch=function(t){let e=this._props.dispatchTransaction;e?e.call(this,t):this.updateState(this.state.apply(t))};function kb(t){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(t.editable),t.someProp("attributes",n=>{if(typeof n=="function"&&(n=n(t.state)),n)for(let r in n)r=="class"?e.class+=" "+n[r]:r=="style"?e.style=(e.style?e.style+";":"")+n[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(n[r]))}),e.translate||(e.translate="no"),[pr.node(0,t.state.doc.content.size,e)]}function Cb(t){if(t.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),t.cursorWrapper={dom:e,deco:pr.widget(t.state.selection.from,e,{raw:!0,marks:t.markCursor})}}else t.cursorWrapper=null}function Eb(t){return!t.someProp("editable",e=>e(t.state)===!1)}function Uz(t,e){let n=Math.min(t.$anchor.sharedDepth(t.head),e.$anchor.sharedDepth(e.head));return t.$anchor.start(n)!=e.$anchor.start(n)}function Tb(t){let e=Object.create(null);function n(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return t.someProp("nodeViews",n),t.someProp("markViews",n),e}function Vz(t,e){let n=0,r=0;for(let i in t){if(t[i]!=e[i])return!0;n++}for(let i in e)r++;return n!=r}function Pb(t){if(t.spec.state||t.spec.filterTransaction||t.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Cs={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},ah={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Hz=typeof navigator<"u"&&/Mac/.test(navigator.platform),qz=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Xt=0;Xt<10;Xt++)Cs[48+Xt]=Cs[96+Xt]=String(Xt);for(var Xt=1;Xt<=24;Xt++)Cs[Xt+111]="F"+Xt;for(var Xt=65;Xt<=90;Xt++)Cs[Xt]=String.fromCharCode(Xt+32),ah[Xt]=String.fromCharCode(Xt);for(var Tp in Cs)ah.hasOwnProperty(Tp)||(ah[Tp]=Cs[Tp]);function Wz(t){var e=Hz&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||qz&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?ah:Cs)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}const Kz=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),Zz=typeof navigator<"u"&&/Win/.test(navigator.platform);function Qz(t){let e=t.split(/-(?!$)/),n=e[e.length-1];n=="Space"&&(n=" ");let r,i,s,o;for(let l=0;l<e.length-1;l++){let u=e[l];if(/^(cmd|meta|m)$/i.test(u))o=!0;else if(/^a(lt)?$/i.test(u))r=!0;else if(/^(c|ctrl|control)$/i.test(u))i=!0;else if(/^s(hift)?$/i.test(u))s=!0;else if(/^mod$/i.test(u))Kz?o=!0:i=!0;else throw new Error("Unrecognized modifier name: "+u)}return r&&(n="Alt-"+n),i&&(n="Ctrl-"+n),o&&(n="Meta-"+n),s&&(n="Shift-"+n),n}function Gz(t){let e=Object.create(null);for(let n in t)e[Qz(n)]=t[n];return e}function Pp(t,e,n=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n&&e.shiftKey&&(t="Shift-"+t),t}function Jz(t){return new Fn({props:{handleKeyDown:rE(t)}})}function rE(t){let e=Gz(t);return function(n,r){let i=Wz(r),s,o=e[Pp(i,r)];if(o&&o(n.state,n.dispatch,n))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let l=e[Pp(i,r,!1)];if(l&&l(n.state,n.dispatch,n))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(Zz&&r.ctrlKey&&r.altKey)&&(s=Cs[r.keyCode])&&s!=i){let l=e[Pp(s,r)];if(l&&l(n.state,n.dispatch,n))return!0}}return!1}}const dv=(t,e)=>t.selection.empty?!1:(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function iE(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("backward",t):n.parentOffset>0)?null:n}const sE=(t,e,n)=>{let r=iE(t,n);if(!r)return!1;let i=hv(r);if(!i){let o=r.blockRange(),l=o&&nl(o);return l==null?!1:(e&&e(t.tr.lift(o,l).scrollIntoView()),!0)}let s=i.nodeBefore;if(pE(t,i,e,-1))return!0;if(r.parent.content.size==0&&(Va(s,"end")||_e.isSelectable(s)))for(let o=r.depth;;o--){let l=Hh(t.doc,r.before(o),r.after(o),le.empty);if(l&&l.slice.size<l.to-l.from){if(e){let u=t.tr.step(l);u.setSelection(Va(s,"end")?Ne.findFrom(u.doc.resolve(u.mapping.map(i.pos,-1)),-1):_e.create(u.doc,i.pos-s.nodeSize)),e(u.scrollIntoView())}return!0}if(o==1||r.node(o-1).childCount>1)break}return s.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),!0):!1},Yz=(t,e,n)=>{let r=iE(t,n);if(!r)return!1;let i=hv(r);return i?oE(t,i,e):!1},Xz=(t,e,n)=>{let r=lE(t,n);if(!r)return!1;let i=fv(r);return i?oE(t,i,e):!1};function oE(t,e,n){let r=e.nodeBefore,i=r,s=e.pos-1;for(;!i.isTextblock;s--){if(i.type.spec.isolating)return!1;let h=i.lastChild;if(!h)return!1;i=h}let o=e.nodeAfter,l=o,u=e.pos+1;for(;!l.isTextblock;u++){if(l.type.spec.isolating)return!1;let h=l.firstChild;if(!h)return!1;l=h}let d=Hh(t.doc,s,u,le.empty);if(!d||d.from!=s||d instanceof Ft&&d.slice.size>=u-s)return!1;if(n){let h=t.tr.step(d);h.setSelection(Ee.create(h.doc,s)),n(h.scrollIntoView())}return!0}function Va(t,e,n=!1){for(let r=t;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}const aE=(t,e,n)=>{let{$head:r,empty:i}=t.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",t):r.parentOffset>0)return!1;s=hv(r)}let o=s&&s.nodeBefore;return!o||!_e.isSelectable(o)?!1:(e&&e(t.tr.setSelection(_e.create(t.doc,s.pos-o.nodeSize)).scrollIntoView()),!0)};function hv(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}function lE(t,e){let{$cursor:n}=t.selection;return!n||(e?!e.endOfTextblock("forward",t):n.parentOffset<n.parent.content.size)?null:n}const uE=(t,e,n)=>{let r=lE(t,n);if(!r)return!1;let i=fv(r);if(!i)return!1;let s=i.nodeAfter;if(pE(t,i,e,1))return!0;if(r.parent.content.size==0&&(Va(s,"start")||_e.isSelectable(s))){let o=Hh(t.doc,r.before(),r.after(),le.empty);if(o&&o.slice.size<o.to-o.from){if(e){let l=t.tr.step(o);l.setSelection(Va(s,"start")?Ne.findFrom(l.doc.resolve(l.mapping.map(i.pos)),1):_e.create(l.doc,l.mapping.map(i.pos))),e(l.scrollIntoView())}return!0}}return s.isAtom&&i.depth==r.depth-1?(e&&e(t.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0):!1},cE=(t,e,n)=>{let{$head:r,empty:i}=t.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;s=fv(r)}let o=s&&s.nodeAfter;return!o||!_e.isSelectable(o)?!1:(e&&e(t.tr.setSelection(_e.create(t.doc,s.pos)).scrollIntoView()),!0)};function fv(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let n=t.node(e);if(t.index(e)+1<n.childCount)return t.doc.resolve(t.after(e+1));if(n.type.spec.isolating)break}return null}const eB=(t,e)=>{let n=t.selection,r=n instanceof _e,i;if(r){if(n.node.isTextblock||!Rs(t.doc,n.from))return!1;i=n.from}else if(i=Vh(t.doc,n.from,-1),i==null)return!1;if(e){let s=t.tr.join(i);r&&s.setSelection(_e.create(s.doc,i-t.doc.resolve(i).nodeBefore.nodeSize)),e(s.scrollIntoView())}return!0},tB=(t,e)=>{let n=t.selection,r;if(n instanceof _e){if(n.node.isTextblock||!Rs(t.doc,n.to))return!1;r=n.to}else if(r=Vh(t.doc,n.to,1),r==null)return!1;return e&&e(t.tr.join(r).scrollIntoView()),!0},nB=(t,e)=>{let{$from:n,$to:r}=t.selection,i=n.blockRange(r),s=i&&nl(i);return s==null?!1:(e&&e(t.tr.lift(i,s).scrollIntoView()),!0)},dE=(t,e)=>{let{$head:n,$anchor:r}=t.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(e&&e(t.tr.insertText(`
`).scrollIntoView()),!0)};function pv(t){for(let e=0;e<t.edgeCount;e++){let{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const rB=(t,e)=>{let{$head:n,$anchor:r}=t.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let i=n.node(-1),s=n.indexAfter(-1),o=pv(i.contentMatchAt(s));if(!o||!i.canReplaceWith(s,s,o))return!1;if(e){let l=n.after(),u=t.tr.replaceWith(l,l,o.createAndFill());u.setSelection(Ne.near(u.doc.resolve(l),1)),e(u.scrollIntoView())}return!0},hE=(t,e)=>{let n=t.selection,{$from:r,$to:i}=n;if(n instanceof Qn||r.parent.inlineContent||i.parent.inlineContent)return!1;let s=pv(i.parent.contentMatchAt(i.indexAfter()));if(!s||!s.isTextblock)return!1;if(e){let o=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,l=t.tr.insert(o,s.createAndFill());l.setSelection(Ee.create(l.doc,o+1)),e(l.scrollIntoView())}return!0},fE=(t,e)=>{let{$cursor:n}=t.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let s=n.before();if(xi(t.doc,s))return e&&e(t.tr.split(s).scrollIntoView()),!0}let r=n.blockRange(),i=r&&nl(r);return i==null?!1:(e&&e(t.tr.lift(r,i).scrollIntoView()),!0)};function iB(t){return(e,n)=>{let{$from:r,$to:i}=e.selection;if(e.selection instanceof _e&&e.selection.node.isBlock)return!r.parentOffset||!xi(e.doc,r.pos)?!1:(n&&n(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let s=[],o,l,u=!1,d=!1;for(let g=r.depth;;g--)if(r.node(g).isBlock){u=r.end(g)==r.pos+(r.depth-g),d=r.start(g)==r.pos-(r.depth-g),l=pv(r.node(g-1).contentMatchAt(r.indexAfter(g-1))),s.unshift(u&&l?{type:l}:null),o=g;break}else{if(g==1)return!1;s.unshift(null)}let h=e.tr;(e.selection instanceof Ee||e.selection instanceof Qn)&&h.deleteSelection();let f=h.mapping.map(r.pos),m=xi(h.doc,f,s.length,s);if(m||(s[0]=l?{type:l}:null,m=xi(h.doc,f,s.length,s)),!m)return!1;if(h.split(f,s.length,s),!u&&d&&r.node(o).type!=l){let g=h.mapping.map(r.before(o)),_=h.doc.resolve(g);l&&r.node(o-1).canReplaceWith(_.index(),_.index()+1,l)&&h.setNodeMarkup(h.mapping.map(r.before(o)),l)}return n&&n(h.scrollIntoView()),!0}}const sB=iB(),oB=(t,e)=>{let{$from:n,to:r}=t.selection,i,s=n.sharedDepth(r);return s==0?!1:(i=n.before(s),e&&e(t.tr.setSelection(_e.create(t.doc,i))),!0)};function aB(t,e,n){let r=e.nodeBefore,i=e.nodeAfter,s=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(s-1,s)?(n&&n(t.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(s,s+1)||!(i.isTextblock||Rs(t.doc,e.pos))?!1:(n&&n(t.tr.join(e.pos).scrollIntoView()),!0)}function pE(t,e,n,r){let i=e.nodeBefore,s=e.nodeAfter,o,l,u=i.type.spec.isolating||s.type.spec.isolating;if(!u&&aB(t,e,n))return!0;let d=!u&&e.parent.canReplace(e.index(),e.index()+1);if(d&&(o=(l=i.contentMatchAt(i.childCount)).findWrapping(s.type))&&l.matchType(o[0]||s.type).validEnd){if(n){let g=e.pos+s.nodeSize,_=Y.empty;for(let S=o.length-1;S>=0;S--)_=Y.from(o[S].create(null,_));_=Y.from(i.copy(_));let v=t.tr.step(new Ut(e.pos-1,g,e.pos,g,new le(_,1,0),o.length,!0)),x=v.doc.resolve(g+2*o.length);x.nodeAfter&&x.nodeAfter.type==i.type&&Rs(v.doc,x.pos)&&v.join(x.pos),n(v.scrollIntoView())}return!0}let h=s.type.spec.isolating||r>0&&u?null:Ne.findFrom(e,1),f=h&&h.$from.blockRange(h.$to),m=f&&nl(f);if(m!=null&&m>=e.depth)return n&&n(t.tr.lift(f,m).scrollIntoView()),!0;if(d&&Va(s,"start",!0)&&Va(i,"end")){let g=i,_=[];for(;_.push(g),!g.isTextblock;)g=g.lastChild;let v=s,x=1;for(;!v.isTextblock;v=v.firstChild)x++;if(g.canReplace(g.childCount,g.childCount,v.content)){if(n){let S=Y.empty;for(let C=_.length-1;C>=0;C--)S=Y.from(_[C].copy(S));let k=t.tr.step(new Ut(e.pos-_.length,e.pos+s.nodeSize,e.pos+x,e.pos+s.nodeSize-x,new le(S,_.length,0),0,!0));n(k.scrollIntoView())}return!0}}return!1}function mE(t){return function(e,n){let r=e.selection,i=t<0?r.$from:r.$to,s=i.depth;for(;i.node(s).isInline;){if(!s)return!1;s--}return i.node(s).isTextblock?(n&&n(e.tr.setSelection(Ee.create(e.doc,t<0?i.start(s):i.end(s)))),!0):!1}}const lB=mE(-1),uB=mE(1);function cB(t,e=null){return function(n,r){let{$from:i,$to:s}=n.selection,o=i.blockRange(s),l=o&&ev(o,t,e);return l?(r&&r(n.tr.wrap(o,l).scrollIntoView()),!0):!1}}function Mb(t,e=null){return function(n,r){let i=!1;for(let s=0;s<n.selection.ranges.length&&!i;s++){let{$from:{pos:o},$to:{pos:l}}=n.selection.ranges[s];n.doc.nodesBetween(o,l,(u,d)=>{if(i)return!1;if(!(!u.isTextblock||u.hasMarkup(t,e)))if(u.type==t)i=!0;else{let h=n.doc.resolve(d),f=h.index();i=h.parent.canReplaceWith(f,f+1,t)}})}if(!i)return!1;if(r){let s=n.tr;for(let o=0;o<n.selection.ranges.length;o++){let{$from:{pos:l},$to:{pos:u}}=n.selection.ranges[o];s.setBlockType(l,u,t,e)}r(s.scrollIntoView())}return!0}}function mv(...t){return function(e,n,r){for(let i=0;i<t.length;i++)if(t[i](e,n,r))return!0;return!1}}mv(dv,sE,aE);mv(dv,uE,cE);mv(dE,hE,fE,sB);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function dB(t,e=null){return function(n,r){let{$from:i,$to:s}=n.selection,o=i.blockRange(s);if(!o)return!1;let l=r?n.tr:null;return hB(l,o,t,e)?(r&&r(l.scrollIntoView()),!0):!1}}function hB(t,e,n,r=null){let i=!1,s=e,o=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(n)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let u=o.resolve(e.start-2);s=new eh(u,u,e.depth),e.endIndex<e.parent.childCount&&(e=new eh(e.$from,o.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let l=ev(s,n,r,e);return l?(t&&fB(t,e,l,i,n),!0):!1}function fB(t,e,n,r,i){let s=Y.empty;for(let h=n.length-1;h>=0;h--)s=Y.from(n[h].type.create(n[h].attrs,s));t.step(new Ut(e.start-(r?2:0),e.end,e.start,e.end,new le(s,0,0),n.length,!0));let o=0;for(let h=0;h<n.length;h++)n[h].type==i&&(o=h+1);let l=n.length-o,u=e.start+n.length-(r?2:0),d=e.parent;for(let h=e.startIndex,f=e.endIndex,m=!0;h<f;h++,m=!1)!m&&xi(t.doc,u,l)&&(t.split(u,l),u+=2*l),u+=d.child(h).nodeSize;return t}function pB(t){return function(e,n){let{$from:r,$to:i}=e.selection,s=r.blockRange(i,o=>o.childCount>0&&o.firstChild.type==t);return s?n?r.node(s.depth-1).type==t?mB(e,n,t,s):gB(e,n,s):!0:!1}}function mB(t,e,n,r){let i=t.tr,s=r.end,o=r.$to.end(r.depth);s<o&&(i.step(new Ut(s-1,o,s,o,new le(Y.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new eh(i.doc.resolve(r.$from.pos),i.doc.resolve(o),r.depth));const l=nl(r);if(l==null)return!1;i.lift(r,l);let u=i.doc.resolve(i.mapping.map(s,-1)-1);return Rs(i.doc,u.pos)&&u.nodeBefore.type==u.nodeAfter.type&&i.join(u.pos),e(i.scrollIntoView()),!0}function gB(t,e,n){let r=t.tr,i=n.parent;for(let g=n.end,_=n.endIndex-1,v=n.startIndex;_>v;_--)g-=i.child(_).nodeSize,r.delete(g-1,g+1);let s=r.doc.resolve(n.start),o=s.nodeAfter;if(r.mapping.map(n.end)!=n.start+s.nodeAfter.nodeSize)return!1;let l=n.startIndex==0,u=n.endIndex==i.childCount,d=s.node(-1),h=s.index(-1);if(!d.canReplace(h+(l?0:1),h+1,o.content.append(u?Y.empty:Y.from(i))))return!1;let f=s.pos,m=f+o.nodeSize;return r.step(new Ut(f-(l?1:0),m+(u?1:0),f+1,m-1,new le((l?Y.empty:Y.from(i.copy(Y.empty))).append(u?Y.empty:Y.from(i.copy(Y.empty))),l?0:1,u?0:1),l?0:1)),e(r.scrollIntoView()),!0}function yB(t){return function(e,n){let{$from:r,$to:i}=e.selection,s=r.blockRange(i,d=>d.childCount>0&&d.firstChild.type==t);if(!s)return!1;let o=s.startIndex;if(o==0)return!1;let l=s.parent,u=l.child(o-1);if(u.type!=t)return!1;if(n){let d=u.lastChild&&u.lastChild.type==l.type,h=Y.from(d?t.create():null),f=new le(Y.from(t.create(null,Y.from(l.type.create(null,h)))),d?3:1,0),m=s.start,g=s.end;n(e.tr.step(new Ut(m-(d?3:1),g,m,g,f,1,!0)).scrollIntoView())}return!0}}function Qh(t){const{state:e,transaction:n}=t;let{selection:r}=n,{doc:i}=n,{storedMarks:s}=n;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return s},get selection(){return r},get doc(){return i},get tr(){return r=n.selection,i=n.doc,s=n.storedMarks,n}}}class Gh{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:n,state:r}=this,{view:i}=n,{tr:s}=r,o=this.buildProps(s);return Object.fromEntries(Object.entries(e).map(([l,u])=>[l,(...h)=>{const f=u(...h)(o);return!s.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(s),f}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,n=!0){const{rawCommands:r,editor:i,state:s}=this,{view:o}=i,l=[],u=!!e,d=e||s.tr,h=()=>(!u&&n&&!d.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(d),l.every(m=>m===!0)),f={...Object.fromEntries(Object.entries(r).map(([m,g])=>[m,(...v)=>{const x=this.buildProps(d,n),S=g(...v)(x);return l.push(S),f}])),run:h};return f}createCan(e){const{rawCommands:n,state:r}=this,i=!1,s=e||r.tr,o=this.buildProps(s,i);return{...Object.fromEntries(Object.entries(n).map(([u,d])=>[u,(...h)=>d(...h)({...o,dispatch:void 0})])),chain:()=>this.createChain(s,i)}}buildProps(e,n=!0){const{rawCommands:r,editor:i,state:s}=this,{view:o}=i,l={tr:e,editor:i,view:o,state:Qh({state:s,transaction:e}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(e,n),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([u,d])=>[u,(...h)=>d(...h)(l)]))}};return l}}class vB{constructor(){this.callbacks={}}on(e,n){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(n),this}emit(e,...n){const r=this.callbacks[e];return r&&r.forEach(i=>i.apply(this,n)),this}off(e,n){const r=this.callbacks[e];return r&&(n?this.callbacks[e]=r.filter(i=>i!==n):delete this.callbacks[e]),this}once(e,n){const r=(...i)=>{this.off(e,r),n.apply(this,i)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}}function me(t,e,n){return t.config[e]===void 0&&t.parent?me(t.parent,e,n):typeof t.config[e]=="function"?t.config[e].bind({...n,parent:t.parent?me(t.parent,e,n):null}):t.config[e]}function Jh(t){const e=t.filter(i=>i.type==="extension"),n=t.filter(i=>i.type==="node"),r=t.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:n,markExtensions:r}}function gE(t){const e=[],{nodeExtensions:n,markExtensions:r}=Jh(t),i=[...n,...r],s={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return t.forEach(o=>{const l={name:o.name,options:o.options,storage:o.storage,extensions:i},u=me(o,"addGlobalAttributes",l);if(!u)return;u().forEach(h=>{h.types.forEach(f=>{Object.entries(h.attributes).forEach(([m,g])=>{e.push({type:f,name:m,attribute:{...s,...g}})})})})}),i.forEach(o=>{const l={name:o.name,options:o.options,storage:o.storage},u=me(o,"addAttributes",l);if(!u)return;const d=u();Object.entries(d).forEach(([h,f])=>{const m={...s,...f};typeof m?.default=="function"&&(m.default=m.default()),m?.isRequired&&m?.default===void 0&&delete m.default,e.push({type:o.name,name:h,attribute:m})})}),e}function Ht(t,e){if(typeof t=="string"){if(!e.nodes[t])throw Error(`There is no node type named '${t}'. Maybe you forgot to add the extension?`);return e.nodes[t]}return t}function xn(...t){return t.filter(e=>!!e).reduce((e,n)=>{const r={...e};return Object.entries(n).forEach(([i,s])=>{if(!r[i]){r[i]=s;return}if(i==="class"){const l=s?String(s).split(" "):[],u=r[i]?r[i].split(" "):[],d=l.filter(h=>!u.includes(h));r[i]=[...u,...d].join(" ")}else if(i==="style"){const l=s?s.split(";").map(h=>h.trim()).filter(Boolean):[],u=r[i]?r[i].split(";").map(h=>h.trim()).filter(Boolean):[],d=new Map;u.forEach(h=>{const[f,m]=h.split(":").map(g=>g.trim());d.set(f,m)}),l.forEach(h=>{const[f,m]=h.split(":").map(g=>g.trim());d.set(f,m)}),r[i]=Array.from(d.entries()).map(([h,f])=>`${h}: ${f}`).join("; ")}else r[i]=s}),r},{})}function xg(t,e){return e.filter(n=>n.type===t.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(t.attrs)||{}:{[n.name]:t.attrs[n.name]}).reduce((n,r)=>xn(n,r),{})}function yE(t){return typeof t=="function"}function Ae(t,e=void 0,...n){return yE(t)?e?t.bind(e)(...n):t(...n):t}function _B(t={}){return Object.keys(t).length===0&&t.constructor===Object}function wB(t){return typeof t!="string"?t:t.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(t):t==="true"?!0:t==="false"?!1:t}function Ob(t,e){return"style"in t?t:{...t,getAttrs:n=>{const r=t.getAttrs?t.getAttrs(n):t.attrs;if(r===!1)return!1;const i=e.reduce((s,o)=>{const l=o.attribute.parseHTML?o.attribute.parseHTML(n):wB(n.getAttribute(o.name));return l==null?s:{...s,[o.name]:l}},{});return{...r,...i}}}}function Nb(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>e==="attrs"&&_B(n)?!1:n!=null))}function bB(t,e){var n;const r=gE(t),{nodeExtensions:i,markExtensions:s}=Jh(t),o=(n=i.find(d=>me(d,"topNode")))===null||n===void 0?void 0:n.name,l=Object.fromEntries(i.map(d=>{const h=r.filter(S=>S.type===d.name),f={name:d.name,options:d.options,storage:d.storage,editor:e},m=t.reduce((S,k)=>{const C=me(k,"extendNodeSchema",f);return{...S,...C?C(d):{}}},{}),g=Nb({...m,content:Ae(me(d,"content",f)),marks:Ae(me(d,"marks",f)),group:Ae(me(d,"group",f)),inline:Ae(me(d,"inline",f)),atom:Ae(me(d,"atom",f)),selectable:Ae(me(d,"selectable",f)),draggable:Ae(me(d,"draggable",f)),code:Ae(me(d,"code",f)),whitespace:Ae(me(d,"whitespace",f)),linebreakReplacement:Ae(me(d,"linebreakReplacement",f)),defining:Ae(me(d,"defining",f)),isolating:Ae(me(d,"isolating",f)),attrs:Object.fromEntries(h.map(S=>{var k;return[S.name,{default:(k=S?.attribute)===null||k===void 0?void 0:k.default}]}))}),_=Ae(me(d,"parseHTML",f));_&&(g.parseDOM=_.map(S=>Ob(S,h)));const v=me(d,"renderHTML",f);v&&(g.toDOM=S=>v({node:S,HTMLAttributes:xg(S,h)}));const x=me(d,"renderText",f);return x&&(g.toText=x),[d.name,g]})),u=Object.fromEntries(s.map(d=>{const h=r.filter(x=>x.type===d.name),f={name:d.name,options:d.options,storage:d.storage,editor:e},m=t.reduce((x,S)=>{const k=me(S,"extendMarkSchema",f);return{...x,...k?k(d):{}}},{}),g=Nb({...m,inclusive:Ae(me(d,"inclusive",f)),excludes:Ae(me(d,"excludes",f)),group:Ae(me(d,"group",f)),spanning:Ae(me(d,"spanning",f)),code:Ae(me(d,"code",f)),attrs:Object.fromEntries(h.map(x=>{var S;return[x.name,{default:(S=x?.attribute)===null||S===void 0?void 0:S.default}]}))}),_=Ae(me(d,"parseHTML",f));_&&(g.parseDOM=_.map(x=>Ob(x,h)));const v=me(d,"renderHTML",f);return v&&(g.toDOM=x=>v({mark:x,HTMLAttributes:xg(x,h)})),[d.name,g]}));return new sC({topNode:o,nodes:l,marks:u})}function Mp(t,e){return e.nodes[t]||e.marks[t]||null}function Lb(t,e){return Array.isArray(e)?e.some(n=>(typeof n=="string"?n:n.name)===t.name):e}function gv(t,e){const n=zo.fromSchema(e).serializeFragment(t),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(n),i.innerHTML}const xB=(t,e=500)=>{let n="";const r=t.parentOffset;return t.parent.nodesBetween(Math.max(0,r-e),r,(i,s,o,l)=>{var u,d;const h=((d=(u=i.type.spec).toText)===null||d===void 0?void 0:d.call(u,{node:i,pos:s,parent:o,index:l}))||i.textContent||"%leaf%";n+=i.isAtom&&!i.isText?h:h.slice(0,Math.max(0,r-s))}),n};function yv(t){return Object.prototype.toString.call(t)==="[object RegExp]"}class Yh{constructor(e){this.find=e.find,this.handler=e.handler}}const SB=(t,e)=>{if(yv(e))return e.exec(t);const n=e(t);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=t,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function Vc(t){var e;const{editor:n,from:r,to:i,text:s,rules:o,plugin:l}=t,{view:u}=n;if(u.composing)return!1;const d=u.state.doc.resolve(r);if(d.parent.type.spec.code||!((e=d.nodeBefore||d.nodeAfter)===null||e===void 0)&&e.marks.find(m=>m.type.spec.code))return!1;let h=!1;const f=xB(d)+s;return o.forEach(m=>{if(h)return;const g=SB(f,m.find);if(!g)return;const _=u.state.tr,v=Qh({state:u.state,transaction:_}),x={from:r-(g[0].length-s.length),to:i},{commands:S,chain:k,can:C}=new Gh({editor:n,state:v});m.handler({state:v,range:x,match:g,commands:S,chain:k,can:C})===null||!_.steps.length||(_.setMeta(l,{transform:_,from:r,to:i,text:s}),u.dispatch(_),h=!0)}),h}function kB(t){const{editor:e,rules:n}=t,r=new Fn({state:{init(){return null},apply(i,s,o){const l=i.getMeta(r);if(l)return l;const u=i.getMeta("applyInputRules");return!!u&&setTimeout(()=>{let{text:h}=u;typeof h=="string"?h=h:h=gv(Y.from(h),o.schema);const{from:f}=u,m=f+h.length;Vc({editor:e,from:f,to:m,text:h,rules:n,plugin:r})}),i.selectionSet||i.docChanged?null:s}},props:{handleTextInput(i,s,o,l){return Vc({editor:e,from:s,to:o,text:l,rules:n,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:s}=i.state.selection;s&&Vc({editor:e,from:s.pos,to:s.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(i,s){if(s.key!=="Enter")return!1;const{$cursor:o}=i.state.selection;return o?Vc({editor:e,from:o.pos,to:o.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function CB(t){return Object.prototype.toString.call(t).slice(8,-1)}function Hc(t){return CB(t)!=="Object"?!1:t.constructor===Object&&Object.getPrototypeOf(t)===Object.prototype}function Xh(t,e){const n={...t};return Hc(t)&&Hc(e)&&Object.keys(e).forEach(r=>{Hc(e[r])&&Hc(t[r])?n[r]=Xh(t[r],e[r]):n[r]=e[r]}),n}class Es{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Ae(me(this,"addOptions",{name:this.name}))),this.storage=Ae(me(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Es(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>Xh(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new Es(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Ae(me(n,"addOptions",{name:n.name})),n.storage=Ae(me(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:e,mark:n}){const{tr:r}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const o=i.marks();if(!!!o.find(d=>d?.type.name===n.name))return!1;const u=o.find(d=>d?.type.name===n.name);return u&&r.removeStoredMark(u),r.insertText(" ",i.pos),e.view.dispatch(r),!0}return!1}}function EB(t){return typeof t=="number"}class TB{constructor(e){this.find=e.find,this.handler=e.handler}}const PB=(t,e,n)=>{if(yv(e))return[...t.matchAll(e)];const r=e(t,n);return r?r.map(i=>{const s=[i.text];return s.index=i.index,s.input=t,s.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),s.push(i.replaceWith)),s}):[]};function MB(t){const{editor:e,state:n,from:r,to:i,rule:s,pasteEvent:o,dropEvent:l}=t,{commands:u,chain:d,can:h}=new Gh({editor:e,state:n}),f=[];return n.doc.nodesBetween(r,i,(g,_)=>{if(!g.isTextblock||g.type.spec.code)return;const v=Math.max(r,_),x=Math.min(i,_+g.content.size),S=g.textBetween(v-_,x-_,void 0,"");PB(S,s.find,o).forEach(C=>{if(C.index===void 0)return;const R=v+C.index+1,N=R+C[0].length,P={from:n.tr.mapping.map(R),to:n.tr.mapping.map(N)},T=s.handler({state:n,range:P,match:C,commands:u,chain:d,can:h,pasteEvent:o,dropEvent:l});f.push(T)})}),f.every(g=>g!==null)}let qc=null;const OB=t=>{var e;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=n.clipboardData)===null||e===void 0||e.setData("text/html",t),n};function NB(t){const{editor:e,rules:n}=t;let r=null,i=!1,s=!1,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,l;try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}const u=({state:h,from:f,to:m,rule:g,pasteEvt:_})=>{const v=h.tr,x=Qh({state:h,transaction:v});if(!(!MB({editor:e,state:x,from:Math.max(f-1,0),to:m.b-1,rule:g,pasteEvent:_,dropEvent:l})||!v.steps.length)){try{l=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{l=null}return o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,v}};return n.map(h=>new Fn({view(f){const m=_=>{var v;r=!((v=f.dom.parentElement)===null||v===void 0)&&v.contains(_.target)?f.dom.parentElement:null,r&&(qc=e)},g=()=>{qc&&(qc=null)};return window.addEventListener("dragstart",m),window.addEventListener("dragend",g),{destroy(){window.removeEventListener("dragstart",m),window.removeEventListener("dragend",g)}}},props:{handleDOMEvents:{drop:(f,m)=>{if(s=r===f.dom.parentElement,l=m,!s){const g=qc;g?.isEditable&&setTimeout(()=>{const _=g.state.selection;_&&g.commands.deleteRange({from:_.from,to:_.to})},10)}return!1},paste:(f,m)=>{var g;const _=(g=m.clipboardData)===null||g===void 0?void 0:g.getData("text/html");return o=m,i=!!_?.includes("data-pm-slice"),!1}}},appendTransaction:(f,m,g)=>{const _=f[0],v=_.getMeta("uiEvent")==="paste"&&!i,x=_.getMeta("uiEvent")==="drop"&&!s,S=_.getMeta("applyPasteRules"),k=!!S;if(!v&&!x&&!k)return;if(k){let{text:N}=S;typeof N=="string"?N=N:N=gv(Y.from(N),g.schema);const{from:P}=S,T=P+N.length,D=OB(N);return u({rule:h,state:g,from:P,to:{b:T},pasteEvt:D})}const C=m.doc.content.findDiffStart(g.doc.content),R=m.doc.content.findDiffEnd(g.doc.content);if(!(!EB(C)||!R||C===R.b))return u({rule:h,state:g,from:C,to:R,pasteEvt:o})}}))}function LB(t){const e=t.filter((n,r)=>t.indexOf(n)!==r);return Array.from(new Set(e))}class wa{constructor(e,n){this.splittableMarks=[],this.editor=n,this.extensions=wa.resolve(e),this.schema=bB(this.extensions,n),this.setupExtensions()}static resolve(e){const n=wa.sort(wa.flatten(e)),r=LB(n.map(i=>i.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),n}static flatten(e){return e.map(n=>{const r={name:n.name,options:n.options,storage:n.storage},i=me(n,"addExtensions",r);return i?[n,...this.flatten(i())]:n}).flat(10)}static sort(e){return e.sort((r,i)=>{const s=me(r,"priority")||100,o=me(i,"priority")||100;return s>o?-1:s<o?1:0})}get commands(){return this.extensions.reduce((e,n)=>{const r={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:Mp(n.name,this.schema)},i=me(n,"addCommands",r);return i?{...e,...i()}:e},{})}get plugins(){const{editor:e}=this,n=wa.sort([...this.extensions].reverse()),r=[],i=[],s=n.map(o=>{const l={name:o.name,options:o.options,storage:o.storage,editor:e,type:Mp(o.name,this.schema)},u=[],d=me(o,"addKeyboardShortcuts",l);let h={};if(o.type==="mark"&&me(o,"exitable",l)&&(h.ArrowRight=()=>Es.handleExit({editor:e,mark:o})),d){const v=Object.fromEntries(Object.entries(d()).map(([x,S])=>[x,()=>S({editor:e})]));h={...h,...v}}const f=Jz(h);u.push(f);const m=me(o,"addInputRules",l);Lb(o,e.options.enableInputRules)&&m&&r.push(...m());const g=me(o,"addPasteRules",l);Lb(o,e.options.enablePasteRules)&&g&&i.push(...g());const _=me(o,"addProseMirrorPlugins",l);if(_){const v=_();u.push(...v)}return u}).flat();return[kB({editor:e,rules:r}),...NB({editor:e,rules:i}),...s]}get attributes(){return gE(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:n}=Jh(this.extensions);return Object.fromEntries(n.filter(r=>!!me(r,"addNodeView")).map(r=>{const i=this.attributes.filter(u=>u.type===r.name),s={name:r.name,options:r.options,storage:r.storage,editor:e,type:Ht(r.name,this.schema)},o=me(r,"addNodeView",s);if(!o)return[];const l=(u,d,h,f,m)=>{const g=xg(u,i);return o()({node:u,view:d,getPos:h,decorations:f,innerDecorations:m,editor:e,extension:r,HTMLAttributes:g})};return[r.name,l]}))}setupExtensions(){this.extensions.forEach(e=>{var n;this.editor.extensionStorage[e.name]=e.storage;const r={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:Mp(e.name,this.schema)};e.type==="mark"&&(!((n=Ae(me(e,"keepOnSplit",r)))!==null&&n!==void 0)||n)&&this.splittableMarks.push(e.name);const i=me(e,"onBeforeCreate",r),s=me(e,"onCreate",r),o=me(e,"onUpdate",r),l=me(e,"onSelectionUpdate",r),u=me(e,"onTransaction",r),d=me(e,"onFocus",r),h=me(e,"onBlur",r),f=me(e,"onDestroy",r);i&&this.editor.on("beforeCreate",i),s&&this.editor.on("create",s),o&&this.editor.on("update",o),l&&this.editor.on("selectionUpdate",l),u&&this.editor.on("transaction",u),d&&this.editor.on("focus",d),h&&this.editor.on("blur",h),f&&this.editor.on("destroy",f)})}}class Sn{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Ae(me(this,"addOptions",{name:this.name}))),this.storage=Ae(me(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Sn(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>Xh(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new Sn({...this.config,...e});return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Ae(me(n,"addOptions",{name:n.name})),n.storage=Ae(me(n,"addStorage",{name:n.name,options:n.options})),n}}function vE(t,e,n){const{from:r,to:i}=e,{blockSeparator:s=`

`,textSerializers:o={}}=n||{};let l="";return t.nodesBetween(r,i,(u,d,h,f)=>{var m;u.isBlock&&d>r&&(l+=s);const g=o?.[u.type.name];if(g)return h&&(l+=g({node:u,pos:d,parent:h,index:f,range:e})),!1;u.isText&&(l+=(m=u?.text)===null||m===void 0?void 0:m.slice(Math.max(r,d)-d,i-d))}),l}function _E(t){return Object.fromEntries(Object.entries(t.nodes).filter(([,e])=>e.spec.toText).map(([e,n])=>[e,n.spec.toText]))}const RB=Sn.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Fn({key:new Xr("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:t}=this,{state:e,schema:n}=t,{doc:r,selection:i}=e,{ranges:s}=i,o=Math.min(...s.map(h=>h.$from.pos)),l=Math.max(...s.map(h=>h.$to.pos)),u=_E(n);return vE(r,{from:o,to:l},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:u})}}})]}}),DB=()=>({editor:t,view:e})=>(requestAnimationFrame(()=>{var n;t.isDestroyed||(e.dom.blur(),(n=window?.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),AB=(t=!1)=>({commands:e})=>e.setContent("",t),IB=()=>({state:t,tr:e,dispatch:n})=>{const{selection:r}=e,{ranges:i}=r;return n&&i.forEach(({$from:s,$to:o})=>{t.doc.nodesBetween(s.pos,o.pos,(l,u)=>{if(l.type.isText)return;const{doc:d,mapping:h}=e,f=d.resolve(h.map(u)),m=d.resolve(h.map(u+l.nodeSize)),g=f.blockRange(m);if(!g)return;const _=nl(g);if(l.type.isTextblock){const{defaultType:v}=f.parent.contentMatchAt(f.index());e.setNodeMarkup(g.start,v)}(_||_===0)&&e.lift(g,_)})}),!0},jB=t=>e=>t(e),zB=()=>({state:t,dispatch:e})=>hE(t,e),BB=(t,e)=>({editor:n,tr:r})=>{const{state:i}=n,s=i.doc.slice(t.from,t.to);r.deleteRange(t.from,t.to);const o=r.mapping.map(e);return r.insert(o,s.content),r.setSelection(new Ee(r.doc.resolve(Math.max(o-1,0)))),!0},FB=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,r=n.$anchor.node();if(r.content.size>0)return!1;const i=t.selection.$anchor;for(let s=i.depth;s>0;s-=1)if(i.node(s).type===r.type){if(e){const l=i.before(s),u=i.after(s);t.delete(l,u).scrollIntoView()}return!0}return!1},$B=t=>({tr:e,state:n,dispatch:r})=>{const i=Ht(t,n.schema),s=e.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===i){if(r){const u=s.before(o),d=s.after(o);e.delete(u,d).scrollIntoView()}return!0}return!1},UB=t=>({tr:e,dispatch:n})=>{const{from:r,to:i}=t;return n&&e.delete(r,i),!0},VB=()=>({state:t,dispatch:e})=>dv(t,e),HB=()=>({commands:t})=>t.keyboardShortcut("Enter"),qB=()=>({state:t,dispatch:e})=>rB(t,e);function lh(t,e,n={strict:!0}){const r=Object.keys(e);return r.length?r.every(i=>n.strict?e[i]===t[i]:yv(e[i])?e[i].test(t[i]):e[i]===t[i]):!0}function wE(t,e,n={}){return t.find(r=>r.type===e&&lh(Object.fromEntries(Object.keys(n).map(i=>[i,r.attrs[i]])),n))}function Rb(t,e,n={}){return!!wE(t,e,n)}function vv(t,e,n){var r;if(!t||!e)return;let i=t.parent.childAfter(t.parentOffset);if((!i.node||!i.node.marks.some(h=>h.type===e))&&(i=t.parent.childBefore(t.parentOffset)),!i.node||!i.node.marks.some(h=>h.type===e)||(n=n||((r=i.node.marks[0])===null||r===void 0?void 0:r.attrs),!wE([...i.node.marks],e,n)))return;let o=i.index,l=t.start()+i.offset,u=o+1,d=l+i.node.nodeSize;for(;o>0&&Rb([...t.parent.child(o-1).marks],e,n);)o-=1,l-=t.parent.child(o).nodeSize;for(;u<t.parent.childCount&&Rb([...t.parent.child(u).marks],e,n);)d+=t.parent.child(u).nodeSize,u+=1;return{from:l,to:d}}function As(t,e){if(typeof t=="string"){if(!e.marks[t])throw Error(`There is no mark type named '${t}'. Maybe you forgot to add the extension?`);return e.marks[t]}return t}const WB=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const s=As(t,r.schema),{doc:o,selection:l}=n,{$from:u,from:d,to:h}=l;if(i){const f=vv(u,s,e);if(f&&f.from<=d&&f.to>=h){const m=Ee.create(o,f.from,f.to);n.setSelection(m)}}return!0},KB=t=>e=>{const n=typeof t=="function"?t(e):t;for(let r=0;r<n.length;r+=1)if(n[r](e))return!0;return!1};function bE(t){return t instanceof Ee}function fo(t=0,e=0,n=0){return Math.min(Math.max(t,e),n)}function xE(t,e=null){if(!e)return null;const n=Ne.atStart(t),r=Ne.atEnd(t);if(e==="start"||e===!0)return n;if(e==="end")return r;const i=n.from,s=r.to;return e==="all"?Ee.create(t,fo(0,i,s),fo(t.content.size,i,s)):Ee.create(t,fo(e,i,s),fo(e,i,s))}function ZB(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function _v(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const QB=(t=null,e={})=>({editor:n,view:r,tr:i,dispatch:s})=>{e={scrollIntoView:!0,...e};const o=()=>{(_v()||ZB())&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),e?.scrollIntoView&&n.commands.scrollIntoView())})};if(r.hasFocus()&&t===null||t===!1)return!0;if(s&&t===null&&!bE(n.state.selection))return o(),!0;const l=xE(i.doc,t)||n.state.selection,u=n.state.selection.eq(l);return s&&(u||i.setSelection(l),u&&i.storedMarks&&i.setStoredMarks(i.storedMarks),o()),!0},GB=(t,e)=>n=>t.every((r,i)=>e(r,{...n,index:i})),JB=(t,e)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},t,e),SE=t=>{const e=t.childNodes;for(let n=e.length-1;n>=0;n-=1){const r=e[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?t.removeChild(r):r.nodeType===1&&SE(r)}return t};function Wc(t){const e=`<body>${t}</body>`,n=new window.DOMParser().parseFromString(e,"text/html").body;return SE(n)}function Ru(t,e,n){if(t instanceof vs||t instanceof Y)return t;n={slice:!0,parseOptions:{},...n};const r=typeof t=="object"&&t!==null,i=typeof t=="string";if(r)try{if(Array.isArray(t)&&t.length>0)return Y.fromArray(t.map(l=>e.nodeFromJSON(l)));const o=e.nodeFromJSON(t);return n.errorOnInvalidContent&&o.check(),o}catch(s){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:s});return console.warn("[tiptap warn]: Invalid content.","Passed value:",t,"Error:",s),Ru("",e,n)}if(i){if(n.errorOnInvalidContent){let o=!1,l="";const u=new sC({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:d=>(o=!0,l=typeof d=="string"?d:d.outerHTML,null)}]}})});if(n.slice?_s.fromSchema(u).parseSlice(Wc(t),n.parseOptions):_s.fromSchema(u).parse(Wc(t),n.parseOptions),n.errorOnInvalidContent&&o)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${l}`)})}const s=_s.fromSchema(e);return n.slice?s.parseSlice(Wc(t),n.parseOptions).content:s.parse(Wc(t),n.parseOptions)}return Ru("",e,n)}function YB(t,e,n){const r=t.steps.length-1;if(r<e)return;const i=t.steps[r];if(!(i instanceof Ft||i instanceof Ut))return;const s=t.mapping.maps[r];let o=0;s.forEach((l,u,d,h)=>{o===0&&(o=h)}),t.setSelection(Ne.near(t.doc.resolve(o),n))}const XB=t=>!("type"in t),eF=(t,e,n)=>({tr:r,dispatch:i,editor:s})=>{var o;if(i){n={parseOptions:s.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let l;const u=x=>{s.emit("contentError",{editor:s,error:x,disableCollaboration:()=>{s.storage.collaboration&&(s.storage.collaboration.isDisabled=!0)}})},d={preserveWhitespace:"full",...n.parseOptions};if(!n.errorOnInvalidContent&&!s.options.enableContentCheck&&s.options.emitContentError)try{Ru(e,s.schema,{parseOptions:d,errorOnInvalidContent:!0})}catch(x){u(x)}try{l=Ru(e,s.schema,{parseOptions:d,errorOnInvalidContent:(o=n.errorOnInvalidContent)!==null&&o!==void 0?o:s.options.enableContentCheck})}catch(x){return u(x),!1}let{from:h,to:f}=typeof t=="number"?{from:t,to:t}:{from:t.from,to:t.to},m=!0,g=!0;if((XB(l)?l:[l]).forEach(x=>{x.check(),m=m?x.isText&&x.marks.length===0:!1,g=g?x.isBlock:!1}),h===f&&g){const{parent:x}=r.doc.resolve(h);x.isTextblock&&!x.type.spec.code&&!x.childCount&&(h-=1,f+=1)}let v;if(m){if(Array.isArray(e))v=e.map(x=>x.text||"").join("");else if(e instanceof Y){let x="";e.forEach(S=>{S.text&&(x+=S.text)}),v=x}else typeof e=="object"&&e&&e.text?v=e.text:v=e;r.insertText(v,h,f)}else v=l,r.replaceWith(h,f,v);n.updateSelection&&YB(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:h,text:v}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:h,text:v})}return!0},tF=()=>({state:t,dispatch:e})=>eB(t,e),nF=()=>({state:t,dispatch:e})=>tB(t,e),rF=()=>({state:t,dispatch:e})=>sE(t,e),iF=()=>({state:t,dispatch:e})=>uE(t,e),sF=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Vh(t.doc,t.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},oF=()=>({state:t,dispatch:e,tr:n})=>{try{const r=Vh(t.doc,t.selection.$from.pos,1);return r==null?!1:(n.join(r,2),e&&e(n),!0)}catch{return!1}},aF=()=>({state:t,dispatch:e})=>Yz(t,e),lF=()=>({state:t,dispatch:e})=>Xz(t,e);function kE(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function uF(t){const e=t.split(/-(?!$)/);let n=e[e.length-1];n==="Space"&&(n=" ");let r,i,s,o;for(let l=0;l<e.length-1;l+=1){const u=e[l];if(/^(cmd|meta|m)$/i.test(u))o=!0;else if(/^a(lt)?$/i.test(u))r=!0;else if(/^(c|ctrl|control)$/i.test(u))i=!0;else if(/^s(hift)?$/i.test(u))s=!0;else if(/^mod$/i.test(u))_v()||kE()?o=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${u}`)}return r&&(n=`Alt-${n}`),i&&(n=`Ctrl-${n}`),o&&(n=`Meta-${n}`),s&&(n=`Shift-${n}`),n}const cF=t=>({editor:e,view:n,tr:r,dispatch:i})=>{const s=uF(t).split(/-(?!$)/),o=s.find(d=>!["Alt","Ctrl","Meta","Shift"].includes(d)),l=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:s.includes("Alt"),ctrlKey:s.includes("Ctrl"),metaKey:s.includes("Meta"),shiftKey:s.includes("Shift"),bubbles:!0,cancelable:!0}),u=e.captureTransaction(()=>{n.someProp("handleKeyDown",d=>d(n,l))});return u?.steps.forEach(d=>{const h=d.map(r.mapping);h&&i&&r.maybeStep(h)}),!0};function Du(t,e,n={}){const{from:r,to:i,empty:s}=t.selection,o=e?Ht(e,t.schema):null,l=[];t.doc.nodesBetween(r,i,(f,m)=>{if(f.isText)return;const g=Math.max(r,m),_=Math.min(i,m+f.nodeSize);l.push({node:f,from:g,to:_})});const u=i-r,d=l.filter(f=>o?o.name===f.node.type.name:!0).filter(f=>lh(f.node.attrs,n,{strict:!1}));return s?!!d.length:d.reduce((f,m)=>f+m.to-m.from,0)>=u}const dF=(t,e={})=>({state:n,dispatch:r})=>{const i=Ht(t,n.schema);return Du(n,i,e)?nB(n,r):!1},hF=()=>({state:t,dispatch:e})=>fE(t,e),fF=t=>({state:e,dispatch:n})=>{const r=Ht(t,e.schema);return pB(r)(e,n)},pF=()=>({state:t,dispatch:e})=>dE(t,e);function ef(t,e){return e.nodes[t]?"node":e.marks[t]?"mark":null}function Db(t,e){const n=typeof e=="string"?[e]:e;return Object.keys(t).reduce((r,i)=>(n.includes(i)||(r[i]=t[i]),r),{})}const mF=(t,e)=>({tr:n,state:r,dispatch:i})=>{let s=null,o=null;const l=ef(typeof t=="string"?t:t.name,r.schema);return l?(l==="node"&&(s=Ht(t,r.schema)),l==="mark"&&(o=As(t,r.schema)),i&&n.selection.ranges.forEach(u=>{r.doc.nodesBetween(u.$from.pos,u.$to.pos,(d,h)=>{s&&s===d.type&&n.setNodeMarkup(h,void 0,Db(d.attrs,e)),o&&d.marks.length&&d.marks.forEach(f=>{o===f.type&&n.addMark(h,h+d.nodeSize,o.create(Db(f.attrs,e)))})})}),!0):!1},gF=()=>({tr:t,dispatch:e})=>(e&&t.scrollIntoView(),!0),yF=()=>({tr:t,dispatch:e})=>{if(e){const n=new Qn(t.doc);t.setSelection(n)}return!0},vF=()=>({state:t,dispatch:e})=>aE(t,e),_F=()=>({state:t,dispatch:e})=>cE(t,e),wF=()=>({state:t,dispatch:e})=>oB(t,e),bF=()=>({state:t,dispatch:e})=>uB(t,e),xF=()=>({state:t,dispatch:e})=>lB(t,e);function Sg(t,e,n={},r={}){return Ru(t,e,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}const SF=(t,e=!1,n={},r={})=>({editor:i,tr:s,dispatch:o,commands:l})=>{var u,d;const{doc:h}=s;if(n.preserveWhitespace!=="full"){const f=Sg(t,i.schema,n,{errorOnInvalidContent:(u=r.errorOnInvalidContent)!==null&&u!==void 0?u:i.options.enableContentCheck});return o&&s.replaceWith(0,h.content.size,f).setMeta("preventUpdate",!e),!0}return o&&s.setMeta("preventUpdate",!e),l.insertContentAt({from:0,to:h.content.size},t,{parseOptions:n,errorOnInvalidContent:(d=r.errorOnInvalidContent)!==null&&d!==void 0?d:i.options.enableContentCheck})};function CE(t,e){const n=As(e,t.schema),{from:r,to:i,empty:s}=t.selection,o=[];s?(t.storedMarks&&o.push(...t.storedMarks),o.push(...t.selection.$head.marks())):t.doc.nodesBetween(r,i,u=>{o.push(...u.marks)});const l=o.find(u=>u.type.name===n.name);return l?{...l.attrs}:{}}function kF(t){for(let e=0;e<t.edgeCount;e+=1){const{type:n}=t.edge(e);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function CF(t,e){for(let n=t.depth;n>0;n-=1){const r=t.node(n);if(e(r))return{pos:n>0?t.before(n):0,start:t.start(n),depth:n,node:r}}}function wv(t){return e=>CF(e.$from,t)}function EF(t,e){const n={from:0,to:t.content.size};return vE(t,n,e)}function TF(t,e){const n=Ht(e,t.schema),{from:r,to:i}=t.selection,s=[];t.doc.nodesBetween(r,i,l=>{s.push(l)});const o=s.reverse().find(l=>l.type.name===n.name);return o?{...o.attrs}:{}}function PF(t,e){const n=ef(typeof e=="string"?e:e.name,t.schema);return n==="node"?TF(t,e):n==="mark"?CE(t,e):{}}function EE(t,e,n){const r=[];return t===e?n.resolve(t).marks().forEach(i=>{const s=n.resolve(t),o=vv(s,i.type);o&&r.push({mark:i,...o})}):n.nodesBetween(t,e,(i,s)=>{!i||i?.nodeSize===void 0||r.push(...i.marks.map(o=>({from:s,to:s+i.nodeSize,mark:o})))}),r}function dd(t,e,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const i=t.find(s=>s.type===e&&s.name===r);return i?i.attribute.keepOnSplit:!1}))}function kg(t,e,n={}){const{empty:r,ranges:i}=t.selection,s=e?As(e,t.schema):null;if(r)return!!(t.storedMarks||t.selection.$from.marks()).filter(f=>s?s.name===f.type.name:!0).find(f=>lh(f.attrs,n,{strict:!1}));let o=0;const l=[];if(i.forEach(({$from:f,$to:m})=>{const g=f.pos,_=m.pos;t.doc.nodesBetween(g,_,(v,x)=>{if(!v.isText&&!v.marks.length)return;const S=Math.max(g,x),k=Math.min(_,x+v.nodeSize),C=k-S;o+=C,l.push(...v.marks.map(R=>({mark:R,from:S,to:k})))})}),o===0)return!1;const u=l.filter(f=>s?s.name===f.mark.type.name:!0).filter(f=>lh(f.mark.attrs,n,{strict:!1})).reduce((f,m)=>f+m.to-m.from,0),d=l.filter(f=>s?f.mark.type!==s&&f.mark.type.excludes(s):!0).reduce((f,m)=>f+m.to-m.from,0);return(u>0?u+d:u)>=o}function MF(t,e,n={}){if(!e)return Du(t,null,n)||kg(t,null,n);const r=ef(e,t.schema);return r==="node"?Du(t,e,n):r==="mark"?kg(t,e,n):!1}function Ab(t,e){const{nodeExtensions:n}=Jh(e),r=n.find(o=>o.name===t);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},s=Ae(me(r,"group",i));return typeof s!="string"?!1:s.split(" ").includes("list")}function bv(t,{checkChildren:e=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(t.type.name==="hardBreak")return!0;if(t.isText)return/^\s*$/m.test((r=t.text)!==null&&r!==void 0?r:"")}if(t.isText)return!t.text;if(t.isAtom||t.isLeaf)return!1;if(t.content.childCount===0)return!0;if(e){let i=!0;return t.content.forEach(s=>{i!==!1&&(bv(s,{ignoreWhitespace:n,checkChildren:e})||(i=!1))}),i}return!1}function OF(t){return t instanceof _e}function NF(t,e,n){var r;const{selection:i}=e;let s=null;if(bE(i)&&(s=i.$cursor),s){const l=(r=t.storedMarks)!==null&&r!==void 0?r:s.marks();return!!n.isInSet(l)||!l.some(u=>u.type.excludes(n))}const{ranges:o}=i;return o.some(({$from:l,$to:u})=>{let d=l.depth===0?t.doc.inlineContent&&t.doc.type.allowsMarkType(n):!1;return t.doc.nodesBetween(l.pos,u.pos,(h,f,m)=>{if(d)return!1;if(h.isInline){const g=!m||m.type.allowsMarkType(n),_=!!n.isInSet(h.marks)||!h.marks.some(v=>v.type.excludes(n));d=g&&_}return!d}),d})}const LF=(t,e={})=>({tr:n,state:r,dispatch:i})=>{const{selection:s}=n,{empty:o,ranges:l}=s,u=As(t,r.schema);if(i)if(o){const d=CE(r,u);n.addStoredMark(u.create({...d,...e}))}else l.forEach(d=>{const h=d.$from.pos,f=d.$to.pos;r.doc.nodesBetween(h,f,(m,g)=>{const _=Math.max(g,h),v=Math.min(g+m.nodeSize,f);m.marks.find(S=>S.type===u)?m.marks.forEach(S=>{u===S.type&&n.addMark(_,v,u.create({...S.attrs,...e}))}):n.addMark(_,v,u.create(e))})});return NF(r,n,u)},RF=(t,e)=>({tr:n})=>(n.setMeta(t,e),!0),DF=(t,e={})=>({state:n,dispatch:r,chain:i})=>{const s=Ht(t,n.schema);let o;return n.selection.$anchor.sameParent(n.selection.$head)&&(o=n.selection.$anchor.parent.attrs),s.isTextblock?i().command(({commands:l})=>Mb(s,{...o,...e})(n)?!0:l.clearNodes()).command(({state:l})=>Mb(s,{...o,...e})(l,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},AF=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,i=fo(t,0,r.content.size),s=_e.create(r,i);e.setSelection(s)}return!0},IF=t=>({tr:e,dispatch:n})=>{if(n){const{doc:r}=e,{from:i,to:s}=typeof t=="number"?{from:t,to:t}:t,o=Ee.atStart(r).from,l=Ee.atEnd(r).to,u=fo(i,o,l),d=fo(s,o,l),h=Ee.create(r,u,d);e.setSelection(h)}return!0},jF=t=>({state:e,dispatch:n})=>{const r=Ht(t,e.schema);return yB(r)(e,n)};function Ib(t,e){const n=t.storedMarks||t.selection.$to.parentOffset&&t.selection.$from.marks();if(n){const r=n.filter(i=>e?.includes(i.type.name));t.tr.ensureMarks(r)}}const zF=({keepMarks:t=!0}={})=>({tr:e,state:n,dispatch:r,editor:i})=>{const{selection:s,doc:o}=e,{$from:l,$to:u}=s,d=i.extensionManager.attributes,h=dd(d,l.node().type.name,l.node().attrs);if(s instanceof _e&&s.node.isBlock)return!l.parentOffset||!xi(o,l.pos)?!1:(r&&(t&&Ib(n,i.extensionManager.splittableMarks),e.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;const f=u.parentOffset===u.parent.content.size,m=l.depth===0?void 0:kF(l.node(-1).contentMatchAt(l.indexAfter(-1)));let g=f&&m?[{type:m,attrs:h}]:void 0,_=xi(e.doc,e.mapping.map(l.pos),1,g);if(!g&&!_&&xi(e.doc,e.mapping.map(l.pos),1,m?[{type:m}]:void 0)&&(_=!0,g=m?[{type:m,attrs:h}]:void 0),r){if(_&&(s instanceof Ee&&e.deleteSelection(),e.split(e.mapping.map(l.pos),1,g),m&&!f&&!l.parentOffset&&l.parent.type!==m)){const v=e.mapping.map(l.before()),x=e.doc.resolve(v);l.node(-1).canReplaceWith(x.index(),x.index()+1,m)&&e.setNodeMarkup(e.mapping.map(l.before()),m)}t&&Ib(n,i.extensionManager.splittableMarks),e.scrollIntoView()}return _},BF=(t,e={})=>({tr:n,state:r,dispatch:i,editor:s})=>{var o;const l=Ht(t,r.schema),{$from:u,$to:d}=r.selection,h=r.selection.node;if(h&&h.isBlock||u.depth<2||!u.sameParent(d))return!1;const f=u.node(-1);if(f.type!==l)return!1;const m=s.extensionManager.attributes;if(u.parent.content.size===0&&u.node(-1).childCount===u.indexAfter(-1)){if(u.depth===2||u.node(-3).type!==l||u.index(-2)!==u.node(-2).childCount-1)return!1;if(i){let S=Y.empty;const k=u.index(-1)?1:u.index(-2)?2:3;for(let D=u.depth-k;D>=u.depth-3;D-=1)S=Y.from(u.node(D).copy(S));const C=u.indexAfter(-1)<u.node(-2).childCount?1:u.indexAfter(-2)<u.node(-3).childCount?2:3,R={...dd(m,u.node().type.name,u.node().attrs),...e},N=((o=l.contentMatch.defaultType)===null||o===void 0?void 0:o.createAndFill(R))||void 0;S=S.append(Y.from(l.createAndFill(null,N)||void 0));const P=u.before(u.depth-(k-1));n.replace(P,u.after(-C),new le(S,4-k,0));let T=-1;n.doc.nodesBetween(P,n.doc.content.size,(D,j)=>{if(T>-1)return!1;D.isTextblock&&D.content.size===0&&(T=j+1)}),T>-1&&n.setSelection(Ee.near(n.doc.resolve(T))),n.scrollIntoView()}return!0}const g=d.pos===u.end()?f.contentMatchAt(0).defaultType:null,_={...dd(m,f.type.name,f.attrs),...e},v={...dd(m,u.node().type.name,u.node().attrs),...e};n.delete(u.pos,d.pos);const x=g?[{type:l,attrs:_},{type:g,attrs:v}]:[{type:l,attrs:_}];if(!xi(n.doc,u.pos,2))return!1;if(i){const{selection:S,storedMarks:k}=r,{splittableMarks:C}=s.extensionManager,R=k||S.$to.parentOffset&&S.$from.marks();if(n.split(u.pos,2,x).scrollIntoView(),!R||!i)return!0;const N=R.filter(P=>C.includes(P.type.name));n.ensureMarks(N)}return!0},Op=(t,e)=>{const n=wv(o=>o.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===i?.type&&Rs(t.doc,n.pos)&&t.join(n.pos),!0},Np=(t,e)=>{const n=wv(o=>o.type===e)(t.selection);if(!n)return!0;const r=t.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const i=t.doc.nodeAt(r);return n.node.type===i?.type&&Rs(t.doc,r)&&t.join(r),!0},FF=(t,e,n,r={})=>({editor:i,tr:s,state:o,dispatch:l,chain:u,commands:d,can:h})=>{const{extensions:f,splittableMarks:m}=i.extensionManager,g=Ht(t,o.schema),_=Ht(e,o.schema),{selection:v,storedMarks:x}=o,{$from:S,$to:k}=v,C=S.blockRange(k),R=x||v.$to.parentOffset&&v.$from.marks();if(!C)return!1;const N=wv(P=>Ab(P.type.name,f))(v);if(C.depth>=1&&N&&C.depth-N.depth<=1){if(N.node.type===g)return d.liftListItem(_);if(Ab(N.node.type.name,f)&&g.validContent(N.node.content)&&l)return u().command(()=>(s.setNodeMarkup(N.pos,g),!0)).command(()=>Op(s,g)).command(()=>Np(s,g)).run()}return!n||!R||!l?u().command(()=>h().wrapInList(g,r)?!0:d.clearNodes()).wrapInList(g,r).command(()=>Op(s,g)).command(()=>Np(s,g)).run():u().command(()=>{const P=h().wrapInList(g,r),T=R.filter(D=>m.includes(D.type.name));return s.ensureMarks(T),P?!0:d.clearNodes()}).wrapInList(g,r).command(()=>Op(s,g)).command(()=>Np(s,g)).run()},$F=(t,e={},n={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:s=!1}=n,o=As(t,r.schema);return kg(r,o,e)?i.unsetMark(o,{extendEmptyMarkRange:s}):i.setMark(o,e)},UF=(t,e,n={})=>({state:r,commands:i})=>{const s=Ht(t,r.schema),o=Ht(e,r.schema),l=Du(r,s,n);let u;return r.selection.$anchor.sameParent(r.selection.$head)&&(u=r.selection.$anchor.parent.attrs),l?i.setNode(o,u):i.setNode(s,{...u,...n})},VF=(t,e={})=>({state:n,commands:r})=>{const i=Ht(t,n.schema);return Du(n,i,e)?r.lift(i):r.wrapIn(i,e)},HF=()=>({state:t,dispatch:e})=>{const n=t.plugins;for(let r=0;r<n.length;r+=1){const i=n[r];let s;if(i.spec.isInputRules&&(s=i.getState(t))){if(e){const o=t.tr,l=s.transform;for(let u=l.steps.length-1;u>=0;u-=1)o.step(l.steps[u].invert(l.docs[u]));if(s.text){const u=o.doc.resolve(s.from).marks();o.replaceWith(s.from,s.to,t.schema.text(s.text,u))}else o.delete(s.from,s.to)}return!0}}return!1},qF=()=>({tr:t,dispatch:e})=>{const{selection:n}=t,{empty:r,ranges:i}=n;return r||e&&i.forEach(s=>{t.removeMark(s.$from.pos,s.$to.pos)}),!0},WF=(t,e={})=>({tr:n,state:r,dispatch:i})=>{var s;const{extendEmptyMarkRange:o=!1}=e,{selection:l}=n,u=As(t,r.schema),{$from:d,empty:h,ranges:f}=l;if(!i)return!0;if(h&&o){let{from:m,to:g}=l;const _=(s=d.marks().find(x=>x.type===u))===null||s===void 0?void 0:s.attrs,v=vv(d,u,_);v&&(m=v.from,g=v.to),n.removeMark(m,g,u)}else f.forEach(m=>{n.removeMark(m.$from.pos,m.$to.pos,u)});return n.removeStoredMark(u),!0},KF=(t,e={})=>({tr:n,state:r,dispatch:i})=>{let s=null,o=null;const l=ef(typeof t=="string"?t:t.name,r.schema);return l?(l==="node"&&(s=Ht(t,r.schema)),l==="mark"&&(o=As(t,r.schema)),i&&n.selection.ranges.forEach(u=>{const d=u.$from.pos,h=u.$to.pos;let f,m,g,_;n.selection.empty?r.doc.nodesBetween(d,h,(v,x)=>{s&&s===v.type&&(g=Math.max(x,d),_=Math.min(x+v.nodeSize,h),f=x,m=v)}):r.doc.nodesBetween(d,h,(v,x)=>{x<d&&s&&s===v.type&&(g=Math.max(x,d),_=Math.min(x+v.nodeSize,h),f=x,m=v),x>=d&&x<=h&&(s&&s===v.type&&n.setNodeMarkup(x,void 0,{...v.attrs,...e}),o&&v.marks.length&&v.marks.forEach(S=>{if(o===S.type){const k=Math.max(x,d),C=Math.min(x+v.nodeSize,h);n.addMark(k,C,o.create({...S.attrs,...e}))}}))}),m&&(f!==void 0&&n.setNodeMarkup(f,void 0,{...m.attrs,...e}),o&&m.marks.length&&m.marks.forEach(v=>{o===v.type&&n.addMark(g,_,o.create({...v.attrs,...e}))}))}),!0):!1},ZF=(t,e={})=>({state:n,dispatch:r})=>{const i=Ht(t,n.schema);return cB(i,e)(n,r)},QF=(t,e={})=>({state:n,dispatch:r})=>{const i=Ht(t,n.schema);return dB(i,e)(n,r)};var GF=Object.freeze({__proto__:null,blur:DB,clearContent:AB,clearNodes:IB,command:jB,createParagraphNear:zB,cut:BB,deleteCurrentNode:FB,deleteNode:$B,deleteRange:UB,deleteSelection:VB,enter:HB,exitCode:qB,extendMarkRange:WB,first:KB,focus:QB,forEach:GB,insertContent:JB,insertContentAt:eF,joinBackward:rF,joinDown:nF,joinForward:iF,joinItemBackward:sF,joinItemForward:oF,joinTextblockBackward:aF,joinTextblockForward:lF,joinUp:tF,keyboardShortcut:cF,lift:dF,liftEmptyBlock:hF,liftListItem:fF,newlineInCode:pF,resetAttributes:mF,scrollIntoView:gF,selectAll:yF,selectNodeBackward:vF,selectNodeForward:_F,selectParentNode:wF,selectTextblockEnd:bF,selectTextblockStart:xF,setContent:SF,setMark:LF,setMeta:RF,setNode:DF,setNodeSelection:AF,setTextSelection:IF,sinkListItem:jF,splitBlock:zF,splitListItem:BF,toggleList:FF,toggleMark:$F,toggleNode:UF,toggleWrap:VF,undoInputRule:HF,unsetAllMarks:qF,unsetMark:WF,updateAttributes:KF,wrapIn:ZF,wrapInList:QF});const JF=Sn.create({name:"commands",addCommands(){return{...GF}}}),YF=Sn.create({name:"drop",addProseMirrorPlugins(){return[new Fn({key:new Xr("tiptapDrop"),props:{handleDrop:(t,e,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:n,moved:r})}}})]}}),XF=Sn.create({name:"editable",addProseMirrorPlugins(){return[new Fn({key:new Xr("editable"),props:{editable:()=>this.editor.options.editable}})]}}),e$=new Xr("focusEvents"),t$=Sn.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:t}=this;return[new Fn({key:e$,props:{handleDOMEvents:{focus:(e,n)=>{t.isFocused=!0;const r=t.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,n)=>{t.isFocused=!1;const r=t.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),n$=Sn.create({name:"keymap",addKeyboardShortcuts(){const t=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:l})=>{const{selection:u,doc:d}=l,{empty:h,$anchor:f}=u,{pos:m,parent:g}=f,_=f.parent.isTextblock&&m>0?l.doc.resolve(m-1):f,v=_.parent.type.spec.isolating,x=f.pos-f.parentOffset,S=v&&_.parent.childCount===1?x===f.pos:Ne.atStart(d).from===m;return!h||!g.type.isTextblock||g.textContent.length||!S||S&&f.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:t,"Mod-Backspace":t,"Shift-Backspace":t,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},s={...r,"Ctrl-h":t,"Alt-Backspace":t,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return _v()||kE()?s:i},addProseMirrorPlugins(){return[new Fn({key:new Xr("clearDocument"),appendTransaction:(t,e,n)=>{if(t.some(v=>v.getMeta("composition")))return;const r=t.some(v=>v.docChanged)&&!e.doc.eq(n.doc),i=t.some(v=>v.getMeta("preventClearDocument"));if(!r||i)return;const{empty:s,from:o,to:l}=e.selection,u=Ne.atStart(e.doc).from,d=Ne.atEnd(e.doc).to;if(s||!(o===u&&l===d)||!bv(n.doc))return;const m=n.tr,g=Qh({state:n,transaction:m}),{commands:_}=new Gh({editor:this.editor,state:g});if(_.clearNodes(),!!m.steps.length)return m}})]}}),r$=Sn.create({name:"paste",addProseMirrorPlugins(){return[new Fn({key:new Xr("tiptapPaste"),props:{handlePaste:(t,e,n)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:n})}}})]}}),i$=Sn.create({name:"tabindex",addProseMirrorPlugins(){return[new Fn({key:new Xr("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class io{get name(){return this.node.type.name}constructor(e,n,r=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=n,this.currentNode=i}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(e);return new io(n,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new io(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new io(e,this.editor)}get children(){const e=[];return this.node.content.forEach((n,r)=>{const i=n.isBlock&&!n.isTextblock,s=n.isAtom&&!n.isText,o=this.pos+r+(s?0:1);if(o<0||o>this.resolvedPos.doc.nodeSize-2)return;const l=this.resolvedPos.doc.resolve(o);if(!i&&l.depth<=this.depth)return;const u=new io(l,this.editor,i,i?n:null);i&&(u.actualDepth=this.depth+1),e.push(new io(l,this.editor,i,i?n:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,n={}){let r=null,i=this.parent;for(;i&&!r;){if(i.node.type.name===e)if(Object.keys(n).length>0){const s=i.node.attrs,o=Object.keys(n);for(let l=0;l<o.length;l+=1){const u=o[l];if(s[u]!==n[u])break}}else r=i;i=i.parent}return r}querySelector(e,n={}){return this.querySelectorAll(e,n,!0)[0]||null}querySelectorAll(e,n={},r=!1){let i=[];if(!this.children||this.children.length===0)return i;const s=Object.keys(n);return this.children.forEach(o=>{r&&i.length>0||(o.node.type.name===e&&s.every(u=>n[u]===o.node.attrs[u])&&i.push(o),!(r&&i.length>0)&&(i=i.concat(o.querySelectorAll(e,n,r))))}),i}setAttribute(e){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(n)}}const s$=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function o$(t,e,n){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute("data-tiptap-style",""),i.innerHTML=t,document.getElementsByTagName("head")[0].appendChild(i),i}class a$ extends vB{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:r,moved:i})=>this.options.onDrop(n,r,i)),this.on("paste",({event:n,slice:r})=>this.options.onPaste(n,r)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=o$(s$,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,n=!0){this.setOptions({editable:e}),n&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,n){const r=yE(n)?n(e,[...this.state.plugins]):[...this.state.plugins,e],i=this.state.reconfigure({plugins:r});return this.view.updateState(i),i}unregisterPlugin(e){if(this.isDestroyed)return;const n=this.state.plugins;let r=n;if([].concat(e).forEach(s=>{const o=typeof s=="string"?`${s}$`:s.key;r=r.filter(l=>!l.key.startsWith(o))}),n.length===r.length)return;const i=this.state.reconfigure({plugins:r});return this.view.updateState(i),i}createExtensionManager(){var e,n;const i=[...this.options.enableCoreExtensions?[XF,RB.configure({blockSeparator:(n=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||n===void 0?void 0:n.blockSeparator}),JF,t$,n$,i$,YF,r$].filter(s=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[s.name]!==!1:!0):[],...this.options.extensions].filter(s=>["extension","node","mark"].includes(s?.type));this.extensionManager=new wa(i,this)}createCommandManager(){this.commandManager=new Gh({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let n;try{n=Sg(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(o){if(!(o instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(o.message))throw o;this.emit("contentError",{editor:this,error:o,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(l=>l.name!=="collaboration"),this.createExtensionManager()}}),n=Sg(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const r=xE(n,this.options.autofocus);this.view=new nE(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)===null||e===void 0?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:_a.create({doc:n,selection:r||void 0})});const i=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(i),this.createNodeViews(),this.prependClass();const s=this.view.dom;s.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(o=>{var l;return(l=this.capturedTransaction)===null||l===void 0?void 0:l.step(o)});return}const n=this.state.apply(e),r=!this.state.selection.eq(n.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:n}),this.view.updateState(n),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=e.getMeta("focus"),s=e.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:e}),s&&this.emit("blur",{editor:this,event:s.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return PF(this.state,e)}isActive(e,n){const r=typeof e=="string"?e:null,i=typeof e=="string"?n:e;return MF(this.state,r,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return gv(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:n=`

`,textSerializers:r={}}=e||{};return EF(this.state.doc,{blockSeparator:n,textSerializers:{..._E(this.schema),...r}})}get isEmpty(){return bv(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(e,n))||null}$nodes(e,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(e,n))||null}$pos(e){const n=this.state.doc.resolve(e);return new io(n,this)}get $doc(){return this.$pos(0)}}function Ha(t){return new Yh({find:t.find,handler:({state:e,range:n,match:r})=>{const i=Ae(t.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:s}=e,o=r[r.length-1],l=r[0];if(o){const u=l.search(/\S/),d=n.from+l.indexOf(o),h=d+o.length;if(EE(n.from,n.to,e.doc).filter(g=>g.mark.type.excluded.find(v=>v===t.type&&v!==g.mark.type)).filter(g=>g.to>d).length)return null;h<n.to&&s.delete(h,n.to),d>n.from&&s.delete(n.from+u,d);const m=n.from+u+o.length;s.addMark(n.from+u,m,t.type.create(i||{})),s.removeStoredMark(t.type)}}})}function l$(t){return new Yh({find:t.find,handler:({state:e,range:n,match:r})=>{const i=Ae(t.getAttributes,void 0,r)||{},{tr:s}=e,o=n.from;let l=n.to;const u=t.type.create(i);if(r[1]){const d=r[0].lastIndexOf(r[1]);let h=o+d;h>l?h=l:l=h+r[1].length;const f=r[0][r[0].length-1];s.insertText(f,o+r[0].length-1),s.replaceWith(h,l,u)}else if(r[0]){const d=t.type.isInline?o:o-1;s.insert(d,t.type.create(i)).delete(s.mapping.map(o),s.mapping.map(l))}s.scrollIntoView()}})}function Cg(t){return new Yh({find:t.find,handler:({state:e,range:n,match:r})=>{const i=e.doc.resolve(n.from),s=Ae(t.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),t.type))return null;e.tr.delete(n.from,n.to).setBlockType(n.from,n.from,t.type,s)}})}function Au(t){return new Yh({find:t.find,handler:({state:e,range:n,match:r,chain:i})=>{const s=Ae(t.getAttributes,void 0,r)||{},o=e.tr.delete(n.from,n.to),u=o.doc.resolve(n.from).blockRange(),d=u&&ev(u,t.type,s);if(!d)return null;if(o.wrap(u,d),t.keepMarks&&t.editor){const{selection:f,storedMarks:m}=e,{splittableMarks:g}=t.editor.extensionManager,_=m||f.$to.parentOffset&&f.$from.marks();if(_){const v=_.filter(x=>g.includes(x.type.name));o.ensureMarks(v)}}if(t.keepAttributes){const f=t.type.name==="bulletList"||t.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(f,s).run()}const h=o.doc.resolve(n.from-1).nodeBefore;h&&h.type===t.type&&Rs(o.doc,n.from-1)&&(!t.joinPredicate||t.joinPredicate(r,h))&&o.join(n.from-1)}})}class Bn{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=Ae(me(this,"addOptions",{name:this.name}))),this.storage=Ae(me(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Bn(e)}configure(e={}){const n=this.extend({...this.config,addOptions:()=>Xh(this.options,e)});return n.name=this.name,n.parent=this.parent,n}extend(e={}){const n=new Bn(e);return n.parent=this,this.child=n,n.name=e.name?e.name:n.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=Ae(me(n,"addOptions",{name:n.name})),n.storage=Ae(me(n,"addStorage",{name:n.name,options:n.options})),n}}function qa(t){return new TB({find:t.find,handler:({state:e,range:n,match:r,pasteEvent:i})=>{const s=Ae(t.getAttributes,void 0,r,i);if(s===!1||s===null)return null;const{tr:o}=e,l=r[r.length-1],u=r[0];let d=n.to;if(l){const h=u.search(/\S/),f=n.from+u.indexOf(l),m=f+l.length;if(EE(n.from,n.to,e.doc).filter(_=>_.mark.type.excluded.find(x=>x===t.type&&x!==_.mark.type)).filter(_=>_.to>f).length)return null;m<n.to&&o.delete(m,n.to),f>n.from&&o.delete(n.from+h,f),d=n.from+h+l.length,o.addMark(n.from+h,d,t.type.create(s||{})),o.removeStoredMark(t.type)}}})}function u$(t,e){const{selection:n}=t,{$from:r}=n;if(n instanceof _e){const s=r.index();return r.parent.canReplaceWith(s,s+1,e)}let i=r.depth;for(;i>=0;){const s=r.index(i);if(r.node(i).contentMatchAt(s).matchType(e))return!0;i-=1}return!1}function c$(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var TE={exports:{}},Lp={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jb;function d$(){if(jb)return Lp;jb=1;var t=q;function e(f,m){return f===m&&(f!==0||1/f===1/m)||f!==f&&m!==m}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,i=t.useEffect,s=t.useLayoutEffect,o=t.useDebugValue;function l(f,m){var g=m(),_=r({inst:{value:g,getSnapshot:m}}),v=_[0].inst,x=_[1];return s(function(){v.value=g,v.getSnapshot=m,u(v)&&x({inst:v})},[f,g,m]),i(function(){return u(v)&&x({inst:v}),f(function(){u(v)&&x({inst:v})})},[f]),o(g),g}function u(f){var m=f.getSnapshot;f=f.value;try{var g=m();return!n(f,g)}catch{return!0}}function d(f,m){return m()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:l;return Lp.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:h,Lp}TE.exports=d$();var xv=TE.exports;const h$=(...t)=>e=>{t.forEach(n=>{typeof n=="function"?n(e):n&&(n.current=e)})},f$=({contentComponent:t})=>{const e=xv.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return q.createElement(q.Fragment,null,Object.values(e))};function p$(){const t=new Set;let e={};return{subscribe(n){return t.add(n),()=>{t.delete(n)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(n,r){e={...e,[n]:ak.createPortal(r.reactElement,r.element,n)},t.forEach(i=>i())},removeRenderer(n){const r={...e};delete r[n],e=r,t.forEach(i=>i())}}}class m$ extends q.Component{constructor(e){var n;super(e),this.editorContentRef=q.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(!((n=e.editor)===null||n===void 0)&&n.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const n=this.editorContentRef.current;n.append(...e.options.element.childNodes),e.setOptions({element:n}),e.contentComponent=p$(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const e=this.props.editor;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild))return;const n=document.createElement("div");n.append(...e.options.element.childNodes),e.setOptions({element:n})}render(){const{editor:e,innerRef:n,...r}=this.props;return q.createElement(q.Fragment,null,q.createElement("div",{ref:h$(n,this.editorContentRef),...r}),e?.contentComponent&&q.createElement(f$,{contentComponent:e.contentComponent}))}}const g$=M.forwardRef((t,e)=>{const n=q.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[t.editor]);return q.createElement(m$,{key:n,innerRef:e,...t})}),y$=q.memo(g$);var v$=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,i,s;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(!t(e[i],n[i]))return!1;return!0}if(e instanceof Map&&n instanceof Map){if(e.size!==n.size)return!1;for(i of e.entries())if(!n.has(i[0]))return!1;for(i of e.entries())if(!t(i[1],n.get(i[0])))return!1;return!0}if(e instanceof Set&&n instanceof Set){if(e.size!==n.size)return!1;for(i of e.entries())if(!n.has(i[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(n)){if(r=e.length,r!=n.length)return!1;for(i=r;i--!==0;)if(e[i]!==n[i])return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(s=Object.keys(e),r=s.length,r!==Object.keys(n).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(n,s[i]))return!1;for(i=r;i--!==0;){var o=s[i];if(!(o==="_owner"&&e.$$typeof)&&!t(e[o],n[o]))return!1}return!0}return e!==e&&n!==n},_$=c$(v$),PE={exports:{}},Rp={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zb;function w$(){if(zb)return Rp;zb=1;var t=q,e=xv;function n(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var r=typeof Object.is=="function"?Object.is:n,i=e.useSyncExternalStore,s=t.useRef,o=t.useEffect,l=t.useMemo,u=t.useDebugValue;return Rp.useSyncExternalStoreWithSelector=function(d,h,f,m,g){var _=s(null);if(_.current===null){var v={hasValue:!1,value:null};_.current=v}else v=_.current;_=l(function(){function S(P){if(!k){if(k=!0,C=P,P=m(P),g!==void 0&&v.hasValue){var T=v.value;if(g(T,P))return R=T}return R=P}if(T=R,r(C,P))return T;var D=m(P);return g!==void 0&&g(T,D)?T:(C=P,R=D)}var k=!1,C,R,N=f===void 0?null:f;return[function(){return S(h())},N===null?void 0:function(){return S(N())}]},[h,f,m,g]);var x=i(d,_[0],_[1]);return o(function(){v.hasValue=!0,v.value=x},[x]),u(x),x},Rp}PE.exports=w$();var b$=PE.exports;const x$=typeof window<"u"?M.useLayoutEffect:M.useEffect;class S${constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const n=()=>{this.transactionNumber+=1,this.subscribers.forEach(i=>i())},r=this.editor;return r.on("transaction",n),()=>{r.off("transaction",n)}}}}function k$(t){var e;const[n]=M.useState(()=>new S$(t.editor)),r=b$.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,t.selector,(e=t.equalityFn)!==null&&e!==void 0?e:_$);return x$(()=>n.watch(t.editor),[t.editor,n]),M.useDebugValue(r),r}const C$=!1,Eg=typeof window>"u",E$=Eg||!!(typeof window<"u"&&window.next);class Sv{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?Eg||E$?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var i,s;return(s=(i=this.options.current).onBeforeCreate)===null||s===void 0?void 0:s.call(i,...r)},onBlur:(...r)=>{var i,s;return(s=(i=this.options.current).onBlur)===null||s===void 0?void 0:s.call(i,...r)},onCreate:(...r)=>{var i,s;return(s=(i=this.options.current).onCreate)===null||s===void 0?void 0:s.call(i,...r)},onDestroy:(...r)=>{var i,s;return(s=(i=this.options.current).onDestroy)===null||s===void 0?void 0:s.call(i,...r)},onFocus:(...r)=>{var i,s;return(s=(i=this.options.current).onFocus)===null||s===void 0?void 0:s.call(i,...r)},onSelectionUpdate:(...r)=>{var i,s;return(s=(i=this.options.current).onSelectionUpdate)===null||s===void 0?void 0:s.call(i,...r)},onTransaction:(...r)=>{var i,s;return(s=(i=this.options.current).onTransaction)===null||s===void 0?void 0:s.call(i,...r)},onUpdate:(...r)=>{var i,s;return(s=(i=this.options.current).onUpdate)===null||s===void 0?void 0:s.call(i,...r)},onContentError:(...r)=>{var i,s;return(s=(i=this.options.current).onContentError)===null||s===void 0?void 0:s.call(i,...r)},onDrop:(...r)=>{var i,s;return(s=(i=this.options.current).onDrop)===null||s===void 0?void 0:s.call(i,...r)},onPaste:(...r)=>{var i,s;return(s=(i=this.options.current).onPaste)===null||s===void 0?void 0:s.call(i,...r)}};return new a$(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,n){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&n.extensions?e.extensions.length!==n.extensions.length?!1:e.extensions.every((i,s)=>{var o;return i===((o=n.extensions)===null||o===void 0?void 0:o[s])}):e[r]===n[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?Sv.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,i)=>r===e[i]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===e&&this.setEditor(null))},1)}}function T$(t={},e=[]){const n=M.useRef(t);n.current=t;const[r]=M.useState(()=>new Sv(n)),i=xv.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return M.useDebugValue(i),M.useEffect(r.onRender(e)),k$({editor:i,selector:({transactionNumber:s})=>t.shouldRerenderOnTransaction===!1?null:t.immediatelyRender&&s===0?0:s+1}),i}const P$=M.createContext({editor:null});P$.Consumer;const M$=M.createContext({onDragStart:void 0}),O$=()=>M.useContext(M$);q.forwardRef((t,e)=>{const{onDragStart:n}=O$(),r=t.as||"div";return q.createElement(r,{...t,ref:e,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...t.style}})});const N$=/^\s*>\s$/,L$=Bn.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:t}){return["blockquote",xn(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>({commands:t})=>t.wrapIn(this.name),toggleBlockquote:()=>({commands:t})=>t.toggleWrap(this.name),unsetBlockquote:()=>({commands:t})=>t.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Au({find:N$,type:this.type})]}}),R$=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,D$=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,A$=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,I$=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,j$=Es.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:t=>t.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:t=>t.type.name===this.name},{style:"font-weight",getAttrs:t=>/^(bold(er)?|[5-9]\d{2,})$/.test(t)&&null}]},renderHTML({HTMLAttributes:t}){return["strong",xn(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>({commands:t})=>t.setMark(this.name),toggleBold:()=>({commands:t})=>t.toggleMark(this.name),unsetBold:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Ha({find:R$,type:this.type}),Ha({find:A$,type:this.type})]},addPasteRules(){return[qa({find:D$,type:this.type}),qa({find:I$,type:this.type})]}}),z$="listItem",Bb="textStyle",Fb=/^\s*([-+*])\s$/,B$=Bn.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:t}){return["ul",xn(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(z$,this.editor.getAttributes(Bb)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let t=Au({find:Fb,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Au({find:Fb,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Bb),editor:this.editor})),[t]}}),F$=/(^|[^`])`([^`]+)`(?!`)/,$$=/(^|[^`])`([^`]+)`(?!`)/g,U$=Es.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:t}){return["code",xn(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>({commands:t})=>t.setMark(this.name),toggleCode:()=>({commands:t})=>t.toggleMark(this.name),unsetCode:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Ha({find:F$,type:this.type})]},addPasteRules(){return[qa({find:$$,type:this.type})]}}),V$=/^```([a-z]+)?[\s\n]$/,H$=/^~~~([a-z]+)?[\s\n]$/,q$=Bn.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:t=>{var e;const{languageClassPrefix:n}=this.options,s=[...((e=t.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(o=>o.startsWith(n)).map(o=>o.replace(n,""))[0];return s||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:t,HTMLAttributes:e}){return["pre",xn(this.options.HTMLAttributes,e),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:t=>({commands:e})=>e.setNode(this.name,t),toggleCodeBlock:t=>({commands:e})=>e.toggleNode(this.name,"paragraph",t)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:t,$anchor:e}=this.editor.state.selection,n=e.pos===1;return!t||e.parent.type.name!==this.name?!1:n||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:t})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=t,{selection:n}=e,{$from:r,empty:i}=n;if(!i||r.parent.type!==this.type)return!1;const s=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith(`

`);return!s||!o?!1:t.chain().command(({tr:l})=>(l.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:t})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=t,{selection:n,doc:r}=e,{$from:i,empty:s}=n;if(!s||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const l=i.after();return l===void 0?!1:r.nodeAt(l)?t.commands.command(({tr:d})=>(d.setSelection(Ne.near(r.resolve(l))),!0)):t.commands.exitCode()}}},addInputRules(){return[Cg({find:V$,type:this.type,getAttributes:t=>({language:t[1]})}),Cg({find:H$,type:this.type,getAttributes:t=>({language:t[1]})})]},addProseMirrorPlugins(){return[new Fn({key:new Xr("codeBlockVSCodeHandler"),props:{handlePaste:(t,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const n=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,s=i?.mode;if(!n||!s)return!1;const{tr:o,schema:l}=t.state,u=l.text(n.replace(/\r\n?/g,`
`));return o.replaceSelectionWith(this.type.create({language:s},u)),o.selection.$from.parent.type!==this.type&&o.setSelection(Ee.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),t.dispatch(o),!0}}})]}}),W$=Bn.create({name:"doc",topNode:!0,content:"block+"});function K$(t={}){return new Fn({view(e){return new Z$(e,t)}})}class Z${constructor(e,n){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=n.width)!==null&&r!==void 0?r:1,this.color=n.color===!1?void 0:n.color||"black",this.class=n.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let s=o=>{this[i](o)};return e.dom.addEventListener(i,s),{name:i,handler:s}})}destroy(){this.handlers.forEach(({name:e,handler:n})=>this.editorView.dom.removeEventListener(e,n))}update(e,n){this.cursorPos!=null&&n.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),n=!e.parent.inlineContent,r,i=this.editorView.dom,s=i.getBoundingClientRect(),o=s.width/i.offsetWidth,l=s.height/i.offsetHeight;if(n){let f=e.nodeBefore,m=e.nodeAfter;if(f||m){let g=this.editorView.nodeDOM(this.cursorPos-(f?f.nodeSize:0));if(g){let _=g.getBoundingClientRect(),v=f?_.bottom:_.top;f&&m&&(v=(v+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let x=this.width/2*l;r={left:_.left,right:_.right,top:v-x,bottom:v+x}}}}if(!r){let f=this.editorView.coordsAtPos(this.cursorPos),m=this.width/2*o;r={left:f.left-m,right:f.left+m,top:f.top,bottom:f.bottom}}let u=this.editorView.dom.offsetParent;this.element||(this.element=u.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n);let d,h;if(!u||u==document.body&&getComputedStyle(u).position=="static")d=-pageXOffset,h=-pageYOffset;else{let f=u.getBoundingClientRect(),m=f.width/u.offsetWidth,g=f.height/u.offsetHeight;d=f.left-u.scrollLeft*m,h=f.top-u.scrollTop*g}this.element.style.left=(r.left-d)/o+"px",this.element.style.top=(r.top-h)/l+"px",this.element.style.width=(r.right-r.left)/o+"px",this.element.style.height=(r.bottom-r.top)/l+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let n=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=n&&n.inside>=0&&this.editorView.state.doc.nodeAt(n.inside),i=r&&r.type.spec.disableDropCursor,s=typeof i=="function"?i(this.editorView,n,e):i;if(n&&!s){let o=n.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let l=gC(this.editorView.state.doc,o,this.editorView.dragging.slice);l!=null&&(o=l)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}const Q$=Sn.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[K$(this.options)]}});class ht extends Ne{constructor(e){super(e,e)}map(e,n){let r=e.resolve(n.map(this.head));return ht.valid(r)?new ht(r):Ne.near(r)}content(){return le.empty}eq(e){return e instanceof ht&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,n){if(typeof n.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new ht(e.resolve(n.pos))}getBookmark(){return new kv(this.anchor)}static valid(e){let n=e.parent;if(n.isTextblock||!G$(e)||!J$(e))return!1;let r=n.type.spec.allowGapCursor;if(r!=null)return r;let i=n.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,n,r=!1){e:for(;;){if(!r&&ht.valid(e))return e;let i=e.pos,s=null;for(let o=e.depth;;o--){let l=e.node(o);if(n>0?e.indexAfter(o)<l.childCount:e.index(o)>0){s=l.child(n>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;i+=n;let u=e.doc.resolve(i);if(ht.valid(u))return u}for(;;){let o=n>0?s.firstChild:s.lastChild;if(!o){if(s.isAtom&&!s.isText&&!_e.isSelectable(s)){e=e.doc.resolve(i+s.nodeSize*n),r=!1;continue e}break}s=o,i+=n;let l=e.doc.resolve(i);if(ht.valid(l))return l}return null}}}ht.prototype.visible=!1;ht.findFrom=ht.findGapCursorFrom;Ne.jsonID("gapcursor",ht);class kv{constructor(e){this.pos=e}map(e){return new kv(e.map(this.pos))}resolve(e){let n=e.resolve(this.pos);return ht.valid(n)?new ht(n):Ne.near(n)}}function G$(t){for(let e=t.depth;e>=0;e--){let n=t.index(e),r=t.node(e);if(n==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function J$(t){for(let e=t.depth;e>=0;e--){let n=t.indexAfter(e),r=t.node(e);if(n==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(n);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function Y$(){return new Fn({props:{decorations:n3,createSelectionBetween(t,e,n){return e.pos==n.pos&&ht.valid(n)?new ht(n):null},handleClick:e3,handleKeyDown:X$,handleDOMEvents:{beforeinput:t3}}})}const X$=rE({ArrowLeft:Kc("horiz",-1),ArrowRight:Kc("horiz",1),ArrowUp:Kc("vert",-1),ArrowDown:Kc("vert",1)});function Kc(t,e){const n=t=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,s){let o=r.selection,l=e>0?o.$to:o.$from,u=o.empty;if(o instanceof Ee){if(!s.endOfTextblock(n)||l.depth==0)return!1;u=!1,l=r.doc.resolve(e>0?l.after():l.before())}let d=ht.findGapCursorFrom(l,e,u);return d?(i&&i(r.tr.setSelection(new ht(d))),!0):!1}}function e3(t,e,n){if(!t||!t.editable)return!1;let r=t.state.doc.resolve(e);if(!ht.valid(r))return!1;let i=t.posAtCoords({left:n.clientX,top:n.clientY});return i&&i.inside>-1&&_e.isSelectable(t.state.doc.nodeAt(i.inside))?!1:(t.dispatch(t.state.tr.setSelection(new ht(r))),!0)}function t3(t,e){if(e.inputType!="insertCompositionText"||!(t.state.selection instanceof ht))return!1;let{$from:n}=t.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(t.state.schema.nodes.text);if(!r)return!1;let i=Y.empty;for(let o=r.length-1;o>=0;o--)i=Y.from(r[o].createAndFill(null,i));let s=t.state.tr.replace(n.pos,n.pos,new le(i,0,0));return s.setSelection(Ee.near(s.doc.resolve(n.pos+1))),t.dispatch(s),!1}function n3(t){if(!(t.selection instanceof ht))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Lt.create(t.doc,[pr.widget(t.selection.head,e,{key:"gapcursor"})])}const r3=Sn.create({name:"gapCursor",addProseMirrorPlugins(){return[Y$()]},extendNodeSchema(t){var e;const n={name:t.name,options:t.options,storage:t.storage};return{allowGapCursor:(e=Ae(me(t,"allowGapCursor",n)))!==null&&e!==void 0?e:null}}}),i3=Bn.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:t}){return["br",xn(this.options.HTMLAttributes,t)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:t,chain:e,state:n,editor:r})=>t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:i,storedMarks:s}=n;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:l}=r.extensionManager,u=s||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:d,dispatch:h})=>{if(h&&u&&o){const f=u.filter(m=>l.includes(m.type.name));d.ensureMarks(f)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),s3=Bn.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(t=>({tag:`h${t}`,attrs:{level:t}}))},renderHTML({node:t,HTMLAttributes:e}){return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,xn(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.setNode(this.name,t):!1,toggleHeading:t=>({commands:e})=>this.options.levels.includes(t.level)?e.toggleNode(this.name,"paragraph",t):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((t,e)=>({...t,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(t=>Cg({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${t}})\\s$`),type:this.type,getAttributes:{level:t}}))}});var uh=200,Vt=function(){};Vt.prototype.append=function(e){return e.length?(e=Vt.from(e),!this.length&&e||e.length<uh&&this.leafAppend(e)||this.length<uh&&e.leafPrepend(this)||this.appendInner(e)):this};Vt.prototype.prepend=function(e){return e.length?Vt.from(e).append(this):this};Vt.prototype.appendInner=function(e){return new o3(this,e)};Vt.prototype.slice=function(e,n){return e===void 0&&(e=0),n===void 0&&(n=this.length),e>=n?Vt.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,n))};Vt.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};Vt.prototype.forEach=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length),n<=r?this.forEachInner(e,n,r,0):this.forEachInvertedInner(e,n,r,0)};Vt.prototype.map=function(e,n,r){n===void 0&&(n=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(s,o){return i.push(e(s,o))},n,r),i};Vt.from=function(e){return e instanceof Vt?e:e&&e.length?new ME(e):Vt.empty};var ME=function(t){function e(r){t.call(this),this.values=r}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,s){return i==0&&s==this.length?this:new e(this.values.slice(i,s))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,s,o,l){for(var u=s;u<o;u++)if(i(this.values[u],l+u)===!1)return!1},e.prototype.forEachInvertedInner=function(i,s,o,l){for(var u=s-1;u>=o;u--)if(i(this.values[u],l+u)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=uh)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=uh)return new e(i.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(e.prototype,n),e}(Vt);Vt.empty=new ME([]);var o3=function(t){function e(n,r){t.call(this),this.left=n,this.right=r,this.length=n.length+r.length,this.depth=Math.max(n.depth,r.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,s,o){var l=this.left.length;if(i<l&&this.left.forEachInner(r,i,Math.min(s,l),o)===!1||s>l&&this.right.forEachInner(r,Math.max(i-l,0),Math.min(this.length,s)-l,o+l)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,s,o){var l=this.left.length;if(i>l&&this.right.forEachInvertedInner(r,i-l,Math.max(s,l)-l,o+l)===!1||s<l&&this.left.forEachInvertedInner(r,Math.min(i,l),s,o)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var s=this.left.length;return i<=s?this.left.slice(r,i):r>=s?this.right.slice(r-s,i-s):this.left.slice(r,s).append(this.right.slice(0,i-s))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(Vt);const a3=500;class Nr{constructor(e,n){this.items=e,this.eventCount=n}popEvent(e,n){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,s;n&&(i=this.remapping(r,this.items.length),s=i.maps.length);let o=e.tr,l,u,d=[],h=[];return this.items.forEach((f,m)=>{if(!f.step){i||(i=this.remapping(r,m+1),s=i.maps.length),s--,h.push(f);return}if(i){h.push(new Hr(f.map));let g=f.step.map(i.slice(s)),_;g&&o.maybeStep(g).doc&&(_=o.mapping.maps[o.mapping.maps.length-1],d.push(new Hr(_,void 0,void 0,d.length+h.length))),s--,_&&i.appendMap(_,s)}else o.maybeStep(f.step);if(f.selection)return l=i?f.selection.map(i.slice(s)):f.selection,u=new Nr(this.items.slice(0,r).append(h.reverse().concat(d)),this.eventCount-1),!1},this.items.length,0),{remaining:u,transform:o,selection:l}}addTransform(e,n,r,i){let s=[],o=this.eventCount,l=this.items,u=!i&&l.length?l.get(l.length-1):null;for(let h=0;h<e.steps.length;h++){let f=e.steps[h].invert(e.docs[h]),m=new Hr(e.mapping.maps[h],f,n),g;(g=u&&u.merge(m))&&(m=g,h?s.pop():l=l.slice(0,l.length-1)),s.push(m),n&&(o++,n=void 0),i||(u=m)}let d=o-r.depth;return d>u3&&(l=l3(l,d),o-=d),new Nr(l.append(s),o)}remapping(e,n){let r=new Pu;return this.items.forEach((i,s)=>{let o=i.mirrorOffset!=null&&s-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,o)},e,n),r}addMaps(e){return this.eventCount==0?this:new Nr(this.items.append(e.map(n=>new Hr(n))),this.eventCount)}rebased(e,n){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-n),s=e.mapping,o=e.steps.length,l=this.eventCount;this.items.forEach(m=>{m.selection&&l--},i);let u=n;this.items.forEach(m=>{let g=s.getMirror(--u);if(g==null)return;o=Math.min(o,g);let _=s.maps[g];if(m.step){let v=e.steps[g].invert(e.docs[g]),x=m.selection&&m.selection.map(s.slice(u+1,g));x&&l++,r.push(new Hr(_,v,x))}else r.push(new Hr(_))},i);let d=[];for(let m=n;m<o;m++)d.push(new Hr(s.maps[m]));let h=this.items.slice(0,i).append(d).append(r),f=new Nr(h,l);return f.emptyItemCount()>a3&&(f=f.compress(this.items.length-r.length)),f}emptyItemCount(){let e=0;return this.items.forEach(n=>{n.step||e++}),e}compress(e=this.items.length){let n=this.remapping(0,e),r=n.maps.length,i=[],s=0;return this.items.forEach((o,l)=>{if(l>=e)i.push(o),o.selection&&s++;else if(o.step){let u=o.step.map(n.slice(r)),d=u&&u.getMap();if(r--,d&&n.appendMap(d,r),u){let h=o.selection&&o.selection.map(n.slice(r));h&&s++;let f=new Hr(d.invert(),u,h),m,g=i.length-1;(m=i.length&&i[g].merge(f))?i[g]=m:i.push(f)}}else o.map&&r--},this.items.length,0),new Nr(Vt.from(i.reverse()),s)}}Nr.empty=new Nr(Vt.empty,0);function l3(t,e){let n;return t.forEach((r,i)=>{if(r.selection&&e--==0)return n=i,!1}),t.slice(n)}class Hr{constructor(e,n,r,i){this.map=e,this.step=n,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let n=e.step.merge(this.step);if(n)return new Hr(n.getMap().invert(),n,this.selection)}}}class Ji{constructor(e,n,r,i,s){this.done=e,this.undone=n,this.prevRanges=r,this.prevTime=i,this.prevComposition=s}}const u3=20;function c3(t,e,n,r){let i=n.getMeta(wo),s;if(i)return i.historyState;n.getMeta(f3)&&(t=new Ji(t.done,t.undone,null,0,-1));let o=n.getMeta("appendedTransaction");if(n.steps.length==0)return t;if(o&&o.getMeta(wo))return o.getMeta(wo).redo?new Ji(t.done.addTransform(n,void 0,r,hd(e)),t.undone,$b(n.mapping.maps),t.prevTime,t.prevComposition):new Ji(t.done,t.undone.addTransform(n,void 0,r,hd(e)),null,t.prevTime,t.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let l=n.getMeta("composition"),u=t.prevTime==0||!o&&t.prevComposition!=l&&(t.prevTime<(n.time||0)-r.newGroupDelay||!d3(n,t.prevRanges)),d=o?Dp(t.prevRanges,n.mapping):$b(n.mapping.maps);return new Ji(t.done.addTransform(n,u?e.selection.getBookmark():void 0,r,hd(e)),Nr.empty,d,n.time,l??t.prevComposition)}else return(s=n.getMeta("rebased"))?new Ji(t.done.rebased(n,s),t.undone.rebased(n,s),Dp(t.prevRanges,n.mapping),t.prevTime,t.prevComposition):new Ji(t.done.addMaps(n.mapping.maps),t.undone.addMaps(n.mapping.maps),Dp(t.prevRanges,n.mapping),t.prevTime,t.prevComposition)}function d3(t,e){if(!e)return!1;if(!t.docChanged)return!0;let n=!1;return t.mapping.maps[0].forEach((r,i)=>{for(let s=0;s<e.length;s+=2)r<=e[s+1]&&i>=e[s]&&(n=!0)}),n}function $b(t){let e=[];for(let n=t.length-1;n>=0&&e.length==0;n--)t[n].forEach((r,i,s,o)=>e.push(s,o));return e}function Dp(t,e){if(!t)return null;let n=[];for(let r=0;r<t.length;r+=2){let i=e.map(t[r],1),s=e.map(t[r+1],-1);i<=s&&n.push(i,s)}return n}function h3(t,e,n){let r=hd(e),i=wo.get(e).spec.config,s=(n?t.undone:t.done).popEvent(e,r);if(!s)return null;let o=s.selection.resolve(s.transform.doc),l=(n?t.done:t.undone).addTransform(s.transform,e.selection.getBookmark(),i,r),u=new Ji(n?l:s.remaining,n?s.remaining:l,null,0,-1);return s.transform.setSelection(o).setMeta(wo,{redo:n,historyState:u})}let Ap=!1,Ub=null;function hd(t){let e=t.plugins;if(Ub!=e){Ap=!1,Ub=e;for(let n=0;n<e.length;n++)if(e[n].spec.historyPreserveItems){Ap=!0;break}}return Ap}const wo=new Xr("history"),f3=new Xr("closeHistory");function p3(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new Fn({key:wo,state:{init(){return new Ji(Nr.empty,Nr.empty,null,0,-1)},apply(e,n,r){return c3(n,r,e,t)}},config:t,props:{handleDOMEvents:{beforeinput(e,n){let r=n.inputType,i=r=="historyUndo"?NE:r=="historyRedo"?LE:null;return i?(n.preventDefault(),i(e.state,e.dispatch)):!1}}}})}function OE(t,e){return(n,r)=>{let i=wo.getState(n);if(!i||(t?i.undone:i.done).eventCount==0)return!1;if(r){let s=h3(i,n,t);s&&r(e?s.scrollIntoView():s)}return!0}}const NE=OE(!1,!0),LE=OE(!0,!0),m3=Sn.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:t,dispatch:e})=>NE(t,e),redo:()=>({state:t,dispatch:e})=>LE(t,e)}},addProseMirrorPlugins(){return[p3(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),g3=Bn.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:t}){return["hr",xn(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>({chain:t,state:e})=>{if(!u$(e,e.schema.nodes[this.name]))return!1;const{selection:n}=e,{$from:r,$to:i}=n,s=t();return r.parentOffset===0?s.insertContentAt({from:Math.max(r.pos-1,0),to:i.pos},{type:this.name}):OF(n)?s.insertContentAt(i.pos,{type:this.name}):s.insertContent({type:this.name}),s.command(({tr:o,dispatch:l})=>{var u;if(l){const{$to:d}=o.selection,h=d.end();if(d.nodeAfter)d.nodeAfter.isTextblock?o.setSelection(Ee.create(o.doc,d.pos+1)):d.nodeAfter.isBlock?o.setSelection(_e.create(o.doc,d.pos)):o.setSelection(Ee.create(o.doc,d.pos));else{const f=(u=d.parent.type.contentMatch.defaultType)===null||u===void 0?void 0:u.create();f&&(o.insert(h,f),o.setSelection(Ee.create(o.doc,h+1)))}o.scrollIntoView()}return!0}).run()}}},addInputRules(){return[l$({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),y3=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,v3=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,_3=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,w3=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,b3=Es.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:t=>t.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:t=>t.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:t}){return["em",xn(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>({commands:t})=>t.setMark(this.name),toggleItalic:()=>({commands:t})=>t.toggleMark(this.name),unsetItalic:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Ha({find:y3,type:this.type}),Ha({find:_3,type:this.type})]},addPasteRules(){return[qa({find:v3,type:this.type}),qa({find:w3,type:this.type})]}}),x3=Bn.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:t}){return["li",xn(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),S3="listItem",Vb="textStyle",Hb=/^(\d+)\.\s$/,k3=Bn.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:t=>t.hasAttribute("start")?parseInt(t.getAttribute("start")||"",10):1},type:{default:null,parseHTML:t=>t.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:t}){const{start:e,...n}=t;return e===1?["ol",xn(this.options.HTMLAttributes,n),0]:["ol",xn(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>({commands:t,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(S3,this.editor.getAttributes(Vb)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let t=Au({find:Hb,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(t=Au({find:Hb,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(Vb)}),joinPredicate:(e,n)=>n.childCount+n.attrs.start===+e[1],editor:this.editor})),[t]}}),C3=Bn.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:t}){return["p",xn(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>({commands:t})=>t.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),E3=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,T3=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,P3=Es.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:t=>t.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:t}){return["s",xn(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>({commands:t})=>t.setMark(this.name),toggleStrike:()=>({commands:t})=>t.toggleMark(this.name),unsetStrike:()=>({commands:t})=>t.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Ha({find:E3,type:this.type})]},addPasteRules(){return[qa({find:T3,type:this.type})]}}),M3=Bn.create({name:"text",group:"inline"}),O3=Sn.create({name:"starterKit",addExtensions(){const t=[];return this.options.bold!==!1&&t.push(j$.configure(this.options.bold)),this.options.blockquote!==!1&&t.push(L$.configure(this.options.blockquote)),this.options.bulletList!==!1&&t.push(B$.configure(this.options.bulletList)),this.options.code!==!1&&t.push(U$.configure(this.options.code)),this.options.codeBlock!==!1&&t.push(q$.configure(this.options.codeBlock)),this.options.document!==!1&&t.push(W$.configure(this.options.document)),this.options.dropcursor!==!1&&t.push(Q$.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&t.push(r3.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&t.push(i3.configure(this.options.hardBreak)),this.options.heading!==!1&&t.push(s3.configure(this.options.heading)),this.options.history!==!1&&t.push(m3.configure(this.options.history)),this.options.horizontalRule!==!1&&t.push(g3.configure(this.options.horizontalRule)),this.options.italic!==!1&&t.push(b3.configure(this.options.italic)),this.options.listItem!==!1&&t.push(x3.configure(this.options.listItem)),this.options.orderedList!==!1&&t.push(k3.configure(this.options.orderedList)),this.options.paragraph!==!1&&t.push(C3.configure(this.options.paragraph)),this.options.strike!==!1&&t.push(P3.configure(this.options.strike)),this.options.text!==!1&&t.push(M3.configure(this.options.text)),t}});function N3({cardId:t,value:e}){const n=nn(),r=q.useRef(!1),i=Pi({mutationFn:async u=>{const d=be(),{error:h}=await d.from("cards").update({description:u}).eq("id",t);if(h)throw h;r.current&&(await I1(t),r.current=!1)},onSuccess:async()=>{await n.invalidateQueries({predicate:u=>Array.isArray(u.queryKey)&&u.queryKey.includes("card")})}}),s=T$({extensions:[O3],content:e??{type:"doc",content:[{type:"paragraph"}]},onUpdate:({editor:u})=>{r.current=!0;const d=u.getJSON();l(d)},editorProps:{attributes:{class:"prose prose-invert max-w-none min-h-[120px] p-2 rounded border border-app bg-surface-2"}}}),o=q.useRef(null),l=u=>{o.current&&window.clearTimeout(o.current),o.current=window.setTimeout(()=>i.mutate(u),500)};return w.jsxs("div",{children:[w.jsxs("div",{className:"flex items-center gap-2 mb-2 text-sm",children:[w.jsx("button",{className:"px-2 py-1 rounded border border-app",onClick:()=>s?.chain().focus().toggleBold().run(),children:"Bold"}),w.jsx("button",{className:"px-2 py-1 rounded border border-app",onClick:()=>s?.chain().focus().toggleItalic().run(),children:"Italic"}),w.jsx("button",{className:"px-2 py-1 rounded border border-app",onClick:()=>s?.chain().focus().toggleBulletList().run(),children:" List"})]}),w.jsx(y$,{editor:s}),i.isPending&&w.jsx("div",{className:"text-xs text-muted mt-1",children:"Saving"})]})}function RE(t,e){const n=M.useRef(e);M.useEffect(function(){e!==n.current&&t.attributionControl!=null&&(n.current!=null&&t.attributionControl.removeAttribution(n.current),e!=null&&t.attributionControl.addAttribution(e)),n.current=e},[t,e])}const L3=1;function R3(t){return Object.freeze({__version:L3,map:t})}function D3(t,e){return Object.freeze({...t,...e})}const DE=M.createContext(null),AE=DE.Provider;function Cv(){const t=M.useContext(DE);if(t==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}function A3(t){function e(n,r){const{instance:i,context:s}=t(n).current;return M.useImperativeHandle(r,()=>i),n.children==null?null:q.createElement(AE,{value:s},n.children)}return M.forwardRef(e)}function I3(t){function e(n,r){const[i,s]=M.useState(!1),{instance:o}=t(n,s).current;M.useImperativeHandle(r,()=>o),M.useEffect(function(){i&&o.update()},[o,i,n.children]);const l=o._contentNode;return l?Wr.createPortal(n.children,l):null}return M.forwardRef(e)}function j3(t){function e(n,r){const{instance:i}=t(n).current;return M.useImperativeHandle(r,()=>i),null}return M.forwardRef(e)}function IE(t,e){const n=M.useRef();M.useEffect(function(){return e!=null&&t.instance.on(e),n.current=e,function(){n.current!=null&&t.instance.off(n.current),n.current=null}},[t,e])}function Ev(t,e){const n=t.pane??e.pane;return n?{...t,pane:n}:t}function z3(t,e){return function(r,i){const s=Cv(),o=t(Ev(r,s),s);return RE(s.map,r.attribution),IE(o.current,r.eventHandlers),e(o.current,s,r,i),o}}var Tg={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(t,e){(function(n,r){r(e)})(Gn,function(n){var r="1.9.4";function i(a){var c,p,y,b;for(p=1,y=arguments.length;p<y;p++){b=arguments[p];for(c in b)a[c]=b[c]}return a}var s=Object.create||function(){function a(){}return function(c){return a.prototype=c,new a}}();function o(a,c){var p=Array.prototype.slice;if(a.bind)return a.bind.apply(a,p.call(arguments,1));var y=p.call(arguments,2);return function(){return a.apply(c,y.length?y.concat(p.call(arguments)):arguments)}}var l=0;function u(a){return"_leaflet_id"in a||(a._leaflet_id=++l),a._leaflet_id}function d(a,c,p){var y,b,E,A;return A=function(){y=!1,b&&(E.apply(p,b),b=!1)},E=function(){y?b=arguments:(a.apply(p,arguments),setTimeout(A,c),y=!0)},E}function h(a,c,p){var y=c[1],b=c[0],E=y-b;return a===y&&p?a:((a-b)%E+E)%E+b}function f(){return!1}function m(a,c){if(c===!1)return a;var p=Math.pow(10,c===void 0?6:c);return Math.round(a*p)/p}function g(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function _(a){return g(a).split(/\s+/)}function v(a,c){Object.prototype.hasOwnProperty.call(a,"options")||(a.options=a.options?s(a.options):{});for(var p in c)a.options[p]=c[p];return a.options}function x(a,c,p){var y=[];for(var b in a)y.push(encodeURIComponent(p?b.toUpperCase():b)+"="+encodeURIComponent(a[b]));return(!c||c.indexOf("?")===-1?"?":"&")+y.join("&")}var S=/\{ *([\w_ -]+) *\}/g;function k(a,c){return a.replace(S,function(p,y){var b=c[y];if(b===void 0)throw new Error("No value provided for variable "+p);return typeof b=="function"&&(b=b(c)),b})}var C=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"};function R(a,c){for(var p=0;p<a.length;p++)if(a[p]===c)return p;return-1}var N="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function P(a){return window["webkit"+a]||window["moz"+a]||window["ms"+a]}var T=0;function D(a){var c=+new Date,p=Math.max(0,16-(c-T));return T=c+p,window.setTimeout(a,p)}var j=window.requestAnimationFrame||P("RequestAnimationFrame")||D,O=window.cancelAnimationFrame||P("CancelAnimationFrame")||P("CancelRequestAnimationFrame")||function(a){window.clearTimeout(a)};function F(a,c,p){if(p&&j===D)a.call(c);else return j.call(window,o(a,c))}function Z(a){a&&O.call(window,a)}var se={__proto__:null,extend:i,create:s,bind:o,get lastId(){return l},stamp:u,throttle:d,wrapNum:h,falseFn:f,formatNum:m,trim:g,splitWords:_,setOptions:v,getParamString:x,template:k,isArray:C,indexOf:R,emptyImageUrl:N,requestFn:j,cancelFn:O,requestAnimFrame:F,cancelAnimFrame:Z};function oe(){}oe.extend=function(a){var c=function(){v(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},p=c.__super__=this.prototype,y=s(p);y.constructor=c,c.prototype=y;for(var b in this)Object.prototype.hasOwnProperty.call(this,b)&&b!=="prototype"&&b!=="__super__"&&(c[b]=this[b]);return a.statics&&i(c,a.statics),a.includes&&(ye(a.includes),i.apply(null,[y].concat(a.includes))),i(y,a),delete y.statics,delete y.includes,y.options&&(y.options=p.options?s(p.options):{},i(y.options,a.options)),y._initHooks=[],y.callInitHooks=function(){if(!this._initHooksCalled){p.callInitHooks&&p.callInitHooks.call(this),this._initHooksCalled=!0;for(var E=0,A=y._initHooks.length;E<A;E++)y._initHooks[E].call(this)}},c},oe.include=function(a){var c=this.prototype.options;return i(this.prototype,a),a.options&&(this.prototype.options=c,this.mergeOptions(a.options)),this},oe.mergeOptions=function(a){return i(this.prototype.options,a),this},oe.addInitHook=function(a){var c=Array.prototype.slice.call(arguments,1),p=typeof a=="function"?a:function(){this[a].apply(this,c)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(p),this};function ye(a){if(!(typeof L>"u"||!L||!L.Mixin)){a=C(a)?a:[a];for(var c=0;c<a.length;c++)a[c]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ue={on:function(a,c,p){if(typeof a=="object")for(var y in a)this._on(y,a[y],c);else{a=_(a);for(var b=0,E=a.length;b<E;b++)this._on(a[b],c,p)}return this},off:function(a,c,p){if(!arguments.length)delete this._events;else if(typeof a=="object")for(var y in a)this._off(y,a[y],c);else{a=_(a);for(var b=arguments.length===1,E=0,A=a.length;E<A;E++)b?this._off(a[E]):this._off(a[E],c,p)}return this},_on:function(a,c,p,y){if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}if(this._listens(a,c,p)===!1){p===this&&(p=void 0);var b={fn:c,ctx:p};y&&(b.once=!0),this._events=this._events||{},this._events[a]=this._events[a]||[],this._events[a].push(b)}},_off:function(a,c,p){var y,b,E;if(this._events&&(y=this._events[a],!!y)){if(arguments.length===1){if(this._firingCount)for(b=0,E=y.length;b<E;b++)y[b].fn=f;delete this._events[a];return}if(typeof c!="function"){console.warn("wrong listener type: "+typeof c);return}var A=this._listens(a,c,p);if(A!==!1){var B=y[A];this._firingCount&&(B.fn=f,this._events[a]=y=y.slice()),y.splice(A,1)}}},fire:function(a,c,p){if(!this.listens(a,p))return this;var y=i({},c,{type:a,target:this,sourceTarget:c&&c.sourceTarget||this});if(this._events){var b=this._events[a];if(b){this._firingCount=this._firingCount+1||1;for(var E=0,A=b.length;E<A;E++){var B=b[E],V=B.fn;B.once&&this.off(a,V,B.ctx),V.call(B.ctx||this,y)}this._firingCount--}}return p&&this._propagateEvent(y),this},listens:function(a,c,p,y){typeof a!="string"&&console.warn('"string" type argument expected');var b=c;typeof c!="function"&&(y=!!c,b=void 0,p=void 0);var E=this._events&&this._events[a];if(E&&E.length&&this._listens(a,b,p)!==!1)return!0;if(y){for(var A in this._eventParents)if(this._eventParents[A].listens(a,c,p,y))return!0}return!1},_listens:function(a,c,p){if(!this._events)return!1;var y=this._events[a]||[];if(!c)return!!y.length;p===this&&(p=void 0);for(var b=0,E=y.length;b<E;b++)if(y[b].fn===c&&y[b].ctx===p)return b;return!1},once:function(a,c,p){if(typeof a=="object")for(var y in a)this._on(y,a[y],c,!0);else{a=_(a);for(var b=0,E=a.length;b<E;b++)this._on(a[b],c,p,!0)}return this},addEventParent:function(a){return this._eventParents=this._eventParents||{},this._eventParents[u(a)]=a,this},removeEventParent:function(a){return this._eventParents&&delete this._eventParents[u(a)],this},_propagateEvent:function(a){for(var c in this._eventParents)this._eventParents[c].fire(a.type,i({layer:a.target,propagatedFrom:a.target},a),!0)}};ue.addEventListener=ue.on,ue.removeEventListener=ue.clearAllEventListeners=ue.off,ue.addOneTimeEventListener=ue.once,ue.fireEvent=ue.fire,ue.hasEventListeners=ue.listens;var Te=oe.extend(ue);function H(a,c,p){this.x=p?Math.round(a):a,this.y=p?Math.round(c):c}var ne=Math.trunc||function(a){return a>0?Math.floor(a):Math.ceil(a)};H.prototype={clone:function(){return new H(this.x,this.y)},add:function(a){return this.clone()._add(G(a))},_add:function(a){return this.x+=a.x,this.y+=a.y,this},subtract:function(a){return this.clone()._subtract(G(a))},_subtract:function(a){return this.x-=a.x,this.y-=a.y,this},divideBy:function(a){return this.clone()._divideBy(a)},_divideBy:function(a){return this.x/=a,this.y/=a,this},multiplyBy:function(a){return this.clone()._multiplyBy(a)},_multiplyBy:function(a){return this.x*=a,this.y*=a,this},scaleBy:function(a){return new H(this.x*a.x,this.y*a.y)},unscaleBy:function(a){return new H(this.x/a.x,this.y/a.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ne(this.x),this.y=ne(this.y),this},distanceTo:function(a){a=G(a);var c=a.x-this.x,p=a.y-this.y;return Math.sqrt(c*c+p*p)},equals:function(a){return a=G(a),a.x===this.x&&a.y===this.y},contains:function(a){return a=G(a),Math.abs(a.x)<=Math.abs(this.x)&&Math.abs(a.y)<=Math.abs(this.y)},toString:function(){return"Point("+m(this.x)+", "+m(this.y)+")"}};function G(a,c,p){return a instanceof H?a:C(a)?new H(a[0],a[1]):a==null?a:typeof a=="object"&&"x"in a&&"y"in a?new H(a.x,a.y):new H(a,c,p)}function $(a,c){if(a)for(var p=c?[a,c]:a,y=0,b=p.length;y<b;y++)this.extend(p[y])}$.prototype={extend:function(a){var c,p;if(!a)return this;if(a instanceof H||typeof a[0]=="number"||"x"in a)c=p=G(a);else if(a=K(a),c=a.min,p=a.max,!c||!p)return this;return!this.min&&!this.max?(this.min=c.clone(),this.max=p.clone()):(this.min.x=Math.min(c.x,this.min.x),this.max.x=Math.max(p.x,this.max.x),this.min.y=Math.min(c.y,this.min.y),this.max.y=Math.max(p.y,this.max.y)),this},getCenter:function(a){return G((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,a)},getBottomLeft:function(){return G(this.min.x,this.max.y)},getTopRight:function(){return G(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(a){var c,p;return typeof a[0]=="number"||a instanceof H?a=G(a):a=K(a),a instanceof $?(c=a.min,p=a.max):c=p=a,c.x>=this.min.x&&p.x<=this.max.x&&c.y>=this.min.y&&p.y<=this.max.y},intersects:function(a){a=K(a);var c=this.min,p=this.max,y=a.min,b=a.max,E=b.x>=c.x&&y.x<=p.x,A=b.y>=c.y&&y.y<=p.y;return E&&A},overlaps:function(a){a=K(a);var c=this.min,p=this.max,y=a.min,b=a.max,E=b.x>c.x&&y.x<p.x,A=b.y>c.y&&y.y<p.y;return E&&A},isValid:function(){return!!(this.min&&this.max)},pad:function(a){var c=this.min,p=this.max,y=Math.abs(c.x-p.x)*a,b=Math.abs(c.y-p.y)*a;return K(G(c.x-y,c.y-b),G(p.x+y,p.y+b))},equals:function(a){return a?(a=K(a),this.min.equals(a.getTopLeft())&&this.max.equals(a.getBottomRight())):!1}};function K(a,c){return!a||a instanceof $?a:new $(a,c)}function ie(a,c){if(a)for(var p=c?[a,c]:a,y=0,b=p.length;y<b;y++)this.extend(p[y])}ie.prototype={extend:function(a){var c=this._southWest,p=this._northEast,y,b;if(a instanceof te)y=a,b=a;else if(a instanceof ie){if(y=a._southWest,b=a._northEast,!y||!b)return this}else return a?this.extend(ee(a)||re(a)):this;return!c&&!p?(this._southWest=new te(y.lat,y.lng),this._northEast=new te(b.lat,b.lng)):(c.lat=Math.min(y.lat,c.lat),c.lng=Math.min(y.lng,c.lng),p.lat=Math.max(b.lat,p.lat),p.lng=Math.max(b.lng,p.lng)),this},pad:function(a){var c=this._southWest,p=this._northEast,y=Math.abs(c.lat-p.lat)*a,b=Math.abs(c.lng-p.lng)*a;return new ie(new te(c.lat-y,c.lng-b),new te(p.lat+y,p.lng+b))},getCenter:function(){return new te((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new te(this.getNorth(),this.getWest())},getSouthEast:function(){return new te(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(a){typeof a[0]=="number"||a instanceof te||"lat"in a?a=ee(a):a=re(a);var c=this._southWest,p=this._northEast,y,b;return a instanceof ie?(y=a.getSouthWest(),b=a.getNorthEast()):y=b=a,y.lat>=c.lat&&b.lat<=p.lat&&y.lng>=c.lng&&b.lng<=p.lng},intersects:function(a){a=re(a);var c=this._southWest,p=this._northEast,y=a.getSouthWest(),b=a.getNorthEast(),E=b.lat>=c.lat&&y.lat<=p.lat,A=b.lng>=c.lng&&y.lng<=p.lng;return E&&A},overlaps:function(a){a=re(a);var c=this._southWest,p=this._northEast,y=a.getSouthWest(),b=a.getNorthEast(),E=b.lat>c.lat&&y.lat<p.lat,A=b.lng>c.lng&&y.lng<p.lng;return E&&A},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(a,c){return a?(a=re(a),this._southWest.equals(a.getSouthWest(),c)&&this._northEast.equals(a.getNorthEast(),c)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function re(a,c){return a instanceof ie?a:new ie(a,c)}function te(a,c,p){if(isNaN(a)||isNaN(c))throw new Error("Invalid LatLng object: ("+a+", "+c+")");this.lat=+a,this.lng=+c,p!==void 0&&(this.alt=+p)}te.prototype={equals:function(a,c){if(!a)return!1;a=ee(a);var p=Math.max(Math.abs(this.lat-a.lat),Math.abs(this.lng-a.lng));return p<=(c===void 0?1e-9:c)},toString:function(a){return"LatLng("+m(this.lat,a)+", "+m(this.lng,a)+")"},distanceTo:function(a){return Re.distance(this,ee(a))},wrap:function(){return Re.wrapLatLng(this)},toBounds:function(a){var c=180*a/40075017,p=c/Math.cos(Math.PI/180*this.lat);return re([this.lat-c,this.lng-p],[this.lat+c,this.lng+p])},clone:function(){return new te(this.lat,this.lng,this.alt)}};function ee(a,c,p){return a instanceof te?a:C(a)&&typeof a[0]!="object"?a.length===3?new te(a[0],a[1],a[2]):a.length===2?new te(a[0],a[1]):null:a==null?a:typeof a=="object"&&"lat"in a?new te(a.lat,"lng"in a?a.lng:a.lon,a.alt):c===void 0?null:new te(a,c,p)}var Se={latLngToPoint:function(a,c){var p=this.projection.project(a),y=this.scale(c);return this.transformation._transform(p,y)},pointToLatLng:function(a,c){var p=this.scale(c),y=this.transformation.untransform(a,p);return this.projection.unproject(y)},project:function(a){return this.projection.project(a)},unproject:function(a){return this.projection.unproject(a)},scale:function(a){return 256*Math.pow(2,a)},zoom:function(a){return Math.log(a/256)/Math.LN2},getProjectedBounds:function(a){if(this.infinite)return null;var c=this.projection.bounds,p=this.scale(a),y=this.transformation.transform(c.min,p),b=this.transformation.transform(c.max,p);return new $(y,b)},infinite:!1,wrapLatLng:function(a){var c=this.wrapLng?h(a.lng,this.wrapLng,!0):a.lng,p=this.wrapLat?h(a.lat,this.wrapLat,!0):a.lat,y=a.alt;return new te(p,c,y)},wrapLatLngBounds:function(a){var c=a.getCenter(),p=this.wrapLatLng(c),y=c.lat-p.lat,b=c.lng-p.lng;if(y===0&&b===0)return a;var E=a.getSouthWest(),A=a.getNorthEast(),B=new te(E.lat-y,E.lng-b),V=new te(A.lat-y,A.lng-b);return new ie(B,V)}},Re=i({},Se,{wrapLng:[-180,180],R:6371e3,distance:function(a,c){var p=Math.PI/180,y=a.lat*p,b=c.lat*p,E=Math.sin((c.lat-a.lat)*p/2),A=Math.sin((c.lng-a.lng)*p/2),B=E*E+Math.cos(y)*Math.cos(b)*A*A,V=2*Math.atan2(Math.sqrt(B),Math.sqrt(1-B));return this.R*V}}),Ce=6378137,Oe={R:Ce,MAX_LATITUDE:85.0511287798,project:function(a){var c=Math.PI/180,p=this.MAX_LATITUDE,y=Math.max(Math.min(p,a.lat),-p),b=Math.sin(y*c);return new H(this.R*a.lng*c,this.R*Math.log((1+b)/(1-b))/2)},unproject:function(a){var c=180/Math.PI;return new te((2*Math.atan(Math.exp(a.y/this.R))-Math.PI/2)*c,a.x*c/this.R)},bounds:function(){var a=Ce*Math.PI;return new $([-a,-a],[a,a])}()};function et(a,c,p,y){if(C(a)){this._a=a[0],this._b=a[1],this._c=a[2],this._d=a[3];return}this._a=a,this._b=c,this._c=p,this._d=y}et.prototype={transform:function(a,c){return this._transform(a.clone(),c)},_transform:function(a,c){return c=c||1,a.x=c*(this._a*a.x+this._b),a.y=c*(this._c*a.y+this._d),a},untransform:function(a,c){return c=c||1,new H((a.x/c-this._b)/this._a,(a.y/c-this._d)/this._c)}};function De(a,c,p,y){return new et(a,c,p,y)}var gt=i({},Re,{code:"EPSG:3857",projection:Oe,transformation:function(){var a=.5/(Math.PI*Oe.R);return De(a,.5,-a,.5)}()}),rn=i({},gt,{code:"EPSG:900913"});function Tn(a){return document.createElementNS("http://www.w3.org/2000/svg",a)}function kt(a,c){var p="",y,b,E,A,B,V;for(y=0,E=a.length;y<E;y++){for(B=a[y],b=0,A=B.length;b<A;b++)V=B[b],p+=(b?"L":"M")+V.x+" "+V.y;p+=c?W.svg?"z":"x":""}return p||"M0 0"}var Ct=document.documentElement.style,Pn="ActiveXObject"in window,Li=Pn&&!document.addEventListener,$n="msLaunchUri"in navigator&&!("documentMode"in document),jr=Q("webkit"),ei=Q("android"),Is=Q("android 2")||Q("android 3"),er=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),ti=ei&&Q("Google")&&er<537&&!("AudioNode"in window),Ri=!!window.opera,Un=!$n&&Q("chrome"),At=Q("gecko")&&!jr&&!Ri&&!Pn,qt=!Un&&Q("safari"),Di=Q("phantom"),sn="OTransition"in Ct,Bo=navigator.platform.indexOf("Win")===0,Vn=Pn&&"transition"in Ct,Ai="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Is,ni="MozPerspective"in Ct,js=!window.L_DISABLE_3D&&(Vn||Ai||ni)&&!sn&&!Di,ri=typeof orientation<"u"||Q("mobile"),zs=ri&&jr,Ii=ri&&Ai,Bs=!window.PointerEvent&&window.MSPointerEvent,ji=!!(window.PointerEvent||Bs),at="ontouchstart"in window||!!window.TouchEvent,Wt=!window.L_NO_TOUCH&&(at||ji),It=ri&&Ri,tr=ri&&At,Kt=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,yt=function(){var a=!1;try{var c=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("testPassiveEventSupport",f,c),window.removeEventListener("testPassiveEventSupport",f,c)}catch{}return a}(),Zt=function(){return!!document.createElement("canvas").getContext}(),nr=!!(document.createElementNS&&Tn("svg").createSVGRect),ft=!!nr&&function(){var a=document.createElement("div");return a.innerHTML="<svg/>",(a.firstChild&&a.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),I=!nr&&function(){try{var a=document.createElement("div");a.innerHTML='<v:shape adj="1"/>';var c=a.firstChild;return c.style.behavior="url(#default#VML)",c&&typeof c.adj=="object"}catch{return!1}}(),z=navigator.platform.indexOf("Mac")===0,U=navigator.platform.indexOf("Linux")===0;function Q(a){return navigator.userAgent.toLowerCase().indexOf(a)>=0}var W={ie:Pn,ielt9:Li,edge:$n,webkit:jr,android:ei,android23:Is,androidStock:ti,opera:Ri,chrome:Un,gecko:At,safari:qt,phantom:Di,opera12:sn,win:Bo,ie3d:Vn,webkit3d:Ai,gecko3d:ni,any3d:js,mobile:ri,mobileWebkit:zs,mobileWebkit3d:Ii,msPointer:Bs,pointer:ji,touch:Wt,touchNative:at,mobileOpera:It,mobileGecko:tr,retina:Kt,passiveEvents:yt,canvas:Zt,svg:nr,vml:I,inlineSvg:ft,mac:z,linux:U},he=W.msPointer?"MSPointerDown":"pointerdown",ve=W.msPointer?"MSPointerMove":"pointermove",ce=W.msPointer?"MSPointerUp":"pointerup",pe=W.msPointer?"MSPointerCancel":"pointercancel",de={touchstart:he,touchmove:ve,touchend:ce,touchcancel:pe},ge={touchstart:rr,touchmove:Mn,touchend:Mn,touchcancel:Mn},ke={},ze=!1;function Et(a,c,p){return c==="touchstart"&&Fs(),ge[c]?(p=ge[c].bind(this,p),a.addEventListener(de[c],p,!1),p):(console.warn("wrong event specified:",c),f)}function Qe(a,c,p){if(!de[c]){console.warn("wrong event specified:",c);return}a.removeEventListener(de[c],p,!1)}function He(a){ke[a.pointerId]=a}function it(a){ke[a.pointerId]&&(ke[a.pointerId]=a)}function ii(a){delete ke[a.pointerId]}function Fs(){ze||(document.addEventListener(he,He,!0),document.addEventListener(ve,it,!0),document.addEventListener(ce,ii,!0),document.addEventListener(pe,ii,!0),ze=!0)}function Mn(a,c){if(c.pointerType!==(c.MSPOINTER_TYPE_MOUSE||"mouse")){c.touches=[];for(var p in ke)c.touches.push(ke[p]);c.changedTouches=[c],a(c)}}function rr(a,c){c.MSPOINTER_TYPE_TOUCH&&c.pointerType===c.MSPOINTER_TYPE_TOUCH&&Qt(c),Mn(a,c)}function rl(a){var c={},p,y;for(y in a)p=a[y],c[y]=p&&p.bind?p.bind(a):p;return a=c,c.type="dblclick",c.detail=2,c.isTrusted=!1,c._simulated=!0,c}var $s=200;function si(a,c){a.addEventListener("dblclick",c);var p=0,y;function b(E){if(E.detail!==1){y=E.detail;return}if(!(E.pointerType==="mouse"||E.sourceCapabilities&&!E.sourceCapabilities.firesTouchEvents)){var A=Nv(E);if(!(A.some(function(V){return V instanceof HTMLLabelElement&&V.attributes.for})&&!A.some(function(V){return V instanceof HTMLInputElement||V instanceof HTMLSelectElement}))){var B=Date.now();B-p<=$s?(y++,y===2&&c(rl(E))):y=1,p=B}}}return a.addEventListener("click",b),{dblclick:c,simDblclick:b}}function Fo(a,c){a.removeEventListener("dblclick",c.dblclick),a.removeEventListener("click",c.simDblclick)}var zi=Xu(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Ie=Xu(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),tt=Ie==="webkitTransition"||Ie==="OTransition"?Ie+"End":"transitionend";function oi(a){return typeof a=="string"?document.getElementById(a):a}function br(a,c){var p=a.style[c]||a.currentStyle&&a.currentStyle[c];if((!p||p==="auto")&&document.defaultView){var y=document.defaultView.getComputedStyle(a,null);p=y?y[c]:null}return p==="auto"?null:p}function we(a,c,p){var y=document.createElement(a);return y.className=c||"",p&&p.appendChild(y),y}function We(a){var c=a.parentNode;c&&c.removeChild(a)}function Us(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function Bi(a){var c=a.parentNode;c&&c.lastChild!==a&&c.appendChild(a)}function $o(a){var c=a.parentNode;c&&c.firstChild!==a&&c.insertBefore(a,c.firstChild)}function tf(a,c){if(a.classList!==void 0)return a.classList.contains(c);var p=Yu(a);return p.length>0&&new RegExp("(^|\\s)"+c+"(\\s|$)").test(p)}function Le(a,c){if(a.classList!==void 0)for(var p=_(c),y=0,b=p.length;y<b;y++)a.classList.add(p[y]);else if(!tf(a,c)){var E=Yu(a);nf(a,(E?E+" ":"")+c)}}function pt(a,c){a.classList!==void 0?a.classList.remove(c):nf(a,g((" "+Yu(a)+" ").replace(" "+c+" "," ")))}function nf(a,c){a.className.baseVal===void 0?a.className=c:a.className.baseVal=c}function Yu(a){return a.correspondingElement&&(a=a.correspondingElement),a.className.baseVal===void 0?a.className:a.className.baseVal}function ir(a,c){"opacity"in a.style?a.style.opacity=c:"filter"in a.style&&VE(a,c)}function VE(a,c){var p=!1,y="DXImageTransform.Microsoft.Alpha";try{p=a.filters.item(y)}catch{if(c===1)return}c=Math.round(c*100),p?(p.Enabled=c!==100,p.Opacity=c):a.style.filter+=" progid:"+y+"(opacity="+c+")"}function Xu(a){for(var c=document.documentElement.style,p=0;p<a.length;p++)if(a[p]in c)return a[p];return!1}function Vs(a,c,p){var y=c||new H(0,0);a.style[zi]=(W.ie3d?"translate("+y.x+"px,"+y.y+"px)":"translate3d("+y.x+"px,"+y.y+"px,0)")+(p?" scale("+p+")":"")}function vt(a,c){a._leaflet_pos=c,W.any3d?Vs(a,c):(a.style.left=c.x+"px",a.style.top=c.y+"px")}function Hs(a){return a._leaflet_pos||new H(0,0)}var il,sl,rf;if("onselectstart"in document)il=function(){Pe(window,"selectstart",Qt)},sl=function(){Je(window,"selectstart",Qt)};else{var ol=Xu(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);il=function(){if(ol){var a=document.documentElement.style;rf=a[ol],a[ol]="none"}},sl=function(){ol&&(document.documentElement.style[ol]=rf,rf=void 0)}}function sf(){Pe(window,"dragstart",Qt)}function of(){Je(window,"dragstart",Qt)}var ec,af;function lf(a){for(;a.tabIndex===-1;)a=a.parentNode;a.style&&(tc(),ec=a,af=a.style.outlineStyle,a.style.outlineStyle="none",Pe(window,"keydown",tc))}function tc(){ec&&(ec.style.outlineStyle=af,ec=void 0,af=void 0,Je(window,"keydown",tc))}function Mv(a){do a=a.parentNode;while((!a.offsetWidth||!a.offsetHeight)&&a!==document.body);return a}function uf(a){var c=a.getBoundingClientRect();return{x:c.width/a.offsetWidth||1,y:c.height/a.offsetHeight||1,boundingClientRect:c}}var HE={__proto__:null,TRANSFORM:zi,TRANSITION:Ie,TRANSITION_END:tt,get:oi,getStyle:br,create:we,remove:We,empty:Us,toFront:Bi,toBack:$o,hasClass:tf,addClass:Le,removeClass:pt,setClass:nf,getClass:Yu,setOpacity:ir,testProp:Xu,setTransform:Vs,setPosition:vt,getPosition:Hs,get disableTextSelection(){return il},get enableTextSelection(){return sl},disableImageDrag:sf,enableImageDrag:of,preventOutline:lf,restoreOutline:tc,getSizedParentNode:Mv,getScale:uf};function Pe(a,c,p,y){if(c&&typeof c=="object")for(var b in c)df(a,b,c[b],p);else{c=_(c);for(var E=0,A=c.length;E<A;E++)df(a,c[E],p,y)}return this}var zr="_leaflet_events";function Je(a,c,p,y){if(arguments.length===1)Ov(a),delete a[zr];else if(c&&typeof c=="object")for(var b in c)hf(a,b,c[b],p);else if(c=_(c),arguments.length===2)Ov(a,function(B){return R(c,B)!==-1});else for(var E=0,A=c.length;E<A;E++)hf(a,c[E],p,y);return this}function Ov(a,c){for(var p in a[zr]){var y=p.split(/\d/)[0];(!c||c(y))&&hf(a,y,null,null,p)}}var cf={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function df(a,c,p,y){var b=c+u(p)+(y?"_"+u(y):"");if(a[zr]&&a[zr][b])return this;var E=function(B){return p.call(y||a,B||window.event)},A=E;!W.touchNative&&W.pointer&&c.indexOf("touch")===0?E=Et(a,c,E):W.touch&&c==="dblclick"?E=si(a,E):"addEventListener"in a?c==="touchstart"||c==="touchmove"||c==="wheel"||c==="mousewheel"?a.addEventListener(cf[c]||c,E,W.passiveEvents?{passive:!1}:!1):c==="mouseenter"||c==="mouseleave"?(E=function(B){B=B||window.event,pf(a,B)&&A(B)},a.addEventListener(cf[c],E,!1)):a.addEventListener(c,A,!1):a.attachEvent("on"+c,E),a[zr]=a[zr]||{},a[zr][b]=E}function hf(a,c,p,y,b){b=b||c+u(p)+(y?"_"+u(y):"");var E=a[zr]&&a[zr][b];if(!E)return this;!W.touchNative&&W.pointer&&c.indexOf("touch")===0?Qe(a,c,E):W.touch&&c==="dblclick"?Fo(a,E):"removeEventListener"in a?a.removeEventListener(cf[c]||c,E,!1):a.detachEvent("on"+c,E),a[zr][b]=null}function qs(a){return a.stopPropagation?a.stopPropagation():a.originalEvent?a.originalEvent._stopped=!0:a.cancelBubble=!0,this}function ff(a){return df(a,"wheel",qs),this}function al(a){return Pe(a,"mousedown touchstart dblclick contextmenu",qs),a._leaflet_disable_click=!0,this}function Qt(a){return a.preventDefault?a.preventDefault():a.returnValue=!1,this}function Ws(a){return Qt(a),qs(a),this}function Nv(a){if(a.composedPath)return a.composedPath();for(var c=[],p=a.target;p;)c.push(p),p=p.parentNode;return c}function Lv(a,c){if(!c)return new H(a.clientX,a.clientY);var p=uf(c),y=p.boundingClientRect;return new H((a.clientX-y.left)/p.x-c.clientLeft,(a.clientY-y.top)/p.y-c.clientTop)}var qE=W.linux&&W.chrome?window.devicePixelRatio:W.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Rv(a){return W.edge?a.wheelDeltaY/2:a.deltaY&&a.deltaMode===0?-a.deltaY/qE:a.deltaY&&a.deltaMode===1?-a.deltaY*20:a.deltaY&&a.deltaMode===2?-a.deltaY*60:a.deltaX||a.deltaZ?0:a.wheelDelta?(a.wheelDeltaY||a.wheelDelta)/2:a.detail&&Math.abs(a.detail)<32765?-a.detail*20:a.detail?a.detail/-32765*60:0}function pf(a,c){var p=c.relatedTarget;if(!p)return!0;try{for(;p&&p!==a;)p=p.parentNode}catch{return!1}return p!==a}var WE={__proto__:null,on:Pe,off:Je,stopPropagation:qs,disableScrollPropagation:ff,disableClickPropagation:al,preventDefault:Qt,stop:Ws,getPropagationPath:Nv,getMousePosition:Lv,getWheelDelta:Rv,isExternalTarget:pf,addListener:Pe,removeListener:Je},Dv=Te.extend({run:function(a,c,p,y){this.stop(),this._el=a,this._inProgress=!0,this._duration=p||.25,this._easeOutPower=1/Math.max(y||.5,.2),this._startPos=Hs(a),this._offset=c.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=F(this._animate,this),this._step()},_step:function(a){var c=+new Date-this._startTime,p=this._duration*1e3;c<p?this._runFrame(this._easeOut(c/p),a):(this._runFrame(1),this._complete())},_runFrame:function(a,c){var p=this._startPos.add(this._offset.multiplyBy(a));c&&p._round(),vt(this._el,p),this.fire("step")},_complete:function(){Z(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(a){return 1-Math.pow(1-a,this._easeOutPower)}}),Ve=Te.extend({options:{crs:gt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(a,c){c=v(this,c),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(a),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),c.maxBounds&&this.setMaxBounds(c.maxBounds),c.zoom!==void 0&&(this._zoom=this._limitZoom(c.zoom)),c.center&&c.zoom!==void 0&&this.setView(ee(c.center),c.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Ie&&W.any3d&&!W.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Pe(this._proxy,tt,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(a,c,p){if(c=c===void 0?this._zoom:this._limitZoom(c),a=this._limitCenter(ee(a),c,this.options.maxBounds),p=p||{},this._stop(),this._loaded&&!p.reset&&p!==!0){p.animate!==void 0&&(p.zoom=i({animate:p.animate},p.zoom),p.pan=i({animate:p.animate,duration:p.duration},p.pan));var y=this._zoom!==c?this._tryAnimatedZoom&&this._tryAnimatedZoom(a,c,p.zoom):this._tryAnimatedPan(a,p.pan);if(y)return clearTimeout(this._sizeTimer),this}return this._resetView(a,c,p.pan&&p.pan.noMoveStart),this},setZoom:function(a,c){return this._loaded?this.setView(this.getCenter(),a,{zoom:c}):(this._zoom=a,this)},zoomIn:function(a,c){return a=a||(W.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+a,c)},zoomOut:function(a,c){return a=a||(W.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-a,c)},setZoomAround:function(a,c,p){var y=this.getZoomScale(c),b=this.getSize().divideBy(2),E=a instanceof H?a:this.latLngToContainerPoint(a),A=E.subtract(b).multiplyBy(1-1/y),B=this.containerPointToLatLng(b.add(A));return this.setView(B,c,{zoom:p})},_getBoundsCenterZoom:function(a,c){c=c||{},a=a.getBounds?a.getBounds():re(a);var p=G(c.paddingTopLeft||c.padding||[0,0]),y=G(c.paddingBottomRight||c.padding||[0,0]),b=this.getBoundsZoom(a,!1,p.add(y));if(b=typeof c.maxZoom=="number"?Math.min(c.maxZoom,b):b,b===1/0)return{center:a.getCenter(),zoom:b};var E=y.subtract(p).divideBy(2),A=this.project(a.getSouthWest(),b),B=this.project(a.getNorthEast(),b),V=this.unproject(A.add(B).divideBy(2).add(E),b);return{center:V,zoom:b}},fitBounds:function(a,c){if(a=re(a),!a.isValid())throw new Error("Bounds are not valid.");var p=this._getBoundsCenterZoom(a,c);return this.setView(p.center,p.zoom,c)},fitWorld:function(a){return this.fitBounds([[-90,-180],[90,180]],a)},panTo:function(a,c){return this.setView(a,this._zoom,{pan:c})},panBy:function(a,c){if(a=G(a).round(),c=c||{},!a.x&&!a.y)return this.fire("moveend");if(c.animate!==!0&&!this.getSize().contains(a))return this._resetView(this.unproject(this.project(this.getCenter()).add(a)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Dv,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),c.noMoveStart||this.fire("movestart"),c.animate!==!1){Le(this._mapPane,"leaflet-pan-anim");var p=this._getMapPanePos().subtract(a).round();this._panAnim.run(this._mapPane,p,c.duration||.25,c.easeLinearity)}else this._rawPanBy(a),this.fire("move").fire("moveend");return this},flyTo:function(a,c,p){if(p=p||{},p.animate===!1||!W.any3d)return this.setView(a,c,p);this._stop();var y=this.project(this.getCenter()),b=this.project(a),E=this.getSize(),A=this._zoom;a=ee(a),c=c===void 0?A:c;var B=Math.max(E.x,E.y),V=B*this.getZoomScale(A,c),J=b.distanceTo(y)||1,ae=1.42,xe=ae*ae;function je(_t){var fc=_t?-1:1,DT=_t?V:B,AT=V*V-B*B+fc*xe*xe*J*J,IT=2*DT*xe*J,Cf=AT/IT,p_=Math.sqrt(Cf*Cf+1)-Cf,jT=p_<1e-9?-18:Math.log(p_);return jT}function fn(_t){return(Math.exp(_t)-Math.exp(-_t))/2}function jt(_t){return(Math.exp(_t)+Math.exp(-_t))/2}function or(_t){return fn(_t)/jt(_t)}var On=je(0);function Ko(_t){return B*(jt(On)/jt(On+ae*_t))}function OT(_t){return B*(jt(On)*or(On+ae*_t)-fn(On))/xe}function NT(_t){return 1-Math.pow(1-_t,1.5)}var LT=Date.now(),h_=(je(1)-On)/ae,RT=p.duration?1e3*p.duration:1e3*h_*.8;function f_(){var _t=(Date.now()-LT)/RT,fc=NT(_t)*h_;_t<=1?(this._flyToFrame=F(f_,this),this._move(this.unproject(y.add(b.subtract(y).multiplyBy(OT(fc)/J)),A),this.getScaleZoom(B/Ko(fc),A),{flyTo:!0})):this._move(a,c)._moveEnd(!0)}return this._moveStart(!0,p.noMoveStart),f_.call(this),this},flyToBounds:function(a,c){var p=this._getBoundsCenterZoom(a,c);return this.flyTo(p.center,p.zoom,c)},setMaxBounds:function(a){return a=re(a),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),a.isValid()?(this.options.maxBounds=a,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(a){var c=this.options.minZoom;return this.options.minZoom=a,this._loaded&&c!==a&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(a):this},setMaxZoom:function(a){var c=this.options.maxZoom;return this.options.maxZoom=a,this._loaded&&c!==a&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(a):this},panInsideBounds:function(a,c){this._enforcingBounds=!0;var p=this.getCenter(),y=this._limitCenter(p,this._zoom,re(a));return p.equals(y)||this.panTo(y,c),this._enforcingBounds=!1,this},panInside:function(a,c){c=c||{};var p=G(c.paddingTopLeft||c.padding||[0,0]),y=G(c.paddingBottomRight||c.padding||[0,0]),b=this.project(this.getCenter()),E=this.project(a),A=this.getPixelBounds(),B=K([A.min.add(p),A.max.subtract(y)]),V=B.getSize();if(!B.contains(E)){this._enforcingBounds=!0;var J=E.subtract(B.getCenter()),ae=B.extend(E).getSize().subtract(V);b.x+=J.x<0?-ae.x:ae.x,b.y+=J.y<0?-ae.y:ae.y,this.panTo(this.unproject(b),c),this._enforcingBounds=!1}return this},invalidateSize:function(a){if(!this._loaded)return this;a=i({animate:!1,pan:!0},a===!0?{animate:!0}:a);var c=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var p=this.getSize(),y=c.divideBy(2).round(),b=p.divideBy(2).round(),E=y.subtract(b);return!E.x&&!E.y?this:(a.animate&&a.pan?this.panBy(E):(a.pan&&this._rawPanBy(E),this.fire("move"),a.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:c,newSize:p}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(a){if(a=this._locateOptions=i({timeout:1e4,watch:!1},a),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var c=o(this._handleGeolocationResponse,this),p=o(this._handleGeolocationError,this);return a.watch?this._locationWatchId=navigator.geolocation.watchPosition(c,p,a):navigator.geolocation.getCurrentPosition(c,p,a),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(a){if(this._container._leaflet_id){var c=a.code,p=a.message||(c===1?"permission denied":c===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:c,message:"Geolocation error: "+p+"."})}},_handleGeolocationResponse:function(a){if(this._container._leaflet_id){var c=a.coords.latitude,p=a.coords.longitude,y=new te(c,p),b=y.toBounds(a.coords.accuracy*2),E=this._locateOptions;if(E.setView){var A=this.getBoundsZoom(b);this.setView(y,E.maxZoom?Math.min(A,E.maxZoom):A)}var B={latlng:y,bounds:b,timestamp:a.timestamp};for(var V in a.coords)typeof a.coords[V]=="number"&&(B[V]=a.coords[V]);this.fire("locationfound",B)}},addHandler:function(a,c){if(!c)return this;var p=this[a]=new c(this);return this._handlers.push(p),this.options[a]&&p.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),We(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Z(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var a;for(a in this._layers)this._layers[a].remove();for(a in this._panes)We(this._panes[a]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(a,c){var p="leaflet-pane"+(a?" leaflet-"+a.replace("Pane","")+"-pane":""),y=we("div",p,c||this._mapPane);return a&&(this._panes[a]=y),y},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var a=this.getPixelBounds(),c=this.unproject(a.getBottomLeft()),p=this.unproject(a.getTopRight());return new ie(c,p)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(a,c,p){a=re(a),p=G(p||[0,0]);var y=this.getZoom()||0,b=this.getMinZoom(),E=this.getMaxZoom(),A=a.getNorthWest(),B=a.getSouthEast(),V=this.getSize().subtract(p),J=K(this.project(B,y),this.project(A,y)).getSize(),ae=W.any3d?this.options.zoomSnap:1,xe=V.x/J.x,je=V.y/J.y,fn=c?Math.max(xe,je):Math.min(xe,je);return y=this.getScaleZoom(fn,y),ae&&(y=Math.round(y/(ae/100))*(ae/100),y=c?Math.ceil(y/ae)*ae:Math.floor(y/ae)*ae),Math.max(b,Math.min(E,y))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new H(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(a,c){var p=this._getTopLeftPoint(a,c);return new $(p,p.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(a){return this.options.crs.getProjectedBounds(a===void 0?this.getZoom():a)},getPane:function(a){return typeof a=="string"?this._panes[a]:a},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(a,c){var p=this.options.crs;return c=c===void 0?this._zoom:c,p.scale(a)/p.scale(c)},getScaleZoom:function(a,c){var p=this.options.crs;c=c===void 0?this._zoom:c;var y=p.zoom(a*p.scale(c));return isNaN(y)?1/0:y},project:function(a,c){return c=c===void 0?this._zoom:c,this.options.crs.latLngToPoint(ee(a),c)},unproject:function(a,c){return c=c===void 0?this._zoom:c,this.options.crs.pointToLatLng(G(a),c)},layerPointToLatLng:function(a){var c=G(a).add(this.getPixelOrigin());return this.unproject(c)},latLngToLayerPoint:function(a){var c=this.project(ee(a))._round();return c._subtract(this.getPixelOrigin())},wrapLatLng:function(a){return this.options.crs.wrapLatLng(ee(a))},wrapLatLngBounds:function(a){return this.options.crs.wrapLatLngBounds(re(a))},distance:function(a,c){return this.options.crs.distance(ee(a),ee(c))},containerPointToLayerPoint:function(a){return G(a).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(a){return G(a).add(this._getMapPanePos())},containerPointToLatLng:function(a){var c=this.containerPointToLayerPoint(G(a));return this.layerPointToLatLng(c)},latLngToContainerPoint:function(a){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ee(a)))},mouseEventToContainerPoint:function(a){return Lv(a,this._container)},mouseEventToLayerPoint:function(a){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(a))},mouseEventToLatLng:function(a){return this.layerPointToLatLng(this.mouseEventToLayerPoint(a))},_initContainer:function(a){var c=this._container=oi(a);if(c){if(c._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Pe(c,"scroll",this._onScroll,this),this._containerId=u(c)},_initLayout:function(){var a=this._container;this._fadeAnimated=this.options.fadeAnimation&&W.any3d,Le(a,"leaflet-container"+(W.touch?" leaflet-touch":"")+(W.retina?" leaflet-retina":"")+(W.ielt9?" leaflet-oldie":"")+(W.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var c=br(a,"position");c!=="absolute"&&c!=="relative"&&c!=="fixed"&&c!=="sticky"&&(a.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var a=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),vt(this._mapPane,new H(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Le(a.markerPane,"leaflet-zoom-hide"),Le(a.shadowPane,"leaflet-zoom-hide"))},_resetView:function(a,c,p){vt(this._mapPane,new H(0,0));var y=!this._loaded;this._loaded=!0,c=this._limitZoom(c),this.fire("viewprereset");var b=this._zoom!==c;this._moveStart(b,p)._move(a,c)._moveEnd(b),this.fire("viewreset"),y&&this.fire("load")},_moveStart:function(a,c){return a&&this.fire("zoomstart"),c||this.fire("movestart"),this},_move:function(a,c,p,y){c===void 0&&(c=this._zoom);var b=this._zoom!==c;return this._zoom=c,this._lastCenter=a,this._pixelOrigin=this._getNewPixelOrigin(a),y?p&&p.pinch&&this.fire("zoom",p):((b||p&&p.pinch)&&this.fire("zoom",p),this.fire("move",p)),this},_moveEnd:function(a){return a&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Z(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(a){vt(this._mapPane,this._getMapPanePos().subtract(a))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(a){this._targets={},this._targets[u(this._container)]=this;var c=a?Je:Pe;c(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&c(window,"resize",this._onResize,this),W.any3d&&this.options.transform3DLimit&&(a?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Z(this._resizeRequest),this._resizeRequest=F(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var a=this._getMapPanePos();Math.max(Math.abs(a.x),Math.abs(a.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(a,c){for(var p=[],y,b=c==="mouseout"||c==="mouseover",E=a.target||a.srcElement,A=!1;E;){if(y=this._targets[u(E)],y&&(c==="click"||c==="preclick")&&this._draggableMoved(y)){A=!0;break}if(y&&y.listens(c,!0)&&(b&&!pf(E,a)||(p.push(y),b))||E===this._container)break;E=E.parentNode}return!p.length&&!A&&!b&&this.listens(c,!0)&&(p=[this]),p},_isClickDisabled:function(a){for(;a&&a!==this._container;){if(a._leaflet_disable_click)return!0;a=a.parentNode}},_handleDOMEvent:function(a){var c=a.target||a.srcElement;if(!(!this._loaded||c._leaflet_disable_events||a.type==="click"&&this._isClickDisabled(c))){var p=a.type;p==="mousedown"&&lf(c),this._fireDOMEvent(a,p)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(a,c,p){if(a.type==="click"){var y=i({},a);y.type="preclick",this._fireDOMEvent(y,y.type,p)}var b=this._findEventTargets(a,c);if(p){for(var E=[],A=0;A<p.length;A++)p[A].listens(c,!0)&&E.push(p[A]);b=E.concat(b)}if(b.length){c==="contextmenu"&&Qt(a);var B=b[0],V={originalEvent:a};if(a.type!=="keypress"&&a.type!=="keydown"&&a.type!=="keyup"){var J=B.getLatLng&&(!B._radius||B._radius<=10);V.containerPoint=J?this.latLngToContainerPoint(B.getLatLng()):this.mouseEventToContainerPoint(a),V.layerPoint=this.containerPointToLayerPoint(V.containerPoint),V.latlng=J?B.getLatLng():this.layerPointToLatLng(V.layerPoint)}for(A=0;A<b.length;A++)if(b[A].fire(c,V,!0),V.originalEvent._stopped||b[A].options.bubblingMouseEvents===!1&&R(this._mouseEvents,c)!==-1)return}},_draggableMoved:function(a){return a=a.dragging&&a.dragging.enabled()?a:this,a.dragging&&a.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var a=0,c=this._handlers.length;a<c;a++)this._handlers[a].disable()},whenReady:function(a,c){return this._loaded?a.call(c||this,{target:this}):this.on("load",a,c),this},_getMapPanePos:function(){return Hs(this._mapPane)||new H(0,0)},_moved:function(){var a=this._getMapPanePos();return a&&!a.equals([0,0])},_getTopLeftPoint:function(a,c){var p=a&&c!==void 0?this._getNewPixelOrigin(a,c):this.getPixelOrigin();return p.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(a,c){var p=this.getSize()._divideBy(2);return this.project(a,c)._subtract(p)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(a,c,p){var y=this._getNewPixelOrigin(p,c);return this.project(a,c)._subtract(y)},_latLngBoundsToNewLayerBounds:function(a,c,p){var y=this._getNewPixelOrigin(p,c);return K([this.project(a.getSouthWest(),c)._subtract(y),this.project(a.getNorthWest(),c)._subtract(y),this.project(a.getSouthEast(),c)._subtract(y),this.project(a.getNorthEast(),c)._subtract(y)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(a){return this.latLngToLayerPoint(a).subtract(this._getCenterLayerPoint())},_limitCenter:function(a,c,p){if(!p)return a;var y=this.project(a,c),b=this.getSize().divideBy(2),E=new $(y.subtract(b),y.add(b)),A=this._getBoundsOffset(E,p,c);return Math.abs(A.x)<=1&&Math.abs(A.y)<=1?a:this.unproject(y.add(A),c)},_limitOffset:function(a,c){if(!c)return a;var p=this.getPixelBounds(),y=new $(p.min.add(a),p.max.add(a));return a.add(this._getBoundsOffset(y,c))},_getBoundsOffset:function(a,c,p){var y=K(this.project(c.getNorthEast(),p),this.project(c.getSouthWest(),p)),b=y.min.subtract(a.min),E=y.max.subtract(a.max),A=this._rebound(b.x,-E.x),B=this._rebound(b.y,-E.y);return new H(A,B)},_rebound:function(a,c){return a+c>0?Math.round(a-c)/2:Math.max(0,Math.ceil(a))-Math.max(0,Math.floor(c))},_limitZoom:function(a){var c=this.getMinZoom(),p=this.getMaxZoom(),y=W.any3d?this.options.zoomSnap:1;return y&&(a=Math.round(a/y)*y),Math.max(c,Math.min(p,a))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){pt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(a,c){var p=this._getCenterOffset(a)._trunc();return(c&&c.animate)!==!0&&!this.getSize().contains(p)?!1:(this.panBy(p,c),!0)},_createAnimProxy:function(){var a=this._proxy=we("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(a),this.on("zoomanim",function(c){var p=zi,y=this._proxy.style[p];Vs(this._proxy,this.project(c.center,c.zoom),this.getZoomScale(c.zoom,1)),y===this._proxy.style[p]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){We(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var a=this.getCenter(),c=this.getZoom();Vs(this._proxy,this.project(a,c),this.getZoomScale(c,1))},_catchTransitionEnd:function(a){this._animatingZoom&&a.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(a,c,p){if(this._animatingZoom)return!0;if(p=p||{},!this._zoomAnimated||p.animate===!1||this._nothingToAnimate()||Math.abs(c-this._zoom)>this.options.zoomAnimationThreshold)return!1;var y=this.getZoomScale(c),b=this._getCenterOffset(a)._divideBy(1-1/y);return p.animate!==!0&&!this.getSize().contains(b)?!1:(F(function(){this._moveStart(!0,p.noMoveStart||!1)._animateZoom(a,c,!0)},this),!0)},_animateZoom:function(a,c,p,y){this._mapPane&&(p&&(this._animatingZoom=!0,this._animateToCenter=a,this._animateToZoom=c,Le(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:a,zoom:c,noUpdate:y}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&pt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function KE(a,c){return new Ve(a,c)}var xr=oe.extend({options:{position:"topright"},initialize:function(a){v(this,a)},getPosition:function(){return this.options.position},setPosition:function(a){var c=this._map;return c&&c.removeControl(this),this.options.position=a,c&&c.addControl(this),this},getContainer:function(){return this._container},addTo:function(a){this.remove(),this._map=a;var c=this._container=this.onAdd(a),p=this.getPosition(),y=a._controlCorners[p];return Le(c,"leaflet-control"),p.indexOf("bottom")!==-1?y.insertBefore(c,y.firstChild):y.appendChild(c),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(We(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(a){this._map&&a&&a.screenX>0&&a.screenY>0&&this._map.getContainer().focus()}}),ll=function(a){return new xr(a)};Ve.include({addControl:function(a){return a.addTo(this),this},removeControl:function(a){return a.remove(),this},_initControlPos:function(){var a=this._controlCorners={},c="leaflet-",p=this._controlContainer=we("div",c+"control-container",this._container);function y(b,E){var A=c+b+" "+c+E;a[b+E]=we("div",A,p)}y("top","left"),y("top","right"),y("bottom","left"),y("bottom","right")},_clearControlPos:function(){for(var a in this._controlCorners)We(this._controlCorners[a]);We(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Av=xr.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(a,c,p,y){return p<y?-1:y<p?1:0}},initialize:function(a,c,p){v(this,p),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var y in a)this._addLayer(a[y],y);for(y in c)this._addLayer(c[y],y,!0)},onAdd:function(a){this._initLayout(),this._update(),this._map=a,a.on("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(a){return xr.prototype.addTo.call(this,a),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(a,c){return this._addLayer(a,c),this._map?this._update():this},addOverlay:function(a,c){return this._addLayer(a,c,!0),this._map?this._update():this},removeLayer:function(a){a.off("add remove",this._onLayerChange,this);var c=this._getLayer(u(a));return c&&this._layers.splice(this._layers.indexOf(c),1),this._map?this._update():this},expand:function(){Le(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var a=this._map.getSize().y-(this._container.offsetTop+50);return a<this._section.clientHeight?(Le(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=a+"px"):pt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return pt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var a="leaflet-control-layers",c=this._container=we("div",a),p=this.options.collapsed;c.setAttribute("aria-haspopup",!0),al(c),ff(c);var y=this._section=we("section",a+"-list");p&&(this._map.on("click",this.collapse,this),Pe(c,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var b=this._layersLink=we("a",a+"-toggle",c);b.href="#",b.title="Layers",b.setAttribute("role","button"),Pe(b,{keydown:function(E){E.keyCode===13&&this._expandSafely()},click:function(E){Qt(E),this._expandSafely()}},this),p||this.expand(),this._baseLayersList=we("div",a+"-base",y),this._separator=we("div",a+"-separator",y),this._overlaysList=we("div",a+"-overlays",y),c.appendChild(y)},_getLayer:function(a){for(var c=0;c<this._layers.length;c++)if(this._layers[c]&&u(this._layers[c].layer)===a)return this._layers[c]},_addLayer:function(a,c,p){this._map&&a.on("add remove",this._onLayerChange,this),this._layers.push({layer:a,name:c,overlay:p}),this.options.sortLayers&&this._layers.sort(o(function(y,b){return this.options.sortFunction(y.layer,b.layer,y.name,b.name)},this)),this.options.autoZIndex&&a.setZIndex&&(this._lastZIndex++,a.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Us(this._baseLayersList),Us(this._overlaysList),this._layerControlInputs=[];var a,c,p,y,b=0;for(p=0;p<this._layers.length;p++)y=this._layers[p],this._addItem(y),c=c||y.overlay,a=a||!y.overlay,b+=y.overlay?0:1;return this.options.hideSingleBase&&(a=a&&b>1,this._baseLayersList.style.display=a?"":"none"),this._separator.style.display=c&&a?"":"none",this},_onLayerChange:function(a){this._handlingClick||this._update();var c=this._getLayer(u(a.target)),p=c.overlay?a.type==="add"?"overlayadd":"overlayremove":a.type==="add"?"baselayerchange":null;p&&this._map.fire(p,c)},_createRadioElement:function(a,c){var p='<input type="radio" class="leaflet-control-layers-selector" name="'+a+'"'+(c?' checked="checked"':"")+"/>",y=document.createElement("div");return y.innerHTML=p,y.firstChild},_addItem:function(a){var c=document.createElement("label"),p=this._map.hasLayer(a.layer),y;a.overlay?(y=document.createElement("input"),y.type="checkbox",y.className="leaflet-control-layers-selector",y.defaultChecked=p):y=this._createRadioElement("leaflet-base-layers_"+u(this),p),this._layerControlInputs.push(y),y.layerId=u(a.layer),Pe(y,"click",this._onInputClick,this);var b=document.createElement("span");b.innerHTML=" "+a.name;var E=document.createElement("span");c.appendChild(E),E.appendChild(y),E.appendChild(b);var A=a.overlay?this._overlaysList:this._baseLayersList;return A.appendChild(c),this._checkDisabledLayers(),c},_onInputClick:function(){if(!this._preventClick){var a=this._layerControlInputs,c,p,y=[],b=[];this._handlingClick=!0;for(var E=a.length-1;E>=0;E--)c=a[E],p=this._getLayer(c.layerId).layer,c.checked?y.push(p):c.checked||b.push(p);for(E=0;E<b.length;E++)this._map.hasLayer(b[E])&&this._map.removeLayer(b[E]);for(E=0;E<y.length;E++)this._map.hasLayer(y[E])||this._map.addLayer(y[E]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var a=this._layerControlInputs,c,p,y=this._map.getZoom(),b=a.length-1;b>=0;b--)c=a[b],p=this._getLayer(c.layerId).layer,c.disabled=p.options.minZoom!==void 0&&y<p.options.minZoom||p.options.maxZoom!==void 0&&y>p.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var a=this._section;this._preventClick=!0,Pe(a,"click",Qt),this.expand();var c=this;setTimeout(function(){Je(a,"click",Qt),c._preventClick=!1})}}),ZE=function(a,c,p){return new Av(a,c,p)},mf=xr.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(a){var c="leaflet-control-zoom",p=we("div",c+" leaflet-bar"),y=this.options;return this._zoomInButton=this._createButton(y.zoomInText,y.zoomInTitle,c+"-in",p,this._zoomIn),this._zoomOutButton=this._createButton(y.zoomOutText,y.zoomOutTitle,c+"-out",p,this._zoomOut),this._updateDisabled(),a.on("zoomend zoomlevelschange",this._updateDisabled,this),p},onRemove:function(a){a.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(a){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(a.shiftKey?3:1))},_zoomOut:function(a){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(a.shiftKey?3:1))},_createButton:function(a,c,p,y,b){var E=we("a",p,y);return E.innerHTML=a,E.href="#",E.title=c,E.setAttribute("role","button"),E.setAttribute("aria-label",c),al(E),Pe(E,"click",Ws),Pe(E,"click",b,this),Pe(E,"click",this._refocusOnMap,this),E},_updateDisabled:function(){var a=this._map,c="leaflet-disabled";pt(this._zoomInButton,c),pt(this._zoomOutButton,c),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||a._zoom===a.getMinZoom())&&(Le(this._zoomOutButton,c),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||a._zoom===a.getMaxZoom())&&(Le(this._zoomInButton,c),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ve.mergeOptions({zoomControl:!0}),Ve.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new mf,this.addControl(this.zoomControl))});var QE=function(a){return new mf(a)},Iv=xr.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(a){var c="leaflet-control-scale",p=we("div",c),y=this.options;return this._addScales(y,c+"-line",p),a.on(y.updateWhenIdle?"moveend":"move",this._update,this),a.whenReady(this._update,this),p},onRemove:function(a){a.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(a,c,p){a.metric&&(this._mScale=we("div",c,p)),a.imperial&&(this._iScale=we("div",c,p))},_update:function(){var a=this._map,c=a.getSize().y/2,p=a.distance(a.containerPointToLatLng([0,c]),a.containerPointToLatLng([this.options.maxWidth,c]));this._updateScales(p)},_updateScales:function(a){this.options.metric&&a&&this._updateMetric(a),this.options.imperial&&a&&this._updateImperial(a)},_updateMetric:function(a){var c=this._getRoundNum(a),p=c<1e3?c+" m":c/1e3+" km";this._updateScale(this._mScale,p,c/a)},_updateImperial:function(a){var c=a*3.2808399,p,y,b;c>5280?(p=c/5280,y=this._getRoundNum(p),this._updateScale(this._iScale,y+" mi",y/p)):(b=this._getRoundNum(c),this._updateScale(this._iScale,b+" ft",b/c))},_updateScale:function(a,c,p){a.style.width=Math.round(this.options.maxWidth*p)+"px",a.innerHTML=c},_getRoundNum:function(a){var c=Math.pow(10,(Math.floor(a)+"").length-1),p=a/c;return p=p>=10?10:p>=5?5:p>=3?3:p>=2?2:1,c*p}}),GE=function(a){return new Iv(a)},JE='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',gf=xr.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(W.inlineSvg?JE+" ":"")+"Leaflet</a>"},initialize:function(a){v(this,a),this._attributions={}},onAdd:function(a){a.attributionControl=this,this._container=we("div","leaflet-control-attribution"),al(this._container);for(var c in a._layers)a._layers[c].getAttribution&&this.addAttribution(a._layers[c].getAttribution());return this._update(),a.on("layeradd",this._addAttribution,this),this._container},onRemove:function(a){a.off("layeradd",this._addAttribution,this)},_addAttribution:function(a){a.layer.getAttribution&&(this.addAttribution(a.layer.getAttribution()),a.layer.once("remove",function(){this.removeAttribution(a.layer.getAttribution())},this))},setPrefix:function(a){return this.options.prefix=a,this._update(),this},addAttribution:function(a){return a?(this._attributions[a]||(this._attributions[a]=0),this._attributions[a]++,this._update(),this):this},removeAttribution:function(a){return a?(this._attributions[a]&&(this._attributions[a]--,this._update()),this):this},_update:function(){if(this._map){var a=[];for(var c in this._attributions)this._attributions[c]&&a.push(c);var p=[];this.options.prefix&&p.push(this.options.prefix),a.length&&p.push(a.join(", ")),this._container.innerHTML=p.join(' <span aria-hidden="true">|</span> ')}}});Ve.mergeOptions({attributionControl:!0}),Ve.addInitHook(function(){this.options.attributionControl&&new gf().addTo(this)});var YE=function(a){return new gf(a)};xr.Layers=Av,xr.Zoom=mf,xr.Scale=Iv,xr.Attribution=gf,ll.layers=ZE,ll.zoom=QE,ll.scale=GE,ll.attribution=YE;var Br=oe.extend({initialize:function(a){this._map=a},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Br.addTo=function(a,c){return a.addHandler(c,this),this};var XE={Events:ue},jv=W.touch?"touchstart mousedown":"mousedown",Fi=Te.extend({options:{clickTolerance:3},initialize:function(a,c,p,y){v(this,y),this._element=a,this._dragStartTarget=c||a,this._preventOutline=p},enable:function(){this._enabled||(Pe(this._dragStartTarget,jv,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Fi._dragging===this&&this.finishDrag(!0),Je(this._dragStartTarget,jv,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(a){if(this._enabled&&(this._moved=!1,!tf(this._element,"leaflet-zoom-anim"))){if(a.touches&&a.touches.length!==1){Fi._dragging===this&&this.finishDrag();return}if(!(Fi._dragging||a.shiftKey||a.which!==1&&a.button!==1&&!a.touches)&&(Fi._dragging=this,this._preventOutline&&lf(this._element),sf(),il(),!this._moving)){this.fire("down");var c=a.touches?a.touches[0]:a,p=Mv(this._element);this._startPoint=new H(c.clientX,c.clientY),this._startPos=Hs(this._element),this._parentScale=uf(p);var y=a.type==="mousedown";Pe(document,y?"mousemove":"touchmove",this._onMove,this),Pe(document,y?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(a){if(this._enabled){if(a.touches&&a.touches.length>1){this._moved=!0;return}var c=a.touches&&a.touches.length===1?a.touches[0]:a,p=new H(c.clientX,c.clientY)._subtract(this._startPoint);!p.x&&!p.y||Math.abs(p.x)+Math.abs(p.y)<this.options.clickTolerance||(p.x/=this._parentScale.x,p.y/=this._parentScale.y,Qt(a),this._moved||(this.fire("dragstart"),this._moved=!0,Le(document.body,"leaflet-dragging"),this._lastTarget=a.target||a.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Le(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(p),this._moving=!0,this._lastEvent=a,this._updatePosition())}},_updatePosition:function(){var a={originalEvent:this._lastEvent};this.fire("predrag",a),vt(this._element,this._newPos),this.fire("drag",a)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(a){pt(document.body,"leaflet-dragging"),this._lastTarget&&(pt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Je(document,"mousemove touchmove",this._onMove,this),Je(document,"mouseup touchend touchcancel",this._onUp,this),of(),sl();var c=this._moved&&this._moving;this._moving=!1,Fi._dragging=!1,c&&this.fire("dragend",{noInertia:a,distance:this._newPos.distanceTo(this._startPos)})}});function zv(a,c,p){var y,b=[1,4,2,8],E,A,B,V,J,ae,xe,je;for(E=0,ae=a.length;E<ae;E++)a[E]._code=Ks(a[E],c);for(B=0;B<4;B++){for(xe=b[B],y=[],E=0,ae=a.length,A=ae-1;E<ae;A=E++)V=a[E],J=a[A],V._code&xe?J._code&xe||(je=nc(J,V,xe,c,p),je._code=Ks(je,c),y.push(je)):(J._code&xe&&(je=nc(J,V,xe,c,p),je._code=Ks(je,c),y.push(je)),y.push(V));a=y}return a}function Bv(a,c){var p,y,b,E,A,B,V,J,ae;if(!a||a.length===0)throw new Error("latlngs not passed");sr(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var xe=ee([0,0]),je=re(a),fn=je.getNorthWest().distanceTo(je.getSouthWest())*je.getNorthEast().distanceTo(je.getNorthWest());fn<1700&&(xe=yf(a));var jt=a.length,or=[];for(p=0;p<jt;p++){var On=ee(a[p]);or.push(c.project(ee([On.lat-xe.lat,On.lng-xe.lng])))}for(B=V=J=0,p=0,y=jt-1;p<jt;y=p++)b=or[p],E=or[y],A=b.y*E.x-E.y*b.x,V+=(b.x+E.x)*A,J+=(b.y+E.y)*A,B+=A*3;B===0?ae=or[0]:ae=[V/B,J/B];var Ko=c.unproject(G(ae));return ee([Ko.lat+xe.lat,Ko.lng+xe.lng])}function yf(a){for(var c=0,p=0,y=0,b=0;b<a.length;b++){var E=ee(a[b]);c+=E.lat,p+=E.lng,y++}return ee([c/y,p/y])}var eT={__proto__:null,clipPolygon:zv,polygonCenter:Bv,centroid:yf};function Fv(a,c){if(!c||!a.length)return a.slice();var p=c*c;return a=rT(a,p),a=nT(a,p),a}function $v(a,c,p){return Math.sqrt(ul(a,c,p,!0))}function tT(a,c,p){return ul(a,c,p)}function nT(a,c){var p=a.length,y=typeof Uint8Array<"u"?Uint8Array:Array,b=new y(p);b[0]=b[p-1]=1,vf(a,b,c,0,p-1);var E,A=[];for(E=0;E<p;E++)b[E]&&A.push(a[E]);return A}function vf(a,c,p,y,b){var E=0,A,B,V;for(B=y+1;B<=b-1;B++)V=ul(a[B],a[y],a[b],!0),V>E&&(A=B,E=V);E>p&&(c[A]=1,vf(a,c,p,y,A),vf(a,c,p,A,b))}function rT(a,c){for(var p=[a[0]],y=1,b=0,E=a.length;y<E;y++)iT(a[y],a[b])>c&&(p.push(a[y]),b=y);return b<E-1&&p.push(a[E-1]),p}var Uv;function Vv(a,c,p,y,b){var E=y?Uv:Ks(a,p),A=Ks(c,p),B,V,J;for(Uv=A;;){if(!(E|A))return[a,c];if(E&A)return!1;B=E||A,V=nc(a,c,B,p,b),J=Ks(V,p),B===E?(a=V,E=J):(c=V,A=J)}}function nc(a,c,p,y,b){var E=c.x-a.x,A=c.y-a.y,B=y.min,V=y.max,J,ae;return p&8?(J=a.x+E*(V.y-a.y)/A,ae=V.y):p&4?(J=a.x+E*(B.y-a.y)/A,ae=B.y):p&2?(J=V.x,ae=a.y+A*(V.x-a.x)/E):p&1&&(J=B.x,ae=a.y+A*(B.x-a.x)/E),new H(J,ae,b)}function Ks(a,c){var p=0;return a.x<c.min.x?p|=1:a.x>c.max.x&&(p|=2),a.y<c.min.y?p|=4:a.y>c.max.y&&(p|=8),p}function iT(a,c){var p=c.x-a.x,y=c.y-a.y;return p*p+y*y}function ul(a,c,p,y){var b=c.x,E=c.y,A=p.x-b,B=p.y-E,V=A*A+B*B,J;return V>0&&(J=((a.x-b)*A+(a.y-E)*B)/V,J>1?(b=p.x,E=p.y):J>0&&(b+=A*J,E+=B*J)),A=a.x-b,B=a.y-E,y?A*A+B*B:new H(b,E)}function sr(a){return!C(a[0])||typeof a[0][0]!="object"&&typeof a[0][0]<"u"}function Hv(a){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),sr(a)}function qv(a,c){var p,y,b,E,A,B,V,J;if(!a||a.length===0)throw new Error("latlngs not passed");sr(a)||(console.warn("latlngs are not flat! Only the first ring will be used"),a=a[0]);var ae=ee([0,0]),xe=re(a),je=xe.getNorthWest().distanceTo(xe.getSouthWest())*xe.getNorthEast().distanceTo(xe.getNorthWest());je<1700&&(ae=yf(a));var fn=a.length,jt=[];for(p=0;p<fn;p++){var or=ee(a[p]);jt.push(c.project(ee([or.lat-ae.lat,or.lng-ae.lng])))}for(p=0,y=0;p<fn-1;p++)y+=jt[p].distanceTo(jt[p+1])/2;if(y===0)J=jt[0];else for(p=0,E=0;p<fn-1;p++)if(A=jt[p],B=jt[p+1],b=A.distanceTo(B),E+=b,E>y){V=(E-y)/b,J=[B.x-V*(B.x-A.x),B.y-V*(B.y-A.y)];break}var On=c.unproject(G(J));return ee([On.lat+ae.lat,On.lng+ae.lng])}var sT={__proto__:null,simplify:Fv,pointToSegmentDistance:$v,closestPointOnSegment:tT,clipSegment:Vv,_getEdgeIntersection:nc,_getBitCode:Ks,_sqClosestPointOnSegment:ul,isFlat:sr,_flat:Hv,polylineCenter:qv},_f={project:function(a){return new H(a.lng,a.lat)},unproject:function(a){return new te(a.y,a.x)},bounds:new $([-180,-90],[180,90])},wf={R:6378137,R_MINOR:6356752314245179e-9,bounds:new $([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(a){var c=Math.PI/180,p=this.R,y=a.lat*c,b=this.R_MINOR/p,E=Math.sqrt(1-b*b),A=E*Math.sin(y),B=Math.tan(Math.PI/4-y/2)/Math.pow((1-A)/(1+A),E/2);return y=-p*Math.log(Math.max(B,1e-10)),new H(a.lng*c*p,y)},unproject:function(a){for(var c=180/Math.PI,p=this.R,y=this.R_MINOR/p,b=Math.sqrt(1-y*y),E=Math.exp(-a.y/p),A=Math.PI/2-2*Math.atan(E),B=0,V=.1,J;B<15&&Math.abs(V)>1e-7;B++)J=b*Math.sin(A),J=Math.pow((1-J)/(1+J),b/2),V=Math.PI/2-2*Math.atan(E*J)-A,A+=V;return new te(A*c,a.x*c/p)}},oT={__proto__:null,LonLat:_f,Mercator:wf,SphericalMercator:Oe},aT=i({},Re,{code:"EPSG:3395",projection:wf,transformation:function(){var a=.5/(Math.PI*wf.R);return De(a,.5,-a,.5)}()}),Wv=i({},Re,{code:"EPSG:4326",projection:_f,transformation:De(1/180,1,-1/180,.5)}),lT=i({},Se,{projection:_f,transformation:De(1,0,-1,0),scale:function(a){return Math.pow(2,a)},zoom:function(a){return Math.log(a)/Math.LN2},distance:function(a,c){var p=c.lng-a.lng,y=c.lat-a.lat;return Math.sqrt(p*p+y*y)},infinite:!0});Se.Earth=Re,Se.EPSG3395=aT,Se.EPSG3857=gt,Se.EPSG900913=rn,Se.EPSG4326=Wv,Se.Simple=lT;var Sr=Te.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(a){return a.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(a){return a&&a.removeLayer(this),this},getPane:function(a){return this._map.getPane(a?this.options[a]||a:this.options.pane)},addInteractiveTarget:function(a){return this._map._targets[u(a)]=this,this},removeInteractiveTarget:function(a){return delete this._map._targets[u(a)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(a){var c=a.target;if(c.hasLayer(this)){if(this._map=c,this._zoomAnimated=c._zoomAnimated,this.getEvents){var p=this.getEvents();c.on(p,this),this.once("remove",function(){c.off(p,this)},this)}this.onAdd(c),this.fire("add"),c.fire("layeradd",{layer:this})}}});Ve.include({addLayer:function(a){if(!a._layerAdd)throw new Error("The provided object is not a Layer.");var c=u(a);return this._layers[c]?this:(this._layers[c]=a,a._mapToAdd=this,a.beforeAdd&&a.beforeAdd(this),this.whenReady(a._layerAdd,a),this)},removeLayer:function(a){var c=u(a);return this._layers[c]?(this._loaded&&a.onRemove(this),delete this._layers[c],this._loaded&&(this.fire("layerremove",{layer:a}),a.fire("remove")),a._map=a._mapToAdd=null,this):this},hasLayer:function(a){return u(a)in this._layers},eachLayer:function(a,c){for(var p in this._layers)a.call(c,this._layers[p]);return this},_addLayers:function(a){a=a?C(a)?a:[a]:[];for(var c=0,p=a.length;c<p;c++)this.addLayer(a[c])},_addZoomLimit:function(a){(!isNaN(a.options.maxZoom)||!isNaN(a.options.minZoom))&&(this._zoomBoundLayers[u(a)]=a,this._updateZoomLevels())},_removeZoomLimit:function(a){var c=u(a);this._zoomBoundLayers[c]&&(delete this._zoomBoundLayers[c],this._updateZoomLevels())},_updateZoomLevels:function(){var a=1/0,c=-1/0,p=this._getZoomSpan();for(var y in this._zoomBoundLayers){var b=this._zoomBoundLayers[y].options;a=b.minZoom===void 0?a:Math.min(a,b.minZoom),c=b.maxZoom===void 0?c:Math.max(c,b.maxZoom)}this._layersMaxZoom=c===-1/0?void 0:c,this._layersMinZoom=a===1/0?void 0:a,p!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Uo=Sr.extend({initialize:function(a,c){v(this,c),this._layers={};var p,y;if(a)for(p=0,y=a.length;p<y;p++)this.addLayer(a[p])},addLayer:function(a){var c=this.getLayerId(a);return this._layers[c]=a,this._map&&this._map.addLayer(a),this},removeLayer:function(a){var c=a in this._layers?a:this.getLayerId(a);return this._map&&this._layers[c]&&this._map.removeLayer(this._layers[c]),delete this._layers[c],this},hasLayer:function(a){var c=typeof a=="number"?a:this.getLayerId(a);return c in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(a){var c=Array.prototype.slice.call(arguments,1),p,y;for(p in this._layers)y=this._layers[p],y[a]&&y[a].apply(y,c);return this},onAdd:function(a){this.eachLayer(a.addLayer,a)},onRemove:function(a){this.eachLayer(a.removeLayer,a)},eachLayer:function(a,c){for(var p in this._layers)a.call(c,this._layers[p]);return this},getLayer:function(a){return this._layers[a]},getLayers:function(){var a=[];return this.eachLayer(a.push,a),a},setZIndex:function(a){return this.invoke("setZIndex",a)},getLayerId:function(a){return u(a)}}),uT=function(a,c){return new Uo(a,c)},ai=Uo.extend({addLayer:function(a){return this.hasLayer(a)?this:(a.addEventParent(this),Uo.prototype.addLayer.call(this,a),this.fire("layeradd",{layer:a}))},removeLayer:function(a){return this.hasLayer(a)?(a in this._layers&&(a=this._layers[a]),a.removeEventParent(this),Uo.prototype.removeLayer.call(this,a),this.fire("layerremove",{layer:a})):this},setStyle:function(a){return this.invoke("setStyle",a)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var a=new ie;for(var c in this._layers){var p=this._layers[c];a.extend(p.getBounds?p.getBounds():p.getLatLng())}return a}}),cT=function(a,c){return new ai(a,c)},Vo=oe.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(a){v(this,a)},createIcon:function(a){return this._createIcon("icon",a)},createShadow:function(a){return this._createIcon("shadow",a)},_createIcon:function(a,c){var p=this._getIconUrl(a);if(!p){if(a==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var y=this._createImg(p,c&&c.tagName==="IMG"?c:null);return this._setIconStyles(y,a),(this.options.crossOrigin||this.options.crossOrigin==="")&&(y.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),y},_setIconStyles:function(a,c){var p=this.options,y=p[c+"Size"];typeof y=="number"&&(y=[y,y]);var b=G(y),E=G(c==="shadow"&&p.shadowAnchor||p.iconAnchor||b&&b.divideBy(2,!0));a.className="leaflet-marker-"+c+" "+(p.className||""),E&&(a.style.marginLeft=-E.x+"px",a.style.marginTop=-E.y+"px"),b&&(a.style.width=b.x+"px",a.style.height=b.y+"px")},_createImg:function(a,c){return c=c||document.createElement("img"),c.src=a,c},_getIconUrl:function(a){return W.retina&&this.options[a+"RetinaUrl"]||this.options[a+"Url"]}});function dT(a){return new Vo(a)}var cl=Vo.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(a){return typeof cl.imagePath!="string"&&(cl.imagePath=this._detectIconPath()),(this.options.imagePath||cl.imagePath)+Vo.prototype._getIconUrl.call(this,a)},_stripUrl:function(a){var c=function(p,y,b){var E=y.exec(p);return E&&E[b]};return a=c(a,/^url\((['"])?(.+)\1\)$/,2),a&&c(a,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var a=we("div","leaflet-default-icon-path",document.body),c=br(a,"background-image")||br(a,"backgroundImage");if(document.body.removeChild(a),c=this._stripUrl(c),c)return c;var p=document.querySelector('link[href$="leaflet.css"]');return p?p.href.substring(0,p.href.length-11-1):""}}),Kv=Br.extend({initialize:function(a){this._marker=a},addHooks:function(){var a=this._marker._icon;this._draggable||(this._draggable=new Fi(a,a,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Le(a,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&pt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(a){var c=this._marker,p=c._map,y=this._marker.options.autoPanSpeed,b=this._marker.options.autoPanPadding,E=Hs(c._icon),A=p.getPixelBounds(),B=p.getPixelOrigin(),V=K(A.min._subtract(B).add(b),A.max._subtract(B).subtract(b));if(!V.contains(E)){var J=G((Math.max(V.max.x,E.x)-V.max.x)/(A.max.x-V.max.x)-(Math.min(V.min.x,E.x)-V.min.x)/(A.min.x-V.min.x),(Math.max(V.max.y,E.y)-V.max.y)/(A.max.y-V.max.y)-(Math.min(V.min.y,E.y)-V.min.y)/(A.min.y-V.min.y)).multiplyBy(y);p.panBy(J,{animate:!1}),this._draggable._newPos._add(J),this._draggable._startPos._add(J),vt(c._icon,this._draggable._newPos),this._onDrag(a),this._panRequest=F(this._adjustPan.bind(this,a))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(a){this._marker.options.autoPan&&(Z(this._panRequest),this._panRequest=F(this._adjustPan.bind(this,a)))},_onDrag:function(a){var c=this._marker,p=c._shadow,y=Hs(c._icon),b=c._map.layerPointToLatLng(y);p&&vt(p,y),c._latlng=b,a.latlng=b,a.oldLatLng=this._oldLatLng,c.fire("move",a).fire("drag",a)},_onDragEnd:function(a){Z(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",a)}}),rc=Sr.extend({options:{icon:new cl,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(a,c){v(this,c),this._latlng=ee(a)},onAdd:function(a){this._zoomAnimated=this._zoomAnimated&&a.options.markerZoomAnimation,this._zoomAnimated&&a.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(a){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&a.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(a){var c=this._latlng;return this._latlng=ee(a),this.update(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},setZIndexOffset:function(a){return this.options.zIndexOffset=a,this.update()},getIcon:function(){return this.options.icon},setIcon:function(a){return this.options.icon=a,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var a=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(a)}return this},_initIcon:function(){var a=this.options,c="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),p=a.icon.createIcon(this._icon),y=!1;p!==this._icon&&(this._icon&&this._removeIcon(),y=!0,a.title&&(p.title=a.title),p.tagName==="IMG"&&(p.alt=a.alt||"")),Le(p,c),a.keyboard&&(p.tabIndex="0",p.setAttribute("role","button")),this._icon=p,a.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Pe(p,"focus",this._panOnFocus,this);var b=a.icon.createShadow(this._shadow),E=!1;b!==this._shadow&&(this._removeShadow(),E=!0),b&&(Le(b,c),b.alt=""),this._shadow=b,a.opacity<1&&this._updateOpacity(),y&&this.getPane().appendChild(this._icon),this._initInteraction(),b&&E&&this.getPane(a.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Je(this._icon,"focus",this._panOnFocus,this),We(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&We(this._shadow),this._shadow=null},_setPos:function(a){this._icon&&vt(this._icon,a),this._shadow&&vt(this._shadow,a),this._zIndex=a.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(a){this._icon&&(this._icon.style.zIndex=this._zIndex+a)},_animateZoom:function(a){var c=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center).round();this._setPos(c)},_initInteraction:function(){if(this.options.interactive&&(Le(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Kv)){var a=this.options.draggable;this.dragging&&(a=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Kv(this),a&&this.dragging.enable()}},setOpacity:function(a){return this.options.opacity=a,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var a=this.options.opacity;this._icon&&ir(this._icon,a),this._shadow&&ir(this._shadow,a)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var a=this._map;if(a){var c=this.options.icon.options,p=c.iconSize?G(c.iconSize):G(0,0),y=c.iconAnchor?G(c.iconAnchor):G(0,0);a.panInside(this._latlng,{paddingTopLeft:y,paddingBottomRight:p.subtract(y)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function hT(a,c){return new rc(a,c)}var $i=Sr.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(a){this._renderer=a.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(a){return v(this,a),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&a&&Object.prototype.hasOwnProperty.call(a,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),ic=$i.extend({options:{fill:!0,radius:10},initialize:function(a,c){v(this,c),this._latlng=ee(a),this._radius=this.options.radius},setLatLng:function(a){var c=this._latlng;return this._latlng=ee(a),this.redraw(),this.fire("move",{oldLatLng:c,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(a){return this.options.radius=this._radius=a,this.redraw()},getRadius:function(){return this._radius},setStyle:function(a){var c=a&&a.radius||this._radius;return $i.prototype.setStyle.call(this,a),this.setRadius(c),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var a=this._radius,c=this._radiusY||a,p=this._clickTolerance(),y=[a+p,c+p];this._pxBounds=new $(this._point.subtract(y),this._point.add(y))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(a){return a.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function fT(a,c){return new ic(a,c)}var bf=ic.extend({initialize:function(a,c,p){if(typeof c=="number"&&(c=i({},p,{radius:c})),v(this,c),this._latlng=ee(a),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(a){return this._mRadius=a,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var a=[this._radius,this._radiusY||this._radius];return new ie(this._map.layerPointToLatLng(this._point.subtract(a)),this._map.layerPointToLatLng(this._point.add(a)))},setStyle:$i.prototype.setStyle,_project:function(){var a=this._latlng.lng,c=this._latlng.lat,p=this._map,y=p.options.crs;if(y.distance===Re.distance){var b=Math.PI/180,E=this._mRadius/Re.R/b,A=p.project([c+E,a]),B=p.project([c-E,a]),V=A.add(B).divideBy(2),J=p.unproject(V).lat,ae=Math.acos((Math.cos(E*b)-Math.sin(c*b)*Math.sin(J*b))/(Math.cos(c*b)*Math.cos(J*b)))/b;(isNaN(ae)||ae===0)&&(ae=E/Math.cos(Math.PI/180*c)),this._point=V.subtract(p.getPixelOrigin()),this._radius=isNaN(ae)?0:V.x-p.project([J,a-ae]).x,this._radiusY=V.y-A.y}else{var xe=y.unproject(y.project(this._latlng).subtract([this._mRadius,0]));this._point=p.latLngToLayerPoint(this._latlng),this._radius=this._point.x-p.latLngToLayerPoint(xe).x}this._updateBounds()}});function pT(a,c,p){return new bf(a,c,p)}var li=$i.extend({options:{smoothFactor:1,noClip:!1},initialize:function(a,c){v(this,c),this._setLatLngs(a)},getLatLngs:function(){return this._latlngs},setLatLngs:function(a){return this._setLatLngs(a),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(a){for(var c=1/0,p=null,y=ul,b,E,A=0,B=this._parts.length;A<B;A++)for(var V=this._parts[A],J=1,ae=V.length;J<ae;J++){b=V[J-1],E=V[J];var xe=y(a,b,E,!0);xe<c&&(c=xe,p=y(a,b,E))}return p&&(p.distance=Math.sqrt(c)),p},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return qv(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(a,c){return c=c||this._defaultShape(),a=ee(a),c.push(a),this._bounds.extend(a),this.redraw()},_setLatLngs:function(a){this._bounds=new ie,this._latlngs=this._convertLatLngs(a)},_defaultShape:function(){return sr(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(a){for(var c=[],p=sr(a),y=0,b=a.length;y<b;y++)p?(c[y]=ee(a[y]),this._bounds.extend(c[y])):c[y]=this._convertLatLngs(a[y]);return c},_project:function(){var a=new $;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,a),this._bounds.isValid()&&a.isValid()&&(this._rawPxBounds=a,this._updateBounds())},_updateBounds:function(){var a=this._clickTolerance(),c=new H(a,a);this._rawPxBounds&&(this._pxBounds=new $([this._rawPxBounds.min.subtract(c),this._rawPxBounds.max.add(c)]))},_projectLatlngs:function(a,c,p){var y=a[0]instanceof te,b=a.length,E,A;if(y){for(A=[],E=0;E<b;E++)A[E]=this._map.latLngToLayerPoint(a[E]),p.extend(A[E]);c.push(A)}else for(E=0;E<b;E++)this._projectLatlngs(a[E],c,p)},_clipPoints:function(){var a=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return}var c=this._parts,p,y,b,E,A,B,V;for(p=0,b=0,E=this._rings.length;p<E;p++)for(V=this._rings[p],y=0,A=V.length;y<A-1;y++)B=Vv(V[y],V[y+1],a,y,!0),B&&(c[b]=c[b]||[],c[b].push(B[0]),(B[1]!==V[y+1]||y===A-2)&&(c[b].push(B[1]),b++))}},_simplifyPoints:function(){for(var a=this._parts,c=this.options.smoothFactor,p=0,y=a.length;p<y;p++)a[p]=Fv(a[p],c)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(a,c){var p,y,b,E,A,B,V=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(p=0,E=this._parts.length;p<E;p++)for(B=this._parts[p],y=0,A=B.length,b=A-1;y<A;b=y++)if(!(!c&&y===0)&&$v(a,B[b],B[y])<=V)return!0;return!1}});function mT(a,c){return new li(a,c)}li._flat=Hv;var Ho=li.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Bv(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(a){var c=li.prototype._convertLatLngs.call(this,a),p=c.length;return p>=2&&c[0]instanceof te&&c[0].equals(c[p-1])&&c.pop(),c},_setLatLngs:function(a){li.prototype._setLatLngs.call(this,a),sr(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return sr(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var a=this._renderer._bounds,c=this.options.weight,p=new H(c,c);if(a=new $(a.min.subtract(p),a.max.add(p)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(a))){if(this.options.noClip){this._parts=this._rings;return}for(var y=0,b=this._rings.length,E;y<b;y++)E=zv(this._rings[y],a,!0),E.length&&this._parts.push(E)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(a){var c=!1,p,y,b,E,A,B,V,J;if(!this._pxBounds||!this._pxBounds.contains(a))return!1;for(E=0,V=this._parts.length;E<V;E++)for(p=this._parts[E],A=0,J=p.length,B=J-1;A<J;B=A++)y=p[A],b=p[B],y.y>a.y!=b.y>a.y&&a.x<(b.x-y.x)*(a.y-y.y)/(b.y-y.y)+y.x&&(c=!c);return c||li.prototype._containsPoint.call(this,a,!0)}});function gT(a,c){return new Ho(a,c)}var ui=ai.extend({initialize:function(a,c){v(this,c),this._layers={},a&&this.addData(a)},addData:function(a){var c=C(a)?a:a.features,p,y,b;if(c){for(p=0,y=c.length;p<y;p++)b=c[p],(b.geometries||b.geometry||b.features||b.coordinates)&&this.addData(b);return this}var E=this.options;if(E.filter&&!E.filter(a))return this;var A=sc(a,E);return A?(A.feature=lc(a),A.defaultOptions=A.options,this.resetStyle(A),E.onEachFeature&&E.onEachFeature(a,A),this.addLayer(A)):this},resetStyle:function(a){return a===void 0?this.eachLayer(this.resetStyle,this):(a.options=i({},a.defaultOptions),this._setLayerStyle(a,this.options.style),this)},setStyle:function(a){return this.eachLayer(function(c){this._setLayerStyle(c,a)},this)},_setLayerStyle:function(a,c){a.setStyle&&(typeof c=="function"&&(c=c(a.feature)),a.setStyle(c))}});function sc(a,c){var p=a.type==="Feature"?a.geometry:a,y=p?p.coordinates:null,b=[],E=c&&c.pointToLayer,A=c&&c.coordsToLatLng||xf,B,V,J,ae;if(!y&&!p)return null;switch(p.type){case"Point":return B=A(y),Zv(E,a,B,c);case"MultiPoint":for(J=0,ae=y.length;J<ae;J++)B=A(y[J]),b.push(Zv(E,a,B,c));return new ai(b);case"LineString":case"MultiLineString":return V=oc(y,p.type==="LineString"?0:1,A),new li(V,c);case"Polygon":case"MultiPolygon":return V=oc(y,p.type==="Polygon"?1:2,A),new Ho(V,c);case"GeometryCollection":for(J=0,ae=p.geometries.length;J<ae;J++){var xe=sc({geometry:p.geometries[J],type:"Feature",properties:a.properties},c);xe&&b.push(xe)}return new ai(b);case"FeatureCollection":for(J=0,ae=p.features.length;J<ae;J++){var je=sc(p.features[J],c);je&&b.push(je)}return new ai(b);default:throw new Error("Invalid GeoJSON object.")}}function Zv(a,c,p,y){return a?a(c,p):new rc(p,y&&y.markersInheritOptions&&y)}function xf(a){return new te(a[1],a[0],a[2])}function oc(a,c,p){for(var y=[],b=0,E=a.length,A;b<E;b++)A=c?oc(a[b],c-1,p):(p||xf)(a[b]),y.push(A);return y}function Sf(a,c){return a=ee(a),a.alt!==void 0?[m(a.lng,c),m(a.lat,c),m(a.alt,c)]:[m(a.lng,c),m(a.lat,c)]}function ac(a,c,p,y){for(var b=[],E=0,A=a.length;E<A;E++)b.push(c?ac(a[E],sr(a[E])?0:c-1,p,y):Sf(a[E],y));return!c&&p&&b.length>0&&b.push(b[0].slice()),b}function qo(a,c){return a.feature?i({},a.feature,{geometry:c}):lc(c)}function lc(a){return a.type==="Feature"||a.type==="FeatureCollection"?a:{type:"Feature",properties:{},geometry:a}}var kf={toGeoJSON:function(a){return qo(this,{type:"Point",coordinates:Sf(this.getLatLng(),a)})}};rc.include(kf),bf.include(kf),ic.include(kf),li.include({toGeoJSON:function(a){var c=!sr(this._latlngs),p=ac(this._latlngs,c?1:0,!1,a);return qo(this,{type:(c?"Multi":"")+"LineString",coordinates:p})}}),Ho.include({toGeoJSON:function(a){var c=!sr(this._latlngs),p=c&&!sr(this._latlngs[0]),y=ac(this._latlngs,p?2:c?1:0,!0,a);return c||(y=[y]),qo(this,{type:(p?"Multi":"")+"Polygon",coordinates:y})}}),Uo.include({toMultiPoint:function(a){var c=[];return this.eachLayer(function(p){c.push(p.toGeoJSON(a).geometry.coordinates)}),qo(this,{type:"MultiPoint",coordinates:c})},toGeoJSON:function(a){var c=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(c==="MultiPoint")return this.toMultiPoint(a);var p=c==="GeometryCollection",y=[];return this.eachLayer(function(b){if(b.toGeoJSON){var E=b.toGeoJSON(a);if(p)y.push(E.geometry);else{var A=lc(E);A.type==="FeatureCollection"?y.push.apply(y,A.features):y.push(A)}}}),p?qo(this,{geometries:y,type:"GeometryCollection"}):{type:"FeatureCollection",features:y}}});function Qv(a,c){return new ui(a,c)}var yT=Qv,uc=Sr.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(a,c,p){this._url=a,this._bounds=re(c),v(this,p)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Le(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){We(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(a){return this.options.opacity=a,this._image&&this._updateOpacity(),this},setStyle:function(a){return a.opacity&&this.setOpacity(a.opacity),this},bringToFront:function(){return this._map&&Bi(this._image),this},bringToBack:function(){return this._map&&$o(this._image),this},setUrl:function(a){return this._url=a,this._image&&(this._image.src=a),this},setBounds:function(a){return this._bounds=re(a),this._map&&this._reset(),this},getEvents:function(){var a={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var a=this._url.tagName==="IMG",c=this._image=a?this._url:we("img");if(Le(c,"leaflet-image-layer"),this._zoomAnimated&&Le(c,"leaflet-zoom-animated"),this.options.className&&Le(c,this.options.className),c.onselectstart=f,c.onmousemove=f,c.onload=o(this.fire,this,"load"),c.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),a){this._url=c.src;return}c.src=this._url,c.alt=this.options.alt},_animateZoom:function(a){var c=this._map.getZoomScale(a.zoom),p=this._map._latLngBoundsToNewLayerBounds(this._bounds,a.zoom,a.center).min;Vs(this._image,p,c)},_reset:function(){var a=this._image,c=new $(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),p=c.getSize();vt(a,c.min),a.style.width=p.x+"px",a.style.height=p.y+"px"},_updateOpacity:function(){ir(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var a=this.options.errorOverlayUrl;a&&this._url!==a&&(this._url=a,this._image.src=a)},getCenter:function(){return this._bounds.getCenter()}}),vT=function(a,c,p){return new uc(a,c,p)},Gv=uc.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var a=this._url.tagName==="VIDEO",c=this._image=a?this._url:we("video");if(Le(c,"leaflet-image-layer"),this._zoomAnimated&&Le(c,"leaflet-zoom-animated"),this.options.className&&Le(c,this.options.className),c.onselectstart=f,c.onmousemove=f,c.onloadeddata=o(this.fire,this,"load"),a){for(var p=c.getElementsByTagName("source"),y=[],b=0;b<p.length;b++)y.push(p[b].src);this._url=p.length>0?y:[c.src];return}C(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(c.style,"objectFit")&&(c.style.objectFit="fill"),c.autoplay=!!this.options.autoplay,c.loop=!!this.options.loop,c.muted=!!this.options.muted,c.playsInline=!!this.options.playsInline;for(var E=0;E<this._url.length;E++){var A=we("source");A.src=this._url[E],c.appendChild(A)}}});function _T(a,c,p){return new Gv(a,c,p)}var Jv=uc.extend({_initImage:function(){var a=this._image=this._url;Le(a,"leaflet-image-layer"),this._zoomAnimated&&Le(a,"leaflet-zoom-animated"),this.options.className&&Le(a,this.options.className),a.onselectstart=f,a.onmousemove=f}});function wT(a,c,p){return new Jv(a,c,p)}var Fr=Sr.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(a,c){a&&(a instanceof te||C(a))?(this._latlng=ee(a),v(this,c)):(v(this,a),this._source=c),this.options.content&&(this._content=this.options.content)},openOn:function(a){return a=arguments.length?a:this._source._map,a.hasLayer(this)||a.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(a){return this._map?this.close():(arguments.length?this._source=a:a=this._source,this._prepareOpen(),this.openOn(a._map)),this},onAdd:function(a){this._zoomAnimated=a._zoomAnimated,this._container||this._initLayout(),a._fadeAnimated&&ir(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),a._fadeAnimated&&ir(this._container,1),this.bringToFront(),this.options.interactive&&(Le(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(a){a._fadeAnimated?(ir(this._container,0),this._removeTimeout=setTimeout(o(We,void 0,this._container),200)):We(this._container),this.options.interactive&&(pt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(a){return this._latlng=ee(a),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(a){return this._content=a,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var a={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Bi(this._container),this},bringToBack:function(){return this._map&&$o(this._container),this},_prepareOpen:function(a){var c=this._source;if(!c._map)return!1;if(c instanceof ai){c=null;var p=this._source._layers;for(var y in p)if(p[y]._map){c=p[y];break}if(!c)return!1;this._source=c}if(!a)if(c.getCenter)a=c.getCenter();else if(c.getLatLng)a=c.getLatLng();else if(c.getBounds)a=c.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(a),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var a=this._contentNode,c=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof c=="string")a.innerHTML=c;else{for(;a.hasChildNodes();)a.removeChild(a.firstChild);a.appendChild(c)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var a=this._map.latLngToLayerPoint(this._latlng),c=G(this.options.offset),p=this._getAnchor();this._zoomAnimated?vt(this._container,a.add(p)):c=c.add(a).add(p);var y=this._containerBottom=-c.y,b=this._containerLeft=-Math.round(this._containerWidth/2)+c.x;this._container.style.bottom=y+"px",this._container.style.left=b+"px"}},_getAnchor:function(){return[0,0]}});Ve.include({_initOverlay:function(a,c,p,y){var b=c;return b instanceof a||(b=new a(y).setContent(c)),p&&b.setLatLng(p),b}}),Sr.include({_initOverlay:function(a,c,p,y){var b=p;return b instanceof a?(v(b,y),b._source=this):(b=c&&!y?c:new a(y,this),b.setContent(p)),b}});var cc=Fr.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(a){return a=arguments.length?a:this._source._map,!a.hasLayer(this)&&a._popup&&a._popup.options.autoClose&&a.removeLayer(a._popup),a._popup=this,Fr.prototype.openOn.call(this,a)},onAdd:function(a){Fr.prototype.onAdd.call(this,a),a.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof $i||this._source.on("preclick",qs))},onRemove:function(a){Fr.prototype.onRemove.call(this,a),a.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof $i||this._source.off("preclick",qs))},getEvents:function(){var a=Fr.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(a.preclick=this.close),this.options.keepInView&&(a.moveend=this._adjustPan),a},_initLayout:function(){var a="leaflet-popup",c=this._container=we("div",a+" "+(this.options.className||"")+" leaflet-zoom-animated"),p=this._wrapper=we("div",a+"-content-wrapper",c);if(this._contentNode=we("div",a+"-content",p),al(c),ff(this._contentNode),Pe(c,"contextmenu",qs),this._tipContainer=we("div",a+"-tip-container",c),this._tip=we("div",a+"-tip",this._tipContainer),this.options.closeButton){var y=this._closeButton=we("a",a+"-close-button",c);y.setAttribute("role","button"),y.setAttribute("aria-label","Close popup"),y.href="#close",y.innerHTML='<span aria-hidden="true">&#215;</span>',Pe(y,"click",function(b){Qt(b),this.close()},this)}},_updateLayout:function(){var a=this._contentNode,c=a.style;c.width="",c.whiteSpace="nowrap";var p=a.offsetWidth;p=Math.min(p,this.options.maxWidth),p=Math.max(p,this.options.minWidth),c.width=p+1+"px",c.whiteSpace="",c.height="";var y=a.offsetHeight,b=this.options.maxHeight,E="leaflet-popup-scrolled";b&&y>b?(c.height=b+"px",Le(a,E)):pt(a,E),this._containerWidth=this._container.offsetWidth},_animateZoom:function(a){var c=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center),p=this._getAnchor();vt(this._container,c.add(p))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var a=this._map,c=parseInt(br(this._container,"marginBottom"),10)||0,p=this._container.offsetHeight+c,y=this._containerWidth,b=new H(this._containerLeft,-p-this._containerBottom);b._add(Hs(this._container));var E=a.layerPointToContainerPoint(b),A=G(this.options.autoPanPadding),B=G(this.options.autoPanPaddingTopLeft||A),V=G(this.options.autoPanPaddingBottomRight||A),J=a.getSize(),ae=0,xe=0;E.x+y+V.x>J.x&&(ae=E.x+y-J.x+V.x),E.x-ae-B.x<0&&(ae=E.x-B.x),E.y+p+V.y>J.y&&(xe=E.y+p-J.y+V.y),E.y-xe-B.y<0&&(xe=E.y-B.y),(ae||xe)&&(this.options.keepInView&&(this._autopanning=!0),a.fire("autopanstart").panBy([ae,xe]))}},_getAnchor:function(){return G(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),bT=function(a,c){return new cc(a,c)};Ve.mergeOptions({closePopupOnClick:!0}),Ve.include({openPopup:function(a,c,p){return this._initOverlay(cc,a,c,p).openOn(this),this},closePopup:function(a){return a=arguments.length?a:this._popup,a&&a.close(),this}}),Sr.include({bindPopup:function(a,c){return this._popup=this._initOverlay(cc,this._popup,a,c),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(a){return this._popup&&(this instanceof ai||(this._popup._source=this),this._popup._prepareOpen(a||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(a){return this._popup&&this._popup.setContent(a),this},getPopup:function(){return this._popup},_openPopup:function(a){if(!(!this._popup||!this._map)){Ws(a);var c=a.layer||a.target;if(this._popup._source===c&&!(c instanceof $i)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(a.latlng);return}this._popup._source=c,this.openPopup(a.latlng)}},_movePopup:function(a){this._popup.setLatLng(a.latlng)},_onKeyPress:function(a){a.originalEvent.keyCode===13&&this._openPopup(a)}});var dc=Fr.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(a){Fr.prototype.onAdd.call(this,a),this.setOpacity(this.options.opacity),a.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(a){Fr.prototype.onRemove.call(this,a),a.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var a=Fr.prototype.getEvents.call(this);return this.options.permanent||(a.preclick=this.close),a},_initLayout:function(){var a="leaflet-tooltip",c=a+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=we("div",c),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+u(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(a){var c,p,y=this._map,b=this._container,E=y.latLngToContainerPoint(y.getCenter()),A=y.layerPointToContainerPoint(a),B=this.options.direction,V=b.offsetWidth,J=b.offsetHeight,ae=G(this.options.offset),xe=this._getAnchor();B==="top"?(c=V/2,p=J):B==="bottom"?(c=V/2,p=0):B==="center"?(c=V/2,p=J/2):B==="right"?(c=0,p=J/2):B==="left"?(c=V,p=J/2):A.x<E.x?(B="right",c=0,p=J/2):(B="left",c=V+(ae.x+xe.x)*2,p=J/2),a=a.subtract(G(c,p,!0)).add(ae).add(xe),pt(b,"leaflet-tooltip-right"),pt(b,"leaflet-tooltip-left"),pt(b,"leaflet-tooltip-top"),pt(b,"leaflet-tooltip-bottom"),Le(b,"leaflet-tooltip-"+B),vt(b,a)},_updatePosition:function(){var a=this._map.latLngToLayerPoint(this._latlng);this._setPosition(a)},setOpacity:function(a){this.options.opacity=a,this._container&&ir(this._container,a)},_animateZoom:function(a){var c=this._map._latLngToNewLayerPoint(this._latlng,a.zoom,a.center);this._setPosition(c)},_getAnchor:function(){return G(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),xT=function(a,c){return new dc(a,c)};Ve.include({openTooltip:function(a,c,p){return this._initOverlay(dc,a,c,p).openOn(this),this},closeTooltip:function(a){return a.close(),this}}),Sr.include({bindTooltip:function(a,c){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(dc,this._tooltip,a,c),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(a){if(!(!a&&this._tooltipHandlersAdded)){var c=a?"off":"on",p={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?p.add=this._openTooltip:(p.mouseover=this._openTooltip,p.mouseout=this.closeTooltip,p.click=this._openTooltip,this._map?this._addFocusListeners():p.add=this._addFocusListeners),this._tooltip.options.sticky&&(p.mousemove=this._moveTooltip),this[c](p),this._tooltipHandlersAdded=!a}},openTooltip:function(a){return this._tooltip&&(this instanceof ai||(this._tooltip._source=this),this._tooltip._prepareOpen(a)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(a){return this._tooltip&&this._tooltip.setContent(a),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(a){var c=typeof a.getElement=="function"&&a.getElement();c&&(Pe(c,"focus",function(){this._tooltip._source=a,this.openTooltip()},this),Pe(c,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(a){var c=typeof a.getElement=="function"&&a.getElement();c&&c.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(a){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var c=this;this._map.once("moveend",function(){c._openOnceFlag=!1,c._openTooltip(a)});return}this._tooltip._source=a.layer||a.target,this.openTooltip(this._tooltip.options.sticky?a.latlng:void 0)}},_moveTooltip:function(a){var c=a.latlng,p,y;this._tooltip.options.sticky&&a.originalEvent&&(p=this._map.mouseEventToContainerPoint(a.originalEvent),y=this._map.containerPointToLayerPoint(p),c=this._map.layerPointToLatLng(y)),this._tooltip.setLatLng(c)}});var Yv=Vo.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(a){var c=a&&a.tagName==="DIV"?a:document.createElement("div"),p=this.options;if(p.html instanceof Element?(Us(c),c.appendChild(p.html)):c.innerHTML=p.html!==!1?p.html:"",p.bgPos){var y=G(p.bgPos);c.style.backgroundPosition=-y.x+"px "+-y.y+"px"}return this._setIconStyles(c,"icon"),c},createShadow:function(){return null}});function ST(a){return new Yv(a)}Vo.Default=cl;var dl=Sr.extend({options:{tileSize:256,opacity:1,updateWhenIdle:W.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(a){v(this,a)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(a){a._addZoomLimit(this)},onRemove:function(a){this._removeAllTiles(),We(this._container),a._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Bi(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&($o(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(a){return this.options.opacity=a,this._updateOpacity(),this},setZIndex:function(a){return this.options.zIndex=a,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var a=this._clampZoom(this._map.getZoom());a!==this._tileZoom&&(this._tileZoom=a,this._updateLevels()),this._update()}return this},getEvents:function(){var a={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d(this._onMoveEnd,this.options.updateInterval,this)),a.move=this._onMove),this._zoomAnimated&&(a.zoomanim=this._animateZoom),a},createTile:function(){return document.createElement("div")},getTileSize:function(){var a=this.options.tileSize;return a instanceof H?a:new H(a,a)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(a){for(var c=this.getPane().children,p=-a(-1/0,1/0),y=0,b=c.length,E;y<b;y++)E=c[y].style.zIndex,c[y]!==this._container&&E&&(p=a(p,+E));isFinite(p)&&(this.options.zIndex=p+a(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!W.ielt9){ir(this._container,this.options.opacity);var a=+new Date,c=!1,p=!1;for(var y in this._tiles){var b=this._tiles[y];if(!(!b.current||!b.loaded)){var E=Math.min(1,(a-b.loaded)/200);ir(b.el,E),E<1?c=!0:(b.active?p=!0:this._onOpaqueTile(b),b.active=!0)}}p&&!this._noPrune&&this._pruneTiles(),c&&(Z(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this))}},_onOpaqueTile:f,_initContainer:function(){this._container||(this._container=we("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var a=this._tileZoom,c=this.options.maxZoom;if(a!==void 0){for(var p in this._levels)p=Number(p),this._levels[p].el.children.length||p===a?(this._levels[p].el.style.zIndex=c-Math.abs(a-p),this._onUpdateLevel(p)):(We(this._levels[p].el),this._removeTilesAtZoom(p),this._onRemoveLevel(p),delete this._levels[p]);var y=this._levels[a],b=this._map;return y||(y=this._levels[a]={},y.el=we("div","leaflet-tile-container leaflet-zoom-animated",this._container),y.el.style.zIndex=c,y.origin=b.project(b.unproject(b.getPixelOrigin()),a).round(),y.zoom=a,this._setZoomTransform(y,b.getCenter(),b.getZoom()),f(y.el.offsetWidth),this._onCreateLevel(y)),this._level=y,y}},_onUpdateLevel:f,_onRemoveLevel:f,_onCreateLevel:f,_pruneTiles:function(){if(this._map){var a,c,p=this._map.getZoom();if(p>this.options.maxZoom||p<this.options.minZoom){this._removeAllTiles();return}for(a in this._tiles)c=this._tiles[a],c.retain=c.current;for(a in this._tiles)if(c=this._tiles[a],c.current&&!c.active){var y=c.coords;this._retainParent(y.x,y.y,y.z,y.z-5)||this._retainChildren(y.x,y.y,y.z,y.z+2)}for(a in this._tiles)this._tiles[a].retain||this._removeTile(a)}},_removeTilesAtZoom:function(a){for(var c in this._tiles)this._tiles[c].coords.z===a&&this._removeTile(c)},_removeAllTiles:function(){for(var a in this._tiles)this._removeTile(a)},_invalidateAll:function(){for(var a in this._levels)We(this._levels[a].el),this._onRemoveLevel(Number(a)),delete this._levels[a];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(a,c,p,y){var b=Math.floor(a/2),E=Math.floor(c/2),A=p-1,B=new H(+b,+E);B.z=+A;var V=this._tileCoordsToKey(B),J=this._tiles[V];return J&&J.active?(J.retain=!0,!0):(J&&J.loaded&&(J.retain=!0),A>y?this._retainParent(b,E,A,y):!1)},_retainChildren:function(a,c,p,y){for(var b=2*a;b<2*a+2;b++)for(var E=2*c;E<2*c+2;E++){var A=new H(b,E);A.z=p+1;var B=this._tileCoordsToKey(A),V=this._tiles[B];if(V&&V.active){V.retain=!0;continue}else V&&V.loaded&&(V.retain=!0);p+1<y&&this._retainChildren(b,E,p+1,y)}},_resetView:function(a){var c=a&&(a.pinch||a.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),c,c)},_animateZoom:function(a){this._setView(a.center,a.zoom,!0,a.noUpdate)},_clampZoom:function(a){var c=this.options;return c.minNativeZoom!==void 0&&a<c.minNativeZoom?c.minNativeZoom:c.maxNativeZoom!==void 0&&c.maxNativeZoom<a?c.maxNativeZoom:a},_setView:function(a,c,p,y){var b=Math.round(c);this.options.maxZoom!==void 0&&b>this.options.maxZoom||this.options.minZoom!==void 0&&b<this.options.minZoom?b=void 0:b=this._clampZoom(b);var E=this.options.updateWhenZooming&&b!==this._tileZoom;(!y||E)&&(this._tileZoom=b,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),b!==void 0&&this._update(a),p||this._pruneTiles(),this._noPrune=!!p),this._setZoomTransforms(a,c)},_setZoomTransforms:function(a,c){for(var p in this._levels)this._setZoomTransform(this._levels[p],a,c)},_setZoomTransform:function(a,c,p){var y=this._map.getZoomScale(p,a.zoom),b=a.origin.multiplyBy(y).subtract(this._map._getNewPixelOrigin(c,p)).round();W.any3d?Vs(a.el,b,y):vt(a.el,b)},_resetGrid:function(){var a=this._map,c=a.options.crs,p=this._tileSize=this.getTileSize(),y=this._tileZoom,b=this._map.getPixelWorldBounds(this._tileZoom);b&&(this._globalTileRange=this._pxBoundsToTileRange(b)),this._wrapX=c.wrapLng&&!this.options.noWrap&&[Math.floor(a.project([0,c.wrapLng[0]],y).x/p.x),Math.ceil(a.project([0,c.wrapLng[1]],y).x/p.y)],this._wrapY=c.wrapLat&&!this.options.noWrap&&[Math.floor(a.project([c.wrapLat[0],0],y).y/p.x),Math.ceil(a.project([c.wrapLat[1],0],y).y/p.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(a){var c=this._map,p=c._animatingZoom?Math.max(c._animateToZoom,c.getZoom()):c.getZoom(),y=c.getZoomScale(p,this._tileZoom),b=c.project(a,this._tileZoom).floor(),E=c.getSize().divideBy(y*2);return new $(b.subtract(E),b.add(E))},_update:function(a){var c=this._map;if(c){var p=this._clampZoom(c.getZoom());if(a===void 0&&(a=c.getCenter()),this._tileZoom!==void 0){var y=this._getTiledPixelBounds(a),b=this._pxBoundsToTileRange(y),E=b.getCenter(),A=[],B=this.options.keepBuffer,V=new $(b.getBottomLeft().subtract([B,-B]),b.getTopRight().add([B,-B]));if(!(isFinite(b.min.x)&&isFinite(b.min.y)&&isFinite(b.max.x)&&isFinite(b.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var J in this._tiles){var ae=this._tiles[J].coords;(ae.z!==this._tileZoom||!V.contains(new H(ae.x,ae.y)))&&(this._tiles[J].current=!1)}if(Math.abs(p-this._tileZoom)>1){this._setView(a,p);return}for(var xe=b.min.y;xe<=b.max.y;xe++)for(var je=b.min.x;je<=b.max.x;je++){var fn=new H(je,xe);if(fn.z=this._tileZoom,!!this._isValidTile(fn)){var jt=this._tiles[this._tileCoordsToKey(fn)];jt?jt.current=!0:A.push(fn)}}if(A.sort(function(On,Ko){return On.distanceTo(E)-Ko.distanceTo(E)}),A.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var or=document.createDocumentFragment();for(je=0;je<A.length;je++)this._addTile(A[je],or);this._level.el.appendChild(or)}}}},_isValidTile:function(a){var c=this._map.options.crs;if(!c.infinite){var p=this._globalTileRange;if(!c.wrapLng&&(a.x<p.min.x||a.x>p.max.x)||!c.wrapLat&&(a.y<p.min.y||a.y>p.max.y))return!1}if(!this.options.bounds)return!0;var y=this._tileCoordsToBounds(a);return re(this.options.bounds).overlaps(y)},_keyToBounds:function(a){return this._tileCoordsToBounds(this._keyToTileCoords(a))},_tileCoordsToNwSe:function(a){var c=this._map,p=this.getTileSize(),y=a.scaleBy(p),b=y.add(p),E=c.unproject(y,a.z),A=c.unproject(b,a.z);return[E,A]},_tileCoordsToBounds:function(a){var c=this._tileCoordsToNwSe(a),p=new ie(c[0],c[1]);return this.options.noWrap||(p=this._map.wrapLatLngBounds(p)),p},_tileCoordsToKey:function(a){return a.x+":"+a.y+":"+a.z},_keyToTileCoords:function(a){var c=a.split(":"),p=new H(+c[0],+c[1]);return p.z=+c[2],p},_removeTile:function(a){var c=this._tiles[a];c&&(We(c.el),delete this._tiles[a],this.fire("tileunload",{tile:c.el,coords:this._keyToTileCoords(a)}))},_initTile:function(a){Le(a,"leaflet-tile");var c=this.getTileSize();a.style.width=c.x+"px",a.style.height=c.y+"px",a.onselectstart=f,a.onmousemove=f,W.ielt9&&this.options.opacity<1&&ir(a,this.options.opacity)},_addTile:function(a,c){var p=this._getTilePos(a),y=this._tileCoordsToKey(a),b=this.createTile(this._wrapCoords(a),o(this._tileReady,this,a));this._initTile(b),this.createTile.length<2&&F(o(this._tileReady,this,a,null,b)),vt(b,p),this._tiles[y]={el:b,coords:a,current:!0},c.appendChild(b),this.fire("tileloadstart",{tile:b,coords:a})},_tileReady:function(a,c,p){c&&this.fire("tileerror",{error:c,tile:p,coords:a});var y=this._tileCoordsToKey(a);p=this._tiles[y],p&&(p.loaded=+new Date,this._map._fadeAnimated?(ir(p.el,0),Z(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this)):(p.active=!0,this._pruneTiles()),c||(Le(p.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:p.el,coords:a})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),W.ielt9||!this._map._fadeAnimated?F(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(a){return a.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(a){var c=new H(this._wrapX?h(a.x,this._wrapX):a.x,this._wrapY?h(a.y,this._wrapY):a.y);return c.z=a.z,c},_pxBoundsToTileRange:function(a){var c=this.getTileSize();return new $(a.min.unscaleBy(c).floor(),a.max.unscaleBy(c).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var a in this._tiles)if(!this._tiles[a].loaded)return!1;return!0}});function kT(a){return new dl(a)}var Wo=dl.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(a,c){this._url=a,c=v(this,c),c.detectRetina&&W.retina&&c.maxZoom>0?(c.tileSize=Math.floor(c.tileSize/2),c.zoomReverse?(c.zoomOffset--,c.minZoom=Math.min(c.maxZoom,c.minZoom+1)):(c.zoomOffset++,c.maxZoom=Math.max(c.minZoom,c.maxZoom-1)),c.minZoom=Math.max(0,c.minZoom)):c.zoomReverse?c.minZoom=Math.min(c.maxZoom,c.minZoom):c.maxZoom=Math.max(c.minZoom,c.maxZoom),typeof c.subdomains=="string"&&(c.subdomains=c.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(a,c){return this._url===a&&c===void 0&&(c=!0),this._url=a,c||this.redraw(),this},createTile:function(a,c){var p=document.createElement("img");return Pe(p,"load",o(this._tileOnLoad,this,c,p)),Pe(p,"error",o(this._tileOnError,this,c,p)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(p.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(p.referrerPolicy=this.options.referrerPolicy),p.alt="",p.src=this.getTileUrl(a),p},getTileUrl:function(a){var c={r:W.retina?"@2x":"",s:this._getSubdomain(a),x:a.x,y:a.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var p=this._globalTileRange.max.y-a.y;this.options.tms&&(c.y=p),c["-y"]=p}return k(this._url,i(c,this.options))},_tileOnLoad:function(a,c){W.ielt9?setTimeout(o(a,this,null,c),0):a(null,c)},_tileOnError:function(a,c,p){var y=this.options.errorTileUrl;y&&c.getAttribute("src")!==y&&(c.src=y),a(p,c)},_onTileRemove:function(a){a.tile.onload=null},_getZoomForUrl:function(){var a=this._tileZoom,c=this.options.maxZoom,p=this.options.zoomReverse,y=this.options.zoomOffset;return p&&(a=c-a),a+y},_getSubdomain:function(a){var c=Math.abs(a.x+a.y)%this.options.subdomains.length;return this.options.subdomains[c]},_abortLoading:function(){var a,c;for(a in this._tiles)if(this._tiles[a].coords.z!==this._tileZoom&&(c=this._tiles[a].el,c.onload=f,c.onerror=f,!c.complete)){c.src=N;var p=this._tiles[a].coords;We(c),delete this._tiles[a],this.fire("tileabort",{tile:c,coords:p})}},_removeTile:function(a){var c=this._tiles[a];if(c)return c.el.setAttribute("src",N),dl.prototype._removeTile.call(this,a)},_tileReady:function(a,c,p){if(!(!this._map||p&&p.getAttribute("src")===N))return dl.prototype._tileReady.call(this,a,c,p)}});function Xv(a,c){return new Wo(a,c)}var e_=Wo.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(a,c){this._url=a;var p=i({},this.defaultWmsParams);for(var y in c)y in this.options||(p[y]=c[y]);c=v(this,c);var b=c.detectRetina&&W.retina?2:1,E=this.getTileSize();p.width=E.x*b,p.height=E.y*b,this.wmsParams=p},onAdd:function(a){this._crs=this.options.crs||a.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var c=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[c]=this._crs.code,Wo.prototype.onAdd.call(this,a)},getTileUrl:function(a){var c=this._tileCoordsToNwSe(a),p=this._crs,y=K(p.project(c[0]),p.project(c[1])),b=y.min,E=y.max,A=(this._wmsVersion>=1.3&&this._crs===Wv?[b.y,b.x,E.y,E.x]:[b.x,b.y,E.x,E.y]).join(","),B=Wo.prototype.getTileUrl.call(this,a);return B+x(this.wmsParams,B,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+A},setParams:function(a,c){return i(this.wmsParams,a),c||this.redraw(),this}});function CT(a,c){return new e_(a,c)}Wo.WMS=e_,Xv.wms=CT;var ci=Sr.extend({options:{padding:.1},initialize:function(a){v(this,a),u(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Le(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var a={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(a.zoomanim=this._onAnimZoom),a},_onAnimZoom:function(a){this._updateTransform(a.center,a.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(a,c){var p=this._map.getZoomScale(c,this._zoom),y=this._map.getSize().multiplyBy(.5+this.options.padding),b=this._map.project(this._center,c),E=y.multiplyBy(-p).add(b).subtract(this._map._getNewPixelOrigin(a,c));W.any3d?Vs(this._container,E,p):vt(this._container,E)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var a in this._layers)this._layers[a]._reset()},_onZoomEnd:function(){for(var a in this._layers)this._layers[a]._project()},_updatePaths:function(){for(var a in this._layers)this._layers[a]._update()},_update:function(){var a=this.options.padding,c=this._map.getSize(),p=this._map.containerPointToLayerPoint(c.multiplyBy(-a)).round();this._bounds=new $(p,p.add(c.multiplyBy(1+a*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),t_=ci.extend({options:{tolerance:0},getEvents:function(){var a=ci.prototype.getEvents.call(this);return a.viewprereset=this._onViewPreReset,a},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ci.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var a=this._container=document.createElement("canvas");Pe(a,"mousemove",this._onMouseMove,this),Pe(a,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Pe(a,"mouseout",this._handleMouseOut,this),a._leaflet_disable_events=!0,this._ctx=a.getContext("2d")},_destroyContainer:function(){Z(this._redrawRequest),delete this._ctx,We(this._container),Je(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var a;this._redrawBounds=null;for(var c in this._layers)a=this._layers[c],a._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ci.prototype._update.call(this);var a=this._bounds,c=this._container,p=a.getSize(),y=W.retina?2:1;vt(c,a.min),c.width=y*p.x,c.height=y*p.y,c.style.width=p.x+"px",c.style.height=p.y+"px",W.retina&&this._ctx.scale(2,2),this._ctx.translate(-a.min.x,-a.min.y),this.fire("update")}},_reset:function(){ci.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(a){this._updateDashArray(a),this._layers[u(a)]=a;var c=a._order={layer:a,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=c),this._drawLast=c,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(a){this._requestRedraw(a)},_removePath:function(a){var c=a._order,p=c.next,y=c.prev;p?p.prev=y:this._drawLast=y,y?y.next=p:this._drawFirst=p,delete a._order,delete this._layers[u(a)],this._requestRedraw(a)},_updatePath:function(a){this._extendRedrawBounds(a),a._project(),a._update(),this._requestRedraw(a)},_updateStyle:function(a){this._updateDashArray(a),this._requestRedraw(a)},_updateDashArray:function(a){if(typeof a.options.dashArray=="string"){var c=a.options.dashArray.split(/[, ]+/),p=[],y,b;for(b=0;b<c.length;b++){if(y=Number(c[b]),isNaN(y))return;p.push(y)}a.options._dashArray=p}else a.options._dashArray=a.options.dashArray},_requestRedraw:function(a){this._map&&(this._extendRedrawBounds(a),this._redrawRequest=this._redrawRequest||F(this._redraw,this))},_extendRedrawBounds:function(a){if(a._pxBounds){var c=(a.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new $,this._redrawBounds.extend(a._pxBounds.min.subtract([c,c])),this._redrawBounds.extend(a._pxBounds.max.add([c,c]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var a=this._redrawBounds;if(a){var c=a.getSize();this._ctx.clearRect(a.min.x,a.min.y,c.x,c.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var a,c=this._redrawBounds;if(this._ctx.save(),c){var p=c.getSize();this._ctx.beginPath(),this._ctx.rect(c.min.x,c.min.y,p.x,p.y),this._ctx.clip()}this._drawing=!0;for(var y=this._drawFirst;y;y=y.next)a=y.layer,(!c||a._pxBounds&&a._pxBounds.intersects(c))&&a._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(a,c){if(this._drawing){var p,y,b,E,A=a._parts,B=A.length,V=this._ctx;if(B){for(V.beginPath(),p=0;p<B;p++){for(y=0,b=A[p].length;y<b;y++)E=A[p][y],V[y?"lineTo":"moveTo"](E.x,E.y);c&&V.closePath()}this._fillStroke(V,a)}}},_updateCircle:function(a){if(!(!this._drawing||a._empty())){var c=a._point,p=this._ctx,y=Math.max(Math.round(a._radius),1),b=(Math.max(Math.round(a._radiusY),1)||y)/y;b!==1&&(p.save(),p.scale(1,b)),p.beginPath(),p.arc(c.x,c.y/b,y,0,Math.PI*2,!1),b!==1&&p.restore(),this._fillStroke(p,a)}},_fillStroke:function(a,c){var p=c.options;p.fill&&(a.globalAlpha=p.fillOpacity,a.fillStyle=p.fillColor||p.color,a.fill(p.fillRule||"evenodd")),p.stroke&&p.weight!==0&&(a.setLineDash&&a.setLineDash(c.options&&c.options._dashArray||[]),a.globalAlpha=p.opacity,a.lineWidth=p.weight,a.strokeStyle=p.color,a.lineCap=p.lineCap,a.lineJoin=p.lineJoin,a.stroke())},_onClick:function(a){for(var c=this._map.mouseEventToLayerPoint(a),p,y,b=this._drawFirst;b;b=b.next)p=b.layer,p.options.interactive&&p._containsPoint(c)&&(!(a.type==="click"||a.type==="preclick")||!this._map._draggableMoved(p))&&(y=p);this._fireEvent(y?[y]:!1,a)},_onMouseMove:function(a){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var c=this._map.mouseEventToLayerPoint(a);this._handleMouseHover(a,c)}},_handleMouseOut:function(a){var c=this._hoveredLayer;c&&(pt(this._container,"leaflet-interactive"),this._fireEvent([c],a,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(a,c){if(!this._mouseHoverThrottled){for(var p,y,b=this._drawFirst;b;b=b.next)p=b.layer,p.options.interactive&&p._containsPoint(c)&&(y=p);y!==this._hoveredLayer&&(this._handleMouseOut(a),y&&(Le(this._container,"leaflet-interactive"),this._fireEvent([y],a,"mouseover"),this._hoveredLayer=y)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,a),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(a,c,p){this._map._fireDOMEvent(c,p||c.type,a)},_bringToFront:function(a){var c=a._order;if(c){var p=c.next,y=c.prev;if(p)p.prev=y;else return;y?y.next=p:p&&(this._drawFirst=p),c.prev=this._drawLast,this._drawLast.next=c,c.next=null,this._drawLast=c,this._requestRedraw(a)}},_bringToBack:function(a){var c=a._order;if(c){var p=c.next,y=c.prev;if(y)y.next=p;else return;p?p.prev=y:y&&(this._drawLast=y),c.prev=null,c.next=this._drawFirst,this._drawFirst.prev=c,this._drawFirst=c,this._requestRedraw(a)}}});function n_(a){return W.canvas?new t_(a):null}var hl=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(a){return document.createElement("<lvml:"+a+' class="lvml">')}}catch{}return function(a){return document.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),ET={_initContainer:function(){this._container=we("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ci.prototype._update.call(this),this.fire("update"))},_initPath:function(a){var c=a._container=hl("shape");Le(c,"leaflet-vml-shape "+(this.options.className||"")),c.coordsize="1 1",a._path=hl("path"),c.appendChild(a._path),this._updateStyle(a),this._layers[u(a)]=a},_addPath:function(a){var c=a._container;this._container.appendChild(c),a.options.interactive&&a.addInteractiveTarget(c)},_removePath:function(a){var c=a._container;We(c),a.removeInteractiveTarget(c),delete this._layers[u(a)]},_updateStyle:function(a){var c=a._stroke,p=a._fill,y=a.options,b=a._container;b.stroked=!!y.stroke,b.filled=!!y.fill,y.stroke?(c||(c=a._stroke=hl("stroke")),b.appendChild(c),c.weight=y.weight+"px",c.color=y.color,c.opacity=y.opacity,y.dashArray?c.dashStyle=C(y.dashArray)?y.dashArray.join(" "):y.dashArray.replace(/( *, *)/g," "):c.dashStyle="",c.endcap=y.lineCap.replace("butt","flat"),c.joinstyle=y.lineJoin):c&&(b.removeChild(c),a._stroke=null),y.fill?(p||(p=a._fill=hl("fill")),b.appendChild(p),p.color=y.fillColor||y.color,p.opacity=y.fillOpacity):p&&(b.removeChild(p),a._fill=null)},_updateCircle:function(a){var c=a._point.round(),p=Math.round(a._radius),y=Math.round(a._radiusY||p);this._setPath(a,a._empty()?"M0 0":"AL "+c.x+","+c.y+" "+p+","+y+" 0,"+65535*360)},_setPath:function(a,c){a._path.v=c},_bringToFront:function(a){Bi(a._container)},_bringToBack:function(a){$o(a._container)}},hc=W.vml?hl:Tn,fl=ci.extend({_initContainer:function(){this._container=hc("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=hc("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){We(this._container),Je(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ci.prototype._update.call(this);var a=this._bounds,c=a.getSize(),p=this._container;(!this._svgSize||!this._svgSize.equals(c))&&(this._svgSize=c,p.setAttribute("width",c.x),p.setAttribute("height",c.y)),vt(p,a.min),p.setAttribute("viewBox",[a.min.x,a.min.y,c.x,c.y].join(" ")),this.fire("update")}},_initPath:function(a){var c=a._path=hc("path");a.options.className&&Le(c,a.options.className),a.options.interactive&&Le(c,"leaflet-interactive"),this._updateStyle(a),this._layers[u(a)]=a},_addPath:function(a){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(a._path),a.addInteractiveTarget(a._path)},_removePath:function(a){We(a._path),a.removeInteractiveTarget(a._path),delete this._layers[u(a)]},_updatePath:function(a){a._project(),a._update()},_updateStyle:function(a){var c=a._path,p=a.options;c&&(p.stroke?(c.setAttribute("stroke",p.color),c.setAttribute("stroke-opacity",p.opacity),c.setAttribute("stroke-width",p.weight),c.setAttribute("stroke-linecap",p.lineCap),c.setAttribute("stroke-linejoin",p.lineJoin),p.dashArray?c.setAttribute("stroke-dasharray",p.dashArray):c.removeAttribute("stroke-dasharray"),p.dashOffset?c.setAttribute("stroke-dashoffset",p.dashOffset):c.removeAttribute("stroke-dashoffset")):c.setAttribute("stroke","none"),p.fill?(c.setAttribute("fill",p.fillColor||p.color),c.setAttribute("fill-opacity",p.fillOpacity),c.setAttribute("fill-rule",p.fillRule||"evenodd")):c.setAttribute("fill","none"))},_updatePoly:function(a,c){this._setPath(a,kt(a._parts,c))},_updateCircle:function(a){var c=a._point,p=Math.max(Math.round(a._radius),1),y=Math.max(Math.round(a._radiusY),1)||p,b="a"+p+","+y+" 0 1,0 ",E=a._empty()?"M0 0":"M"+(c.x-p)+","+c.y+b+p*2+",0 "+b+-p*2+",0 ";this._setPath(a,E)},_setPath:function(a,c){a._path.setAttribute("d",c)},_bringToFront:function(a){Bi(a._path)},_bringToBack:function(a){$o(a._path)}});W.vml&&fl.include(ET);function r_(a){return W.svg||W.vml?new fl(a):null}Ve.include({getRenderer:function(a){var c=a.options.renderer||this._getPaneRenderer(a.options.pane)||this.options.renderer||this._renderer;return c||(c=this._renderer=this._createRenderer()),this.hasLayer(c)||this.addLayer(c),c},_getPaneRenderer:function(a){if(a==="overlayPane"||a===void 0)return!1;var c=this._paneRenderers[a];return c===void 0&&(c=this._createRenderer({pane:a}),this._paneRenderers[a]=c),c},_createRenderer:function(a){return this.options.preferCanvas&&n_(a)||r_(a)}});var i_=Ho.extend({initialize:function(a,c){Ho.prototype.initialize.call(this,this._boundsToLatLngs(a),c)},setBounds:function(a){return this.setLatLngs(this._boundsToLatLngs(a))},_boundsToLatLngs:function(a){return a=re(a),[a.getSouthWest(),a.getNorthWest(),a.getNorthEast(),a.getSouthEast()]}});function TT(a,c){return new i_(a,c)}fl.create=hc,fl.pointsToPath=kt,ui.geometryToLayer=sc,ui.coordsToLatLng=xf,ui.coordsToLatLngs=oc,ui.latLngToCoords=Sf,ui.latLngsToCoords=ac,ui.getFeature=qo,ui.asFeature=lc,Ve.mergeOptions({boxZoom:!0});var s_=Br.extend({initialize:function(a){this._map=a,this._container=a._container,this._pane=a._panes.overlayPane,this._resetStateTimeout=0,a.on("unload",this._destroy,this)},addHooks:function(){Pe(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Je(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){We(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(a){if(!a.shiftKey||a.which!==1&&a.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),il(),sf(),this._startPoint=this._map.mouseEventToContainerPoint(a),Pe(document,{contextmenu:Ws,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(a){this._moved||(this._moved=!0,this._box=we("div","leaflet-zoom-box",this._container),Le(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(a);var c=new $(this._point,this._startPoint),p=c.getSize();vt(this._box,c.min),this._box.style.width=p.x+"px",this._box.style.height=p.y+"px"},_finish:function(){this._moved&&(We(this._box),pt(this._container,"leaflet-crosshair")),sl(),of(),Je(document,{contextmenu:Ws,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(a){if(!(a.which!==1&&a.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var c=new ie(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(c).fire("boxzoomend",{boxZoomBounds:c})}},_onKeyDown:function(a){a.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ve.addInitHook("addHandler","boxZoom",s_),Ve.mergeOptions({doubleClickZoom:!0});var o_=Br.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(a){var c=this._map,p=c.getZoom(),y=c.options.zoomDelta,b=a.originalEvent.shiftKey?p-y:p+y;c.options.doubleClickZoom==="center"?c.setZoom(b):c.setZoomAround(a.containerPoint,b)}});Ve.addInitHook("addHandler","doubleClickZoom",o_),Ve.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var a_=Br.extend({addHooks:function(){if(!this._draggable){var a=this._map;this._draggable=new Fi(a._mapPane,a._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),a.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),a.on("zoomend",this._onZoomEnd,this),a.whenReady(this._onZoomEnd,this))}Le(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){pt(this._map._container,"leaflet-grab"),pt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var a=this._map;if(a._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var c=re(this._map.options.maxBounds);this._offsetLimit=K(this._map.latLngToContainerPoint(c.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(c.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;a.fire("movestart").fire("dragstart"),a.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(a){if(this._map.options.inertia){var c=this._lastTime=+new Date,p=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(p),this._times.push(c),this._prunePositions(c)}this._map.fire("move",a).fire("drag",a)},_prunePositions:function(a){for(;this._positions.length>1&&a-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var a=this._map.getSize().divideBy(2),c=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=c.subtract(a).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(a,c){return a-(a-c)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var a=this._draggable._newPos.subtract(this._draggable._startPos),c=this._offsetLimit;a.x<c.min.x&&(a.x=this._viscousLimit(a.x,c.min.x)),a.y<c.min.y&&(a.y=this._viscousLimit(a.y,c.min.y)),a.x>c.max.x&&(a.x=this._viscousLimit(a.x,c.max.x)),a.y>c.max.y&&(a.y=this._viscousLimit(a.y,c.max.y)),this._draggable._newPos=this._draggable._startPos.add(a)}},_onPreDragWrap:function(){var a=this._worldWidth,c=Math.round(a/2),p=this._initialWorldOffset,y=this._draggable._newPos.x,b=(y-c+p)%a+c-p,E=(y+c+p)%a-c-p,A=Math.abs(b+p)<Math.abs(E+p)?b:E;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=A},_onDragEnd:function(a){var c=this._map,p=c.options,y=!p.inertia||a.noInertia||this._times.length<2;if(c.fire("dragend",a),y)c.fire("moveend");else{this._prunePositions(+new Date);var b=this._lastPos.subtract(this._positions[0]),E=(this._lastTime-this._times[0])/1e3,A=p.easeLinearity,B=b.multiplyBy(A/E),V=B.distanceTo([0,0]),J=Math.min(p.inertiaMaxSpeed,V),ae=B.multiplyBy(J/V),xe=J/(p.inertiaDeceleration*A),je=ae.multiplyBy(-xe/2).round();!je.x&&!je.y?c.fire("moveend"):(je=c._limitOffset(je,c.options.maxBounds),F(function(){c.panBy(je,{duration:xe,easeLinearity:A,noMoveStart:!0,animate:!0})}))}}});Ve.addInitHook("addHandler","dragging",a_),Ve.mergeOptions({keyboard:!0,keyboardPanDelta:80});var l_=Br.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(a){this._map=a,this._setPanDelta(a.options.keyboardPanDelta),this._setZoomDelta(a.options.zoomDelta)},addHooks:function(){var a=this._map._container;a.tabIndex<=0&&(a.tabIndex="0"),Pe(a,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Je(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var a=document.body,c=document.documentElement,p=a.scrollTop||c.scrollTop,y=a.scrollLeft||c.scrollLeft;this._map._container.focus(),window.scrollTo(y,p)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(a){var c=this._panKeys={},p=this.keyCodes,y,b;for(y=0,b=p.left.length;y<b;y++)c[p.left[y]]=[-1*a,0];for(y=0,b=p.right.length;y<b;y++)c[p.right[y]]=[a,0];for(y=0,b=p.down.length;y<b;y++)c[p.down[y]]=[0,a];for(y=0,b=p.up.length;y<b;y++)c[p.up[y]]=[0,-1*a]},_setZoomDelta:function(a){var c=this._zoomKeys={},p=this.keyCodes,y,b;for(y=0,b=p.zoomIn.length;y<b;y++)c[p.zoomIn[y]]=a;for(y=0,b=p.zoomOut.length;y<b;y++)c[p.zoomOut[y]]=-a},_addHooks:function(){Pe(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Je(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(a){if(!(a.altKey||a.ctrlKey||a.metaKey)){var c=a.keyCode,p=this._map,y;if(c in this._panKeys){if(!p._panAnim||!p._panAnim._inProgress)if(y=this._panKeys[c],a.shiftKey&&(y=G(y).multiplyBy(3)),p.options.maxBounds&&(y=p._limitOffset(G(y),p.options.maxBounds)),p.options.worldCopyJump){var b=p.wrapLatLng(p.unproject(p.project(p.getCenter()).add(y)));p.panTo(b)}else p.panBy(y)}else if(c in this._zoomKeys)p.setZoom(p.getZoom()+(a.shiftKey?3:1)*this._zoomKeys[c]);else if(c===27&&p._popup&&p._popup.options.closeOnEscapeKey)p.closePopup();else return;Ws(a)}}});Ve.addInitHook("addHandler","keyboard",l_),Ve.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var u_=Br.extend({addHooks:function(){Pe(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Je(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(a){var c=Rv(a),p=this._map.options.wheelDebounceTime;this._delta+=c,this._lastMousePos=this._map.mouseEventToContainerPoint(a),this._startTime||(this._startTime=+new Date);var y=Math.max(p-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),y),Ws(a)},_performZoom:function(){var a=this._map,c=a.getZoom(),p=this._map.options.zoomSnap||0;a._stop();var y=this._delta/(this._map.options.wheelPxPerZoomLevel*4),b=4*Math.log(2/(1+Math.exp(-Math.abs(y))))/Math.LN2,E=p?Math.ceil(b/p)*p:b,A=a._limitZoom(c+(this._delta>0?E:-E))-c;this._delta=0,this._startTime=null,A&&(a.options.scrollWheelZoom==="center"?a.setZoom(c+A):a.setZoomAround(this._lastMousePos,c+A))}});Ve.addInitHook("addHandler","scrollWheelZoom",u_);var PT=600;Ve.mergeOptions({tapHold:W.touchNative&&W.safari&&W.mobile,tapTolerance:15});var c_=Br.extend({addHooks:function(){Pe(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Je(this._map._container,"touchstart",this._onDown,this)},_onDown:function(a){if(clearTimeout(this._holdTimeout),a.touches.length===1){var c=a.touches[0];this._startPos=this._newPos=new H(c.clientX,c.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(Pe(document,"touchend",Qt),Pe(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",c))},this),PT),Pe(document,"touchend touchcancel contextmenu",this._cancel,this),Pe(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function a(){Je(document,"touchend",Qt),Je(document,"touchend touchcancel",a)},_cancel:function(){clearTimeout(this._holdTimeout),Je(document,"touchend touchcancel contextmenu",this._cancel,this),Je(document,"touchmove",this._onMove,this)},_onMove:function(a){var c=a.touches[0];this._newPos=new H(c.clientX,c.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(a,c){var p=new MouseEvent(a,{bubbles:!0,cancelable:!0,view:window,screenX:c.screenX,screenY:c.screenY,clientX:c.clientX,clientY:c.clientY});p._simulated=!0,c.target.dispatchEvent(p)}});Ve.addInitHook("addHandler","tapHold",c_),Ve.mergeOptions({touchZoom:W.touch,bounceAtZoomLimits:!0});var d_=Br.extend({addHooks:function(){Le(this._map._container,"leaflet-touch-zoom"),Pe(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){pt(this._map._container,"leaflet-touch-zoom"),Je(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(a){var c=this._map;if(!(!a.touches||a.touches.length!==2||c._animatingZoom||this._zooming)){var p=c.mouseEventToContainerPoint(a.touches[0]),y=c.mouseEventToContainerPoint(a.touches[1]);this._centerPoint=c.getSize()._divideBy(2),this._startLatLng=c.containerPointToLatLng(this._centerPoint),c.options.touchZoom!=="center"&&(this._pinchStartLatLng=c.containerPointToLatLng(p.add(y)._divideBy(2))),this._startDist=p.distanceTo(y),this._startZoom=c.getZoom(),this._moved=!1,this._zooming=!0,c._stop(),Pe(document,"touchmove",this._onTouchMove,this),Pe(document,"touchend touchcancel",this._onTouchEnd,this),Qt(a)}},_onTouchMove:function(a){if(!(!a.touches||a.touches.length!==2||!this._zooming)){var c=this._map,p=c.mouseEventToContainerPoint(a.touches[0]),y=c.mouseEventToContainerPoint(a.touches[1]),b=p.distanceTo(y)/this._startDist;if(this._zoom=c.getScaleZoom(b,this._startZoom),!c.options.bounceAtZoomLimits&&(this._zoom<c.getMinZoom()&&b<1||this._zoom>c.getMaxZoom()&&b>1)&&(this._zoom=c._limitZoom(this._zoom)),c.options.touchZoom==="center"){if(this._center=this._startLatLng,b===1)return}else{var E=p._add(y)._divideBy(2)._subtract(this._centerPoint);if(b===1&&E.x===0&&E.y===0)return;this._center=c.unproject(c.project(this._pinchStartLatLng,this._zoom).subtract(E),this._zoom)}this._moved||(c._moveStart(!0,!1),this._moved=!0),Z(this._animRequest);var A=o(c._move,c,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=F(A,this,!0),Qt(a)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Z(this._animRequest),Je(document,"touchmove",this._onTouchMove,this),Je(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ve.addInitHook("addHandler","touchZoom",d_),Ve.BoxZoom=s_,Ve.DoubleClickZoom=o_,Ve.Drag=a_,Ve.Keyboard=l_,Ve.ScrollWheelZoom=u_,Ve.TapHold=c_,Ve.TouchZoom=d_,n.Bounds=$,n.Browser=W,n.CRS=Se,n.Canvas=t_,n.Circle=bf,n.CircleMarker=ic,n.Class=oe,n.Control=xr,n.DivIcon=Yv,n.DivOverlay=Fr,n.DomEvent=WE,n.DomUtil=HE,n.Draggable=Fi,n.Evented=Te,n.FeatureGroup=ai,n.GeoJSON=ui,n.GridLayer=dl,n.Handler=Br,n.Icon=Vo,n.ImageOverlay=uc,n.LatLng=te,n.LatLngBounds=ie,n.Layer=Sr,n.LayerGroup=Uo,n.LineUtil=sT,n.Map=Ve,n.Marker=rc,n.Mixin=XE,n.Path=$i,n.Point=H,n.PolyUtil=eT,n.Polygon=Ho,n.Polyline=li,n.Popup=cc,n.PosAnimation=Dv,n.Projection=oT,n.Rectangle=i_,n.Renderer=ci,n.SVG=fl,n.SVGOverlay=Jv,n.TileLayer=Wo,n.Tooltip=dc,n.Transformation=et,n.Util=se,n.VideoOverlay=Gv,n.bind=o,n.bounds=K,n.canvas=n_,n.circle=pT,n.circleMarker=fT,n.control=ll,n.divIcon=ST,n.extend=i,n.featureGroup=cT,n.geoJSON=Qv,n.geoJson=yT,n.gridLayer=kT,n.icon=dT,n.imageOverlay=vT,n.latLng=ee,n.latLngBounds=re,n.layerGroup=uT,n.map=KE,n.marker=hT,n.point=G,n.polygon=gT,n.polyline=mT,n.popup=bT,n.rectangle=TT,n.setOptions=v,n.stamp=u,n.svg=r_,n.svgOverlay=wT,n.tileLayer=Xv,n.tooltip=xT,n.transformation=De,n.version=r,n.videoOverlay=_T;var MT=window.L;n.noConflict=function(){return window.L=MT,this},window.L=n})})(Tg,Tg.exports);var Ju=Tg.exports;const B3=Ng(Ju);function Tv(t,e,n){return Object.freeze({instance:t,context:e,container:n})}function Pv(t,e){return e==null?function(r,i){const s=M.useRef();return s.current||(s.current=t(r,i)),s}:function(r,i){const s=M.useRef();s.current||(s.current=t(r,i));const o=M.useRef(r),{instance:l}=s.current;return M.useEffect(function(){o.current!==r&&(e(l,r,o.current),o.current=r)},[l,r,i]),s}}function F3(t,e){M.useEffect(function(){return(e.layerContainer??e.map).addLayer(t.instance),function(){e.layerContainer?.removeLayer(t.instance),e.map.removeLayer(t.instance)}},[e,t])}function jE(t){return function(n){const r=Cv(),i=t(Ev(n,r),r);return RE(r.map,n.attribution),IE(i.current,n.eventHandlers),F3(i.current,r),i}}function $3(t,e){const n=Pv(t,e),r=jE(n);return A3(r)}function U3(t,e){const n=Pv(t),r=z3(n,e);return I3(r)}function V3(t,e){const n=Pv(t,e),r=jE(n);return j3(r)}function H3(t,e,n){const{opacity:r,zIndex:i}=e;r!=null&&r!==n.opacity&&t.setOpacity(r),i!=null&&i!==n.zIndex&&t.setZIndex(i)}function zE(){return Cv().map}function q3(t){const e=zE();return M.useEffect(function(){return e.on(t),function(){e.off(t)}},[e,t]),e}function Pg(){return Pg=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Pg.apply(this,arguments)}function W3({bounds:t,boundsOptions:e,center:n,children:r,className:i,id:s,placeholder:o,style:l,whenReady:u,zoom:d,...h},f){const[m]=M.useState({className:i,id:s,style:l}),[g,_]=M.useState(null);M.useImperativeHandle(f,()=>g?.map??null,[g]);const v=M.useCallback(S=>{if(S!==null&&g===null){const k=new Ju.Map(S,h);n!=null&&d!=null?k.setView(n,d):t!=null&&k.fitBounds(t,e),u!=null&&k.whenReady(u),_(R3(k))}},[]);M.useEffect(()=>()=>{g?.map.remove()},[g]);const x=g?q.createElement(AE,{value:g},r):o??null;return q.createElement("div",Pg({},m,{ref:v}),x)}const BE=M.forwardRef(W3),Mg=$3(function({position:e,...n},r){const i=new Ju.Marker(e,n);return Tv(i,D3(r,{overlayContainer:i}))},function(e,n,r){n.position!==r.position&&e.setLatLng(n.position),n.icon!=null&&n.icon!==r.icon&&e.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==r.zIndexOffset&&e.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==r.opacity&&e.setOpacity(n.opacity),e.dragging!=null&&n.draggable!==r.draggable&&(n.draggable===!0?e.dragging.enable():e.dragging.disable())}),K3=U3(function(e,n){const r=new Ju.Popup(e,n.overlayContainer);return Tv(r,n)},function(e,n,{position:r},i){M.useEffect(function(){const{instance:o}=e;function l(d){d.popup===o&&(o.update(),i(!0))}function u(d){d.popup===o&&i(!1)}return n.map.on({popupopen:l,popupclose:u}),n.overlayContainer==null?(r!=null&&o.setLatLng(r),o.openOn(n.map)):n.overlayContainer.bindPopup(o),function(){n.map.off({popupopen:l,popupclose:u}),n.overlayContainer?.unbindPopup(),n.map.removeLayer(o)}},[e,n,i,r])}),FE=V3(function({url:e,...n},r){const i=new Ju.TileLayer(e,Ev(n,r));return Tv(i,r)},function(e,n,r){H3(e,n,r);const{url:i}=n;i!=null&&i!==r.url&&e.setUrl(i)});function $E(t,e,n=1){const r=new URLSearchParams;r.set("format","json"),r.set("q",t),r.set("addressdetails","1"),r.set("limit",String(e?.limit??n)),e?.countryCodes&&r.set("countrycodes",e.countryCodes);let i=e?.bbox,s=!1;if(!i&&e?.biasCenter){const o=Math.max(.05,Math.min(2,e.biasCenter.radiusDeg??.5)),l=e.biasCenter.lat-o,u=e.biasCenter.lat+o,d=e.biasCenter.lng-o,h=e.biasCenter.lng+o;i=[l,d,u,h],s=!0}return i&&(r.set("viewbox",`${i[1]},${i[0]},${i[3]},${i[2]}`),s||r.set("bounded","1")),r.toString()}async function Z3(t,e){if(!t.trim())return null;const r=`https://nominatim.openstreetmap.org/search?${$E(t,{countryCodes:"us",...e},1)}`;console.log("Geocoding URL:",r);try{const i=await fetch(r,{headers:{"Accept-Language":"en"}});if(console.log("Geocoding response status:",i.status),!i.ok)return console.error("Geocoding response not ok:",i.statusText),null;const s=await i.json();if(console.log("Geocoding response data:",s),!s?.length)return console.log("No geocoding results found"),null;const o=s[0],l={lat:parseFloat(o.lat),lng:parseFloat(o.lon),label:o.display_name};return console.log("Geocoding result:",l),l}catch(i){return console.error("Geocoding fetch error:",i),null}}async function Q3(t,e=5,n){const r=t.trim();if(!r)return[];const s=`https://nominatim.openstreetmap.org/search?${$E(r,{countryCodes:"us",limit:e,...n},e)}`;console.log("Search geocoding URL:",s);const o=await fetch(s,{headers:{"Accept-Language":"en"}});return o.ok?(await o.json()||[]).map(u=>({lat:parseFloat(u.lat),lng:parseFloat(u.lon),label:u.display_name})):[]}async function G3(t,e){const n=`https://nominatim.openstreetmap.org/reverse?format=json&lat=${encodeURIComponent(t)}&lon=${encodeURIComponent(e)}&zoom=18&addressdetails=1`,r=await fetch(n,{headers:{"Accept-Language":"en"}});return r.ok?(await r.json())?.display_name??null:null}function J3({onClick:t}){return q3({click(e){t(e.latlng.lat,e.latlng.lng)}}),null}function Y3({cardId:t,boardId:e,lat:n,lng:r,address:i,title:s}){const o=nn(),l=[39.5296,-119.8138],u=St({queryKey:["board-locs",e],queryFn:()=>Jy(e),enabled:!!e}),[d,h]=q.useState(!1),f=Pi({mutationFn:j=>(console.log("LocationBlock: Mutation called with payload:",j),V1(t,j)),onSuccess:async j=>{if(j?.skippedDueToMissingColumns){h(!0),console.warn("LocationBlock: Save skipped because location columns are missing in DB.");return}console.log("LocationBlock: Mutation successful:",j),await o.invalidateQueries({predicate:O=>Array.isArray(O.queryKey)&&(O.queryKey.includes("card")||O.queryKey.includes("cards")||O.queryKey[0]==="board-locs")})},onError:j=>{console.error("LocationBlock: Mutation error:",j)}}),m=q.useRef(null),[g,_]=q.useState(i??""),[v,x]=q.useState(!1),[S,k]=q.useState([]),[C,R]=q.useState(typeof n=="number"&&typeof r=="number"?{lat:n,lng:r}:null),N=q.useRef(i??""),P=q.useRef({lat:n??null,lng:r??null});q.useEffect(()=>{_(i??""),N.current=i??""},[i]),q.useEffect(()=>{R(typeof n=="number"&&typeof r=="number"?{lat:n,lng:r}:null),P.current={lat:n??null,lng:r??null}},[n,r]);function T({points:j}){const O=zE();return q.useEffect(()=>{if(j.length)if(j.length===1)O.setView([j[0].lat,j[0].lng],Math.max(O.getZoom(),14));else{const F=B3.latLngBounds(j.map(Z=>[Z.lat,Z.lng]));O.fitBounds(F,{padding:[24,24],maxZoom:14,animate:!0})}},[j,O]),null}async function D(){const j=g.trim();if(console.log("LocationBlock: commitFromState called with query:",j),!j){const O=(N.current||"").trim().length>0,F=typeof P.current.lat=="number"||typeof P.current.lng=="number";(O||F)&&(console.log("LocationBlock: Clearing location"),R(null),f.mutate({address:null,lat:null,lng:null}));return}if(C){console.log("LocationBlock: Updating address for existing pin:",{address:j,lat:C.lat,lng:C.lng}),f.mutate({address:j,lat:C.lat,lng:C.lng});return}console.log("LocationBlock: Geocoding address:",j);try{const O=(u.data||[]).filter(se=>typeof se.lat=="number"&&typeof se.lng=="number"),F=C?{biasCenter:{lat:C.lat,lng:C.lng,radiusDeg:.6}}:O.length?{biasCenter:{lat:O[0].lat,lng:O[0].lng,radiusDeg:1}}:void 0,Z=await Z3(j,F);Z?(console.log("LocationBlock: Geocoding successful:",Z),R({lat:Z.lat,lng:Z.lng}),f.mutate({lat:Z.lat,lng:Z.lng,address:j})):(console.log("LocationBlock: Geocoding failed, saving address only"),f.mutate({address:j}))}catch(O){console.error("LocationBlock: Geocoding error:",O),f.mutate({address:j})}}return q.useEffect(()=>()=>{D()},[g,C]),w.jsxs("div",{className:"space-y-2",children:[w.jsxs("div",{className:"relative text-sm",children:[w.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[w.jsx("span",{className:"text-xs font-medium text-fg-muted",children:" Card Location"}),C&&w.jsx("span",{className:"text-xs text-green-600 bg-green-100 px-2 py-0.5 rounded",children:"Located"})]}),w.jsx("input",{className:"w-full rounded border border-app bg-surface-2 px-3 py-2 placeholder-fg-muted/60",placeholder:"Enter address or location...",value:g,onChange:j=>{const O=j.target.value;_(O),m.current&&window.clearTimeout(m.current),m.current=window.setTimeout(async()=>{const F=O.trim();if(!F){k([]),x(!1),R(null);return}const Z=(u.data||[]).filter(ye=>typeof ye.lat=="number"&&typeof ye.lng=="number"),se=C?{biasCenter:{lat:C.lat,lng:C.lng,radiusDeg:.6}}:Z.length?{biasCenter:{lat:Z[0].lat,lng:Z[0].lng,radiusDeg:1}}:void 0,oe=await Q3(F,5,se);k(oe.map(ye=>({label:ye.label||`${ye.lat},${ye.lng}`,lat:ye.lat,lng:ye.lng}))),x(oe.length>0)},300)},onFocus:()=>{S.length&&x(!0)},onBlur:async()=>{setTimeout(()=>x(!1),150),await D()}}),v&&S.length>0&&w.jsx("div",{className:"absolute z-10 mt-1 max-h-56 w-full overflow-auto rounded border border-app bg-surface-1 shadow",children:S.map((j,O)=>w.jsx("button",{type:"button",className:"block w-full cursor-pointer px-2 py-1 text-left hover:bg-surface-3",onMouseDown:F=>F.preventDefault(),onClick:()=>{_(j.label),R({lat:j.lat,lng:j.lng}),f.mutate({address:j.label,lat:j.lat,lng:j.lng}),x(!1)},children:j.label},`${j.lat}-${j.lng}-${O}`))})]}),w.jsx("div",{className:"h-64 rounded overflow-hidden border border-neutral-800",onPointerDown:j=>j.stopPropagation(),onPointerMove:j=>j.stopPropagation(),onPointerUp:j=>j.stopPropagation(),children:w.jsxs(BE,{center:C?[C.lat,C.lng]:l,zoom:C?12:4,style:{height:"100%",width:"100%"},children:[w.jsx(FE,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),w.jsx(J3,{onClick:async(j,O)=>{let F=null;try{F=await G3(j,O)}catch{}R({lat:j,lng:O}),f.mutate({lat:j,lng:O,address:F})}}),w.jsx(T,{points:q.useMemo(()=>{const j=(u.data||[]).filter(O=>typeof O.lat=="number"&&typeof O.lng=="number").map(O=>({lat:O.lat,lng:O.lng}));return C?j.some(F=>Math.abs(F.lat-C.lat)<1e-9&&Math.abs(F.lng-C.lng)<1e-9)?j:[...j,C]:j},[u.data,C])}),C&&w.jsx(Mg,{position:[C.lat,C.lng]}),(u.data||[]).map(j=>j.id===t?null:w.jsx(Mg,{position:[j.lat,j.lng]},j.id))]})}),w.jsxs("div",{className:"text-xs text-fg-muted bg-surface-1 p-2 rounded",children:[" ",w.jsx("strong",{children:"How to use:"})," Type an address above or click the map to set location. Zoom out to see all board locations as pins.",u.data&&u.data.length>1&&w.jsxs("span",{className:"block mt-1 text-green-600",children:["Found ",u.data.length-1," other locations on this board"]}),d&&w.jsx("div",{className:"mt-2 text-amber-600",children:"Saving is currently disabled because the database is missing location columns on the cards table. Ask an admin to run scripts/add-location-columns.sql in Supabase SQL editor, then refresh."})]})]})}function X3({workspaceId:t,cardId:e,values:n}){const r=nn(),i=St({queryKey:["custom-field-defs",t],enabled:!!t,queryFn:async()=>{const u=be(),{data:d,error:h}=await u.from("custom_field_defs").select("id, name, type").eq("workspace_id",t);if(h)throw h;return d?.map(f=>({id:f.id,name:f.name,type:f.type||"text"}))??[]}}),s=Pi({mutationFn:async({fieldId:u,newValue:d})=>{const h=be(),{error:f}=await h.from("card_field_values").upsert({card_id:e,field_id:u,value:d},{onConflict:"card_id,field_id"});if(f)throw f},onSuccess:async()=>{await r.invalidateQueries({predicate:u=>Array.isArray(u.queryKey)&&(u.queryKey.includes("card")||u.queryKey[0]==="custom-field-defs")})}});if(!t)return w.jsx("div",{className:"text-sm text-muted",children:"No workspace"});if(i.isLoading)return w.jsx("div",{className:"text-sm text-muted",children:"Loading fields"});if(i.error)return w.jsx("div",{className:"text-sm text-red-500",children:"Failed to load custom fields"});const o=i.data??[],l=new Map;return(n||[]).forEach(u=>{try{const d=typeof u.value=="string"?JSON.parse(u.value):u.value;l.set(u.field_id,d?.value??d??"")}catch{l.set(u.field_id,u.value??"")}}),w.jsx("div",{className:"space-y-2",children:o.length===0?w.jsx("div",{className:"text-sm text-muted",children:"No custom fields"}):o.map(u=>{const d=l.get(u.id)??"";return w.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[w.jsx("div",{className:"w-40 text-fg-muted",children:u.name}),w.jsx("input",{className:"flex-1 rounded border border-app bg-surface-2 px-2 py-1",type:u.type==="number"?"number":"text",value:d,onChange:h=>{const f=h.target.value,m=u.type==="number"?f===""?"":Number(f):f;s.mutate({fieldId:u.id,newValue:{value:m}})}})]},u.id)})})}async function eU(t){const e=be(),{data:n,error:r}=await e.rpc("list_workspace_members",{p_ws_id:t});if(r){if(r?.status===404){const s=new Error("missing-rpc:list_workspace_members");throw s.status=404,s}throw r}return n??[]}async function tU(t){const e=be(),{data:n,error:r}=await e.from("card_assignees").select("user_id").eq("card_id",t);if(r){if(r?.status===404){const s=new Error("missing-table:card_assignees");throw s.status=404,s}throw r}return(n??[]).map(i=>i.user_id)}async function nU(t,e){const n=be(),{error:r}=await n.from("card_assignees").insert({card_id:t,user_id:e});if(r)throw r}async function rU(t,e){const n=be(),{error:r}=await n.from("card_assignees").delete().eq("card_id",t).eq("user_id",e);if(r)throw r}function iU({workspaceId:t,cardId:e}){const n=nn(),r=St({queryKey:["ws-members",t],queryFn:()=>eU(t),enabled:!!t}),i=St({queryKey:["card-assignees",e],queryFn:()=>tU(e),enabled:!!e}),s=Pi({mutationFn:d=>nU(e,d),onSuccess:()=>{n.invalidateQueries({queryKey:["card-assignees",e]}),n.invalidateQueries({predicate:d=>Array.isArray(d.queryKey)&&d.queryKey.includes("activity")})}}),o=Pi({mutationFn:d=>rU(e,d),onSuccess:()=>{n.invalidateQueries({queryKey:["card-assignees",e]}),n.invalidateQueries({predicate:d=>Array.isArray(d.queryKey)&&d.queryKey.includes("activity")})}});if(r.isLoading||i.isLoading)return w.jsx("div",{className:"text-sm text-muted",children:"Loading members"});if(r.error){const d=r.error?.status===404||String(r.error?.message||"").includes("missing-rpc:list_workspace_members");return w.jsx("div",{className:"text-sm text-red-500",children:d?w.jsx("div",{children:"Workspace members RPC is missing. Please apply schema/schema.sql in Supabase (includes list_workspace_members and card_assignees) and re-run the seed."}):"Failed to load workspace members"})}const l=r.data??[],u=i.data??[];return w.jsx("div",{className:"space-y-2",children:l.length===0?w.jsx("div",{className:"text-sm text-muted",children:"No workspace members"}):l.map(d=>{const h=u.includes(d.user_id);return w.jsxs("div",{className:"flex items-center justify-between rounded border border-app px-2 py-1 text-sm",children:[w.jsxs("div",{className:"truncate",children:[w.jsx("span",{className:"text-fg",children:d.user_id}),w.jsxs("span",{className:"ml-2 text-muted",children:["(",d.role,")"]})]}),h?w.jsx("button",{className:"px-2 py-0.5 rounded border border-app text-red-500",onClick:()=>o.mutate(d.user_id),children:"Remove"}):w.jsx("button",{className:"px-2 py-0.5 rounded border border-app",onClick:()=>s.mutate(d.user_id),children:"Assign"})]},d.user_id)})})}const Og="attachments";function sU(t){const e=t.indexOf("/attachments/");return e===-1?null:t.substring(e+13)}async function oU(t,e,n){const r=be(),i=Date.now(),s=n.name.replace(/[^a-zA-Z0-9_.-]/g,"-"),o=`${t}/${e}/${i}-${s}`,{error:l}=await r.storage.from(Og).upload(o,n,{cacheControl:"3600",upsert:!0});if(l)throw l;const d=r.storage.from(Og).getPublicUrl(o).data.publicUrl,{data:h,error:f}=await r.from("attachments").insert({card_id:e,name:n.name,url:d,mime:n.type||"application/octet-stream",size:n.size}).select("id, url").single();if(f)throw f;return{id:h.id,url:h.url}}async function aU(t){const e=be(),n=sU(t);if(n)try{await e.storage.from(Og).remove([n])}catch{}}async function lU(t,e){const n=be(),{error:r}=await n.from("attachments").update({name:e}).eq("id",t);if(r)throw r}function uU({attachments:t,onAddUrl:e,onRemove:n,workspaceId:r,cardId:i,onUploaded:s,registerOpenPicker:o}){const[l,u]=q.useState(""),[d,h]=q.useState(""),[f,m]=q.useState(!1),g=q.useRef(null),_=async()=>{if(!(!l.trim()||!d.trim())){m(!0);try{await e(l.trim(),d.trim()),u(""),h("")}finally{m(!1)}}};return q.useEffect(()=>{o&&o(()=>g.current?.click())},[o]),w.jsxs("div",{className:"space-y-3",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("input",{ref:g,type:"file",className:"hidden",onChange:async v=>{const x=v.target.files?.[0];if(!(!x||!r||!i)){m(!0);try{await oU(r,i,x),await s?.()}finally{m(!1),v.currentTarget.value=""}}}}),w.jsx("button",{className:"px-3 py-1 rounded border border-app text-sm disabled:opacity-50",disabled:f||!r||!i,onClick:()=>g.current?.click(),children:"Upload file"})]}),w.jsxs("div",{className:"flex gap-2",children:[w.jsx("input",{className:"flex-1 rounded border border-app bg-surface-2 px-2 py-1",placeholder:"File name",value:l,onChange:v=>u(v.target.value)}),w.jsx("input",{className:"flex-1 rounded border border-app bg-surface-2 px-2 py-1",placeholder:"https://",value:d,onChange:v=>h(v.target.value)}),w.jsx("button",{className:"px-3 py-1 rounded bg-accent text-white disabled:opacity-50",onClick:_,disabled:f,children:"Add URL"})]}),w.jsx("ul",{className:"divide-y divide-app rounded border border-app overflow-hidden",children:t.length===0?w.jsx("li",{className:"p-2 text-sm text-muted",children:"No attachments"}):t.map(v=>w.jsxs("li",{className:"p-2 flex items-center gap-3",children:[w.jsx("span",{children:v.mime?.includes("pdf")?"":v.mime?.startsWith("image/")?"":""}),w.jsx("a",{href:v.url,target:"_blank",rel:"noreferrer",className:"flex-1 hover:underline",children:v.name||v.url}),w.jsx("button",{className:"text-muted hover:text-app",title:"Rename",onClick:async()=>{const x=window.prompt("New name",v.name||"")?.trim();if(!(!x||x===v.name)){m(!0);try{await lU(v.id,x),await s?.()}finally{m(!1)}}},children:""}),w.jsx("button",{className:"text-muted hover:text-app",title:"Copy link",onClick:async()=>{if(v.url)try{await navigator.clipboard.writeText(v.url)}catch{}},children:""}),w.jsx("button",{className:"text-muted hover:text-red-500",onClick:async()=>{v.url&&await aU(v.url),await n(v.id)},title:"Delete",children:""})]},v.id))})]})}function cU({checklists:t,onToggleItem:e,onAddItem:n,onAddChecklist:r}){return w.jsxs("div",{className:"space-y-4",children:[w.jsxs("div",{className:"flex items-center justify-between",children:[w.jsx("div",{className:"text-sm text-muted",children:"Checklists"}),r&&w.jsx("button",{className:"text-xs px-2 py-1 rounded border border-app hover:text-app",onClick:()=>r(),children:"+ Add checklist"})]}),t.length===0?w.jsx("div",{className:"text-sm text-muted",children:"No checklists"}):t.map(i=>{const s=i.checklist_items??[],o=s.length,l=s.filter(d=>d.done).length,u=o?Math.round(l/o*100):0;return w.jsxs("div",{className:"rounded border border-app",children:[w.jsxs("div",{className:"p-2 flex items-center justify-between",children:[w.jsx("div",{className:"font-medium text-sm",children:i.title||"Checklist"}),w.jsxs("div",{className:"text-xs text-muted",children:[u,"%"]})]}),w.jsx("div",{className:"h-1 bg-app/30",style:{width:"100%"},children:w.jsx("div",{className:"h-1 bg-accent",style:{width:`${u}%`}})}),w.jsxs("ul",{className:"p-2 space-y-1 text-sm",children:[s.map(d=>w.jsxs("li",{className:"flex items-center gap-2",children:[w.jsx("input",{type:"checkbox",checked:d.done,onChange:h=>e(d.id,h.target.checked)}),w.jsx("span",{className:d.done?"line-through text-muted":"",children:d.text||"Item"})]},d.id)),w.jsx(dU,{onAdd:d=>n(i.id,d)})]})]},i.id)})]})}function dU({onAdd:t}){const[e,n]=q.useState("");return w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("input",{className:"flex-1 rounded border border-app bg-surface-2 px-2 py-1",placeholder:"Add item",value:e,onChange:r=>n(r.target.value),onKeyDown:r=>{r.key==="Enter"&&e.trim()&&(t(e.trim()),n(""))}}),w.jsx("button",{className:"px-2 py-1 rounded border border-app text-xs",onClick:()=>{e.trim()&&(t(e.trim()),n(""))},children:"Add"})]})}function hU({onSubmit:t}){const[e,n]=q.useState(""),[r,i]=q.useState(!1),s=async()=>{if(e.trim()){i(!0);try{await t(e.trim()),n("")}finally{i(!1)}}};return w.jsxs("div",{className:"flex gap-2",children:[w.jsx("input",{className:"flex-1 rounded border border-app bg-surface-2 px-2 py-1",placeholder:"Write a comment Use @name to mention",value:e,onChange:o=>n(o.target.value),onKeyDown:o=>{o.key==="Enter"&&s()}}),w.jsx("button",{className:"px-3 py-1 rounded bg-accent text-white disabled:opacity-50",disabled:r,onClick:s,children:"Send"})]})}function fU(t,e,n){const r=e??{},i=s=>s&&n?.listNames&&n.listNames[s]?n.listNames[s]:s??"";switch(t){case"update.title":return`changed title from "${r.from??""}" to "${r.to??""}"`;case"update.dates":{const s=[];return r.fromStart!==r.toStart&&s.push(`start: ${r.fromStart??""}  ${r.toStart??""}`),r.fromEnd!==r.toEnd&&s.push(`end: ${r.fromEnd??""}  ${r.toEnd??""}`),`updated dates${s.length?` (${s.join(", ")})`:""}`}case"update.description":return"updated the description";case"update.location":{const s=r.fromAddress!==r.toAddress,o=r.fromLat!==r.toLat||r.fromLng!==r.toLng;return s?`updated location: ${r.fromAddress??""}  ${r.toAddress??""}`:o?`updated location: (${r.fromLat??""}, ${r.fromLng??""})  (${r.toLat??""}, ${r.toLng??""})`:"updated location"}case"move.list":return`moved card from list ${i(r.fromListId)} to ${i(r.toListId)}`;case"move.board":return`moved card from board "${r.fromBoardName??r.fromBoardId??""}" to "${r.toBoardName??r.toBoardId??""}"`;case"label.add":return`added label "${r.labelName??r.labelId??""}"`;case"label.remove":return`removed label "${r.labelName??r.labelId??""}"`;case"attachment.add":return`added attachment "${r.name??""}"${r.size?` (${pU(r.size)})`:""}`;case"attachment.remove":return`removed attachment "${r.name??""}"`;case"attachment.rename":return`renamed attachment from "${r.from??""}" to "${r.to??""}"`;case"member.add":return`added member "${r.memberName??r.memberId??""}"`;case"member.remove":return`removed member "${r.memberName??r.memberId??""}"`;case"checklist.add":return`added checklist "${r.checklistTitle??r.title??""}"`;case"checklist.remove":return`removed checklist "${r.checklistTitle??r.title??""}"`;case"checklist.item.add":return`added checklist item "${r.text??""}"`;case"checklist.item.toggle":return`marked checklist item "${r.text??""}" as ${r.done?"done":"not done"}`;case"checklist.item.remove":return`removed checklist item "${r.text??""}"`;case"checklist.item.update":return`updated checklist item "${r.text??""}"`;case"card.archive":return"archived this card";case"card.restore":return"restored this card from archive";case"card.delete":return"deleted this card";default:return`activity: ${t} ${Object.keys(r).length?`- ${JSON.stringify(r)}`:""}`}}function pU(t){if(t===0)return"0 B";const e=1024,n=["B","KB","MB","GB"],r=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,r)).toFixed(1))+" "+n[r]}function mU({comments:t,activity:e,listNames:n}){const r=[...t.map(i=>({kind:"comment",id:`c-${i.id}`,who:i.author_id||"unknown",when:i.created_at||"",body:i.body||""})),...e.map(i=>({kind:"activity",id:`a-${i.id}`,who:i.actor_id||"system",when:i.created_at||"",type:i.type,meta:i.meta??{}}))].sort((i,s)=>i.when<s.when?1:-1);return w.jsx("div",{className:"space-y-2 text-sm",children:r.length===0?w.jsx("div",{className:"text-muted",children:"No comments or activity yet"}):r.map(i=>w.jsxs("div",{className:"rounded border border-app p-2",children:[w.jsxs("div",{className:"text-xs text-muted mb-1",children:[i.who,"  ",i.when?new Date(i.when).toLocaleString():""]}),w.jsx("div",{className:"whitespace-pre-wrap break-words",children:i.kind==="comment"?i.body:fU(i.type,i.meta,{listNames:n})})]},i.id))})}function UE({cardId:t,currentBoardId:e,currentListId:n,workspaceId:r,onClose:i,onMoved:s}){const o=St({queryKey:["boards",r],queryFn:()=>Ni(r)}),[l,u]=q.useState(e),d=St({queryKey:["lists-simple",l],queryFn:()=>HD(l),enabled:!!l}),[h,f]=q.useState(n),[m,g]=q.useState("bottom"),_=St({queryKey:["cards",l],queryFn:()=>Gy(String(l)),enabled:!!l});q.useEffect(()=>{d.data&&d.data.length>0&&!d.data.find(x=>x.id===h)&&f(d.data[0].id)},[d.data]);const v=async()=>{if(h)try{const S=(d.data??[]).find(P=>P.id===h);if(!S)return;const R=[...(_.data??[]).filter(P=>P.list_id===S.id)].sort((P,T)=>P.position-T.position),N=m==="top"?(R[0]?.position??0)-1:(R[R.length-1]?.position??0)+1;await z1({cardId:t,toBoardId:l,toListId:h,position:N}),s?.({boardId:l,listId:h}),i?.()}catch(x){console.error("Failed to move card:",x);let S="Failed to move card. Please try again.";if(x&&typeof x=="object"){const k=x;k.code==="42501"?S="Permission denied. You may not have access to move cards between these boards.":k.message?.includes("Not authorized")?S="You are not authorized to move this card.":k.message?.includes("Card not found")?S="Card not found. It may have been deleted or moved already.":k.message?.includes("Target board not in same workspace")?S="Cannot move card to a board in a different workspace.":k.message?.includes("row-level security")?S="Database permission error. The move_card function may need to be updated with proper security settings.":k.message&&(S=`Failed to move card: ${k.message}`)}alert(S)}};return w.jsxs("div",{className:"p-4 bg-bg-card text-fg border border-border rounded-xl shadow-card w-[320px] max-w-[90vw] max-h-[90vh] overflow-y-auto",children:[w.jsxs("div",{className:"flex items-center justify-between mb-4",children:[w.jsx("h3",{className:"font-semibold",children:"Move card"}),w.jsx("button",{className:"text-fg-subtle hover:text-fg",onClick:i,children:""})]}),w.jsxs("div",{className:"space-y-3",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm text-fg-muted mb-1",children:"Board"}),w.jsx("select",{className:"w-full px-3 py-2 rounded border border-border bg-background",value:l,onChange:x=>u(x.target.value),children:o.data?.map(x=>w.jsx("option",{value:x.id,children:x.name},x.id))})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm text-fg-muted mb-1",children:"List"}),w.jsx("select",{className:"w-full px-3 py-2 rounded border border-border bg-background",value:h,onChange:x=>f(x.target.value),children:d.data?.map(x=>w.jsx("option",{value:x.id,children:x.name},x.id))})]}),w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm text-fg-muted mb-1",children:"Position"}),w.jsxs("div",{className:"flex gap-4",children:[w.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[w.jsx("input",{type:"radio",name:"pos",checked:m==="top",onChange:()=>g("top"),className:"text-accent"}),"Top"]}),w.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[w.jsx("input",{type:"radio",name:"pos",checked:m==="bottom",onChange:()=>g("bottom"),className:"text-accent"}),"Bottom"]})]})]})]}),w.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[w.jsx("button",{className:"px-3 py-2 rounded hover:bg-muted",onClick:i,children:"Cancel"}),w.jsx("button",{className:"px-3 py-2 bg-accent text-white rounded hover:bg-accent/90 disabled:opacity-50",onClick:v,disabled:!h,children:"Move"})]})]})}function gU({cardId:t,boardId:e,initialTitle:n,onClose:r}){const[i,s]=q.useState(n),[o,l]=q.useState(!1),[u,d]=q.useState(!1),h=nn(),f=be(),m=q.useRef((n||"").trim()),g=q.useRef(null),_=St({queryKey:["card",t],queryFn:async()=>{const{data:$,error:K}=await f.from("cards").select(`
          id, workspace_id, board_id, list_id, title, description, location_lat, location_lng, location_address, date_start, date_end, position, created_by, created_at, updated_at,
          board:boards(id, name, lists:lists(id, name)),
          card_field_values:card_field_values(field_id, value, custom_field_defs:custom_field_defs(name)),
          card_labels:card_labels(label_id, labels:labels(id, name, color)),
          attachments:attachments(id, name, url, mime, size, created_at),
          comments:comments(id, author_id, body, created_at),
          checklists:checklists(id, title, position, checklist_items:checklist_items(id, text, done, position)),
          activity:activity(id, type, meta, actor_id, created_at)
        `).eq("id",t).maybeSingle();if(K)throw K;return $??null}}),v=_.data??null,x=q.useMemo(()=>{const $={},K=v?.board?.lists;if(Array.isArray(K))for(const ie of K)ie?.id&&($[ie.id]=ie.name||"");return $},[v]);let S,k;if(v?.card_field_values&&Array.isArray(v.card_field_values))for(const $ of v.card_field_values){const ie=(Array.isArray($.custom_field_defs)?$.custom_field_defs[0]:$.custom_field_defs)?.name?.toLowerCase?.();if(ie)try{const te=(typeof $.value=="string"?JSON.parse($.value):$.value)?.value;if(!te)continue;!S&&ie.includes("phone")&&(S=String(te)),!k&&ie.includes("email")&&(k=String(te))}catch{}}const C=[];if(v?.card_labels)for(const $ of v.card_labels)$.label_id&&C.push($.label_id);const R=v?.board?.name==="Archive",N=Pi({mutationFn:async $=>{const K=be(),ie=_.data?.title||n||"",{error:re}=await K.from("cards").update({title:$}).eq("id",t);if(re)throw re;const{logTitleUpdate:te}=await yn(async()=>{const{logTitleUpdate:ee}=await Promise.resolve().then(()=>Xs);return{logTitleUpdate:ee}},void 0);await te(t,ie,$)},onSuccess:async()=>{await h.invalidateQueries({queryKey:["cards",e]})}});q.useEffect(()=>{const $=((_.data?.title??n)||"").trim();m.current=$},[_.data?.title,n]),q.useEffect(()=>{const $=(i||"").trim();if(!(!$||$===m.current))return g.current&&window.clearTimeout(g.current),g.current=window.setTimeout(async()=>{try{await N.mutateAsync($),m.current=$}catch(K){console.error(K)}finally{g.current=null}},600),()=>{g.current&&window.clearTimeout(g.current)}},[i,N]);const P=async($,K,ie="application/octet-stream")=>{const re=be(),te=0,{data:ee,error:Se}=await re.from("attachments").insert({card_id:t,name:$,url:K,mime:ie,size:te,added_by:(await re.auth.getUser()).data.user?.id}).select("id").single();if(Se)throw Se;const{logAttachmentOperation:Re}=await yn(async()=>{const{logAttachmentOperation:Ce}=await Promise.resolve().then(()=>Xs);return{logAttachmentOperation:Ce}},void 0);await Re(t,"add",$,ee?.id,K,te),await h.invalidateQueries({queryKey:["card",t]}),await h.invalidateQueries({predicate:Ce=>Array.isArray(Ce.queryKey)&&Ce.queryKey[0]==="cards"})},T=async $=>{const K=be(),{data:ie}=await K.from("attachments").select("name").eq("id",$).single(),{error:re}=await K.from("attachments").delete().eq("id",$);if(re)throw re;const{logAttachmentOperation:te}=await yn(async()=>{const{logAttachmentOperation:ee}=await Promise.resolve().then(()=>Xs);return{logAttachmentOperation:ee}},void 0);await te(t,"remove",ie?.name||"Unknown",$),await h.invalidateQueries({queryKey:["card",t]}),await h.invalidateQueries({predicate:ee=>Array.isArray(ee.queryKey)&&ee.queryKey[0]==="cards"})},D=async($,K)=>{const ie=be(),{data:re}=await ie.from("checklist_items").select("text, checklist_id").eq("id",$).single(),{error:te}=await ie.from("checklist_items").update({done:K}).eq("id",$);if(te)throw te;const{logChecklistItemOperation:ee}=await yn(async()=>{const{logChecklistItemOperation:Se}=await Promise.resolve().then(()=>Xs);return{logChecklistItemOperation:Se}},void 0);await ee(t,"toggle",$,re?.text||"Unknown item",K,re?.checklist_id),await h.invalidateQueries({queryKey:["card",t]})},j=async($,K)=>{const ie=be(),re=v?.checklists?.find(Ce=>Ce.id===$)?.checklist_items??[],te=(re[re.length-1]?.position??0)+1,{data:ee,error:Se}=await ie.from("checklist_items").insert({checklist_id:$,text:K,done:!1,position:te}).select("id").single();if(Se)throw Se;const{logChecklistItemOperation:Re}=await yn(async()=>{const{logChecklistItemOperation:Ce}=await Promise.resolve().then(()=>Xs);return{logChecklistItemOperation:Ce}},void 0);await Re(t,"add",ee?.id||"",K,!1,$),await h.invalidateQueries({queryKey:["card",t]})},O=async()=>{const $=be(),K=v?.checklists??[],ie=(K[K.length-1]?.position??0)+1,re="Checklist",{data:te,error:ee}=await $.from("checklists").insert({card_id:t,title:re,position:ie}).select("id").single();if(ee)throw ee;const{logChecklistOperation:Se}=await yn(async()=>{const{logChecklistOperation:Re}=await Promise.resolve().then(()=>Xs);return{logChecklistOperation:Re}},void 0);await Se(t,"add",te?.id||"",re),await h.invalidateQueries({queryKey:["card",t]})},[F,Z]=q.useState(!1),se=q.useRef(null),oe=async()=>{const{archiveCard:$}=await yn(async()=>{const{archiveCard:K}=await Promise.resolve().then(()=>rg);return{archiveCard:K}},void 0);await $(t),await h.invalidateQueries({predicate:K=>Array.isArray(K.queryKey)&&(K.queryKey.includes("cards")||K.queryKey.includes("card"))}),r?.()},ye=async()=>{if(!confirm("Delete this card? This cannot be undone."))return;const{deleteCard:$}=await yn(async()=>{const{deleteCard:K}=await Promise.resolve().then(()=>rg);return{deleteCard:K}},void 0);await $(t),await h.invalidateQueries({predicate:K=>Array.isArray(K.queryKey)&&(K.queryKey.includes("cards")||K.queryKey.includes("card"))}),r?.()},ue=async $=>{const K=be(),ie=(await K.auth.getUser()).data.user,{error:re}=await K.from("comments").insert({card_id:t,author_id:ie?.id,body:$});if(re)throw re;await h.invalidateQueries({queryKey:["card",t]}),await h.invalidateQueries({predicate:te=>Array.isArray(te.queryKey)&&te.queryKey[0]==="cards"})},Te=async()=>{try{const $=be(),{data:K}=await $.from("workspaces").select("id").limit(1);if(!K?.[0])return;let{data:ie}=await $.from("boards").select("id, lists:lists(id)").eq("workspace_id",K[0].id).eq("name","Archive"),re,te;if(ie?.[0]){re=ie[0].id;const Se=ie[0].lists;if(Se?.[0])te=Se[0].id;else{const{data:Re}=await $.from("lists").insert({board_id:re,name:"Archived Cards",position:0}).select("id").single();if(!Re)throw new Error("Failed to create Archive list");te=Re.id}}else{const{data:Se}=await $.from("boards").insert({workspace_id:K[0].id,name:"Archive"}).select("id").single();if(!Se)throw new Error("Failed to create Archive board");const{data:Re}=await $.from("lists").insert({board_id:Se.id,name:"Archived Cards",position:0}).select("id").single();if(!Re)throw new Error("Failed to create Archive list");re=Se.id,te=Re.id}const{error:ee}=await $.from("cards").update({board_id:re,list_id:te}).eq("id",t);if(ee)throw ee;await ld(t,"archive"),await h.invalidateQueries({queryKey:["cards",e]}),await h.invalidateQueries({queryKey:["card",t]}),r?.()}catch($){console.error("Failed to archive card:",$),alert("Failed to archive card. Please try again.")}},H=async()=>{try{const $=be(),{data:K}=await $.from("workspaces").select("id").limit(1);if(!K?.[0])return;const{data:ie}=await $.from("boards").select("id, name, lists:lists(id)").eq("workspace_id",K[0].id).neq("name","Archive").limit(1);if(!ie?.[0]){alert("No boards available to restore the card to.");return}const re=ie[0],te=re.lists;if(!te?.[0]){alert("The target board has no lists. Please create a list first.");return}const{error:ee}=await $.from("cards").update({board_id:re.id,list_id:te[0].id}).eq("id",t);if(ee)throw ee;await ld(t,"restore"),await h.invalidateQueries({queryKey:["cards",e]}),await h.invalidateQueries({queryKey:["card",t]}),r?.()}catch($){console.error("Failed to restore card:",$),alert("Failed to restore card. Please try again.")}},ne=async()=>{try{const $=be();await ld(t,"delete");const{error:K}=await $.from("cards").delete().eq("id",t);if(K)throw K;await h.invalidateQueries({queryKey:["cards",e]}),r?.()}catch($){console.error("Failed to delete card:",$),alert("Failed to delete card. Please try again.")}},G=q.useCallback(async()=>{const $=(_.data?.title??n)||"",K=(i||"").trim();if(K&&K!==$)try{await N.mutateAsync(K)}catch(ie){console.error(ie)}r?.()},[_.data?.title,n,i,r,N]);return q.useEffect(()=>{const $=K=>{K.key==="Escape"&&(K.stopPropagation(),G())};return window.addEventListener("keydown",$,{once:!1}),()=>window.removeEventListener("keydown",$)},[G]),q.useEffect(()=>{const $=document.documentElement,K=document.body,ie=$.style.overflow,re=K.style.overflow;$.style.overflow="hidden",K.style.overflow="hidden",$.classList.add("modal-open");const te=ee=>{window.__CARD_MODAL_OPEN__=ee;try{window.dispatchEvent(new CustomEvent("card-modal-toggle",{detail:ee}))}catch{}};return te(!0),()=>{$.style.overflow=ie,K.style.overflow=re,$.classList.remove("modal-open"),te(!1)}},[]),Wr.createPortal(w.jsxs("div",{className:"fixed inset-0 z-40",children:[w.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:G}),w.jsx("div",{className:"relative z-10 flex h-full w-full items-center justify-center",children:w.jsxs("div",{className:"w-[80vw] h-[80vh] max-w-6xl rounded-2xl border border-border bg-bg-card text-fg shadow-card overflow-hidden flex flex-col select-text",children:[w.jsxs("div",{className:"flex items-center gap-3 px-5 py-3 border-b border-border bg-bg-card/95 backdrop-blur",children:[w.jsx("input",{value:i,onChange:$=>s($.target.value),className:"flex-1 rounded border border-border bg-bg-inset px-3 py-2 text-lg font-medium",placeholder:"Card title"}),w.jsx("button",{className:"ml-2 shrink-0 text-fg-subtle hover:text-fg",onClick:G,"aria-label":"Close",children:w.jsx(Ot,{name:"x"})})]}),w.jsx("div",{className:"flex-1 overflow-y-auto p-5",children:w.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[w.jsxs("div",{className:"lg:col-span-2",children:[w.jsxs("div",{className:"mt-1 flex flex-wrap gap-2 text-sm",children:[w.jsx("button",{className:"px-2 py-1 rounded border border-border text-fg-subtle hover:text-fg",onClick:O,children:"+ Add"}),w.jsx("button",{className:"px-2 py-1 rounded border border-border text-fg-subtle hover:text-fg",onClick:O,children:"Checklist"}),w.jsx("button",{className:"px-2 py-1 rounded border border-border text-fg-subtle hover:text-fg",onClick:()=>Z($=>!$),children:"Members"}),w.jsx("button",{className:"px-2 py-1 rounded border border-border text-fg-subtle hover:text-fg",onClick:()=>se.current?.(),children:"Attachment"}),w.jsx("span",{className:"flex-1"}),w.jsx("button",{className:"px-2 py-1 rounded border border-border text-fg-subtle hover:text-fg",onClick:oe,children:"Archive"}),R&&w.jsx("button",{className:"px-2 py-1 rounded border border-danger/40 text-danger hover:text-danger/80",onClick:ye,children:"Delete"})]}),F&&v?.workspace_id&&w.jsxs("div",{className:"mt-2 rounded border border-border bg-bg-inset p-3 text-sm",children:[w.jsx("div",{className:"font-medium mb-2",children:"Members"}),w.jsx(iU,{workspaceId:v.workspace_id,cardId:t})]}),w.jsxs("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-2 gap-3",children:[w.jsxs("div",{children:[w.jsx("div",{className:"text-sm text-fg-muted mb-1",children:"Labels"}),v?w.jsx(hj,{workspaceId:v.workspace_id,cardId:v.id,selectedLabelIds:C}):w.jsx("div",{className:"text-fg-muted text-sm",children:"Loading"})]}),w.jsxs("div",{children:[w.jsx("div",{className:"text-sm text-fg-muted mb-1",children:"Dates"}),w.jsx(fj,{cardId:t,start:v?.date_start??void 0,end:v?.date_end??void 0})]})]}),w.jsxs("div",{className:"mt-4",children:[w.jsx("div",{className:"text-sm text-fg-muted mb-1",children:"Description"}),w.jsx(N3,{cardId:t,value:v?.description??null})]}),w.jsxs("div",{className:"mt-4",children:[w.jsx("div",{className:"text-sm text-fg-muted mb-1",children:"Location"}),w.jsx(Y3,{cardId:t,boardId:e,lat:v?.location_lat??null,lng:v?.location_lng??null,address:v?.location_address??null,title:v?.title})]}),w.jsxs("div",{className:"mt-4",children:[w.jsx("div",{className:"text-sm text-fg-muted mb-1",children:"Custom Fields"}),(S||k)&&w.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm mb-2",children:[S&&w.jsxs("div",{className:"rounded border border-border bg-bg-inset p-2",children:[w.jsx("div",{className:"text-fg-muted text-xs",children:"Phone"}),w.jsx("div",{className:"mt-1",children:S})]}),k&&w.jsxs("div",{className:"rounded border border-border bg-bg-inset p-2",children:[w.jsx("div",{className:"text-fg-muted text-xs",children:"Email"}),w.jsx("div",{className:"mt-1",children:k})]})]}),w.jsx(X3,{workspaceId:v?.workspace_id,cardId:t,values:v?.card_field_values})]}),w.jsxs("div",{className:"mt-4",children:[w.jsx("div",{className:"text-sm text-fg-muted mb-1",children:"Attachments"}),w.jsx(uU,{attachments:v?.attachments??[],onAddUrl:($,K)=>P($,K),onRemove:$=>T($),workspaceId:v?.workspace_id,cardId:t,registerOpenPicker:$=>se.current=$,onUploaded:async()=>{await h.invalidateQueries({queryKey:["card",t]}),await h.invalidateQueries({predicate:$=>Array.isArray($.queryKey)&&$.queryKey[0]==="cards"})}})]}),w.jsxs("div",{className:"mt-4",children:[w.jsx("div",{className:"text-sm text-fg-muted mb-1",children:"Checklists"}),w.jsx(cU,{checklists:v?.checklists??[],onToggleItem:D,onAddItem:j,onAddChecklist:O})]}),w.jsxs("div",{className:"mt-4",children:[w.jsx("div",{className:"text-sm text-fg-muted mb-2",children:"Card Actions"}),w.jsxs("div",{className:"flex flex-wrap gap-2",children:[w.jsxs("button",{onClick:()=>l(!0),className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-bg-subtle border border-border rounded hover:bg-bg-muted transition-colors",children:[w.jsx(Ot,{name:"arrow-right",size:14}),"Move Card"]}),R?w.jsxs("button",{onClick:H,className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-bg-subtle border border-border rounded hover:bg-bg-muted transition-colors",children:[w.jsx(Ot,{name:"plus",size:14}),"Restore"]}):w.jsxs("button",{onClick:Te,className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-bg-subtle border border-border rounded hover:bg-bg-muted transition-colors",children:[w.jsx(Ot,{name:"archive",size:14}),"Archive"]}),w.jsxs("button",{onClick:()=>d(!0),className:"flex items-center gap-1 px-3 py-1.5 text-sm bg-red-50 border border-red-200 text-red-700 rounded hover:bg-red-100 transition-colors",children:[w.jsx(Ot,{name:"trash",size:14}),"Delete"]})]})]})]}),w.jsxs("div",{className:"lg:col-span-1",children:[w.jsx("div",{className:"text-sm text-fg-muted mb-1",children:"Comments"}),w.jsx(hU,{onSubmit:ue}),w.jsx("div",{className:"mt-3",children:w.jsx(mU,{comments:v?.comments??[],activity:v?.activity??[],listNames:x})})]})]})})]})}),o&&v&&w.jsx(UE,{cardId:t,currentBoardId:e,currentListId:v.list_id,workspaceId:v.workspace_id,onClose:()=>l(!1),onMoved:async()=>{l(!1),await h.invalidateQueries({queryKey:["cards",e]}),await h.invalidateQueries({queryKey:["card",t]}),r?.()}}),u&&w.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60]",children:w.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[w.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Delete Card"}),w.jsx("p",{className:"text-gray-600 mb-4",children:"Are you sure you want to delete this card? This action cannot be undone."}),w.jsxs("div",{className:"flex justify-end gap-2",children:[w.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 text-gray-600 border border-gray-300 rounded hover:bg-gray-50 transition-colors",children:"Cancel"}),w.jsx("button",{onClick:async()=>{d(!1),await ne()},className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors",children:"Delete"})]})]})})]}),document.body)}function yU({card:t,dragging:e}){const{attributes:n,listeners:r,setNodeRef:i,transform:s,transition:o,isDragging:l}=Qy({id:t.id,data:{type:"card",cardId:t.id,listId:t.list_id}}),u=nn(),[d,h]=q.useState(!1),[f,m]=q.useState(!1),[g,_]=q.useState(null),v=q.useRef(null),x=q.useRef(null),S=(typeof window<"u"&&window.__CARD_MODAL_OPEN__)===!0,[k,C]=q.useState(!1);q.useEffect(()=>{(async()=>{try{const T=u.getQueryData(["boards"]);if(T){const D=T.find(j=>String(j.id)===t.board_id);C(D?.name==="Archive")}}catch(T){console.error(T)}})()},[t.board_id,u]),q.useEffect(()=>{if(!g)return;const P=T=>{const D=v.current;if(!D)return _(null);D.contains(T.target)||_(null)};return document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[g]);const R={transform:Gr.Transform.toString(s),transition:o,opacity:l?.6:void 0},N=!!(t.date_end&&new Date(t.date_end)<new Date);return w.jsxs("div",{ref:P=>{i(P),v.current=P},style:R,"data-list-id":t.list_id,className:`relative ${S?"":"cursor-grab active:cursor-grabbing"} ${l&&!S?"animate-jiggle":""}`,...S?{}:n,...S?{}:r,onContextMenu:P=>{if(S)return;P.preventDefault();const T=v.current;if(!T)return;const D=T.getBoundingClientRect();_({x:P.clientX-D.left,y:P.clientY-D.top})},children:[w.jsx("div",{onClick:P=>{P.stopPropagation(),x.current&&window.clearTimeout(x.current),x.current=window.setTimeout(()=>{l||h(!0),x.current=null},160)},children:w.jsx(sg,{title:t.title,overdue:N,card:t})}),w.jsx("button",{type:"button",className:"absolute top-1 right-1 text-fg-subtle hover:text-fg focus:outline-none focus:ring-0",onClick:P=>{P.stopPropagation();const T=v.current;if(!T)return;const D=P.currentTarget.getBoundingClientRect(),j=T.getBoundingClientRect();_({x:D.left-j.left-180,y:D.bottom-j.top+4})},"aria-label":"Card actions",title:"Card actions",children:""}),d?w.jsx(gU,{cardId:t.id,boardId:t.board_id,initialTitle:t.title,onClose:()=>h(!1)}):null,f?w.jsxs("div",{className:"fixed inset-0 z-50",onClick:()=>m(!1),children:[w.jsx("div",{className:"absolute inset-0 bg-black/20"}),w.jsx("div",{className:"absolute z-10",style:{top:"50%",left:"50%",transform:"translate(-50%, -50%)"},onClick:P=>P.stopPropagation(),children:w.jsx(UE,{cardId:t.id,currentBoardId:t.board_id,currentListId:t.list_id,workspaceId:t.workspace_id,onClose:()=>m(!1),onMoved:P=>{u.invalidateQueries({queryKey:["cards",t.board_id]}),P.boardId!==t.board_id&&u.invalidateQueries({queryKey:["cards",P.boardId]}),m(!1)}})})]}):null,g&&w.jsxs("div",{className:"absolute z-50 bg-bg-card text-fg border border-border rounded-md shadow-lg text-sm",style:{left:g.x,top:g.y,minWidth:180},onClick:P=>P.stopPropagation(),children:[w.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-bg-inset",onClick:()=>{h(!0),_(null)},children:"Open card"}),w.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-bg-inset",onClick:()=>{m(!0),_(null)},children:"Move card"}),w.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-bg-inset",onClick:async()=>{try{await U1(t.id),await u.invalidateQueries({queryKey:["cards",t.board_id]})}catch(P){console.error(P),alert("Failed to archive card. Check console for details.")}_(null)},children:"Archive card"}),k&&w.jsx("button",{className:"w-full text-left px-3 py-2 text-danger hover:bg-danger/10",onClick:async()=>{if(confirm("Delete this card permanently? This cannot be undone.")){try{const{deleteCard:P}=await yn(async()=>{const{deleteCard:T}=await Promise.resolve().then(()=>rg);return{deleteCard:T}},void 0);await P(t.id),await u.invalidateQueries({queryKey:["cards",t.board_id]})}catch(P){console.error(P),alert("Failed to delete card. Check console for details.")}_(null)}},children:"Delete card (permanent)"})]})]})}function vU({listId:t,listName:e,currentBoardId:n,onClose:r,onMoved:i}){const s=St({queryKey:["boards"],queryFn:()=>Ni("2a8f10d6-4368-43db-ab1d-ab783ec6e935")}),[o,l]=q.useState(n),[u,d]=q.useState(!1),h=async()=>{if(!(!o||u||o===n)){d(!0);try{await ij(t,o),i?.()}catch(f){console.error("Failed to move list:",f),alert("Failed to move list. Please try again.")}finally{d(!1)}}};return w.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",onClick:r,children:w.jsxs("div",{className:"p-4 bg-bg-card text-fg border border-border rounded-xl shadow-card w-[400px] max-w-[90vw]",onClick:f=>f.stopPropagation(),children:[w.jsxs("div",{className:"flex items-center justify-between mb-4",children:[w.jsxs("h3",{className:"font-semibold",children:['Move "',e,'" list']}),w.jsx("button",{className:"text-fg-subtle hover:text-fg",onClick:r,children:""})]}),w.jsxs("div",{className:"space-y-3",children:[w.jsxs("div",{children:[w.jsx("label",{className:"block text-sm text-fg-muted mb-1",children:"Target Board"}),w.jsx("select",{className:"w-full px-3 py-2 rounded border border-border bg-background",value:o,onChange:f=>l(f.target.value),children:s.data?.map(f=>w.jsxs("option",{value:f.id,children:[f.name," ",f.id===n?"(current)":""]},f.id))})]}),w.jsx("div",{className:"text-sm text-fg-muted",children:"This will move the entire list including all its cards to the selected board."})]}),w.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[w.jsx("button",{className:"px-3 py-2 rounded hover:bg-muted",onClick:r,disabled:u,children:"Cancel"}),w.jsx("button",{className:"px-3 py-2 bg-accent text-white rounded hover:bg-accent/90 disabled:opacity-50",onClick:h,disabled:!o||u||o===n,children:u?"Moving...":"Move List"})]})]})})}function _U({title:t,listId:e,cards:n,bump:r}){const{setNodeRef:i}=P1({id:e,data:{type:"list",listId:e}}),{boardId:s}=Io(),o=nn(),[l,u]=q.useState(!1),[d,h]=q.useState(t),f=q.useRef(null),[m,g]=q.useState(null),[_,v]=q.useState(!1),[x,S]=q.useState(!1),k=(typeof window<"u"&&window.__CARD_MODAL_OPEN__)===!0;St({queryKey:["boards"],queryFn:()=>Ni("2a8f10d6-4368-43db-ab1d-ab783ec6e935"),enabled:x}),q.useEffect(()=>h(t),[t]);const[C,R]=q.useState(!1);q.useEffect(()=>{(async()=>{if(s)try{const T=o.getQueryData(["myBoards"]);if(T){const D=T.find(j=>String(j.id)===s);R(D?.name==="Archive")}}catch(T){console.error(T)}})()},[s,o]);const N=async()=>{const P=d.trim();u(!1),!(!P||P===t)&&(o.getQueryCache().findAll({queryKey:["lists"]}),await ej(e,P),await o.invalidateQueries({queryKey:["lists"]}))};return q.useEffect(()=>{if(!m)return;const P=T=>{const D=f.current;if(!D)return g(null);D.contains(T.target)||g(null)};return document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[m]),q.useEffect(()=>{const P=T=>{!!T.detail&&g(null)};return window.addEventListener("card-modal-toggle",P),()=>window.removeEventListener("card-modal-toggle",P)},[]),w.jsxs("div",{ref:f,onContextMenu:P=>{if(k)return;P.preventDefault();const T=f.current;if(!T)return;const D=T.getBoundingClientRect();g({x:P.clientX-D.left,y:P.clientY-D.top})},className:`relative w-80 bg-bg-card text-fg rounded-xl border border-border p-3 shadow-card transition-transform duration-200 will-change-transform hover:scale-[1.01] ${r&&!k?"animate-jiggle scale-[1.015]":""}`,children:[w.jsxs("div",{className:"font-medium mb-2 flex items-center justify-between",onClick:P=>P.stopPropagation(),onDoubleClick:P=>{if(P.stopPropagation(),k)return;const T=f.current,D=P.currentTarget.getBoundingClientRect(),j=T?.getBoundingClientRect();j&&g({x:D.left-j.left,y:D.bottom-j.top+4})},children:[l?w.jsx("input",{autoFocus:!0,className:"bg-transparent border border-app rounded px-1 py-0.5 w-full mr-2",value:d,onChange:P=>h(P.target.value),onBlur:N,onKeyDown:P=>{P.key==="Enter"&&N(),P.key==="Escape"&&(h(t),u(!1))}}):w.jsx("button",{className:"text-left flex-1 focus:outline-none focus:ring-0",onClick:()=>u(!0),title:"Rename list",children:t}),w.jsx("button",{className:"text-fg-subtle hover:text-fg",onClick:P=>{if(P.stopPropagation(),k)return;const T=f.current,D=P.currentTarget.getBoundingClientRect(),j=T?.getBoundingClientRect();j&&g({x:D.left-j.left-200,y:D.bottom-j.top+4})},"aria-label":"List actions",title:"List actions",children:""})]}),w.jsx(Zy,{items:n.map(P=>P.id),strategy:O1,children:w.jsx("div",{ref:i,className:"flex flex-col gap-3 py-2 min-h-[60px]",children:n.map(P=>w.jsx(yU,{card:P,dragging:!1},P.id))})}),m&&w.jsxs("div",{className:"absolute z-50 bg-bg-card text-fg border border-border rounded-md shadow-lg text-sm",style:{left:m.x,top:m.y,minWidth:200},onClick:P=>P.stopPropagation(),children:[w.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-bg-inset",onClick:()=>{v(!0),g(null)},children:"Details"}),w.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-bg-inset",onClick:()=>{S(!0),g(null)},children:"Move list to another board"}),w.jsx("button",{className:"w-full text-left px-3 py-2 hover:bg-bg-inset",onClick:async()=>{try{await rj(e),await o.invalidateQueries({queryKey:["lists"]})}catch(P){console.error(P)}g(null)},children:"Archive list"}),C&&w.jsx("button",{className:"w-full text-left px-3 py-2 text-danger hover:bg-danger/10",onClick:async()=>{if(confirm("Delete this list and its cards permanently? This cannot be undone.")){try{await nj(e),await o.invalidateQueries({queryKey:["lists"]}),await o.invalidateQueries({queryKey:["cards"]})}catch(P){console.error(P)}g(null)}},children:"Delete list (permanent)"})]}),_&&w.jsxs("div",{className:"fixed inset-0 z-40",onClick:()=>v(!1),children:[w.jsx("div",{className:"absolute inset-0 bg-black/40"}),w.jsx("div",{className:"relative z-10 flex items-center justify-center h-full",children:w.jsxs("div",{className:"w-[420px] max-w-[92vw] bg-bg-card text-fg border border-border rounded-xl shadow-card p-4",onClick:P=>P.stopPropagation(),children:[w.jsxs("div",{className:"flex items-center justify-between mb-3",children:[w.jsx("div",{className:"font-medium",children:"List details"}),w.jsx("button",{className:"text-fg-subtle hover:text-fg",onClick:()=>v(!1),children:""})]}),w.jsxs("div",{className:"text-sm text-fg-muted space-y-1",children:[w.jsxs("div",{children:[w.jsx("span",{className:"text-fg",children:"Name:"})," ",d]}),w.jsxs("div",{children:[w.jsx("span",{className:"text-fg",children:"ID:"})," ",e]}),w.jsxs("div",{children:[w.jsx("span",{className:"text-fg",children:"Cards:"})," ",n.length]})]})]})})]}),x&&w.jsx(vU,{listId:e,listName:t,currentBoardId:s,onClose:()=>S(!1),onMoved:()=>{o.invalidateQueries({queryKey:["lists"]}),o.invalidateQueries({queryKey:["cards"]}),S(!1)}})]})}function wU({list:t,cards:e,bump:n}){const{attributes:r,listeners:i,setNodeRef:s,transform:o,transition:l,isDragging:u}=Qy({id:t.id,data:{type:"list",listId:t.id}}),d={transform:Gr.Transform.toString(o),transition:l,opacity:u?0:void 0},h=(typeof window<"u"&&window.__CARD_MODAL_OPEN__)===!0;return w.jsx("div",{ref:s,style:d,className:`relative  ${u&&!h?"animate-jiggle":""}`,...h?{}:r,...h?{}:i,children:w.jsx(_U,{title:t.name,listId:t.id,cards:e,bump:n})})}function bU(){const{boardId:t}=Io(),e=St({queryKey:["lists",t],queryFn:()=>XI(t),enabled:!!t}),n=St({queryKey:["cards",t],queryFn:()=>Gy(t),enabled:!!t}),r=nn(),i=a1(Qm(zh,{activationConstraint:{distance:10}})),[s,o]=q.useState(window.__CARD_MODAL_OPEN__??!1);q.useEffect(()=>{const N=P=>o(!!P.detail);return window.addEventListener("card-modal-toggle",N),()=>window.removeEventListener("card-modal-toggle",N)},[]),q.useEffect(()=>{s&&(u(null),h(null),m(null),_(null))},[s]);const[l,u]=q.useState(null),[d,h]=q.useState(null),[f,m]=q.useState(null),[g,_]=q.useState(null);if(q.useEffect(()=>{if(!t)return;const P=be().channel(`board-${t}`).on("postgres_changes",{event:"*",schema:"public",table:"lists",filter:`board_id=eq.${t}`},()=>r.invalidateQueries({queryKey:["lists",t]})).on("postgres_changes",{event:"*",schema:"public",table:"cards",filter:`board_id=eq.${t}`},()=>r.invalidateQueries({queryKey:["cards",t]})).subscribe();return()=>{P.unsubscribe()}},[t,r]),e.isLoading||n.isLoading)return w.jsx("div",{className:"p-4 text-muted",children:"Loading board"});if(e.error||n.error)return w.jsx("div",{className:"p-4 text-red-500",children:"Failed to load board."});const v=e.data??[],x=n.data??[],S=N=>{const P=N.active.data.current?.type;P&&u({type:P,id:String(N.active.id)})},k=N=>{if(N.active.data.current?.type!=="list")return;const T=N.over?.id?String(N.over.id):null;T&&m(T);const D=r.getQueryData(["lists",t])??[],j=D.find(et=>et.id===String(N.active.id));if(!j)return;const O=D.filter(et=>et.id!==j.id);if(!T){h(O.length);return}const F=O.findIndex(et=>et.id===T);if(F===-1){h(O.length);return}const Z=N.over?.rect,se=N.active?.rect?.current,oe=se?.translated??se?.initial??null,ye=Z?.left??null,ue=Z?.width??null,Te=ye!=null&&ue!=null?ye+ue/2:null,H=oe?.left??null,ne=oe?.width??null,G=H!=null&&ne!=null?H+ne/2:null,$=H??0,K=(H??0)+(ne??0),ie=ye??0,re=(ye??0)+(ue??0),te=Math.max(0,Math.min(K,re)-Math.max($,ie)),ee=ue?te/ue:0,Se=.35,Re=Te!=null&&G!=null?G>Te:!1,Ce=ee>=Se?!Re:Re,Oe=Math.max(0,Math.min(O.length,F+(Ce?1:0)));h(Oe)},C=async N=>{const{active:P,over:T}=N;if(!T||P.id===T.id)return;const D=P.data.current,j=T.data.current;if(D?.type==="list"){const Ce=r.getQueryData(["lists",t])??[],Oe=Ce.find(Ct=>Ct.id===String(P.id));if(!Oe)return;const et=Ce.filter(Ct=>Ct.id!==Oe.id);let De;if(d!=null)De=Math.max(0,Math.min(et.length,d));else{const Ct=et.findIndex(Pn=>Pn.id===String(T.id));De=Ct===-1?et.length:Ct}const gt=et[De-1]?.position??0,rn=et[De]?.position??gt+2,Tn=(gt+rn)/2,kt=[...et.slice(0,De),{...Oe,position:Tn},...et.slice(De)];r.setQueryData(["lists",t],kt);try{const Ct=be(),{error:Pn}=await Ct.from("lists").update({position:Tn}).eq("id",Oe.id);if(Pn)throw Pn;await r.invalidateQueries({queryKey:["lists",t]})}catch(Ct){console.error(Ct),r.setQueryData(["lists",t],Ce)}u(null),h(null),m(null);return}const F=D?.listId;let Z=j?.listId;if(!Z&&j?.cardId&&(Z=j.listId),!Z||!F)return;const se=r.getQueryData(["cards",t])??[],oe=se.filter(Ce=>Ce.list_id===Z),ye=oe.findIndex(Ce=>Ce.id===T.id),ue=j?.type==="card"&&ye!==-1?ye:oe.length,Te=oe[ue-1]?.position??0,H=oe[ue]?.position??Te+2,ne=(Te+H)/2,G=se,$=G.find(Ce=>Ce.id===P.id);if(!$)return;const K={...$,list_id:Z,position:ne},ie=G.filter(Ce=>Ce.id!==P.id),re=ie.filter(Ce=>Ce.list_id===Z),te=ie.filter(Ce=>Ce.list_id!==Z),ee=re.slice(0,ue),Se=re.slice(ue),Re=[...te,...ee,K,...Se];r.setQueryData(["cards",t],Re);try{await F1({cardId:String(P.id),listId:Z,position:ne}),await r.invalidateQueries({queryKey:["cards",t]})}catch(Ce){console.error(Ce),r.setQueryData(["cards",t],G)}_(Z),window.setTimeout(()=>_(Ce=>Ce===Z?null:Ce),220),u(null),h(null),m(null)},R=()=>u(null);return w.jsx("div",{className:"p-4 overflow-x-auto",children:w.jsxs(E1,{sensors:i,collisionDetection:mA,onDragStart:S,onDragOver:k,onDragEnd:C,onDragCancel:R,children:[w.jsx(Zy,{items:v.map(N=>N.id),strategy:PI,children:w.jsxs("div",{className:`flex gap-4 min-w-max items-stretch relative ${s?"pointer-events-none select-none":""}`,children:[l?.type==="list"&&d===0?w.jsx("div",{className:"w-1 self-stretch bg-accent rounded-sm opacity-70"}):null,v.map((N,P)=>w.jsxs(q.Fragment,{children:[w.jsx(wU,{list:N,cards:x.filter(T=>T.list_id===N.id),bump:g===N.id}),l?.type==="list"&&d===P+1?w.jsx("div",{className:"w-1 self-stretch bg-accent rounded-sm opacity-70"}):null]},N.id))]})}),!s&&w.jsx(kI,{children:l?.type==="list"?(()=>{const N=v.find(T=>T.id===l.id);if(!N)return null;const P=x.filter(T=>T.list_id===N.id);return w.jsx("div",{className:`opacity-90 pointer-events-none ${s?"":"animate-jiggle"}`,children:w.jsxs("div",{className:"w-80 bg-surface rounded-md border border-app p-3",children:[w.jsxs("div",{className:"font-medium mb-2 flex items-center justify-between",children:[w.jsx("div",{className:"text-left flex-1",children:N.name}),w.jsx("span",{className:"text-muted",children:""})]}),w.jsx("div",{className:"flex flex-col gap-2 min-h-[20px]",children:P.length>0?P.map(T=>{const D=!!(T.date_end&&new Date(T.date_end)<new Date);return w.jsx(sg,{title:T.title,overdue:D,card:T},T.id)}):w.jsx("div",{className:"text-xs text-muted",children:"No cards"})}),w.jsx("div",{className:"mt-3 w-full text-left text-muted",children:"+ Add card"})]})})})():l?.type==="card"?(()=>{const N=x.find(T=>T.id===l.id);if(!N)return null;const P=!!(N.date_end&&new Date(N.date_end)<new Date);return w.jsx("div",{className:`opacity-90 pointer-events-none ${s?"":"animate-jiggle"}`,children:w.jsx("div",{className:"w-72",children:w.jsx(sg,{title:N.title,overdue:P,card:N})})})})():null})]})})}function xU(){return w.jsxs("div",{className:"min-h-screen bg-app text-app",children:[w.jsx($h,{}),w.jsx(bU,{})]})}function SU(){return w.jsxs("div",{className:"p-4",children:[w.jsx("h2",{className:"text-xl font-semibold",children:"Table View"}),w.jsx("p",{className:"text-neutral-400",children:"TODO: grid of cards with sortable columns"})]})}const qb=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],kU=["January","February","March","April","May","June","July","August","September","October","November","December"],Wb=["bg-red-100 border-red-200","bg-blue-100 border-blue-200","bg-green-100 border-green-200","bg-yellow-100 border-yellow-200","bg-purple-100 border-purple-200","bg-pink-100 border-pink-200","bg-indigo-100 border-indigo-200"];function Kb(){const{boardId:t,workspaceId:e}=Io(),n=!!(e&&!t),r=nn(),[i,s]=q.useState(new Set),[o,l]=q.useState(null),[u,d]=M.useState(null),[h,f]=M.useState(new Date),m=St({queryKey:["boards"],queryFn:()=>Ni(e||"2a8f10d6-4368-43db-ab1d-ab783ec6e935"),enabled:n}),g=St({queryKey:["cardsWithDates",n?e:t],queryFn:()=>ng(n&&e?e:e||"2a8f10d6-4368-43db-ab1d-ab783ec6e935"),select:O=>O.filter(F=>!n&&t?F.board_id===t:!0).filter(F=>F.date_start&&F.date_end).map(F=>({id:F.id,title:F.title,startDate:new Date(F.date_start),endDate:new Date(F.date_end),boardName:F.boards?.name||"Unknown Board",boardId:F.board_id}))}),_=m.data?.find(O=>O.id===t),v=g.data||[];q.useEffect(()=>{if(v.length>0){const O=new Set(v.map(F=>F.boardName));s(O)}},[v]);const x=q.useMemo(()=>{const O=[];switch(u){case"day":{const F=new Date(h),Z=[[F]];O.push({monthStart:new Date(F.getFullYear(),F.getMonth(),1),weeks:Z});break}case"week":{const F=h.getDay(),Z=F===0?-6:1-F,se=new Date(h);se.setDate(h.getDate()+Z);const oe=[];for(let ye=0;ye<7;ye++){const ue=new Date(se);ue.setDate(se.getDate()+ye),oe.push(ue)}O.push({monthStart:new Date(se.getFullYear(),se.getMonth(),1),weeks:[oe]});break}case"month":{const F=new Date(h.getFullYear(),h.getMonth(),1),Z=new Date(h.getFullYear(),h.getMonth()+1,0),se=[];let oe=[];const ye=new Date(F);ye.setDate(F.getDate()-F.getDay());let ue=new Date(ye);for(;ue<=Z||oe.length>0;)if(oe.length===7&&(se.push([...oe]),oe=[]),oe.push(new Date(ue)),ue.setDate(ue.getDate()+1),ue>Z&&oe.length===7){se.push([...oe]);break}O.push({monthStart:F,weeks:se});break}case"year":default:{for(let F=0;F<12;F++){const Z=new Date(h.getFullYear(),F,1),se=new Date(h.getFullYear(),F+1,0),oe=[];let ye=[];const ue=new Date(Z);ue.setDate(Z.getDate()-Z.getDay());let Te=new Date(ue);for(;Te<=se||ye.length>0;)if(ye.length===7&&(oe.push([...ye]),ye=[]),ye.push(new Date(Te)),Te.setDate(Te.getDate()+1),Te>se&&ye.length===7){oe.push([...ye]);break}O.push({monthStart:Z,weeks:oe})}break}}return O},[u,h]),S=()=>{const O=new Date(h);switch(u){case"day":O.setDate(O.getDate()-1);break;case"week":O.setDate(O.getDate()-7);break;case"month":O.setMonth(O.getMonth()-1);break;case"year":O.setFullYear(O.getFullYear()-1);break}f(O)},k=()=>{const O=new Date(h);switch(u){case"day":O.setDate(O.getDate()+1);break;case"week":O.setDate(O.getDate()+7);break;case"month":O.setMonth(O.getMonth()+1);break;case"year":O.setFullYear(O.getFullYear()+1);break}f(O)},C=()=>{f(new Date),setTimeout(()=>{const O=document.getElementById("today-marker");O&&O.scrollIntoView({behavior:"smooth",block:"center"})},100)},R=()=>{switch(u){case"day":return h.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});case"week":{const O=h.getDay(),F=O===0?-6:1-O,Z=new Date(h);Z.setDate(h.getDate()+F);const se=new Date(Z);return se.setDate(Z.getDate()+6),`Week of ${Z.toLocaleDateString("en-US",{month:"short",day:"numeric"})} - ${se.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`}case"month":return h.toLocaleDateString("en-US",{year:"numeric",month:"long"});case"year":return h.getFullYear().toString();default:return""}},N=O=>v.filter(F=>{if(!i.has(F.boardName))return!1;const Z=O[0],se=O[6];return F.startDate<=se&&F.endDate>=Z}),P=O=>{s(F=>{const Z=new Set(F);return Z.has(O)?Z.delete(O):Z.add(O),Z})},T=O=>{l(O)},D=O=>{O.preventDefault()},j=async(O,F)=>{if(O.preventDefault(),!!o){try{const Z=Math.ceil((F.getTime()-o.startDate.getTime())/864e5),se=new Date(o.endDate);se.setDate(se.getDate()+Z),await B1(o.id,F.toISOString(),se.toISOString()),r.invalidateQueries({queryKey:["cardsWithDates"]})}catch(Z){console.error("Failed to update card dates:",Z)}l(null)}};return g.isLoading?w.jsx("div",{className:"flex items-center justify-center h-full",children:w.jsx("div",{className:"text-lg",children:"Loading calendar..."})}):g.error?w.jsx("div",{className:"flex items-center justify-center h-full",children:w.jsx("div",{className:"text-lg text-red-500",children:"Error loading calendar data"})}):w.jsxs("div",{className:`h-full flex flex-col overflow-hidden bg-bg text-fg ${t||n?"pb-20":""}`,children:[w.jsx("div",{className:"border-b border-border p-2 md:p-4 bg-surface flex-shrink-0",children:w.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-4",children:[w.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4",children:[w.jsxs("div",{className:"flex flex-col gap-1",children:[w.jsx("h1",{className:"text-lg md:text-2xl font-semibold",children:n?"Master Calendar":`${_?.name||"Board"} Calendar`}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("button",{onClick:S,className:"p-1 hover:bg-surface-2 rounded text-fg-muted hover:text-fg",title:"Previous",children:""}),w.jsx("span",{className:"text-sm md:text-base font-medium text-fg-muted",children:R()}),w.jsx("button",{onClick:k,className:"p-1 hover:bg-surface-2 rounded text-fg-muted hover:text-fg",title:"Next",children:""})]})]}),w.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[w.jsxs("button",{onClick:C,className:"px-2 md:px-3 py-1 text-xs md:text-sm bg-accent/10 text-accent rounded hover:bg-accent/20 transition-colors",children:[w.jsx("span",{className:"hidden sm:inline",children:"Go to Today"}),w.jsx("span",{className:"sm:hidden",children:"Today"})]}),w.jsx("div",{className:"flex items-center gap-1 ml-2 md:ml-4",children:["day","week","month","year"].map(O=>w.jsx("button",{onClick:()=>d(u===O?null:O),className:`px-2 py-1 text-xs md:text-sm rounded capitalize transition-colors ${u===O?"bg-accent text-white":"bg-surface-2 hover:bg-surface-3 text-fg-muted hover:text-fg"}`,title:`${u===O?"Return to default view":`Switch to ${O} view`}`,children:O},O))})]})]}),n&&w.jsxs("div",{className:"text-xs md:text-sm text-fg-muted",children:["Showing cards from ",Array.from(new Set(v.map(O=>O.boardName))).length," boards"]})]})}),u!=="day"&&w.jsx("div",{className:"grid grid-cols-7 border-b border-border bg-surface flex-shrink-0",children:qb.map(O=>w.jsxs("div",{className:"p-1 md:p-2 text-center text-xs md:text-sm font-medium text-fg-muted border-r border-border last:border-r-0",children:[w.jsx("span",{className:"hidden sm:inline",children:O}),w.jsx("span",{className:"sm:hidden",children:O.slice(0,1)})]},O))}),w.jsx("div",{className:"flex-1 overflow-y-auto",style:{maxHeight:"calc(100vh - 140px)"},children:x.map(O=>{const F=new Date;return w.jsxs("div",{className:"border-b-2 border-border",children:[(u==="month"||u==="year"||u===null)&&w.jsx("div",{className:"bg-surface-2 p-2 md:p-3 sticky top-0 z-10 border-b border-border",children:w.jsxs("h2",{className:"text-base md:text-lg font-semibold",children:[kU[O.monthStart.getMonth()]," ",O.monthStart.getFullYear()]})}),O.weeks.map((Z,se)=>{const oe=N(Z),ye=Z.some(ue=>ue.toDateString()===F.toDateString());return w.jsx("div",{className:"relative",id:ye?"today-marker":void 0,children:w.jsx("div",{className:`${u==="day"?"grid grid-cols-1":"grid grid-cols-7"} ${u==="day"?"min-h-[200px] md:min-h-[300px]":u==="week"?"min-h-[150px] md:min-h-[200px]":u==="year"?"min-h-[60px] md:min-h-[80px]":"min-h-[100px] md:min-h-[140px]"}`,children:Z.map(ue=>{const Te=ue.getMonth()===O.monthStart.getMonth(),H=ue.toDateString()===F.toDateString();return w.jsxs("div",{className:`border-r border-b border-border last:border-r-0 ${u==="day"?"p-2 md:p-4":u==="week"?"p-1 md:p-3":u==="year"?"p-0.5 md:p-1":"p-1 md:p-2"} ${Te?"bg-bg":"bg-bg-inset/30 text-fg-muted"} ${H?"bg-accent/5 font-bold":""}`,onDrop:ne=>j(ne,ue),onDragOver:D,children:[w.jsx("div",{className:`mb-1 ${u==="day"?"text-base md:text-lg":u==="week"?"text-sm md:text-base":u==="year"?"text-[10px] md:text-xs":"text-xs md:text-sm"}`,children:u==="day"?`${qb[ue.getDay()]} ${ue.getDate()}`:ue.getDate()}),oe.filter(ne=>ue>=ne.startDate&&ue<=ne.endDate).slice(0,u==="year"?1:u==="week"?3:void 0).map((ne,G)=>w.jsx("div",{className:`mb-1 rounded border ${Wb[G%Wb.length]} cursor-move ${u==="day"?"text-sm md:text-base p-2":u==="week"?"text-xs md:text-sm p-1":u==="year"?"text-[8px] md:text-[10px] p-0.5":"text-[10px] md:text-xs p-1"}`,draggable:!0,onDragStart:()=>T(ne),title:`${ne.title} (${ne.boardName})`,children:w.jsx("div",{className:"truncate",children:u==="year"?"":ne.title})},`${ne.id}-${ue.toISOString()}`)),u==="year"&&oe.filter(ne=>ue>=ne.startDate&&ue<=ne.endDate).length>1&&w.jsxs("div",{className:"text-[8px] text-fg-muted",children:["+",oe.filter(ne=>ue>=ne.startDate&&ue<=ne.endDate).length-1]})]},ue.toISOString())})})},se)})]},`${O.monthStart.getFullYear()}-${O.monthStart.getMonth()}`)})}),n&&m.data&&w.jsxs("div",{className:"border-t border-border p-2 md:p-4 bg-surface flex-shrink-0",children:[w.jsx("div",{className:"text-xs md:text-sm font-medium mb-2",children:"Boards"}),w.jsx("div",{className:"flex flex-wrap gap-2",children:m.data.filter(O=>v.some(F=>F.boardId===O.id)).map((O,F)=>{const Z=v.filter(se=>se.boardId===O.id).length;return w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("input",{type:"checkbox",checked:i.has(O.name),onChange:()=>P(O.name),className:"w-3 h-3 text-accent bg-bg border-border rounded focus:ring-accent focus:ring-1"}),w.jsxs("span",{className:"text-xs md:text-sm",children:[O.name," (",Z,")"]})]},O.id)})})]}),t&&w.jsx(ig,{boardId:t}),n&&m.data&&m.data.length>0&&w.jsx(ig,{boardId:m.data[0].id})]})}function CU(){return w.jsxs("div",{className:"p-4",children:[w.jsx("h2",{className:"text-xl font-semibold",children:"Dashboard"}),w.jsx("p",{className:"text-neutral-400",children:"TODO: counts by list, overdue cards"})]})}function EU(){const{boardId:t}=Io(),n=St({queryKey:["board-locs",t],queryFn:()=>Jy(t),enabled:!!t}).data||[],r=n.length?[n[0].lat,n[0].lng]:[39.5296,-119.8138];return w.jsxs("div",{className:"min-h-screen bg-app text-app",children:[w.jsx($h,{}),w.jsx("div",{className:"p-4",children:w.jsx("div",{className:"h-[70vh] rounded overflow-hidden border border-app",children:w.jsxs(BE,{center:r,zoom:n.length?8:4,style:{height:"100%",width:"100%"},children:[w.jsx(FE,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),n.map(i=>w.jsx(Mg,{position:[i.lat,i.lng],children:w.jsx(K3,{children:i.title})},i.id))]})})})]})}const TU="/Project-managment-app",PU=RN([{path:"/",element:w.jsx(WI,{}),children:[{index:!0,element:w.jsx(aj,{})},{path:"dev/status",element:w.jsx(lj,{})},{path:"w/:workspaceId",element:w.jsx(oj,{})},{path:"w/:workspaceId/calendar",element:w.jsx(Kb,{})},{path:"b/:boardId/board",element:w.jsx(xU,{})},{path:"b/:boardId/table",element:w.jsx(SU,{})},{path:"b/:boardId/calendar",element:w.jsx(Kb,{})},{path:"b/:boardId/dashboard",element:w.jsx(CU,{})},{path:"b/:boardId/map",element:w.jsx(EU,{})}]}],{basename:TU});function MU({children:t}){const[e,n]=q.useState(!1);return typeof window<"u"&&window.location.pathname.startsWith("/dev/status")?w.jsx(w.Fragment,{children:t}):(q.useEffect(()=>{(async()=>{try{const s=be(),{data:o}=await s.auth.getSession();if(o.session){n(!0);return}const l="gabrielriosemail@gmail.com",u="y3WDQjPBMgVlscwBSWKD8t5GQau9ia15",{error:d}=await s.auth.signInWithPassword({email:l,password:u});d&&console.error("Demo sign-in failed:",d.message)}catch(s){console.error(s)}finally{n(!0)}})()},[]),e?w.jsx(w.Fragment,{children:t}):null)}const OU=new gL;function NU(){return w.jsx(q.StrictMode,{children:w.jsx(yL,{client:OU,children:w.jsx(MU,{children:w.jsxs("div",{className:"min-h-screen bg-app text-app",children:[w.jsx(UN,{router:PU,future:{v7_startTransition:!0}}),w.jsx(A1,{})]})})})})}typeof document<"u"&&Ip.createRoot(document.getElementById("root")).render(w.jsx(NU,{}));
